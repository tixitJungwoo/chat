{"version":3,"sources":["meteor://ğŸ’»app/packages/rocketchat:message-pin/client/lib/PinnedMessage.js","meteor://ğŸ’»app/packages/rocketchat:message-pin/client/actionButton.js","meteor://ğŸ’»app/packages/rocketchat:message-pin/client/messageType.js","meteor://ğŸ’»app/packages/rocketchat:message-pin/client/pinMessage.js","meteor://ğŸ’»app/packages/rocketchat:message-pin/client/tabBar.js","meteor://ğŸ’»app/packages/rocketchat:message-pin/client/views/pinnedMessages.js"],"names":["PinnedMessage","Mongo","Collection","toastr","module","watch","require","v","Meteor","startup","RocketChat","MessageAction","addButton","id","icon","i18nLabel","context","action","message","_arguments","pinned","call","error","handleError","validation","models","Subscriptions","findOne","rid","settings","get","authz","hasAtLeastOnePermission","order","hideDropDown","RoomHistoryManager","getSurroundingMessages","classes","$","event","currentTarget","attr","getPermaLink","_id","success","TAPi18n","__","MessageTypes","registerType","system","methods","pinMessage","userId","ChatMessage","update","$set","unpinMessage","Tracker","autorun","TabBar","groups","i18nTitle","template","removeButton","Template","pinnedMessages","helpers","hasMessages","find","sort","ts","count","messages","_","extend","customClass","hasMore","instance","onCreated","ReactiveVar","limit","data","currentData","subscribe","set","events","e","t","stopPropagation","preventDefault","message_id","closest","remove","actions","getButtons","el","Blaze","toHTMLWithData","messageDropdown","append","dropDown","show","throttle","target","scrollTop","scrollHeight","clientHeight"],"mappings":"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","file":"/packages/rocketchat_message-pin.js","sourcesContent":["this.PinnedMessage = new Mongo.Collection('rocketchat_pinned_message');\n","import toastr from 'toastr';\n\nMeteor.startup(function() {\n\tRocketChat.MessageAction.addButton({\n\t\tid: 'pin-message',\n\t\ticon: 'icon-pin',\n\t\ti18nLabel: 'Pin_Message',\n\t\tcontext: ['pinned', 'message', 'message-mobile'],\n\n\t\taction() {\n\t\t\tconst message = this._arguments[1];\n\t\t\tmessage.pinned = true;\n\t\t\treturn Meteor.call('pinMessage', message, function(error) {\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tvalidation(message) {\n\t\t\tif (RocketChat.models.Subscriptions.findOne({ rid: message.rid }) == null) {\n\t\t\t\treturn false;\n\t\t\t} else if (message.pinned || !RocketChat.settings.get('Message_AllowPinning')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn RocketChat.authz.hasAtLeastOnePermission('pin-message', message.rid);\n\t\t},\n\t\torder: 20\n\t});\n\n\tRocketChat.MessageAction.addButton({\n\t\tid: 'unpin-message',\n\t\ticon: 'icon-pin rotate-45',\n\t\ti18nLabel: 'Unpin_Message',\n\t\tcontext: ['pinned', 'message', 'message-mobile'],\n\t\taction() {\n\t\t\tconst message = this._arguments[1];\n\t\t\tmessage.pinned = false;\n\t\t\treturn Meteor.call('unpinMessage', message, function(error) {\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tvalidation(message) {\n\t\t\tif (RocketChat.models.Subscriptions.findOne({ rid: message.rid }) == null) {\n\t\t\t\treturn false;\n\t\t\t} else if (!message.pinned || !RocketChat.settings.get('Message_AllowPinning')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn RocketChat.authz.hasAtLeastOnePermission('pin-message', message.rid);\n\t\t},\n\t\torder: 21\n\t});\n\n\tRocketChat.MessageAction.addButton({\n\t\tid: 'jump-to-pin-message',\n\t\ticon: 'icon-right-hand',\n\t\ti18nLabel: 'Jump_to_message',\n\t\tcontext: ['pinned'],\n\t\taction() {\n\t\t\tconst message = this._arguments[1];\n\t\t\tRocketChat.MessageAction.hideDropDown();\n\t\t\treturn RoomHistoryManager.getSurroundingMessages(message, 50);\n\t\t},\n\t\tvalidation(message) {\n\t\t\tif (RocketChat.models.Subscriptions.findOne({ rid: message.rid }) == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\torder: 100\n\t});\n\n\treturn RocketChat.MessageAction.addButton({\n\t\tid: 'permalink-pinned',\n\t\ticon: 'icon-link',\n\t\ti18nLabel: 'Permalink',\n\t\tclasses: 'clipboard',\n\t\tcontext: ['pinned'],\n\t\taction() {\n\t\t\tconst message = this._arguments[1];\n\t\t\tRocketChat.MessageAction.hideDropDown();\n\t\t\t$(event.currentTarget).attr('data-clipboard-text', RocketChat.MessageAction.getPermaLink(message._id));\n\t\t\treturn toastr.success(TAPi18n.__('Copied'));\n\t\t},\n\n\t\tvalidation(message) {\n\t\t\tif (RocketChat.models.Subscriptions.findOne({ rid: message.rid }) == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\torder: 101\n\t});\n});\n","Meteor.startup(function() {\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'message_pinned',\n\t\tsystem: true,\n\t\tmessage: 'Pinned_a_message'\n\t});\n});\n","Meteor.methods({\n\tpinMessage(message) {\n\t\tif (!Meteor.userId()) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!RocketChat.settings.get('Message_AllowPinning')) {\n\t\t\treturn false;\n\t\t}\n\t\tif (RocketChat.models.Subscriptions.findOne({ rid: message.rid }) == null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn ChatMessage.update({\n\t\t\t_id: message._id\n\t\t}, {\n\t\t\t$set: {\n\t\t\t\tpinned: true\n\t\t\t}\n\t\t});\n\t},\n\tunpinMessage(message) {\n\t\tif (!Meteor.userId()) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!RocketChat.settings.get('Message_AllowPinning')) {\n\t\t\treturn false;\n\t\t}\n\t\tif (RocketChat.models.Subscriptions.findOne({ rid: message.rid }) == null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn ChatMessage.update({\n\t\t\t_id: message._id\n\t\t}, {\n\t\t\t$set: {\n\t\t\t\tpinned: false\n\t\t\t}\n\t\t});\n\t}\n});\n","Meteor.startup(function() {\n\treturn Tracker.autorun(function() {\n\t\tif (RocketChat.settings.get('Message_AllowPinning')) {\n\t\t\treturn RocketChat.TabBar.addButton({\n\t\t\t\tgroups: ['channel', 'group', 'direct'],\n\t\t\t\tid: 'pinned-messages',\n\t\t\t\ti18nTitle: 'Pinned_Messages',\n\t\t\t\ticon: 'icon-pin',\n\t\t\t\ttemplate: 'pinnedMessages',\n\t\t\t\torder: 10\n\t\t\t});\n\t\t} else {\n\t\t\treturn RocketChat.TabBar.removeButton('pinned-messages');\n\t\t}\n\t});\n});\n","/* globals PinnedMessage */\nTemplate.pinnedMessages.helpers({\n\thasMessages() {\n\t\treturn PinnedMessage.find({\n\t\t\trid: this.rid\n\t\t}, {\n\t\t\tsort: {\n\t\t\t\tts: -1\n\t\t\t}\n\t\t}).count() > 0;\n\t},\n\tmessages() {\n\t\treturn PinnedMessage.find({\n\t\t\trid: this.rid\n\t\t}, {\n\t\t\tsort: {\n\t\t\t\tts: -1\n\t\t\t}\n\t\t});\n\t},\n\tmessage() {\n\t\treturn _.extend(this, {\n\t\t\tcustomClass: 'pinned'\n\t\t});\n\t},\n\thasMore() {\n\t\treturn Template.instance().hasMore.get();\n\t}\n});\n\nTemplate.pinnedMessages.onCreated(function() {\n\tthis.hasMore = new ReactiveVar(true);\n\tthis.limit = new ReactiveVar(50);\n\treturn this.autorun(() => {\n\t\tconst data = Template.currentData();\n\t\treturn this.subscribe('pinnedMessages', data.rid, this.limit.get(), () => {\n\t\t\tif (PinnedMessage.find({\n\t\t\t\trid: data.rid\n\t\t\t}).count() < this.limit.get()) {\n\t\t\t\treturn this.hasMore.set(false);\n\t\t\t}\n\t\t});\n\t});\n});\n\nTemplate.pinnedMessages.events({\n\t'click .message-cog'(e, t) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst message_id = $(e.currentTarget).closest('.message').attr('id');\n\t\tRocketChat.MessageAction.hideDropDown();\n\t\tt.$(`\\#${ message_id } .message-dropdown`).remove();\n\t\tconst message = PinnedMessage.findOne(message_id);\n\t\tconst actions = RocketChat.MessageAction.getButtons(message, 'pinned');\n\t\tconst el = Blaze.toHTMLWithData(Template.messageDropdown, {\n\t\t\tactions\n\t\t});\n\t\tt.$(`\\#${ message_id } .message-cog-container`).append(el);\n\t\tconst dropDown = t.$(`\\#${ message_id } .message-dropdown`);\n\t\treturn dropDown.show();\n\t},\n\t'scroll .content': _.throttle(function(e, instance) {\n\t\tif (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight && instance.hasMore.get()) {\n\t\t\treturn instance.limit.set(instance.limit.get() + 50);\n\t\t}\n\t}, 200)\n});\n"]}