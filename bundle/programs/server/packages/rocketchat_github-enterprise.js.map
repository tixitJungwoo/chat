{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:github-enterprise/common.js","meteor://ðŸ’»app/packages/rocketchat:github-enterprise/startup.js"],"names":["config","serverURL","identityPath","authorizePath","tokenPath","addAutopublishFields","forLoggedInUser","forOtherUsers","GitHubEnterprise","CustomOAuth","Meteor","isServer","startup","RocketChat","settings","get","key","value","configure","Tracker","autorun","addGroup","section","enableQuery","_id","add","type","i18nDescription","readonly","force"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wB,CAEA;AACA;AAEA,IAAMA,SAAS;AACdC,YAAW,EADG;AAEdC,eAAc,cAFA;AAGdC,gBAAe,wBAHD;AAIdC,YAAW,2BAJG;AAKdC,uBAAsB;AACrBC,mBAAiB,CAAC,4BAAD,CADI;AAErBC,iBAAe,CAAC,qCAAD;AAFM;AALR,CAAf;AAWA,IAAMC,mBAAmB,IAAIC,WAAJ,CAAgB,mBAAhB,EAAqCT,MAArC,CAAzB;;AAEA,IAAIU,OAAOC,QAAX,EAAqB;AACpBD,QAAOE,OAAP,CAAe,YAAW;AACzBC,aAAWC,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,EAAqD,UAASC,GAAT,EAAcC,KAAd,EAAqB;AACzEjB,UAAOC,SAAP,GAAmBgB,KAAnB;AACAT,oBAAiBU,SAAjB,CAA2BlB,MAA3B;AACA,GAHD;AAIA,EALD;AAMA,CAPD,MAOO;AACNU,QAAOE,OAAP,CAAe,YAAW;AACzBO,UAAQC,OAAR,CAAgB,YAAW;AAC1B,OAAIP,WAAWC,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,CAAJ,EAA0D;AACzDf,WAAOC,SAAP,GAAmBY,WAAWC,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,CAAnB;AACAP,qBAAiBU,SAAjB,CAA2BlB,MAA3B;AACA;AACD,GALD;AAMA,EAPD;AAQA,kG;;;;;;;;;;;AClCDa,WAAWC,QAAX,CAAoBO,QAApB,CAA6B,OAA7B,EAAsC,YAAW;AAChD,MAAKC,OAAL,CAAa,mBAAb,EAAkC,YAAW;AAC5C,MAAMC,cAAc;AACnBC,QAAK,kCADc;AAEnBP,UAAO;AAFY,GAApB;AAKA,OAAKQ,GAAL,CAAS,kCAAT,EAA6C,KAA7C,EAAoD;AAAEC,SAAM;AAAR,GAApD;AACA,OAAKD,GAAL,CAAS,2BAAT,EAAsC,EAAtC,EAA0C;AAAEC,SAAM,QAAR;AAAkB,aAAQ,IAA1B;AAAgCH,2BAAhC;AAA6CI,oBAAiB;AAA9D,GAA1C;AACA,OAAKF,GAAL,CAAS,qCAAT,EAAgD,EAAhD,EAAoD;AAAEC,SAAM,QAAR;AAAkBH;AAAlB,GAApD;AACA,OAAKE,GAAL,CAAS,yCAAT,EAAoD,EAApD,EAAwD;AAAEC,SAAM,QAAR;AAAkBH;AAAlB,GAAxD;AACA,OAAKE,GAAL,CAAS,+CAAT,EAA0D,0BAA1D,EAAsF;AAAEC,SAAM,aAAR;AAAuBE,aAAU,IAAjC;AAAuCC,UAAO,IAA9C;AAAoDN;AAApD,GAAtF;AACA,EAXD;AAYA,CAbD,iG","file":"/packages/rocketchat_github-enterprise.js","sourcesContent":["/* global CustomOAuth */\n\n// GitHub Enterprise Server CallBack URL needs to be http(s)://{rocketchat.server}[:port]/_oauth/github_enterprise\n// In RocketChat -> Administration the URL needs to be http(s)://{github.enterprise.server}/\n\nconst config = {\n\tserverURL: '',\n\tidentityPath: '/api/v3/user',\n\tauthorizePath: '/login/oauth/authorize',\n\ttokenPath: '/login/oauth/access_token',\n\taddAutopublishFields: {\n\t\tforLoggedInUser: ['services.github-enterprise'],\n\t\tforOtherUsers: ['services.github-enterprise.username']\n\t}\n};\n\nconst GitHubEnterprise = new CustomOAuth('github_enterprise', config);\n\nif (Meteor.isServer) {\n\tMeteor.startup(function() {\n\t\tRocketChat.settings.get('API_GitHub_Enterprise_URL', function(key, value) {\n\t\t\tconfig.serverURL = value;\n\t\t\tGitHubEnterprise.configure(config);\n\t\t});\n\t});\n} else {\n\tMeteor.startup(function() {\n\t\tTracker.autorun(function() {\n\t\t\tif (RocketChat.settings.get('API_GitHub_Enterprise_URL')) {\n\t\t\t\tconfig.serverURL = RocketChat.settings.get('API_GitHub_Enterprise_URL');\n\t\t\t\tGitHubEnterprise.configure(config);\n\t\t\t}\n\t\t});\n\t});\n}\n","RocketChat.settings.addGroup('OAuth', function() {\n\tthis.section('GitHub Enterprise', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_GitHub_Enterprise',\n\t\t\tvalue: true\n\t\t};\n\n\t\tthis.add('Accounts_OAuth_GitHub_Enterprise', false, { type: 'boolean' });\n\t\tthis.add('API_GitHub_Enterprise_URL', '', { type: 'string', public: true, enableQuery, i18nDescription: 'API_GitHub_Enterprise_URL_Description' });\n\t\tthis.add('Accounts_OAuth_GitHub_Enterprise_id', '', { type: 'string', enableQuery });\n\t\tthis.add('Accounts_OAuth_GitHub_Enterprise_secret', '', { type: 'string', enableQuery });\n\t\tthis.add('Accounts_OAuth_GitHub_Enterprise_callback_url', '_oauth/github_enterprise', { type: 'relativeUrl', readonly: true, force: true, enableQuery });\n\t});\n});\n"]}