{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:lib/lib/core.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/getURL.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/settings.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/callbacks.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/fileUploadRestrictions.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/placeholders.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/promises.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/roomTypesCommon.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/slashCommand.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/Message.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/MessageTypes.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/startup/settingsOnLoadSiteUrl.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/debug.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/bugsnag.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/metrics.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/RateLimiter.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/configLogger.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/PushNotification.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/defaultBlockedDomainsList.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/notifyUsersOnMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/roomTypes.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/sendEmailOnMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/sendNotificationsOnMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/validateEmailDomain.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/isDocker.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/addUserToDefaultChannels.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/addUserToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/archiveRoom.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/functions/checkUsernameAvailability.coffee","meteor://ðŸ’»app/server/functions/checkUsernameAvailability.coffee.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/checkEmailAvailability.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/createRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/deleteMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/deleteUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/getFullUserData.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/getRoomByNameOrIdWithOptionToJoin.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/removeUserFromRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/saveUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/saveCustomFields.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/functions/sendMessage.coffee","meteor://ðŸ’»app/server/functions/sendMessage.coffee.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/functions/settings.coffee","meteor://ðŸ’»app/server/functions/settings.coffee.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setUserAvatar.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/functions/setUsername.coffee","meteor://ðŸ’»app/server/functions/setUsername.coffee.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setRealName.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/unarchiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/updateMessage.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/functions/Notifications.coffee","meteor://ðŸ’»app/server/functions/Notifications.coffee.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_Base.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/models/Messages.coffee","meteor://ðŸ’»app/server/models/Messages.coffee.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Reports.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/models/Rooms.coffee","meteor://ðŸ’»app/server/models/Rooms.coffee.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/models/Settings.coffee","meteor://ðŸ’»app/server/models/Settings.coffee.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/models/Subscriptions.coffee","meteor://ðŸ’»app/server/models/Subscriptions.coffee.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/models/Uploads.coffee","meteor://ðŸ’»app/server/models/Uploads.coffee.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/models/Users.coffee","meteor://ðŸ’»app/server/models/Users.coffee.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_BaseCache.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_BaseDb.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/oauth/oauth.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/oauth/google.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/oauth/proxy.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/statsTracker.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/cache/CacheLoad.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/settingsOnLoadCdnPrefix.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/settingsOnLoadSMTP.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/oAuthServicesUpdate.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/settings.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/publications/settings.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/refreshOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addUserToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addUsersToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/archiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/blockUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/checkRegistrationSecretURL.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/cleanChannelHistory.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/createChannel.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/createToken.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/createPrivateGroup.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/deleteMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/deleteUserOwnAccount.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/filterBadWords.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/filterATAllTag.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getChannelHistory.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getFullUserData.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getRoomRoles.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getServerInfo.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getUserRoles.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/insertOrUpdateUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/joinDefaultChannels.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/joinRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/leaveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/removeOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/restartServer.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/robotMethods.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/saveSetting.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/sendInvitationEmail.js","meteor://ðŸ’»app/packages/rocketchat_lib/server/methods/sendMessage.coffee","meteor://ðŸ’»app/server/methods/sendMessage.coffee.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/sendSMTPTestEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setAdminStatus.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setRealName.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setUsername.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/unarchiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/unblockUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/updateMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/startup/defaultRoomTypes.js"],"names":["RocketChat","models","getURL","path","cdn","full","cdnPrefix","_","rtrim","trim","settings","get","pathPrefix","__meteor_runtime_config__","ROOT_URL_PATH_PREFIX","basePath","finalPath","ltrim","Meteor","isCordova","absoluteUrl","callbacks","regexCallbacks","ts","Date","_id","callback","onload","Object","keys","forEach","value","key","isRegExp","test","reduce","items","push","set","call","batchSet","save","setting","editor","actions","map","reduceRight","wrap","err","success","load","initialLoad","item","cbValue","cbKey","regex","concat","k","name","source","isServer","showTime","showTotalTime","priority","HIGH","MEDIUM","LOW","add","hook","id","isNumber","Random","Error","stack","find","cb","remove","hookName","reject","run","constant","length","totalTime","result","sortBy","time","now","callbackResult","currentTime","statsTracker","timing","split","match","console","log","String","runAsync","defer","fileUploadMediaWhiteList","mediaTypeWhiteList","fileUploadIsValidContentType","type","list","contains","wildCardGlob","wildcards","filter","indexOf","replace","placeholders","str","data","strLeft","strRightBack","email","password","unsubscribe","promises","p","Promise","resolve","previousPromise","then","roomTypesCommon","roomTypes","roomTypesOrder","mainOrder","identifier","order","config","route","action","routeConfig","isClient","triggersExit","roomExit","FlowRouter","hasCustomLink","roomType","link","getRouteLink","subData","routeData","openRouteLink","queryParams","go","module","exportDefault","slashCommands","commands","command","options","params","description","clientOnly","methods","slashCommand","userId","method","cmd","msg","Message","parse","language","messageType","MessageTypes","getType","render","template","message","localStorage","getItem","TAPi18n","__","u","username","html","escapeHTML","types","registerType","t","isSystemMessage","system","isChartMessage","startup","room_name","user_by","user_added","user_removed","user_left","user","user_muted","user_unmuted","role","host","ROOT_URL","defaultOptions","rootUrl","hostname","process","env","MOBILE_ROOT_URL","MOBILE_DDP_URL","WebAppInternals","generateBoilerplate","logger","Logger","publish","wrapMethods","originalHandler","methodsMap","args","Array","prototype","slice","arguments","apply","originalMeteorMethods","methodMap","each","handler","originalMeteorPublish","func","bugsnag","watch","require","v","register","notify","Info","app","version","info","error","on","bindEnvironment","originalMeteorDebug","_debug","client","promclient","metrics","messagesSent","Counter","RateLimiter","limitFunction","fn","numRequests","timeInterval","matchers","TEST_MODE","rateLimiter","addRule","matcher","increment","rateLimitResult","check","allowed","Math","ceil","timeToReset","seconds","limitMethod","methodName","DDPRateLimiter","LoggerManager","showPackage","showFileAndLine","logLevel","parseInt","setTimeout","enable","PushNotification","getNotificationId","roomId","serverId","hash","i","charCodeAt","send","roomName","usersTo","payload","title","icon","url","defaultUrl","from","badge","sound","text","query","notId","gcm","style","summaryText","image","apn","Push","emailDomainDefaultBlackList","moment","room","editedAt","abs","diff","Rooms","incMsgCountById","rid","messageContainsHighlight","highlights","has","some","highlight","regexp","RegExp","s","escapeRegExp","Subscriptions","incUnreadOfDirectForRoomIdExcludingUserId","toAll","mentionIds","highlightsIds","Users","findUsersByUsernamesWithHighlights","usernames","fields","fetch","mentions","mention","preferences","incUnreadForRoomIdExcludingUserId","incUnreadForRoomIdAndUserIds","compact","unique","incMsgCountAndSetLastMessageTimestampById","setAlertForRoomIdExcludingUserId","setPublish","setRoomFind","roomFind","getRoomFind","runPublish","scope","emailSubject","usersToSendEmail","directMessage","getMessageLink","sub","roomPath","join","divisorMessage","messageHTML","tokens","token","header","footer","findWithSendEmailByRoomId","disableNotifications","emailNotifications","userIdsToSendEmail","defaultLink","linkByUser","findByRoomIdAndUserIds","usersOfMention","getUsersToSendOfflineEmail","siteName","emailNotificationMode","emails","verified","to","address","subject","Email","findOneById","canBeNotified","mobile","desktop","alwaysNotifyDesktopUsers","dontNotifyDesktopUsers","alwaysNotifyMobileUsers","dontNotifyMobileUsers","desktopNotificationDurations","notificationPreferencesByRoom","findNotificationPreferencesByRoom","subscription","desktopNotifications","mobilePushNotifications","desktopNotificationDuration","userIdsToNotify","userIdsToPushNotify","usersWithHighlights","push_message","push_username","push_room","userOfMentionId","userOfMention","findOne","statusConnection","Sandstorm","Notifications","notifyUser","duration","sender","enabled","toHere","desktopMentionIds","union","difference","usersOfDesktopMentions","$in","active","callJoin","usersOfMentionItem","runAsUser","pluck","mobileMentionIds","usersOfMobileMentions","$ne","status","includes","without","usersOfMentionId","allUserIdsToNotify","dns","Npm","emailDomainBlackList","emailDomainWhiteList","useDefaultBlackList","useDNSDomainCheck","domain","validateEmailDomain","emailValidation","emailDomain","substr","lastIndexOf","wrapAsync","resolveMx","e","fs","hasDockerEnv","statSync","hasDockerCGroup","readFileSync","isDocker","undefined","addUserToDefaultChannels","silenced","defaultRooms","findByDefaultAndTypes","muted","ro","authz","hasPermission","addUsernameById","findOneByRoomIdAndUserId","createWithRoomAndUser","open","alert","unread","Messages","createUserJoinWithRoomIdAndUser","addUserToRoom","inviter","createUserAddedWithRoomIdAndUser","archiveRoom","archiveById","archiveByRoomId","checkUsernameAvailability","usernameBlackList","_this","len","restrictedUsername","users","$regex","checkEmailAvailability","createRoom","owner","members","readOnly","extraData","findOneByUsername","nameValidation","findOneByName","archived","sysMes","assign","createWithTypeNameUserAndUsernames","member","muteUsernameByRoomId","extra","ls","addUserRoles","deleteMessage","keepHistory","showDeletedStatus","deletedMsg","cloneAndSaveAsHistoryById","setHiddenById","file","Uploads","update","$set","_hidden","removeById","FileUpload","delete","setAsDeletedByIdAndUser","notifyRoom","deleteUser","removeByUserId","findByUserId","removeByRoomId","removeByTypeContainingUsername","removeUsernameFromAll","avatarOrigin","RocketChatFileAvatarInstance","deleteFile","encodeURIComponent","Integrations","disableByUserId","getFullUserData","limit","utcOffset","extend","phone","createdAt","lastLogin","services","requirePasswordChange","requirePasswordChangeReason","roles","customFields","sort","findByUsername","filterReg","findByUsernameNameOrEmailAddress","getRoomByNameOrIdWithOptionToJoin","_getRoomByNameOrIdWithOptionToJoin","currentUserId","nameOrId","tryDirectByUserIdOnly","joinChannel","errorOnEmpty","startsWith","substring","findOneByIdOrName","roomUser","$or","isObject","removeUserFromRoom","removeUsernameById","removedUser","createUserLeaveWithRoomIdAndUser","createCommandWithRoomIdAndUser","removeByRoomIdAndUserId","saveUser","userData","existingRoles","getRoles","field","escape","input","createUser","joinDefaultChannels","Accounts","updateUser","sendWelcomeEmail","lng","gravatarUrl","Gravatar","imageUrl","size","secure","setUserAvatar","setUsername","setRealName","setEmail","setPassword","saveCustomFields","formData","customFieldsMeta","JSON","fieldName","required","maxLength","minLength","setCustomFields","modifyRecordField","array","$addToSet","sendMessage","upsert","sandstormSessionId","updated_room","urls","pick","Match","parseUrls","insert","blockedSettings","hiddenSettings","ref","ref1","SETTINGS_BLOCKED","settingId","SETTINGS_HIDDEN","_sorter","base","existantSetting","ref2","ref3","ref4","ref5","updateOperations","group","packageValue","valueSource","hidden","blocked","sorter","enableQuery","stringify","i18nDefaultQuery","toLowerCase","processEnvValue","meteorSettingsValue","i18nLabel","i18nDescription","$setOnInsert","force","section","$unset","$exists","Settings","db","addGroup","isFunction","updateById","updateValueAndEditorById","updateValueById","updateOptionsById","clearById","init","results","observe","added","record","changed","removed","afterInitialLoad","onAfterInitialLoad","dataURI","contentType","service","encoding","setAvatarOrigin","HTTP","npmRequestOptions","response","statusCode","headers","content","fileData","RocketChatFile","dataURIParse","rs","bufferToStream","Buffer","ws","createWriteStream","notifyLogged","pipe","_setUsername","avatarData","avatarSuggestions","gravatar","previousUsername","error1","sendEnrollmentEmail","getAvatarSuggestionForUser","blob","updateAllUsernamesByUserId","updateUsernameOfEditByUserId","findByMention","updatedMsg","updateUsernameAndMessageOfMentionByIdAndOldUsername","replaceUsername","replaceMutedUsername","replaceUsernameOfUserByUserId","setUserUsernameByUserId","setNameForDirectRoomsWithOldName","getFileWithReadStream","readStream","_setRealName","setName","_setEmail","unarchiveRoom","unarchiveById","unarchiveByRoomId","updateMessage","editedBy","tempid","_Class","self","debug","streamAll","Streamer","streamLogged","streamRoom","streamRoomUsers","streamUser","allowWrite","eventName","subscriptions","findByRoomIdAndNotUserId","allowRead","notifyAll","unshift","emit","notifyAllInThisInstance","emitWithoutBroadcast","notifyLoggedInThisInstance","notifyRoomInThisInstance","notifyUserInThisInstance","ModelsBaseDb","ModelsBaseCache","_CacheControl","EnvironmentVariable","ModelsBase","nameOrModel","useCache","_db","model","collectionName","_useCache","cache","bind","getDynamicView","processQueryOptionsOnResult","constructor","arrayToCursor","count","setUpdatedAt","origin","findOneByIds","ids","insertOrUpsert","allow","deny","ensureIndex","dropIndex","tryEnsureIndex","tryDropIndex","trashFind","trashFindDeletedAfter","_Base","child","parent","hasProp","ctor","__super__","hasOwnProperty","superClass","sparse","expireAfterSeconds","findVisibleByMentionAndRoomId","findVisibleByRoomId","findVisibleByRoomIdNotContainingTypes","$nin","findInvisibleByRoomId","findVisibleByRoomIdAfterTimestamp","timestamp","$gt","findVisibleByRoomIdBeforeTimestamp","$lt","findVisibleByRoomIdBeforeTimestampInclusive","$lte","findVisibleByRoomIdBetweenTimestamps","afterTimestamp","beforeTimestamp","findVisibleByRoomIdBetweenTimestampsInclusive","$gte","findVisibleByRoomIdBeforeTimestampNotContainingTypes","findVisibleByRoomIdBetweenTimestampsNotContainingTypes","findVisibleCreatedOrEditedAfterTimestamp","findStarredByUserAtRoom","findPinnedByRoom","pinned","findSnippetedByRoom","snippeted","getLastTimestamp","findByRoomIdAndMessageIds","messageIds","findOneBySlackBotIdAndSlackTs","slackBotId","slackTs","findOneBySlackTs","me","attachments","reactions","setPinnedByIdAndUserId","pinnedBy","pinnedAt","setSnippetedByIdAndUserId","snippetName","snippetedBy","snippetedAt","setUrlsById","multi","oldUsername","newUsername","newMessage","updateUserStarById","starred","$pull","upgradeEtsToEditAt","ets","$rename","setMessageAttachments","setSlackBotIdAndSlackTs","createWithTypeRoomIdMessageAndUser","groupable","createUserRemovedWithRoomIdAndUser","createUserMutedWithRoomIdAndUser","createUserUnmutedWithRoomIdAndUser","createNewModeratorWithRoomIdAndUser","createModeratorRemovedWithRoomIdAndUser","createNewOwnerWithRoomIdAndUser","createOwnerRemovedWithRoomIdAndUser","createSubscriptionRoleAddedWithRoomIdAndUser","createSubscriptionRoleRemovedWithRoomIdAndUser","getMessageByFileId","fileID","Reports","createWithMessageDescriptionAndUserId","ModelRooms","ignoreUpdatedFields","_idOrName","findOneByImportId","importIds","findOneByNameAndType","findOneByIdContainingUsername","findOneByNameAndTypeNotContainingUsername","findById","findByIds","roomIds","findByType","findByTypes","findBySubscriptionUserId","_room","findBySubscriptionUserIdUpdatedAfter","_updatedAt","findByNameContaining","nameRegex","findByNameContainingTypesWithUsername","obj","findContainingTypesWithUsername","findByNameContainingAndTypes","findByNameAndType","findByNameAndTypeNotDefault","findByNameAndTypeNotContainingUsername","findByNameStartingAndTypes","defaultValue","findByTypeContainingUsername","findByTypeContainingUsernames","$all","findByTypesAndNotUserIdContainingUsername","uid","findByContainingUsername","findByTypeAndName","findByIndex","findByTypeAndNameContainingUsername","findByTypeAndArchivationState","archivationstate","addImportIds","$each","addUsernamesById","addUsernameByName","removeUsernamesById","removeUsernameByName","setNameById","inc","$inc","msgs","lastMessageTimestamp","lm","setJoinCodeById","joinCode","joinCodeRequired","setUserById","setTypeById","setTopicById","topic","setAnnouncementById","announcement","unmuteUsernameByRoomId","saveDefaultById","setTopicAndTagsById","tags","setData","unsetData","isEmpty","tag","createWithIdTypeAndName","ModelSettings","findOneNotHiddenById","findByRole","findPublic","findNotHiddenPublic","findNotHiddenPublicUpdatedAfter","updatedAt","findNotHiddenPrivate","findNotHidden","findNotHiddenUpdatedAfter","updateValueNotHiddenById","createWithIdAndValue","_createdAt","ModelSubscriptions","findOneByRoomNameAndUserId","findByUserIdUpdatedAfter","findByRoomIdAndRoles","findByTypeAndUserId","findByTypeNameAndUserId","findByRoomId","getLastSeen","userIds","hideByRoomIdAndUserId","openByRoomIdAndUserId","setAsReadByRoomIdAndUserId","setAsUnreadByRoomIdAndUserId","firstMessageUnreadTimestamp","setFavoriteByRoomIdAndUserId","favorite","f","updateNameAndAlertByRoomId","updateNameByRoomId","oldName","setBlockedByRoomId","blocker","query2","update2","unsetBlockedByRoomId","updateTypeByRoomId","addRoleById","removeRoleById","setArchivedByUsername","findNotHiddenFilesOfRoom","fileOptions","fileQuery","complete","uploading","uploadedAt","insertFileInit","store","progress","extension","direct","updateFileComplete","fileId","ModelUsers","findOneByEmailAddress","emailAddress","findOneAdmin","admin","findOneByIdAndLoginToken","_hashLoginToken","findUsersNotOffline","findActiveByUsernameOrNameRegexWithExceptions","searchTerm","exceptions","termRegex","isArray","$and","findByActiveUsersExcept","findUsersByNameOrUsername","nameOrUsername","usernameNameOrEmailAddress","findLDAPUsers","ldap","findCrowdUsers","crowd","getLastLogin","findUsersByUsernames","updateLastLoginById","setServiceId","serviceName","serviceId","serviceIdKey","setEmailVerified","$elemMatch","values","unsetAvatarOrigin","setUserActive","setAllUsersActive","unsetLoginTokens","unsetRequirePasswordChange","resetPasswordAndSetRequirePasswordChange","setLanguage","setProfile","profile","setPreferences","setUtcOffset","saveUserById","phoneNumber","create","usersIds","loki","EventEmitter","objectPath","lokiEq","LokiOps","$eq","lokiNe","a","b","lokiIn","subA","every","subB","findWhere","ignore","traceMethodCalls","target","_stats","property","calls","avg","origMethod","loaded","startTime","round","setInterval","_getStatsAvg","stats","Adapter","loadDatabase","saveDatabase","deleteDatabase","adapter","indexes","joins","collection","addCollection","hasOne","hasMany","processRemoteJoinInserted","remote","processRemoteJoinRemoved","localRecord","processLocalJoinInserted","local","localRecords","_findByIndex","where","mutableRecord","transform","records","splice","addToAllIndexes","indexName","addToIndex","index","removeFromAllIndexes","removeFromIndex","startSync","updateDiffById","r","direction","valueA","valueB","skip","fieldsToRemove","fieldsToGet","warn","pickFields","picked","omit","processQuery","parentField","and","subValue","observeChanges","_publishCursor","cursor","addDynamicView","updatedFields","updateRecord","topLevelFields","del","$min","curValue","$max","$mul","$pullAll","$pop","shift","pop","valueItem","removeWhere","baseName","trash","Mongo","Collection","_ensureIndex","_deletedAt","isOplogAvailable","MongoInternals","defaultRemoteCollectionDriver","mongo","_oplogHandle","onOplogEntry","isOplogEnabled","baseModel","_name","wrapModel","once","event","processOplogRecord","_defineTooFarBehind","Number","MAX_SAFE_INTEGER","originals","defineSyncStrategy","modifier","cacheAllowedModifiers","notAllowedModifiers","placeholderFields","updateHasPositionalOperator","op","o","oplog","listenerCount","strategy","findOptions","insertedId","_returnObject","__collection__","_dropIndex","deletedAt","AccessTokenServices","registerAccessTokenService","handleAccessTokenRequest","registerLoginHandler","accessToken","ObjectIncluding","ServiceConfiguration","configurations","ConfigError","oauth","serviceNames","LoginCancelledError","numericError","oauthResult","updateOrCreateUserFromExternalService","serviceData","getIdentity","access_token","getScopes","idToken","expiresIn","Integer","Maybe","identity","expiresAt","scopes","Google","whitelistedFields","refreshToken","OAuth","_redirectUri","proxy","StatsD","dogstatsd","track","hrtime","decrement","histogram","gauge","arr","applyFind","$size","testWebAppInternals","isString","setBundledJsCssPrefix","buildMailURL","debounce","MAIL_URL","oauth_updated","_OAuthServicesUpdate","clientId","secret","custom","serverURL","tokenPath","identityPath","authorizePath","buttonLabelText","buttonLabelColor","loginStyle","buttonColor","tokenSentVia","usernameField","mergeUsers","CustomOAuth","appId","consumerKey","OAuthServicesUpdate","OAuthServicesRemove","DEPLOYMENT_ID","readonly","actionText","code","multiline","placeholder","unblock","addOAuthService","capitalize","persistent","refreshOAuthService","addUsersToRoom","userInRoom","canAddUser","newUser","blockUser","subscription2","checkRegistrationSecretURL","cleanChannelHistory","latest","oldest","inclusive","Boolean","createChannel","Optional","createToken","_generateStampedLoginToken","_insertLoginToken","authToken","createPrivateGroup","originalMessage","deleteAllowed","deleteOwn","blockDeleteInMinutes","msgTs","currentTsDiff","deleteUserOwnAccount","bcrypt","_checkPassword","digest","algorithm","Filter","badWordsList","clean","getChannelHistory","unreads","fromUserId","isUndefined","isDate","UI_Use_Real_Name","messages","unreadNotLoaded","firstUnread","firstMsg","unreadMessages","getRoomRoles","Roles","getServerInfo","getUserRoles","roleIds","findUsersInRoles","intersection","insertOrUpdateUser","joinRoom","leaveRoom","hasRole","numOwners","getUsersInRole","removeOAuthService","restart_server","abort","exit","m","saveSetting","sendInvitationEmail","rfcMailPattern","validEmails","import","l","tsDiff","message_ts","server_ts","getTime","alias","sandstorm","connection","sendSMTPTestEmail","setAdminStatus","param","joinDefaultChannelsSilenced","unblockUser","editAllowed","editOwn","blockEditInMinutes","openRoom","findRoom","ChatRoom","roomData","condition","hasAtLeastOnePermission","showJoinLink","ChatSubscription","fname","secondaryRoomName","getUserStatus","Session","hasAllPermission"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;EAIAA,aAAa;AACZC,SAAQ;AADI,CAAb,0H;;;;;;;;;;;ACLAD,WAAWE,MAAX,GAAoB,UAACC,IAAD,EAA6C;AAAA,gFAAP,EAAO;AAAA,qBAApCC,GAAoC;AAAA,KAApCA,GAAoC,4BAA9B,IAA8B;AAAA,sBAAxBC,IAAwB;AAAA,KAAxBA,IAAwB,6BAAjB,KAAiB;;AAChE,KAAMC,YAAYC,EAAEC,KAAF,CAAQD,EAAEE,IAAF,CAAOT,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,YAAxB,KAAyC,EAAhD,CAAR,EAA6D,GAA7D,CAAlB;;AACA,KAAMC,aAAaL,EAAEC,KAAF,CAAQD,EAAEE,IAAF,CAAOI,0BAA0BC,oBAA1B,IAAkD,EAAzD,CAAR,EAAsE,GAAtE,CAAnB;;AAEA,KAAIC,iBAAJ;;AAEA,KAAMC,YAAYT,EAAEU,KAAF,CAAQV,EAAEE,IAAF,CAAON,IAAP,CAAR,EAAsB,GAAtB,CAAlB;;AAEA,KAAIC,OAAOE,cAAc,EAAzB,EAA6B;AAC5BS,aAAWT,YAAYM,UAAvB;AACA,EAFD,MAEO,IAAIP,QAAQa,OAAOC,SAAnB,EAA8B;AACpC,SAAOD,OAAOE,WAAP,CAAmBJ,SAAnB,CAAP;AACA,EAFM,MAEA;AACND,aAAWH,UAAX;AACA;;AAED,QAAWG,QAAX,SAAyBC,SAAzB;AACA,CAjBD,2H;;;;;;;;;;;ACCA;;;EAIAhB,WAAWU,QAAX,GAAsB;AACrBW,YAAW,EADU;AAErBC,iBAAgB,EAFK;AAGrBC,KAAI,IAAIC,IAAJ,EAHiB;AAIrBb,IAJqB,YAIjBc,GAJiB,EAIZC,QAJY,EAIF;AAClB,MAAIA,YAAY,IAAhB,EAAsB;AACrB1B,cAAWU,QAAX,CAAoBiB,MAApB,CAA2BF,GAA3B,EAAgCC,QAAhC;;AACA,OAAI,CAACR,OAAOR,QAAZ,EAAsB;AACrB;AACA;;AACD,OAAIe,QAAQ,GAAZ,EAAiB;AAChB,WAAOG,OAAOC,IAAP,CAAYX,OAAOR,QAAnB,EAA6BoB,OAA7B,CAAqC,eAAO;AAClD,SAAMC,QAAQb,OAAOR,QAAP,CAAgBsB,GAAhB,CAAd;AACAN,cAASM,GAAT,EAAcD,KAAd;AACA,KAHM,CAAP;AAIA;;AACD,OAAIxB,EAAE0B,QAAF,CAAWR,GAAX,KAAmBP,OAAOR,QAA9B,EAAwC;AACvC,WAAOkB,OAAOC,IAAP,CAAYX,OAAOR,QAAnB,EAA6BoB,OAA7B,CAAqC,eAAO;AAClD,SAAI,CAACL,IAAIS,IAAJ,CAASF,GAAT,CAAL,EAAoB;AACnB;AACA;;AACD,SAAMD,QAAQb,OAAOR,QAAP,CAAgBsB,GAAhB,CAAd;AACAN,cAASM,GAAT,EAAcD,KAAd;AACA,KANM,CAAP;AAOA;;AACD,UAAOb,OAAOR,QAAP,CAAgBe,GAAhB,KAAwB,IAAxB,IAAgCC,SAASD,GAAT,EAAcP,OAAOR,QAAP,CAAgBe,GAAhB,CAAd,CAAvC;AACA,GArBD,MAqBO;AACN,OAAI,CAACP,OAAOR,QAAZ,EAAsB;AACrB;AACA;;AACD,OAAIH,EAAE0B,QAAF,CAAWR,GAAX,CAAJ,EAAqB;AACpB,WAAOG,OAAOC,IAAP,CAAYX,OAAOR,QAAnB,EAA6ByB,MAA7B,CAAoC,UAACC,KAAD,EAAQJ,GAAR,EAAgB;AAC1D,SAAMD,QAAQb,OAAOR,QAAP,CAAgBsB,GAAhB,CAAd;;AACA,SAAIP,IAAIS,IAAJ,CAASF,GAAT,CAAJ,EAAmB;AAClBI,YAAMC,IAAN,CAAW;AACVL,eADU;AAEVD;AAFU,OAAX;AAIA;;AACD,YAAOK,KAAP;AACA,KATM,EASJ,EATI,CAAP;AAUA;;AACD,UAAOlB,OAAOR,QAAP,IAAmBQ,OAAOR,QAAP,CAAgBe,GAAhB,CAA1B;AACA;AACD,EA5CoB;AA6CrBa,IA7CqB,YA6CjBb,GA7CiB,EA6CZM,KA7CY,EA6CLL,QA7CK,EA6CK;AACzB,SAAOR,OAAOqB,IAAP,CAAY,aAAZ,EAA2Bd,GAA3B,EAAgCM,KAAhC,EAAuCL,QAAvC,CAAP;AACA,EA/CoB;AAgDrBc,SAhDqB,YAgDZ9B,QAhDY,EAgDFgB,QAhDE,EAgDQ;AAC5B;AACA;AACA,MAAMe,OAAO,UAASC,OAAT,EAAkB;AAC9B,UAAO,UAAShB,QAAT,EAAmB;AACzB,WAAOR,OAAOqB,IAAP,CAAY,aAAZ,EAA2BG,QAAQjB,GAAnC,EAAwCiB,QAAQX,KAAhD,EAAuDW,QAAQC,MAA/D,EAAuEjB,QAAvE,CAAP;AACA,IAFD;AAGA,GAJD;;AAKA,MAAMkB,UAAUrC,EAAEsC,GAAF,CAAMnC,QAAN,EAAgB,UAACgC,OAAD;AAAA,UAAaD,KAAKC,OAAL,CAAb;AAAA,GAAhB,CAAhB;;AACA,SAAOnC,EAAEqC,OAAF,EAAWE,WAAX,CAAuBvC,EAAEwC,IAAzB,EAA+B,UAACC,GAAD,EAAMC,OAAN;AAAA,UAAkBvB,SAASsB,GAAT,EAAcC,OAAd,CAAlB;AAAA,GAA/B,GAAP;AACA,EA1DoB;AA2DrBC,KA3DqB,YA2DhBlB,GA3DgB,EA2DXD,KA3DW,EA2DJoB,WA3DI,EA2DS;AAC7B,GAAC,GAAD,EAAMnB,GAAN,EAAWF,OAAX,CAAmB,gBAAQ;AAC1B,OAAI9B,WAAWU,QAAX,CAAoBW,SAApB,CAA8B+B,IAA9B,CAAJ,EAAyC;AACxCpD,eAAWU,QAAX,CAAoBW,SAApB,CAA8B+B,IAA9B,EAAoCtB,OAApC,CAA4C;AAAA,YAAYJ,SAASM,GAAT,EAAcD,KAAd,EAAqBoB,WAArB,CAAZ;AAAA,KAA5C;AACA;AACD,GAJD;AAKAvB,SAAOC,IAAP,CAAY7B,WAAWU,QAAX,CAAoBY,cAAhC,EAAgDQ,OAAhD,CAAwD,iBAAS;AAChE,OAAMuB,UAAUrD,WAAWU,QAAX,CAAoBY,cAApB,CAAmCgC,KAAnC,CAAhB;;AACA,OAAI,CAACD,QAAQE,KAAR,CAAcrB,IAAd,CAAmBF,GAAnB,CAAL,EAA8B;AAC7B;AACA;;AACDqB,WAAQhC,SAAR,CAAkBS,OAAlB,CAA0B;AAAA,WAAYJ,SAASM,GAAT,EAAcD,KAAd,EAAqBoB,WAArB,CAAZ;AAAA,IAA1B;AACA,GAND;AAOA,EAxEoB;AAyErBxB,OAzEqB,YAyEdK,GAzEc,EAyETN,QAzES,EAyEC;AACrB;AACA;AACA;AACA;AACA;AACA,MAAMG,OAAO,GAAG2B,MAAH,CAAUxB,GAAV,CAAb;AACAH,OAAKC,OAAL,CAAa,aAAK;AACjB,OAAIvB,EAAE0B,QAAF,CAAWwB,CAAX,CAAJ,EAAmB;AAClBzD,eAAWU,QAAX,CAAoBY,cAApB,CAAmCoC,OAAOD,EAAEE,MAA5C,IAAsD3D,WAAWU,QAAX,CAAoBY,cAApB,CAAmCoC,OAAOD,EAAEE,MAA5C,KAAuD;AAC5GJ,YAAOE,CADqG;AAE5GpC,gBAAW;AAFiG,KAA7G;AAIArB,eAAWU,QAAX,CAAoBY,cAApB,CAAmCmC,EAAEE,MAArC,EAA6CtC,SAA7C,CAAuDgB,IAAvD,CAA4DX,QAA5D;AACA,IAND,MAMO;AACN1B,eAAWU,QAAX,CAAoBW,SAApB,CAA8BoC,CAA9B,IAAmCzD,WAAWU,QAAX,CAAoBW,SAApB,CAA8BoC,CAA9B,KAAoC,EAAvE;AACAzD,eAAWU,QAAX,CAAoBW,SAApB,CAA8BoC,CAA9B,EAAiCpB,IAAjC,CAAsCX,QAAtC;AACA;AACD,GAXD;AAYA;AA5FoB,CAAtB,0H;;;;;;;;;;;ACLA;;;EAKA1B,WAAWqB,SAAX,GAAuB,EAAvB;;AAEA,IAAIH,OAAO0C,QAAX,EAAqB;AACpB5D,YAAWqB,SAAX,CAAqBwC,QAArB,GAAgC,IAAhC;AACA7D,YAAWqB,SAAX,CAAqByC,aAArB,GAAqC,IAArC;AACA,CAHD,MAGO;AACN9D,YAAWqB,SAAX,CAAqBwC,QAArB,GAAgC,KAAhC;AACA7D,YAAWqB,SAAX,CAAqByC,aAArB,GAAqC,KAArC;AACA,C,CAGD;;;;AAIA9D,WAAWqB,SAAX,CAAqB0C,QAArB,GAAgC;AAC/BC,OAAM,CAAC,IADwB;AAE/BC,SAAQ,CAFuB;AAG/BC,MAAK;AAH0B,CAAhC,C,CAOA;;;;;;AAMAlE,WAAWqB,SAAX,CAAqB8C,GAArB,GAA2B,UAASC,IAAT,EAAe1C,QAAf,EAAyBqC,QAAzB,EAAmCM,EAAnC,EAAuC;AACjE,KAAIN,YAAY,IAAhB,EAAsB;AACrBA,aAAW/D,WAAWqB,SAAX,CAAqB0C,QAArB,CAA8BE,MAAzC;AACA;;AACD,KAAI,CAAC1D,EAAE+D,QAAF,CAAWP,QAAX,CAAL,EAA2B;AAC1BA,aAAW/D,WAAWqB,SAAX,CAAqB0C,QAArB,CAA8BE,MAAzC;AACA;;AACDvC,UAASqC,QAAT,GAAoBA,QAApB;AACArC,UAAS2C,EAAT,GAAcA,MAAME,OAAOF,EAAP,EAApB;AACArE,YAAWqB,SAAX,CAAqB+C,IAArB,IAA6BpE,WAAWqB,SAAX,CAAqB+C,IAArB,KAA8B,EAA3D;;AACA,KAAIpE,WAAWqB,SAAX,CAAqBwC,QAArB,KAAkC,IAAtC,EAA4C;AAC3C,MAAMb,MAAM,IAAIwB,KAAJ,EAAZ;AACA9C,WAAS+C,KAAT,GAAiBzB,IAAIyB,KAArB;AACA;;AACD,KAAIzE,WAAWqB,SAAX,CAAqB+C,IAArB,EAA2BM,IAA3B,CAAgC,UAACC,EAAD;AAAA,SAAQA,GAAGN,EAAH,KAAU3C,SAAS2C,EAA3B;AAAA,EAAhC,CAAJ,EAAoE;AACnE;AACA;;AACDrE,YAAWqB,SAAX,CAAqB+C,IAArB,EAA2B/B,IAA3B,CAAgCX,QAAhC;AACA,CAlBD,C,CAqBA;;;;;;AAMA1B,WAAWqB,SAAX,CAAqBuD,MAArB,GAA8B,UAASC,QAAT,EAAmBR,EAAnB,EAAuB;AACpDrE,YAAWqB,SAAX,CAAqBwD,QAArB,IAAiCtE,EAAEuE,MAAF,CAAS9E,WAAWqB,SAAX,CAAqBwD,QAArB,CAAT,EAAyC,UAACnD,QAAD;AAAA,SAAcA,SAAS2C,EAAT,KAAgBA,EAA9B;AAAA,EAAzC,CAAjC;AACA,CAFD,C,CAKA;;;;;;;;AAQArE,WAAWqB,SAAX,CAAqB0D,GAArB,GAA2B,UAASX,IAAT,EAAehB,IAAf,EAAqB4B,QAArB,EAA+B;AACzD,KAAM3D,YAAYrB,WAAWqB,SAAX,CAAqB+C,IAArB,CAAlB;;AACA,KAAI/C,aAAaA,UAAU4D,MAA3B,EAAmC;AAClC,MAAIC,YAAY,CAAhB;;AACA,MAAMC,SAAS5E,EAAE6E,MAAF,CAAS/D,SAAT,EAAoB,UAASK,QAAT,EAAmB;AACrD,UAAOA,SAASqC,QAAT,IAAqB/D,WAAWqB,SAAX,CAAqB0C,QAArB,CAA8BE,MAA1D;AACA,GAFc,EAEZ9B,MAFY,CAEL,UAASgD,MAAT,EAAiBzD,QAAjB,EAA2B;AACpC,OAAI2D,OAAO,CAAX;;AACA,OAAIrF,WAAWqB,SAAX,CAAqBwC,QAArB,KAAkC,IAAlC,IAA0C7D,WAAWqB,SAAX,CAAqByC,aAArB,KAAuC,IAArF,EAA2F;AAC1FuB,WAAO7D,KAAK8D,GAAL,EAAP;AACA;;AACD,OAAMC,iBAAiB7D,SAASyD,MAAT,EAAiBH,QAAjB,CAAvB;;AACA,OAAIhF,WAAWqB,SAAX,CAAqBwC,QAArB,KAAkC,IAAlC,IAA0C7D,WAAWqB,SAAX,CAAqByC,aAArB,KAAuC,IAArF,EAA2F;AAC1F,QAAM0B,cAAchE,KAAK8D,GAAL,KAAaD,IAAjC;AACAH,iBAAaM,WAAb;;AACA,QAAIxF,WAAWqB,SAAX,CAAqBwC,QAArB,KAAkC,IAAtC,EAA4C;AAC3C,SAAI3C,OAAO0C,QAAX,EAAqB;AACpB5D,iBAAWyF,YAAX,CAAwBC,MAAxB,CAA+B,gBAA/B,EAAiDF,WAAjD,EAA8D,WAAUpB,IAAV,gBAAgC1C,SAAS2C,EAAzC,CAA9D;AACA,MAFD,MAEO;AACN,UAAII,QAAQ/C,SAAS+C,KAAT,IAAkB,OAAO/C,SAAS+C,KAAT,CAAekB,KAAtB,KAAgC,UAAlD,IAAgEjE,SAAS+C,KAAT,CAAekB,KAAf,CAAqB,IAArB,CAA5E;AACAlB,cAAQA,SAASA,MAAM,CAAN,CAAT,IAAqB,CAACA,MAAM,CAAN,EAASmB,KAAT,CAAe,QAAf,KAA0B,EAA3B,EAA+B,CAA/B,CAA7B;AACAC,cAAQC,GAAR,CAAYC,OAAOP,WAAP,CAAZ,EAAiCpB,IAAjC,EAAuC1C,SAAS2C,EAAhD,EAAoDI,KAApD;AACA;AACD;AACD;;AACD,UAAQ,OAAOc,cAAP,KAA0B,WAA3B,GAA0CJ,MAA1C,GAAmDI,cAA1D;AACA,GAtBc,EAsBZnC,IAtBY,CAAf;;AAuBA,MAAIpD,WAAWqB,SAAX,CAAqByC,aAArB,KAAuC,IAA3C,EAAiD;AAChD,OAAI5C,OAAO0C,QAAX,EAAqB;AACpB5D,eAAWyF,YAAX,CAAwBC,MAAxB,CAA+B,qBAA/B,EAAsDR,SAAtD,EAAiE,WAAUd,IAAV,CAAjE;AACA,IAFD,MAEO;AACNyB,YAAQC,GAAR,CAAgB1B,IAAhB,QAA0Bc,SAA1B;AACA;AACD;;AACD,SAAOC,MAAP;AACA,EAjCD,MAiCO;AACN,SAAO/B,IAAP;AACA;AACD,CAtCD,C,CAyCA;;;;;;;AAOApD,WAAWqB,SAAX,CAAqB2E,QAArB,GAAgC,UAAS5B,IAAT,EAAehB,IAAf,EAAqB4B,QAArB,EAA+B;AAC9D,KAAM3D,YAAYrB,WAAWqB,SAAX,CAAqB+C,IAArB,CAAlB;;AACA,KAAIlD,OAAO0C,QAAP,IAAmBvC,SAAnB,IAAgCA,UAAU4D,MAA9C,EAAsD;AACrD/D,SAAO+E,KAAP,CAAa,YAAW;AACvB1F,KAAE6E,MAAF,CAAS/D,SAAT,EAAoB,UAACK,QAAD;AAAA,WAAcA,SAASqC,QAAT,IAAqB/D,WAAWqB,SAAX,CAAqB0C,QAArB,CAA8BE,MAAjE;AAAA,IAApB,EAA6FnC,OAA7F,CAAqG,UAACJ,QAAD;AAAA,WAAcA,SAAS0B,IAAT,EAAe4B,QAAf,CAAd;AAAA,IAArG;AACA,GAFD;AAGA,EAJD,MAIO;AACN,SAAO5B,IAAP;AACA;AACD,CATD,4H;;;;;;;;;;;ACzHApD,WAAWkG,wBAAX,GAAsC,YAAW;AAChD,KAAMC,qBAAqBnG,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,+BAAxB,CAA3B;;AAEA,KAAI,CAACwF,kBAAD,IAAuBA,uBAAuB,GAAlD,EAAuD;AACtD;AACA;;AACD,QAAO5F,EAAEsC,GAAF,CAAMsD,mBAAmBR,KAAnB,CAAyB,GAAzB,CAAN,EAAqC,UAASvC,IAAT,EAAe;AAC1D,SAAOA,KAAK3C,IAAL,EAAP;AACA,EAFM,CAAP;AAGA,CATD;;AAWAT,WAAWoG,4BAAX,GAA0C,UAASC,IAAT,EAAe;AACxD,KAAMC,OAAOtG,WAAWkG,wBAAX,EAAb;;AACA,KAAI,CAACI,IAAD,IAAS/F,EAAEgG,QAAF,CAAWD,IAAX,EAAiBD,IAAjB,CAAb,EAAqC;AACpC,SAAO,IAAP;AACA,EAFD,MAEO;AACN,MAAMG,eAAe,IAArB;;AACA,MAAMC,YAAYlG,EAAEmG,MAAF,CAASJ,IAAT,EAAe,UAASlD,IAAT,EAAe;AAC/C,UAAOA,KAAKuD,OAAL,CAAaH,YAAb,IAA6B,CAApC;AACA,GAFiB,CAAlB;;AAGA,MAAIjG,EAAEgG,QAAF,CAAWE,SAAX,EAAsBJ,KAAKO,OAAL,CAAa,SAAb,EAAwBJ,YAAxB,CAAtB,CAAJ,EAAkE;AACjE,UAAO,IAAP;AACA;AACD;;AACD,QAAO,KAAP;AACA,CAdD,2H;;;;;;;;;;;ACXAxG,WAAW6G,YAAX,GAA0B,EAA1B;;AAEA7G,WAAW6G,YAAX,CAAwBD,OAAxB,GAAkC,UAASE,GAAT,EAAcC,IAAd,EAAoB;AACrD,KAAI,CAACD,GAAL,EAAU;AACT,SAAO,EAAP;AACA;;AAEDA,OAAMA,IAAIF,OAAJ,CAAY,gBAAZ,EAA8B5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,WAAxB,KAAwC,EAAtE,CAAN;AACAmG,OAAMA,IAAIF,OAAJ,CAAY,eAAZ,EAA6B5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,UAAxB,KAAuC,EAApE,CAAN;;AAEA,KAAIoG,IAAJ,EAAU;AACTD,QAAMA,IAAIF,OAAJ,CAAY,WAAZ,EAAyBG,KAAKrD,IAAL,IAAa,EAAtC,CAAN;AACAoD,QAAMA,IAAIF,OAAJ,CAAY,YAAZ,EAA0BrG,EAAEyG,OAAF,CAAUD,KAAKrD,IAAf,EAAqB,GAArB,KAA6B,EAAvD,CAAN;AACAoD,QAAMA,IAAIF,OAAJ,CAAY,YAAZ,EAA0BrG,EAAE0G,YAAF,CAAeF,KAAKrD,IAApB,EAA0B,GAA1B,KAAkC,EAA5D,CAAN;AACAoD,QAAMA,IAAIF,OAAJ,CAAY,YAAZ,EAA0BG,KAAKG,KAAL,IAAc,EAAxC,CAAN;AACAJ,QAAMA,IAAIF,OAAJ,CAAY,eAAZ,EAA6BG,KAAKI,QAAL,IAAiB,EAA9C,CAAN;;AAEA,MAAIJ,KAAKK,WAAT,EAAsB;AACrBN,SAAMA,IAAIF,OAAJ,CAAY,kBAAZ,EAAgCG,KAAKK,WAArC,CAAN;AACA;AACD;;AAEDN,OAAMA,IAAIF,OAAJ,CAAY,+BAAZ,EAA6C,OAAO,MAAP,GAAgB,IAA7D,CAAN;AAGA,QAAOE,GAAP;AACA,CAxBD,2H;;;;;;;;;;;ACDA;;;EAKA9G,WAAWqH,QAAX,GAAsB,EAAtB,C,CAGA;;;AAIArH,WAAWqH,QAAX,CAAoBtD,QAApB,GAA+B;AAC9BC,OAAM,CAAC,IADuB;AAE9BC,SAAQ,CAFsB;AAG9BC,MAAK;AAHyB,CAA/B,C,CAOA;;;;;;AAMAlE,WAAWqH,QAAX,CAAoBlD,GAApB,GAA0B,UAASC,IAAT,EAAe1C,QAAf,EAAsE;AAAA,KAA7C4F,CAA6C,uEAAzCtH,WAAWqH,QAAX,CAAoBtD,QAApB,CAA6BE,MAAY;AAAA,KAAJI,EAAI;AAC/F,KAAMN,WAAW,CAACxD,EAAE+D,QAAF,CAAWgD,CAAX,CAAD,GAAiBtH,WAAWqH,QAAX,CAAoBtD,QAApB,CAA6BE,MAA9C,GAAuDqD,CAAxE;AACA5F,UAASqC,QAAT,GAAoBA,QAApB;AACArC,UAAS2C,EAAT,GAAcA,MAAME,OAAOF,EAAP,EAApB;AACArE,YAAWqH,QAAX,CAAoBjD,IAApB,IAA4BpE,WAAWqH,QAAX,CAAoBjD,IAApB,KAA6B,EAAzD;;AACA,KAAIpE,WAAWqH,QAAX,CAAoBjD,IAApB,EAA0BM,IAA1B,CAA+B;AAAA,SAAMC,GAAGN,EAAH,KAAU3C,SAAS2C,EAAzB;AAAA,EAA/B,CAAJ,EAAiE;AAChE;AACA;;AACDrE,YAAWqH,QAAX,CAAoBjD,IAApB,EAA0B/B,IAA1B,CAA+BX,QAA/B;AACA,CATD,C,CAYA;;;;;;AAMA1B,WAAWqH,QAAX,CAAoBzC,MAApB,GAA6B,UAASC,QAAT,EAAmBR,EAAnB,EAAuB;AACnDrE,YAAWqH,QAAX,CAAoBxC,QAApB,IAAgCtE,EAAEuE,MAAF,CAAS9E,WAAWqH,QAAX,CAAoBxC,QAApB,CAAT,EAAwC,UAACnD,QAAD;AAAA,SAAcA,SAAS2C,EAAT,KAAgBA,EAA9B;AAAA,EAAxC,CAAhC;AACA,CAFD,C,CAKA;;;;;;;;AAQArE,WAAWqH,QAAX,CAAoBtC,GAApB,GAA0B,UAASX,IAAT,EAAehB,IAAf,EAAqB4B,QAArB,EAA+B;AACxD,KAAI3D,YAAYrB,WAAWqH,QAAX,CAAoBjD,IAApB,CAAhB;;AACA,KAAI/C,aAAa,IAAb,IAAqBA,UAAU4D,MAAV,KAAqB,CAA9C,EAAiD;AAChD,SAAOsC,QAAQC,OAAR,CAAgBpE,IAAhB,CAAP;AACA;;AACD/B,aAAYd,EAAE6E,MAAF,CAAS/D,SAAT,EAAoB,UAACK,QAAD;AAAA,SAAcA,SAASqC,QAAT,IAAqB/D,WAAWqH,QAAX,CAAoBtD,QAApB,CAA6BE,MAAhE;AAAA,EAApB,CAAZ;AACA,QAAO5C,UAAUc,MAAV,CAAiB,UAASsF,eAAT,EAA0B/F,QAA1B,EAAoC;AAC3D,SAAO,IAAI6F,OAAJ,CAAY,UAASC,OAAT,EAAkB1C,MAAlB,EAA0B;AAC5C,UAAO2C,gBAAgBC,IAAhB,CAAqB,UAACvC,MAAD;AAAA,WAAYzD,SAASyD,MAAT,EAAiBH,QAAjB,EAA2B0C,IAA3B,CAAgCF,OAAhC,EAAyC1C,MAAzC,CAAZ;AAAA,IAArB,CAAP;AACA,GAFM,CAAP;AAGA,EAJM,EAIJyC,QAAQC,OAAR,CAAgBpE,IAAhB,CAJI,CAAP;AAKA,CAXD,C,CAcA;;;;;;;AAOApD,WAAWqH,QAAX,CAAoBrB,QAApB,GAA+B,UAAS5B,IAAT,EAAehB,IAAf,EAAqB4B,QAArB,EAA+B;AAC7D,KAAM3D,YAAYrB,WAAWqH,QAAX,CAAoBjD,IAApB,CAAlB;;AACA,KAAI,CAAClD,OAAO0C,QAAR,IAAoBvC,aAAa,IAAjC,IAAyCA,UAAU4D,MAAV,KAAqB,CAAlE,EAAqE;AACpE,SAAO7B,IAAP;AACA;;AACDlC,QAAO+E,KAAP,CAAa,YAAM;AAClB1F,IAAE6E,MAAF,CAAS/D,SAAT,EAAoB,UAACK,QAAD;AAAA,UAAcA,SAASqC,QAAT,IAAqB/D,WAAWqH,QAAX,CAAoBtD,QAApB,CAA6BE,MAAhE;AAAA,GAApB,EAA4FnC,OAA5F,CAAoG,UAASJ,QAAT,EAAmB;AACtHA,YAAS0B,IAAT,EAAe4B,QAAf;AACA,GAFD;AAGA,EAJD;AAKA,CAVD,2H;;;;;;;;;;;;;;;;;AC9EA,qBACA,KAAK2C,eAAL;AACC,mBAAc;AAAA;AACb,OAAKC,SAAL,GAAiB,EAAjB;AACA,OAAKC,cAAL,GAAsB,EAAtB;AACA,OAAKC,SAAL,GAAiB,CAAjB;AACA,EALF,CAOC;;;;;;;;;;;AAPD,kBAkBC3D,GAlBD;AAAA,iBAkB8C;AAAA,OAAzC4D,UAAyC,uEAA5BxD,OAAOF,EAAP,EAA4B;AAAA,OAAf2D,KAAe;AAAA,OAARC,MAAQ;;AAC5C,OAAI,KAAKL,SAAL,CAAeG,UAAf,KAA8B,IAAlC,EAAwC;AACvC,WAAO,KAAP;AACA;;AACD,OAAIC,SAAS,IAAb,EAAmB;AAClBA,YAAQ,KAAKF,SAAL,GAAiB,EAAzB;AACA,SAAKA,SAAL,IAAkB,EAAlB;AACA;;AACD,QAAKD,cAAL,CAAoBxF,IAApB,CAAyB;AACxB0F,0BADwB;AAExBC;AAFwB,IAAzB;AAIA,QAAKJ,SAAL,CAAeG,UAAf,IAA6BE,MAA7B;;AACA,OAAIA,OAAOC,KAAP,IAAgBD,OAAOC,KAAP,CAAa/H,IAA7B,IAAqC8H,OAAOC,KAAP,CAAaxE,IAAlD,IAA0DuE,OAAOC,KAAP,CAAaC,MAA3E,EAAmF;AAClF,QAAMC,cAAc;AACnB1E,WAAMuE,OAAOC,KAAP,CAAaxE,IADA;AAEnByE,aAAQF,OAAOC,KAAP,CAAaC;AAFF,KAApB;;AAIA,QAAIjH,OAAOmH,QAAX,EAAqB;AACpBD,iBAAYE,YAAZ,GAA2B,CAACC,QAAD,CAA3B;AACA;;AACD,WAAOC,WAAWN,KAAX,CAAiBD,OAAOC,KAAP,CAAa/H,IAA9B,EAAoCiI,WAApC,CAAP;AACA;AACD;;AAzCF;AAAA;;AAAA,kBA2CCK,aA3CD;AAAA,yBA2CeC,QA3Cf,EA2CyB;AACvB,UAAO,KAAKd,SAAL,CAAec,QAAf,KAA4B,KAAKd,SAAL,CAAec,QAAf,EAAyBR,KAArD,IAA8D,KAAKN,SAAL,CAAec,QAAf,EAAyBR,KAAzB,CAA+BS,IAA/B,IAAuC,IAA5G;AACA;;AA7CF;AAAA,MA+CC;;;;;AA/CD,kBAoDCC,YApDD;AAAA,wBAoDcF,QApDd,EAoDwBG,OApDxB,EAoDiC;AAC/B,OAAI,KAAKjB,SAAL,CAAec,QAAf,KAA4B,IAAhC,EAAsC;AACrC,WAAO,KAAP;AACA;;AACD,OAAII,YAAY,EAAhB;;AACA,OAAI,KAAKlB,SAAL,CAAec,QAAf,KAA4B,KAAKd,SAAL,CAAec,QAAf,EAAyBR,KAArD,IAA8D,KAAKN,SAAL,CAAec,QAAf,EAAyBR,KAAzB,CAA+BS,IAAjG,EAAuG;AACtGG,gBAAY,KAAKlB,SAAL,CAAec,QAAf,EAAyBR,KAAzB,CAA+BS,IAA/B,CAAoCE,OAApC,CAAZ;AACA,IAFD,MAEO,IAAIA,WAAWA,QAAQnF,IAAvB,EAA6B;AACnCoF,gBAAY;AACXpF,WAAMmF,QAAQnF;AADH,KAAZ;AAGA;;AACD,UAAO8E,WAAWrI,IAAX,CAAgB,KAAKyH,SAAL,CAAec,QAAf,EAAyBR,KAAzB,CAA+BxE,IAA/C,EAAqDoF,SAArD,CAAP;AACA;;AAjEF;AAAA;;AAAA,kBAmECC,aAnED;AAAA,yBAmEeL,QAnEf,EAmEyBG,OAnEzB,EAmEkCG,WAnElC,EAmE+C;AAC7C,OAAI,KAAKpB,SAAL,CAAec,QAAf,KAA4B,IAAhC,EAAsC;AACrC,WAAO,KAAP;AACA;;AACD,OAAII,YAAY,EAAhB;;AACA,OAAI,KAAKlB,SAAL,CAAec,QAAf,KAA4B,KAAKd,SAAL,CAAec,QAAf,EAAyBR,KAArD,IAA8D,KAAKN,SAAL,CAAec,QAAf,EAAyBR,KAAzB,CAA+BS,IAAjG,EAAuG;AACtGG,gBAAY,KAAKlB,SAAL,CAAec,QAAf,EAAyBR,KAAzB,CAA+BS,IAA/B,CAAoCE,OAApC,CAAZ;AACA,IAFD,MAEO,IAAIA,WAAWA,QAAQnF,IAAvB,EAA6B;AACnCoF,gBAAY;AACXpF,WAAMmF,QAAQnF;AADH,KAAZ;AAGA;;AACD,UAAO8E,WAAWS,EAAX,CAAc,KAAKrB,SAAL,CAAec,QAAf,EAAyBR,KAAzB,CAA+BxE,IAA7C,EAAmDoF,SAAnD,EAA8DE,WAA9D,CAAP;AACA;;AAhFF;AAAA;;AAAA;AAAA;;AADAE,OAAOC,aAAP,CAmFe,KAAKxB,eAnFpB,kF;;;;;;;;;;;ACAA3H,WAAWoJ,aAAX,GAA2B;AAC1BC,WAAU;AADgB,CAA3B;;AAIArJ,WAAWoJ,aAAX,CAAyBjF,GAAzB,GAA+B,UAASmF,OAAT,EAAkB5H,QAAlB,EAAkD;AAAA,KAAtB6H,OAAsB,uEAAZ,EAAY;AAAA,KAARpE,MAAQ;AAChFnF,YAAWoJ,aAAX,CAAyBC,QAAzB,CAAkCC,OAAlC,IAA6C;AAC5CA,kBAD4C;AAE5C5H,oBAF4C;AAG5C8H,UAAQD,QAAQC,MAH4B;AAI5CC,eAAaF,QAAQE,WAJuB;AAK5CC,cAAYH,QAAQG,UAAR,IAAsB,KALU;AAM5CvE;AAN4C,EAA7C;AAQA,CATD;;AAWAnF,WAAWoJ,aAAX,CAAyBrE,GAAzB,GAA+B,UAASuE,OAAT,EAAkBE,MAAlB,EAA0BpG,IAA1B,EAAgC;AAC9D,KAAIpD,WAAWoJ,aAAX,CAAyBC,QAAzB,CAAkCC,OAAlC,KAA8CtJ,WAAWoJ,aAAX,CAAyBC,QAAzB,CAAkCC,OAAlC,EAA2C5H,QAA7F,EAAuG;AACtG,SAAO1B,WAAWoJ,aAAX,CAAyBC,QAAzB,CAAkCC,OAAlC,EAA2C5H,QAA3C,CAAoD4H,OAApD,EAA6DE,MAA7D,EAAqEpG,IAArE,CAAP;AACA;AACD,CAJD;;AAMAlC,OAAOyI,OAAP,CAAe;AACdC,aADc,YACDN,OADC,EACQ;AACrB,MAAI,CAACpI,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAC5DsF,YAAQ;AADoD,IAAvD,CAAN;AAGA;;AACD,SAAO9J,WAAWoJ,aAAX,CAAyBrE,GAAzB,CAA6BuE,QAAQS,GAArC,EAA0CT,QAAQE,MAAlD,EAA0DF,QAAQU,GAAlE,CAAP;AACA;AARa,CAAf,2H;;;;;;;;;;;ACrBAhK,WAAWiK,OAAX,GAAqB;AACpBC,MADoB,YACdF,GADc,EACTG,QADS,EACC;AACpB,MAAMC,cAAcpK,WAAWqK,YAAX,CAAwBC,OAAxB,CAAgCN,GAAhC,CAApB;;AACA,MAAII,WAAJ,EAAiB;AAChB,OAAIA,YAAYG,MAAhB,EAAwB;AACvB,WAAOH,YAAYG,MAAZ,CAAmBP,GAAnB,CAAP;AACA,IAFD,MAEO,IAAII,YAAYI,QAAhB,EAA0B;AAChC;AACA;AACA,IAHM,MAGA,IAAIJ,YAAYK,OAAhB,EAAyB;AAC/B,QAAI,CAACN,QAAD,IAAa,OAAOO,YAAP,KAAwB,WAAzC,EAAsD;AACrDP,gBAAWO,aAAaC,OAAb,CAAqB,cAArB,CAAX;AACA;;AACD,QAAM5D,OAAQ,OAAOqD,YAAYrD,IAAnB,KAA4B,UAA5B,IAA0CqD,YAAYrD,IAAZ,CAAiBiD,GAAjB,CAA3C,IAAqE,EAAlF;AACA,WAAOY,QAAQC,EAAR,CAAWT,YAAYK,OAAvB,EAAgC1D,IAAhC,EAAsCoD,QAAtC,CAAP;AACA;AACD;;AACD,MAAIH,IAAIc,CAAJ,IAASd,IAAIc,CAAJ,CAAMC,QAAN,KAAmB/K,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,kBAAxB,CAAhC,EAA6E;AAC5EqJ,OAAIgB,IAAJ,GAAWhB,IAAIA,GAAf;AACA,UAAOA,IAAIgB,IAAX;AACA;;AACDhB,MAAIgB,IAAJ,GAAWhB,IAAIA,GAAf;;AACA,MAAIzJ,EAAEE,IAAF,CAAOuJ,IAAIgB,IAAX,MAAqB,EAAzB,EAA6B;AAC5BhB,OAAIgB,IAAJ,GAAWzK,EAAE0K,UAAF,CAAajB,IAAIgB,IAAjB,CAAX;AACA;;AACDhB,MAAIgB,IAAJ,GAAWhB,IAAIgB,IAAJ,CAASpE,OAAT,CAAiB,MAAjB,EAAyB,OAAzB,CAAX;AACA,SAAOoD,IAAIgB,IAAX;AACA;AA3BmB,CAArB,0H;;;;;;;;;;;;;;;;;ACAAhL,WAAWqK,YAAX,GAA0B;AACzB,mBAAc;AAAA;AACb,OAAKa,KAAL,GAAa,EAAb;AACA;;AAHwB,kBAKzBC,YALyB;AAAA,wBAKZ5B,OALY,EAKH;AACrB,UAAO,KAAK2B,KAAL,CAAW3B,QAAQlF,EAAnB,IAAyBkF,OAAhC;AACA;;AAPwB;AAAA;;AAAA,kBASzBe,OATyB;AAAA,mBASjBG,OATiB,EASR;AAChB,UAAO,KAAKS,KAAL,CAAWT,WAAWA,QAAQW,CAA9B,CAAP;AACA;;AAXwB;AAAA;;AAAA,kBAazBC,eAbyB;AAAA,2BAaTZ,OAbS,EAaA;AACxB,OAAMpE,OAAO,KAAK6E,KAAL,CAAWT,WAAWA,QAAQW,CAA9B,CAAb;AACA,UAAO/E,QAAQA,KAAKiF,MAApB;AACA;;AAhBwB;AAAA;;AAAA,kBAkBzBC,cAlByB;AAAA,0BAkBVd,OAlBU,EAkBD;AACvB,OAAMpE,OAAO,KAAK6E,KAAL,CAAWT,WAAWA,QAAQW,CAA9B,CAAb;AACM,UAAO/E,QAAQA,QAAQ,OAAvB;AACN;;AArBwB;AAAA;;AAAA;AAAA,MAA1B;AAyBAnF,OAAOsK,OAAP,CAAe,YAAW;AACzBxL,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,GADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,mBAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNgB,eAAWhB,QAAQT,GADb;AAEN0B,aAASjB,QAAQK,CAAR,CAAUC;AAFb,IAAP;AAIA;AATmC,EAArC;AAWA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,IADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,eAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNkB,gBAAYlB,QAAQT,GADd;AAEN0B,aAASjB,QAAQK,CAAR,CAAUC;AAFb,IAAP;AAIA;AATmC,EAArC;AAWA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,IADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,iBAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNmB,kBAAcnB,QAAQT,GADhB;AAEN0B,aAASjB,QAAQK,CAAR,CAAUC;AAFb,IAAP;AAIA;AATmC,EAArC;AAWA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,IADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,WAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNoB,eAAWpB,QAAQK,CAAR,CAAUC;AADf,IAAP;AAGA;AARmC,EAArC;AAUA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,IADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,qBAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNqB,UAAMrB,QAAQK,CAAR,CAAUC;AADV,IAAP;AAGA;AARmC,EAArC;AAUA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,IADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,SAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNqB,UAAMrB,QAAQK,CAAR,CAAUC;AADV,IAAP;AAGA;AARmC,EAArC;AAUA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,IADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,iBAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNqB,UAAMrB,QAAQK,CAAR,CAAUC;AADV,IAAP;AAGA;AARmC,EAArC;AAUA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,KADgC;AAEpCkG,QAFoC,YAE7BE,OAF6B,EAEpB;AACf,UAAOzK,WAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,kBAAzB,EAA6C0F,OAA7C,CAAP;AACA;AAJmC,EAArC;AAMAzK,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,YADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,eAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNsB,gBAAYtB,QAAQT,GADd;AAEN0B,aAASjB,QAAQK,CAAR,CAAUC;AAFb,IAAP;AAIA;AATmC,EAArC;AAWA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,cADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,iBAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNuB,kBAAcvB,QAAQT,GADhB;AAEN0B,aAASjB,QAAQK,CAAR,CAAUC;AAFb,IAAP;AAIA;AATmC,EAArC;AAWA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,yBADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,yCAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNM,cAAUN,QAAQT,GADZ;AAENiC,UAAMxB,QAAQwB,IAFR;AAGNP,aAASjB,QAAQK,CAAR,CAAUC;AAHb,IAAP;AAKA;AAVmC,EAArC;AAYA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,2BADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,sDAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNM,cAAUN,QAAQT,GADZ;AAENiC,UAAMxB,QAAQwB,IAFR;AAGNP,aAASjB,QAAQK,CAAR,CAAUC;AAHb,IAAP;AAKA;AAVmC,EAArC;AAYA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,eADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,2CAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNM,cAAUN,QAAQK,CAAR,CAAUC;AADd,IAAP;AAGA;AARmC,EAArC;AAUA/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACpC9G,MAAI,iBADgC;AAEpCiH,UAAQ,IAF4B;AAGpCb,WAAS,6CAH2B;AAIpC1D,MAJoC,YAI/B0D,OAJ+B,EAItB;AACb,UAAO;AACNM,cAAUN,QAAQK,CAAR,CAAUC;AADd,IAAP;AAGA;AARmC,EAArC,EAxIyB,CAmJzB;AACA;;AACG/K,YAAWqK,YAAX,CAAwBc,YAAxB,CAAqC;AACjC9G,MAAI,OAD6B;AAEjCiH,UAAQ;AAFyB,EAArC;AAIH,CAzJD,4H;;;;;;;;;;;ACzBA,6BACAtL,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,UAAxB,EAAoC,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AACxD,KAAIA,SAAS,IAAT,IAAiBA,MAAMtB,IAAN,OAAiB,EAAtC,EAA0C;AACzC;AACA;;AACD,KAAIyL,OAAOnK,MAAM6E,OAAN,CAAc,KAAd,EAAqB,EAArB,CAAX,CAJwD,CAKxD;;AACA,KAAMhB,QAAQ7D,MAAM6D,KAAN,CAAY,2BAAZ,CAAd;;AACA,KAAIA,SAAS,IAAb,EAAmB;AAClBsG,SAAOtG,MAAM,CAAN,CAAP,CADkB,CAElB;AACA;;AACD/E,2BAA0BsL,QAA1B,GAAqCD,IAArC;;AAEA,KAAIhL,OAAOE,WAAP,CAAmBgL,cAAnB,IAAqClL,OAAOE,WAAP,CAAmBgL,cAAnB,CAAkCC,OAA3E,EAAoF;AACnFnL,SAAOE,WAAP,CAAmBgL,cAAnB,CAAkCC,OAAlC,GAA4CH,IAA5C;AACA;;AACD,KAAIhL,OAAO0C,QAAX,EAAqB;AACpB5D,aAAWsM,QAAX,GAAsBJ,KAAKtF,OAAL,CAAa,cAAb,EAA6B,EAA7B,CAAtB;AACA2F,UAAQC,GAAR,CAAYC,eAAZ,GAA8BP,IAA9B;AACAK,UAAQC,GAAR,CAAYE,cAAZ,GAA6BR,IAA7B;;AACA,MAAI,OAAOS,eAAP,KAA2B,WAA3B,IAA0CA,gBAAgBC,mBAA9D,EAAmF;AAClF,UAAOD,gBAAgBC,mBAAhB,EAAP;AACA;AACD;AACD,CAxBD,2H;;;;;;;;;;;ACDA,IAAMC,SAAS,IAAIC,MAAJ,CAAW,QAAX,EAAqB;AACnCnD,UAAS;AACRG,UAAQ;AACPzD,SAAM;AADC,GADA;AAIR0G,WAAS;AACR1G,SAAM;AADE;AAJD;AAD0B,CAArB,CAAf;;AAWA,IAAM2G,cAAc,UAAStJ,IAAT,EAAeuJ,eAAf,EAAgCC,UAAhC,EAA4C;AAC/DA,YAAWxJ,IAAX,IAAmB,YAAW;AAC7B,MAAMyJ,OAAOzJ,SAAS,UAAT,GAAsB0J,MAAMC,SAAN,CAAgBC,KAAhB,CAAsB/K,IAAtB,CAA2BgL,SAA3B,EAAsC,CAAtC,CAAtB,GAAiEA,SAA9E;AACAV,SAAO/C,MAAP,CAAcpG,IAAd,EAAoB,YAApB,EAAkCxC,OAAO2I,MAAP,EAAlC,EAAmD,eAAnD,EAAoEsD,IAApE;AAEA,SAAOF,gBAAgBO,KAAhB,CAAsB,IAAtB,EAA4BD,SAA5B,CAAP;AACA,EALD;AAMA,CAPD;;AASA,IAAME,wBAAwBvM,OAAOyI,OAArC;;AAEAzI,OAAOyI,OAAP,GAAiB,UAAS+D,SAAT,EAAoB;AACpCnN,GAAEoN,IAAF,CAAOD,SAAP,EAAkB,UAASE,OAAT,EAAkBlK,IAAlB,EAAwB;AACzCsJ,cAAYtJ,IAAZ,EAAkBkK,OAAlB,EAA2BF,SAA3B;AACA,EAFD;;AAGAD,uBAAsBC,SAAtB;AACA,CALD;;AAOA,IAAMG,wBAAwB3M,OAAO6L,OAArC;;AAEA7L,OAAO6L,OAAP,GAAiB,UAASrJ,IAAT,EAAeoK,IAAf,EAAqB;AACrC,QAAOD,sBAAsBnK,IAAtB,EAA4B,YAAW;AAC7CmJ,SAAOE,OAAP,CAAerJ,IAAf,EAAqB,YAArB,EAAmC,KAAKmG,MAAxC,EAAgD,eAAhD,EAAiE0D,SAAjE;AAEA,SAAOO,KAAKN,KAAL,CAAW,IAAX,EAAiBD,SAAjB,CAAP;AACA,EAJM,CAAP;AAKA,CAND,2H;;;;;;;;;;;AC/BA,IAAIQ,gBAAJ;AAAY7E,OAAO8E,KAAP,CAAaC,QAAQ,SAAR,CAAb,EAAgC;AAAA,sBAASC,CAAT,EAAW;AAACH,YAAQG,CAAR;AAAU;AAAtB,CAAhC,EAAwD,CAAxD;AAEZlO,WAAW+N,OAAX,GAAqBA,OAArB;AAEA/N,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,iBAAxB,EAA2C,UAACqB,GAAD,EAAMD,KAAN,EAAgB;AAC1D,KAAIA,KAAJ,EAAW;AACVgM,UAAQI,QAAR,CAAiBpM,KAAjB;AACA;AACD,CAJD;;AAMA,IAAMqM,SAAS,UAAS3D,OAAT,EAAkBhG,KAAlB,EAAyB;AACvC,KAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC9BgG,mBAAgBhG,KAAhB;AACA;;AACD,KAAI8E,UAAU,EAAd;;AACA,KAAIvJ,WAAWqO,IAAf,EAAqB;AACpB9E,YAAU;AAAE+E,QAAK;AAAEC,aAASvO,WAAWqO,IAAX,CAAgBE,OAA3B;AAAoCC,UAAMxO,WAAWqO;AAArD;AAAP,GAAV;AACA;;AACD,KAAMI,QAAQ,IAAIjK,KAAJ,CAAUiG,OAAV,CAAd;AACAgE,OAAMhK,KAAN,GAAcA,KAAd;AACAzE,YAAW+N,OAAX,CAAmBK,MAAnB,CAA0BK,KAA1B,EAAiClF,OAAjC;AACA,CAXD;;AAaAgD,QAAQmC,EAAR,CAAW,mBAAX,EAAgCxN,OAAOyN,eAAP,CAAuB,UAACF,KAAD,EAAW;AACjEL,QAAOK,MAAMhE,OAAb,EAAsBgE,MAAMhK,KAA5B;AACA,OAAMgK,KAAN;AACA,CAH+B,CAAhC;AAKA,IAAMG,sBAAsB1N,OAAO2N,MAAnC;;AACA3N,OAAO2N,MAAP,GAAgB,YAAW;AAC1BT,yBAAUb,SAAV;AACA,QAAOqB,qCAAuBrB,SAAvB,CAAP;AACA,CAHD,2H;;;;;;;;;;;AC7BA,IAAMuB,SAASb,QAAQ,aAAR,CAAf;;AAEAjO,WAAW+O,UAAX,GAAwBD,MAAxB;AAEA9O,WAAWgP,OAAX,GAAqB,EAArB,C,CAEA;;AAEAhP,WAAWgP,OAAX,CAAmBC,YAAnB,GAAkC,IAAIH,OAAOI,OAAX,CAAmB,eAAnB,EAAoC,mCAApC,CAAlC,iB;;;;;;;;;;;;;;;;;ACRA,yBACAlP,WAAWmP,WAAX,GAAyB;AAAA;AAAA;AAAA;;AAAA,kBACxBC,aADwB;AAAA,yBACVC,EADU,EACNC,WADM,EACOC,YADP,EACqBC,QADrB,EAC+B;AACtD,OAAIjD,QAAQC,GAAR,CAAYiD,SAAZ,KAA0B,MAA9B,EAAsC;AACrC,WAAOJ,EAAP;AACA;;AACD,OAAMK,cAAc,IAAIP,WAAJ,EAApB;AACAO,eAAYC,OAAZ,CAAoBH,QAApB,EAA8BF,WAA9B,EAA2CC,YAA3C;AACA,UAAO,YAAkB;AAAA,sCAANpC,IAAM;AAANA,SAAM;AAAA;;AACxB,QAAMvH,QAAQ,EAAd;;AACArF,MAAEoN,IAAF,CAAO6B,QAAP,EAAiB,UAASI,OAAT,EAAkB5N,GAAlB,EAAuB;AACvC,YAAO4D,MAAM5D,GAAN,IAAamL,KAAKnL,GAAL,CAApB;AACA,KAFD;;AAGA0N,gBAAYG,SAAZ,CAAsBjK,KAAtB;AACA,QAAMkK,kBAAkBJ,YAAYK,KAAZ,CAAkBnK,KAAlB,CAAxB;;AACA,QAAIkK,gBAAgBE,OAApB,EAA6B;AAC5B,YAAOX,GAAG7B,KAAH,CAAS,IAAT,EAAeD,SAAf,CAAP;AACA,KAFD,MAEO;AACN,WAAM,IAAIrM,OAAOsD,KAAX,CAAiB,yBAAjB,iEAA0GyL,KAAKC,IAAL,CAAUJ,gBAAgBK,WAAhB,GAA8B,IAAxC,CAA1G,oCAAyL;AAC9LA,mBAAaL,gBAAgBK,WADiK;AAE9LC,eAASH,KAAKC,IAAL,CAAUJ,gBAAgBK,WAAhB,GAA8B,IAAxC;AAFqL,MAAzL,CAAN;AAIA;AACD,IAfD;AAgBA;;AAvBuB;AAAA;;AAAA,kBAyBxBE,WAzBwB;AAAA,uBAyBZC,UAzBY,EAyBAhB,WAzBA,EAyBaC,YAzBb,EAyB2BC,QAzB3B,EAyBqC;AAC5D,OAAIjD,QAAQC,GAAR,CAAYiD,SAAZ,KAA0B,MAA9B,EAAsC;AACrC;AACA;;AACD,OAAM7J,QAAQ;AACbS,UAAM,QADO;AAEb3C,UAAM4M;AAFO,IAAd;;AAIA/P,KAAEoN,IAAF,CAAO6B,QAAP,EAAiB,UAASI,OAAT,EAAkB5N,GAAlB,EAAuB;AACvC,WAAO4D,MAAM5D,GAAN,IAAawN,SAASxN,GAAT,CAApB;AACA,IAFD;;AAGA,UAAOuO,eAAeZ,OAAf,CAAuB/J,KAAvB,EAA8B0J,WAA9B,EAA2CC,YAA3C,CAAP;AACA;;AArCuB;AAAA;;AAAA;AAAA,MAAzB,qH;;;;;;;;;;;ACDA,2BACAvP,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,aAAxB,EAAuC,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AAC3D,QAAOyO,cAAcC,WAAd,GAA4B1O,KAAnC;AACA,CAFD;AAIA/B,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,UAAxB,EAAoC,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AACxD,QAAOyO,cAAcE,eAAd,GAAgC3O,KAAvC;AACA,CAFD;AAIA/B,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,WAAxB,EAAqC,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AACzD,KAAIA,SAAS,IAAb,EAAmB;AAClByO,gBAAcG,QAAd,GAAyBC,SAAS7O,KAAT,CAAzB;AACAb,SAAO2P,UAAP,CAAkB,YAAM;AACvB,UAAOL,cAAcM,MAAd,CAAqB,IAArB,CAAP;AACA,GAFD,EAEG,GAFH;AAGA;AACD,CAPD,2H;;;;;;;;;;;;;;;;;ACTA,kB,IACMC,gB;;;;;4BACLC,iB;6BAAkBC,M,EAAQ;AACzB,OAAMC,WAAWlR,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,UAAxB,CAAjB;AACA,UAAO,KAAKwQ,IAAL,CAAcD,QAAd,SAA4BD,MAA5B,CAAP,CAFyB,CAEsB;AAC/C;;;;;4BAEDE,I;gBAAKrK,G,EAAK;AACT,OAAIqK,OAAO,CAAX;AACA,OAAIC,IAAItK,IAAI7B,MAAZ;;AAEA,UAAOmM,CAAP,EAAU;AACTD,WAAQ,CAACA,QAAQ,CAAT,IAAcA,IAAf,GAAuBrK,IAAIuK,UAAJ,CAAe,EAAED,CAAjB,CAA9B;AACAD,WAAOA,OAAOA,IAAd,CAFS,CAEW;AACpB;;AACD,UAAOA,IAAP;AACA;;;;;4BAEDG,I;sBAAgE;AAAA,OAAzDC,QAAyD,QAAzDA,QAAyD;AAAA,OAA/CN,MAA+C,QAA/CA,MAA+C;AAAA,OAAvClG,QAAuC,QAAvCA,QAAuC;AAAA,OAA7BN,OAA6B,QAA7BA,OAA6B;AAAA,OAApB+G,OAAoB,QAApBA,OAAoB;AAAA,OAAXC,OAAW,QAAXA,OAAW;AAC/D,OAAIC,cAAJ;;AACA,OAAIH,YAAYA,aAAa,EAA7B,EAAiC;AAChCG,iBAAYH,QAAZ;AACA9G,cAAcM,QAAd,UAA6BN,OAA7B;AACA,IAHD,MAGO;AACNiH,iBAAY3G,QAAZ;AACA;;AACD,OAAM4G,OAAO3R,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,oBAAxB,EAA8CiR,GAA9C,IAAqD5R,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,oBAAxB,EAA8CkR,UAAhH;AACA,OAAM5J,SAAS;AACd6J,UAAM,MADQ;AAEdC,WAAO,CAFO;AAGdC,WAAO,SAHO;AAIdN,gBAJc;AAKdO,UAAMxH,OALQ;AAMdgH,oBANc;AAOdS,WAAOV,OAPO;AAQdW,WAAO,KAAKnB,iBAAL,CAAuBC,MAAvB,CARO;AASdmB,SAAK;AACJC,YAAO,OADH;AAEJC,kBAAa,kBAFT;AAGJC,YAAOvS,WAAWE,MAAX,CAAkByR,IAAlB,EAAwB;AAAEtR,YAAM;AAAR,MAAxB;AAHH,KATS;AAcdmS,SAAK;AACJP,WAAMP,SAAUA,UAAU,EAAV,IAAgBjH,YAAY,EAA7B,GAAmC,IAAnC,GAA0C,EAAnD,IAAyDA;AAD3D;AAdS,IAAf;AAmBA,UAAOgI,KAAKnB,IAAL,CAAUrJ,MAAV,CAAP;AACA;;;;;;;;AAGFjI,WAAW+Q,gBAAX,GAA8B,IAAIA,gBAAJ,EAA9B,wE;;;;;;;;;;;AClDA/Q,WAAW0S,2BAAX,GAAyC,CACxC,YADwC,EAExC,SAFwC,EAGxC,SAHwC,EAIxC,iBAJwC,EAKxC,UALwC,EAMxC,UANwC,EAOxC,YAPwC,EAQxC,gBARwC,EASxC,oBATwC,EAUxC,kBAVwC,EAWxC,iBAXwC,EAYxC,WAZwC,EAaxC,YAbwC,EAcxC,gBAdwC,EAexC,SAfwC,EAgBxC,YAhBwC,EAiBxC,YAjBwC,EAkBxC,WAlBwC,EAmBxC,WAnBwC,EAoBxC,kBApBwC,EAqBxC,UArBwC,EAsBxC,iBAtBwC,EAuBxC,YAvBwC,EAwBxC,kBAxBwC,EAyBxC,YAzBwC,EA0BxC,iBA1BwC,EA2BxC,iBA3BwC,EA4BxC,gBA5BwC,EA6BxC,cA7BwC,EA8BxC,cA9BwC,EA+BxC,cA/BwC,EAgCxC,iBAhCwC,EAiCxC,kBAjCwC,EAkCxC,gBAlCwC,EAmCxC,gBAnCwC,EAoCxC,gBApCwC,EAqCxC,iBArCwC,EAsCxC,QAtCwC,EAuCxC,UAvCwC,EAwCxC,UAxCwC,EAyCxC,eAzCwC,EA0CxC,eA1CwC,EA2CxC,eA3CwC,EA4CxC,oBA5CwC,EA6CxC,WA7CwC,EA8CxC,eA9CwC,EA+CxC,SA/CwC,EAgDxC,UAhDwC,EAiDxC,QAjDwC,EAkDxC,eAlDwC,EAmDxC,eAnDwC,EAoDxC,aApDwC,EAqDxC,eArDwC,EAsDxC,eAtDwC,EAuDxC,UAvDwC,EAwDxC,cAxDwC,EAyDxC,QAzDwC,EA0DxC,aA1DwC,EA2DxC,cA3DwC,EA4DxC,cA5DwC,EA6DxC,WA7DwC,EA8DxC,cA9DwC,EA+DxC,WA/DwC,EAgExC,qBAhEwC,EAiExC,eAjEwC,EAkExC,cAlEwC,EAmExC,aAnEwC,EAoExC,cApEwC,EAqExC,cArEwC,EAsExC,eAtEwC,EAuExC,cAvEwC,EAwExC,cAxEwC,EAyExC,YAzEwC,EA0ExC,aA1EwC,EA2ExC,iBA3EwC,EA4ExC,aA5EwC,EA6ExC,aA7EwC,EA8ExC,uBA9EwC,EA+ExC,UA/EwC,EAgFxC,WAhFwC,EAiFxC,gBAjFwC,EAkFxC,YAlFwC,EAmFxC,cAnFwC,EAoFxC,iBApFwC,EAqFxC,eArFwC,EAsFxC,cAtFwC,EAuFxC,gBAvFwC,EAwFxC,eAxFwC,EAyFxC,cAzFwC,EA0FxC,aA1FwC,EA2FxC,aA3FwC,EA4FxC,SA5FwC,EA6FxC,YA7FwC,EA8FxC,eA9FwC,EA+FxC,eA/FwC,EAgGxC,cAhGwC,EAiGxC,oBAjGwC,EAkGxC,oBAlGwC,EAmGxC,WAnGwC,EAoGxC,eApGwC,EAqGxC,kBArGwC,EAsGxC,eAtGwC,EAuGxC,cAvGwC,EAwGxC,eAxGwC,EAyGxC,SAzGwC,EA0GxC,cA1GwC,EA2GxC,kBA3GwC,EA4GxC,gBA5GwC,EA6GxC,kBA7GwC,EA8GxC,yBA9GwC,EA+GxC,SA/GwC,EAgHxC,OAhHwC,EAiHxC,cAjHwC,EAkHxC,YAlHwC,EAmHxC,cAnHwC,EAoHxC,WApHwC,EAqHxC,QArHwC,EAsHxC,aAtHwC,EAuHxC,gBAvHwC,EAwHxC,gBAxHwC,EAyHxC,aAzHwC,EA0HxC,cA1HwC,EA2HxC,oBA3HwC,EA4HxC,cA5HwC,EA6HxC,iBA7HwC,EA8HxC,gBA9HwC,EA+HxC,gBA/HwC,EAgIxC,gBAhIwC,EAiIxC,aAjIwC,EAkIxC,WAlIwC,EAmIxC,WAnIwC,EAoIxC,WApIwC,EAqIxC,gBArIwC,EAsIxC,kBAtIwC,EAuIxC,YAvIwC,EAwIxC,mBAxIwC,EAyIxC,cAzIwC,EA0IxC,gBA1IwC,EA2IxC,wBA3IwC,EA4IxC,cA5IwC,EA6IxC,kBA7IwC,EA8IxC,eA9IwC,EA+IxC,eA/IwC,EAgJxC,SAhJwC,EAiJxC,UAjJwC,EAkJxC,QAlJwC,EAmJxC,eAnJwC,EAoJxC,aApJwC,EAqJxC,gBArJwC,EAsJxC,YAtJwC,EAuJxC,aAvJwC,EAwJxC,aAxJwC,EAyJxC,iBAzJwC,EA0JxC,cA1JwC,EA2JxC,YA3JwC,EA4JxC,YA5JwC,EA6JxC,YA7JwC,EA8JxC,WA9JwC,EA+JxC,eA/JwC,EAgKxC,iBAhKwC,EAiKxC,UAjKwC,EAkKxC,sBAlKwC,EAmKxC,cAnKwC,EAoKxC,eApKwC,EAqKxC,iBArKwC,EAsKxC,gBAtKwC,EAuKxC,uBAvKwC,EAwKxC,8BAxKwC,EAyKxC,yCAzKwC,EA0KxC,qBA1KwC,EA2KxC,YA3KwC,EA4KxC,kBA5KwC,EA6KxC,iBA7KwC,EA8KxC,iBA9KwC,EA+KxC,YA/KwC,EAgLxC,qBAhLwC,EAiLxC,gCAjLwC,EAkLxC,aAlLwC,EAmLxC,YAnLwC,EAoLxC,YApLwC,EAqLxC,WArLwC,EAsLxC,eAtLwC,EAuLxC,aAvLwC,EAwLxC,aAxLwC,EAyLxC,mBAzLwC,EA0LxC,YA1LwC,EA2LxC,WA3LwC,EA4LxC,WA5LwC,EA6LxC,aA7LwC,EA8LxC,aA9LwC,EA+LxC,QA/LwC,EAgMxC,UAhMwC,EAiMxC,aAjMwC,EAkMxC,iBAlMwC,EAmMxC,iBAnMwC,EAoMxC,aApMwC,EAqMxC,gBArMwC,EAsMxC,cAtMwC,EAuMxC,YAvMwC,EAwMxC,YAxMwC,EAyMxC,YAzMwC,EA0MxC,mBA1MwC,EA2MxC,eA3MwC,EA4MxC,YA5MwC,EA6MxC,WA7MwC,EA8MxC,gBA9MwC,EA+MxC,aA/MwC,EAgNxC,gBAhNwC,EAiNxC,YAjNwC,EAkNxC,cAlNwC,EAmNxC,aAnNwC,EAoNxC,iBApNwC,EAqNxC,eArNwC,EAsNxC,gBAtNwC,EAuNxC,iBAvNwC,EAwNxC,iBAxNwC,EAyNxC,qBAzNwC,EA0NxC,qBA1NwC,EA2NxC,kBA3NwC,EA4NxC,wBA5NwC,EA6NxC,cA7NwC,EA8NxC,cA9NwC,EA+NxC,YA/NwC,EAgOxC,iBAhOwC,EAiOxC,cAjOwC,EAkOxC,eAlOwC,EAmOxC,UAnOwC,EAoOxC,UApOwC,EAqOxC,UArOwC,EAsOxC,SAtOwC,EAuOxC,aAvOwC,EAwOxC,cAxOwC,EAyOxC,cAzOwC,EA0OxC,eA1OwC,EA2OxC,eA3OwC,EA4OxC,eA5OwC,EA6OxC,WA7OwC,EA8OxC,iBA9OwC,EA+OxC,gBA/OwC,EAgPxC,cAhPwC,EAiPxC,eAjPwC,EAkPxC,qBAlPwC,EAmPxC,aAnPwC,EAoPxC,eApPwC,EAqPxC,YArPwC,EAsPxC,kBAtPwC,EAuPxC,gBAvPwC,EAwPxC,eAxPwC,EAyPxC,eAzPwC,EA0PxC,kBA1PwC,EA2PxC,kBA3PwC,EA4PxC,eA5PwC,EA6PxC,oBA7PwC,EA8PxC,gBA9PwC,EA+PxC,gBA/PwC,EAgQxC,gBAhQwC,EAiQxC,gBAjQwC,EAkQxC,gBAlQwC,EAmQxC,aAnQwC,EAoQxC,cApQwC,EAqQxC,kBArQwC,EAsQxC,WAtQwC,EAuQxC,WAvQwC,EAwQxC,cAxQwC,EAyQxC,aAzQwC,EA0QxC,YA1QwC,EA2QxC,aA3QwC,EA4QxC,aA5QwC,EA6QxC,YA7QwC,EA8QxC,aA9QwC,EA+QxC,aA/QwC,EAgRxC,gBAhRwC,EAiRxC,eAjRwC,EAkRxC,cAlRwC,EAmRxC,aAnRwC,EAoRxC,oBApRwC,EAqRxC,aArRwC,EAsRxC,gBAtRwC,EAuRxC,cAvRwC,EAwRxC,iBAxRwC,EAyRxC,SAzRwC,EA0RxC,gBA1RwC,EA2RxC,+BA3RwC,EA4RxC,YA5RwC,EA6RxC,cA7RwC,EA8RxC,aA9RwC,EA+RxC,gBA/RwC,EAgSxC,aAhSwC,EAiSxC,gBAjSwC,EAkSxC,gBAlSwC,EAmSxC,gBAnSwC,EAoSxC,cApSwC,EAqSxC,4BArSwC,EAsSxC,eAtSwC,EAuSxC,WAvSwC,EAwSxC,eAxSwC,EAySxC,8BAzSwC,EA0SxC,aA1SwC,EA2SxC,aA3SwC,EA4SxC,aA5SwC,EA6SxC,sBA7SwC,EA8SxC,iBA9SwC,EA+SxC,kBA/SwC,EAgTxC,gBAhTwC,EAiTxC,iBAjTwC,EAkTxC,iBAlTwC,EAmTxC,iBAnTwC,EAoTxC,2BApTwC,EAqTxC,mBArTwC,EAsTxC,kBAtTwC,EAuTxC,cAvTwC,EAwTxC,iBAxTwC,EAyTxC,kBAzTwC,EA0TxC,eA1TwC,EA2TxC,gBA3TwC,EA4TxC,QA5TwC,EA6TxC,YA7TwC,EA8TxC,kBA9TwC,EA+TxC,kBA/TwC,EAgUxC,kBAhUwC,EAiUxC,kBAjUwC,EAkUxC,mBAlUwC,EAmUxC,mBAnUwC,EAoUxC,kBApUwC,EAqUxC,oBArUwC,EAsUxC,mBAtUwC,EAuUxC,mBAvUwC,EAwUxC,wBAxUwC,EAyUxC,WAzUwC,EA0UxC,iBA1UwC,EA2UxC,SA3UwC,EA4UxC,YA5UwC,EA6UxC,eA7UwC,EA8UxC,kBA9UwC,EA+UxC,YA/UwC,EAgVxC,aAhVwC,EAiVxC,cAjVwC,EAkVxC,iBAlVwC,EAmVxC,SAnVwC,EAoVxC,aApVwC,EAqVxC,WArVwC,EAsVxC,aAtVwC,EAuVxC,eAvVwC,EAwVxC,cAxVwC,EAyVxC,YAzVwC,EA0VxC,YA1VwC,EA2VxC,WA3VwC,EA4VxC,aA5VwC,EA6VxC,eA7VwC,EA8VxC,aA9VwC,EA+VxC,mBA/VwC,EAgWxC,gBAhWwC,EAiWxC,kBAjWwC,EAkWxC,aAlWwC,EAmWxC,WAnWwC,EAoWxC,gBApWwC,EAqWxC,UArWwC,EAsWxC,UAtWwC,EAuWxC,gBAvWwC,EAwWxC,gBAxWwC,EAyWxC,gBAzWwC,EA0WxC,gBA1WwC,EA2WxC,mBA3WwC,EA4WxC,mBA5WwC,EA6WxC,mBA7WwC,EA8WxC,eA9WwC,EA+WxC,cA/WwC,EAgXxC,cAhXwC,EAiXxC,gBAjXwC,EAkXxC,eAlXwC,EAmXxC,kBAnXwC,EAoXxC,iBApXwC,EAqXxC,QArXwC,EAsXxC,UAtXwC,EAuXxC,cAvXwC,EAwXxC,SAxXwC,EAyXxC,cAzXwC,EA0XxC,aA1XwC,EA2XxC,eA3XwC,EA4XxC,aA5XwC,EA6XxC,aA7XwC,EA8XxC,WA9XwC,EA+XxC,gBA/XwC,EAgYxC,kBAhYwC,EAiYxC,YAjYwC,EAkYxC,aAlYwC,EAmYxC,YAnYwC,EAoYxC,gBApYwC,EAqYxC,cArYwC,EAsYxC,cAtYwC,EAuYxC,cAvYwC,EAwYxC,WAxYwC,EAyYxC,WAzYwC,EA0YxC,iBA1YwC,EA2YxC,iBA3YwC,EA4YxC,WA5YwC,EA6YxC,SA7YwC,EA8YxC,aA9YwC,EA+YxC,oBA/YwC,EAgZxC,cAhZwC,EAiZxC,SAjZwC,EAkZxC,cAlZwC,EAmZxC,SAnZwC,EAoZxC,aApZwC,EAqZxC,eArZwC,EAsZxC,oBAtZwC,EAuZxC,WAvZwC,EAwZxC,gBAxZwC,EAyZxC,eAzZwC,EA0ZxC,cA1ZwC,EA2ZxC,WA3ZwC,EA4ZxC,gBA5ZwC,EA6ZxC,aA7ZwC,EA8ZxC,cA9ZwC,EA+ZxC,cA/ZwC,EAgaxC,YAhawC,EAiaxC,cAjawC,EAkaxC,mBAlawC,EAmaxC,UAnawC,EAoaxC,WApawC,EAqaxC,UArawC,EAsaxC,QAtawC,EAuaxC,cAvawC,EAwaxC,aAxawC,EAyaxC,iBAzawC,EA0axC,oBA1awC,EA2axC,SA3awC,EA4axC,oBA5awC,EA6axC,YA7awC,EA8axC,aA9awC,EA+axC,WA/awC,EAgbxC,WAhbwC,EAibxC,cAjbwC,EAkbxC,aAlbwC,EAmbxC,gBAnbwC,EAobxC,eApbwC,EAqbxC,aArbwC,EAsbxC,gBAtbwC,EAubxC,gBAvbwC,EAwbxC,aAxbwC,EAybxC,eAzbwC,EA0bxC,WA1bwC,EA2bxC,aA3bwC,EA4bxC,aA5bwC,EA6bxC,YA7bwC,EA8bxC,eA9bwC,EA+bxC,WA/bwC,EAgcxC,cAhcwC,EAicxC,gBAjcwC,EAkcxC,WAlcwC,EAmcxC,iBAncwC,EAocxC,oBApcwC,EAqcxC,YArcwC,EAscxC,cAtcwC,EAucxC,eAvcwC,EAwcxC,cAxcwC,EAycxC,gBAzcwC,EA0cxC,gBA1cwC,EA2cxC,gBA3cwC,EA4cxC,gBA5cwC,EA6cxC,eA7cwC,EA8cxC,iBA9cwC,EA+cxC,mBA/cwC,EAgdxC,iBAhdwC,EAidxC,cAjdwC,EAkdxC,WAldwC,EAmdxC,WAndwC,EAodxC,cApdwC,EAqdxC,iBArdwC,EAsdxC,4BAtdwC,EAudxC,cAvdwC,EAwdxC,YAxdwC,EAydxC,eAzdwC,EA0dxC,eA1dwC,EA2dxC,cA3dwC,EA4dxC,aA5dwC,EA6dxC,cA7dwC,EA8dxC,gBA9dwC,EA+dxC,eA/dwC,EAgexC,cAhewC,EAiexC,eAjewC,EAkexC,eAlewC,EAmexC,gBAnewC,EAoexC,kBApewC,EAqexC,eArewC,EAsexC,eAtewC,EAuexC,aAvewC,EAwexC,gBAxewC,EAyexC,eAzewC,EA0exC,YA1ewC,EA2exC,WA3ewC,EA4exC,eA5ewC,EA6exC,eA7ewC,EA8exC,qBA9ewC,EA+exC,mBA/ewC,EAgfxC,uBAhfwC,EAifxC,eAjfwC,EAkfxC,QAlfwC,EAmfxC,aAnfwC,EAofxC,mBApfwC,EAqfxC,cArfwC,EAsfxC,kBAtfwC,EAufxC,eAvfwC,EAwfxC,gBAxfwC,EAyfxC,cAzfwC,EA0fxC,4BA1fwC,EA2fxC,eA3fwC,EA4fxC,kBA5fwC,EA6fxC,cA7fwC,EA8fxC,iBA9fwC,EA+fxC,WA/fwC,EAggBxC,aAhgBwC,EAigBxC,mBAjgBwC,EAkgBxC,YAlgBwC,EAmgBxC,YAngBwC,EAogBxC,mBApgBwC,EAqgBxC,gBArgBwC,EAsgBxC,eAtgBwC,EAugBxC,kBAvgBwC,EAwgBxC,kBAxgBwC,EAygBxC,YAzgBwC,EA0gBxC,YA1gBwC,EA2gBxC,eA3gBwC,EA4gBxC,oBA5gBwC,EA6gBxC,eA7gBwC,EA8gBxC,kBA9gBwC,EA+gBxC,iBA/gBwC,EAghBxC,eAhhBwC,EAihBxC,iBAjhBwC,EAkhBxC,eAlhBwC,EAmhBxC,aAnhBwC,EAohBxC,gBAphBwC,EAqhBxC,oBArhBwC,EAshBxC,WAthBwC,EAuhBxC,gBAvhBwC,EAwhBxC,gBAxhBwC,EAyhBxC,gBAzhBwC,EA0hBxC,qBA1hBwC,EA2hBxC,gBA3hBwC,EA4hBxC,cA5hBwC,EA6hBxC,iBA7hBwC,EA8hBxC,gBA9hBwC,EA+hBxC,iBA/hBwC,EAgiBxC,YAhiBwC,EAiiBxC,gBAjiBwC,EAkiBxC,WAliBwC,EAmiBxC,cAniBwC,EAoiBxC,eApiBwC,EAqiBxC,cAriBwC,EAsiBxC,cAtiBwC,EAuiBxC,cAviBwC,EAwiBxC,cAxiBwC,EAyiBxC,aAziBwC,EA0iBxC,eA1iBwC,EA2iBxC,cA3iBwC,EA4iBxC,SA5iBwC,EA6iBxC,YA7iBwC,EA8iBxC,kBA9iBwC,EA+iBxC,YA/iBwC,EAgjBxC,kBAhjBwC,EAijBxC,kBAjjBwC,EAkjBxC,WAljBwC,EAmjBxC,cAnjBwC,EAojBxC,eApjBwC,EAqjBxC,sBArjBwC,EAsjBxC,YAtjBwC,EAujBxC,eAvjBwC,EAwjBxC,UAxjBwC,EAyjBxC,cAzjBwC,EA0jBxC,YA1jBwC,EA2jBxC,cA3jBwC,EA4jBxC,gBA5jBwC,EA6jBxC,mBA7jBwC,EA8jBxC,mBA9jBwC,EA+jBxC,mBA/jBwC,EAgkBxC,aAhkBwC,EAikBxC,eAjkBwC,EAkkBxC,gBAlkBwC,EAmkBxC,YAnkBwC,EAokBxC,WApkBwC,EAqkBxC,gBArkBwC,EAskBxC,YAtkBwC,EAukBxC,cAvkBwC,EAwkBxC,gBAxkBwC,EAykBxC,gBAzkBwC,EA0kBxC,iBA1kBwC,EA2kBxC,gBA3kBwC,EA4kBxC,gBA5kBwC,EA6kBxC,mBA7kBwC,EA8kBxC,WA9kBwC,EA+kBxC,UA/kBwC,EAglBxC,WAhlBwC,EAilBxC,sBAjlBwC,EAklBxC,6BAllBwC,EAmlBxC,gBAnlBwC,EAolBxC,cAplBwC,EAqlBxC,gBArlBwC,EAslBxC,SAtlBwC,EAulBxC,YAvlBwC,EAwlBxC,iBAxlBwC,EAylBxC,cAzlBwC,EA0lBxC,wBA1lBwC,EA2lBxC,YA3lBwC,EA4lBxC,SA5lBwC,EA6lBxC,qBA7lBwC,EA8lBxC,WA9lBwC,EA+lBxC,aA/lBwC,EAgmBxC,gBAhmBwC,EAimBxC,kBAjmBwC,EAkmBxC,WAlmBwC,EAmmBxC,WAnmBwC,EAomBxC,cApmBwC,EAqmBxC,aArmBwC,EAsmBxC,kBAtmBwC,EAumBxC,gBAvmBwC,EAwmBxC,cAxmBwC,EAymBxC,cAzmBwC,EA0mBxC,WA1mBwC,EA2mBxC,SA3mBwC,EA4mBxC,aA5mBwC,EA6mBxC,+BA7mBwC,EA8mBxC,WA9mBwC,EA+mBxC,gBA/mBwC,EAgnBxC,cAhnBwC,EAinBxC,SAjnBwC,EAknBxC,kBAlnBwC,EAmnBxC,iBAnnBwC,EAonBxC,WApnBwC,EAqnBxC,cArnBwC,EAsnBxC,gBAtnBwC,EAunBxC,eAvnBwC,EAwnBxC,4BAxnBwC,EAynBxC,gBAznBwC,EA0nBxC,mBA1nBwC,EA2nBxC,WA3nBwC,EA4nBxC,YA5nBwC,EA6nBxC,WA7nBwC,EA8nBxC,WA9nBwC,EA+nBxC,WA/nBwC,EAgoBxC,WAhoBwC,EAioBxC,UAjoBwC,EAkoBxC,eAloBwC,EAmoBxC,gBAnoBwC,EAooBxC,iBApoBwC,EAqoBxC,eAroBwC,EAsoBxC,YAtoBwC,EAuoBxC,kBAvoBwC,EAwoBxC,cAxoBwC,EAyoBxC,kBAzoBwC,EA0oBxC,gBA1oBwC,EA2oBxC,iBA3oBwC,EA4oBxC,yBA5oBwC,EA6oBxC,yBA7oBwC,EA8oBxC,kBA9oBwC,EA+oBxC,kBA/oBwC,EAgpBxC,6BAhpBwC,EAipBxC,iBAjpBwC,EAkpBxC,mBAlpBwC,EAmpBxC,iBAnpBwC,EAopBxC,kBAppBwC,EAqpBxC,iBArpBwC,EAspBxC,eAtpBwC,EAupBxC,aAvpBwC,EAwpBxC,cAxpBwC,EAypBxC,aAzpBwC,EA0pBxC,iBA1pBwC,EA2pBxC,eA3pBwC,EA4pBxC,aA5pBwC,EA6pBxC,aA7pBwC,EA8pBxC,aA9pBwC,EA+pBxC,iBA/pBwC,EAgqBxC,gBAhqBwC,EAiqBxC,eAjqBwC,EAkqBxC,wBAlqBwC,EAmqBxC,cAnqBwC,EAoqBxC,YApqBwC,EAqqBxC,cArqBwC,EAsqBxC,eAtqBwC,EAuqBxC,cAvqBwC,EAwqBxC,eAxqBwC,EAyqBxC,eAzqBwC,EA0qBxC,eA1qBwC,EA2qBxC,gBA3qBwC,EA4qBxC,cA5qBwC,EA6qBxC,aA7qBwC,EA8qBxC,cA9qBwC,EA+qBxC,gBA/qBwC,EAgrBxC,cAhrBwC,EAirBxC,eAjrBwC,EAkrBxC,UAlrBwC,EAmrBxC,gBAnrBwC,EAorBxC,eAprBwC,EAqrBxC,SArrBwC,EAsrBxC,kBAtrBwC,EAurBxC,SAvrBwC,EAwrBxC,SAxrBwC,EAyrBxC,UAzrBwC,EA0rBxC,YA1rBwC,EA2rBxC,gBA3rBwC,EA4rBxC,eA5rBwC,EA6rBxC,aA7rBwC,EA8rBxC,aA9rBwC,EA+rBxC,aA/rBwC,EAgsBxC,aAhsBwC,EAisBxC,YAjsBwC,EAksBxC,aAlsBwC,EAmsBxC,YAnsBwC,EAosBxC,cApsBwC,EAqsBxC,+BArsBwC,EAssBxC,YAtsBwC,EAusBxC,gBAvsBwC,EAwsBxC,gBAxsBwC,EAysBxC,cAzsBwC,EA0sBxC,aA1sBwC,EA2sBxC,oBA3sBwC,EA4sBxC,gBA5sBwC,EA6sBxC,gBA7sBwC,EA8sBxC,gBA9sBwC,EA+sBxC,aA/sBwC,EAgtBxC,YAhtBwC,EAitBxC,aAjtBwC,EAktBxC,gBAltBwC,EAmtBxC,eAntBwC,EAotBxC,eAptBwC,EAqtBxC,iBArtBwC,EAstBxC,gBAttBwC,EAutBxC,gBAvtBwC,EAwtBxC,aAxtBwC,EAytBxC,iBAztBwC,EA0tBxC,iBA1tBwC,EA2tBxC,iBA3tBwC,EA4tBxC,kBA5tBwC,EA6tBxC,oBA7tBwC,EA8tBxC,cA9tBwC,EA+tBxC,aA/tBwC,EAguBxC,eAhuBwC,EAiuBxC,eAjuBwC,EAkuBxC,WAluBwC,EAmuBxC,UAnuBwC,EAouBxC,eApuBwC,EAquBxC,cAruBwC,EAsuBxC,YAtuBwC,EAuuBxC,cAvuBwC,EAwuBxC,gBAxuBwC,EAyuBxC,cAzuBwC,EA0uBxC,eA1uBwC,EA2uBxC,gBA3uBwC,EA4uBxC,oBA5uBwC,EA6uBxC,eA7uBwC,EA8uBxC,eA9uBwC,EA+uBxC,aA/uBwC,EAgvBxC,YAhvBwC,EAivBxC,cAjvBwC,EAkvBxC,YAlvBwC,EAmvBxC,WAnvBwC,EAovBxC,eApvBwC,EAqvBxC,kBArvBwC,EAsvBxC,kBAtvBwC,EAuvBxC,cAvvBwC,EAwvBxC,kBAxvBwC,EAyvBxC,oBAzvBwC,EA0vBxC,gBA1vBwC,EA2vBxC,eA3vBwC,EA4vBxC,iBA5vBwC,EA6vBxC,eA7vBwC,EA8vBxC,QA9vBwC,EA+vBxC,aA/vBwC,EAgwBxC,iBAhwBwC,EAiwBxC,gBAjwBwC,EAkwBxC,mBAlwBwC,EAmwBxC,aAnwBwC,EAowBxC,gBApwBwC,EAqwBxC,cArwBwC,EAswBxC,aAtwBwC,EAuwBxC,eAvwBwC,EAwwBxC,cAxwBwC,EAywBxC,yBAzwBwC,EA0wBxC,oBA1wBwC,EA2wBxC,eA3wBwC,EA4wBxC,gBA5wBwC,EA6wBxC,eA7wBwC,EA8wBxC,iBA9wBwC,EA+wBxC,eA/wBwC,EAgxBxC,eAhxBwC,EAixBxC,eAjxBwC,EAkxBxC,iBAlxBwC,EAmxBxC,eAnxBwC,EAoxBxC,aApxBwC,EAqxBxC,aArxBwC,EAsxBxC,eAtxBwC,EAuxBxC,kBAvxBwC,EAwxBxC,gBAxxBwC,EAyxBxC,eAzxBwC,EA0xBxC,cA1xBwC,EA2xBxC,gBA3xBwC,EA4xBxC,wBA5xBwC,EA6xBxC,oBA7xBwC,EA8xBxC,mBA9xBwC,EA+xBxC,yBA/xBwC,EAgyBxC,oBAhyBwC,EAiyBxC,0BAjyBwC,EAkyBxC,aAlyBwC,EAmyBxC,aAnyBwC,EAoyBxC,eApyBwC,EAqyBxC,mBAryBwC,EAsyBxC,kBAtyBwC,EAuyBxC,QAvyBwC,EAwyBxC,mBAxyBwC,EAyyBxC,mBAzyBwC,EA0yBxC,0BA1yBwC,EA2yBxC,cA3yBwC,EA4yBxC,WA5yBwC,EA6yBxC,2BA7yBwC,EA8yBxC,YA9yBwC,EA+yBxC,YA/yBwC,EAgzBxC,UAhzBwC,EAizBxC,UAjzBwC,EAkzBxC,iBAlzBwC,EAmzBxC,WAnzBwC,EAozBxC,aApzBwC,EAqzBxC,gBArzBwC,EAszBxC,iBAtzBwC,EAuzBxC,gBAvzBwC,EAwzBxC,eAxzBwC,EAyzBxC,gBAzzBwC,EA0zBxC,eA1zBwC,EA2zBxC,eA3zBwC,EA4zBxC,eA5zBwC,EA6zBxC,eA7zBwC,EA8zBxC,gBA9zBwC,EA+zBxC,eA/zBwC,EAg0BxC,eAh0BwC,EAi0BxC,cAj0BwC,EAk0BxC,eAl0BwC,EAm0BxC,cAn0BwC,EAo0BxC,cAp0BwC,EAq0BxC,eAr0BwC,EAs0BxC,eAt0BwC,EAu0BxC,cAv0BwC,EAw0BxC,iBAx0BwC,EAy0BxC,gBAz0BwC,EA00BxC,gBA10BwC,EA20BxC,WA30BwC,EA40BxC,WA50BwC,EA60BxC,cA70BwC,EA80BxC,iBA90BwC,EA+0BxC,cA/0BwC,EAg1BxC,YAh1BwC,EAi1BxC,aAj1BwC,EAk1BxC,oBAl1BwC,EAm1BxC,WAn1BwC,EAo1BxC,cAp1BwC,EAq1BxC,WAr1BwC,EAs1BxC,eAt1BwC,EAu1BxC,aAv1BwC,EAw1BxC,WAx1BwC,EAy1BxC,OAz1BwC,EA01BxC,qBA11BwC,EA21BxC,cA31BwC,EA41BxC,mBA51BwC,EA61BxC,cA71BwC,EA81BxC,aA91BwC,EA+1BxC,mBA/1BwC,EAg2BxC,mBAh2BwC,EAi2BxC,mBAj2BwC,EAk2BxC,gBAl2BwC,EAm2BxC,gBAn2BwC,EAo2BxC,WAp2BwC,EAq2BxC,YAr2BwC,EAs2BxC,QAt2BwC,EAu2BxC,cAv2BwC,EAw2BxC,WAx2BwC,EAy2BxC,YAz2BwC,EA02BxC,cA12BwC,EA22BxC,aA32BwC,EA42BxC,sBA52BwC,EA62BxC,aA72BwC,EA82BxC,cA92BwC,EA+2BxC,YA/2BwC,EAg3BxC,QAh3BwC,EAi3BxC,mBAj3BwC,EAk3BxC,4BAl3BwC,EAm3BxC,mBAn3BwC,EAo3BxC,mBAp3BwC,EAq3BxC,kBAr3BwC,EAs3BxC,iBAt3BwC,EAu3BxC,gBAv3BwC,EAw3BxC,kBAx3BwC,EAy3BxC,iBAz3BwC,EA03BxC,iBA13BwC,EA23BxC,oBA33BwC,EA43BxC,oBA53BwC,EA63BxC,UA73BwC,EA83BxC,cA93BwC,EA+3BxC,cA/3BwC,EAg4BxC,cAh4BwC,EAi4BxC,WAj4BwC,EAk4BxC,oBAl4BwC,EAm4BxC,YAn4BwC,EAo4BxC,cAp4BwC,EAq4BxC,qBAr4BwC,EAs4BxC,sBAt4BwC,EAu4BxC,gBAv4BwC,EAw4BxC,eAx4BwC,EAy4BxC,WAz4BwC,EA04BxC,eA14BwC,EA24BxC,gBA34BwC,EA44BxC,mBA54BwC,EA64BxC,oBA74BwC,EA84BxC,WA94BwC,EA+4BxC,UA/4BwC,EAg5BxC,YAh5BwC,EAi5BxC,YAj5BwC,EAk5BxC,WAl5BwC,EAm5BxC,YAn5BwC,EAo5BxC,UAp5BwC,EAq5BxC,aAr5BwC,EAs5BxC,YAt5BwC,EAu5BxC,UAv5BwC,EAw5BxC,QAx5BwC,EAy5BxC,eAz5BwC,EA05BxC,aA15BwC,EA25BxC,aA35BwC,EA45BxC,YA55BwC,EA65BxC,aA75BwC,EA85BxC,gBA95BwC,EA+5BxC,2BA/5BwC,EAg6BxC,YAh6BwC,EAi6BxC,SAj6BwC,EAk6BxC,QAl6BwC,EAm6BxC,gBAn6BwC,EAo6BxC,oBAp6BwC,EAq6BxC,aAr6BwC,EAs6BxC,gBAt6BwC,EAu6BxC,WAv6BwC,EAw6BxC,aAx6BwC,EAy6BxC,aAz6BwC,EA06BxC,aA16BwC,EA26BxC,WA36BwC,EA46BxC,UA56BwC,EA66BxC,aA76BwC,EA86BxC,SA96BwC,CAAzC,C;;;;;;;;;;;ACAA,IAAIC,eAAJ;AAAWzJ,OAAO8E,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACyE,WAAOzE,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAEXlO,WAAWqB,SAAX,CAAqB8C,GAArB,CAAyB,kBAAzB,EAA6C,UAASsG,OAAT,EAAkBmI,IAAlB,EAAwB;AACpE;AACA,KAAInI,QAAQoI,QAAR,IAAoB5C,KAAK6C,GAAL,CAASH,OAAOlI,QAAQoI,QAAf,EAAyBE,IAAzB,EAAT,IAA4C,KAApE,EAA2E;AAC1E;AACA/S,aAAWC,MAAX,CAAkB+S,KAAlB,CAAwBC,eAAxB,CAAwCxI,QAAQyI,GAAhD,EAAqD,CAArD;AACA,SAAOzI,OAAP;AACA,EAJD,MAIO,IAAIA,QAAQoI,QAAZ,EAAsB;AAC5B;AACA,SAAOpI,OAAP;AACA;;AAED,KAAIA,QAAQlJ,EAAR,IAAc0O,KAAK6C,GAAL,CAASH,OAAOlI,QAAQlJ,EAAf,EAAmBwR,IAAnB,EAAT,IAAsC,KAAxD,EAA+D;AAC9D/S,aAAWC,MAAX,CAAkB+S,KAAlB,CAAwBC,eAAxB,CAAwCxI,QAAQyI,GAAhD,EAAqD,CAArD;AACA,SAAOzI,OAAP;AACA,EAdmE,CAgBpE;;;;;;;;;AAQA,UAAS0I,wBAAT,CAAkC1I,OAAlC,EAA2C2I,UAA3C,EAAuD;AACtD,MAAI,CAAEA,UAAF,IAAgBA,WAAWnO,MAAX,KAAsB,CAA1C,EAA6C;AAAE,UAAO,KAAP;AAAe;;AAE9D,MAAIoO,MAAM,KAAV;AACAD,aAAWE,IAAX,CAAgB,UAASC,SAAT,EAAoB;AACnC,OAAMC,SAAS,IAAIC,MAAJ,CAAWC,EAAEC,YAAF,CAAeJ,SAAf,CAAX,EAAsC,GAAtC,CAAf;;AACA,OAAIC,OAAOtR,IAAP,CAAYuI,QAAQT,GAApB,CAAJ,EAA8B;AAC7BqJ,UAAM,IAAN;AACA,WAAO,IAAP;AACA;AACD,GAND;AAQA,SAAOA,GAAP;AACA;;AAED,KAAIT,KAAKxH,CAAL,IAAU,IAAV,IAAkBwH,KAAKxH,CAAL,KAAW,GAAjC,EAAsC;AACrC;AACApL,aAAWC,MAAX,CAAkB2T,aAAlB,CAAgCC,yCAAhC,CAA0EpJ,QAAQyI,GAAlF,EAAuFzI,QAAQK,CAAR,CAAUrJ,GAAjG,EAAsG,CAAtG;AACA,EAHD,MAGO;AACN,MAAIqS,QAAQ,KAAZ;AACA,MAAMC,aAAa,EAAnB;AACA,MAAMC,gBAAgB,EAAtB;AACA,MAAMZ,aAAapT,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBC,kCAAxB,CAA2DtB,KAAKuB,SAAhE,EAA2E;AAAEC,WAAQ;AAAE,WAAO,CAAT;AAAY,uCAAmC;AAA/C;AAAV,GAA3E,EAA0IC,KAA1I,EAAnB;;AAEA,MAAI5J,QAAQ6J,QAAR,IAAoB,IAAxB,EAA8B;AAC7B7J,WAAQ6J,QAAR,CAAiBxS,OAAjB,CAAyB,UAASyS,OAAT,EAAkB;AAC1C,QAAI,CAACT,KAAD,IAAUS,QAAQ9S,GAAR,KAAgB,KAA9B,EAAqC;AACpCqS,aAAQ,IAAR;AACA;;AACD,QAAIS,QAAQ9S,GAAR,KAAgBgJ,QAAQK,CAAR,CAAUrJ,GAA9B,EAAmC;AAClCsS,gBAAW1R,IAAX,CAAgBkS,QAAQ9S,GAAxB;AACA;AACD,IAPD;AAQA;;AAED2R,aAAWtR,OAAX,CAAmB,UAASgK,IAAT,EAAe;AACjC,OAAIA,QAAQA,KAAKpL,QAAb,IAAyBoL,KAAKpL,QAAL,CAAc8T,WAAvC,IAAsDrB,yBAAyB1I,OAAzB,EAAkCqB,KAAKpL,QAAL,CAAc8T,WAAd,CAA0BpB,UAA5D,CAA1D,EAAmI;AAClI,QAAItH,KAAKrK,GAAL,KAAagJ,QAAQK,CAAR,CAAUrJ,GAA3B,EAAgC;AAC/BuS,mBAAc3R,IAAd,CAAmByJ,KAAKrK,GAAxB;AACA;AACD;AACD,GAND;;AAQA,MAAIqS,KAAJ,EAAW;AACV9T,cAAWC,MAAX,CAAkB2T,aAAlB,CAAgCa,iCAAhC,CAAkE7B,KAAKnR,GAAvE,EAA4EgJ,QAAQK,CAAR,CAAUrJ,GAAtF;AACA,GAFD,MAEO,IAAKsS,cAAcA,WAAW9O,MAAX,GAAoB,CAAnC,IAA0C+O,iBAAiBA,cAAc/O,MAAd,GAAuB,CAAtF,EAA0F;AAChGjF,cAAWC,MAAX,CAAkB2T,aAAlB,CAAgCc,4BAAhC,CAA6D9B,KAAKnR,GAAlE,EAAuElB,EAAEoU,OAAF,CAAUpU,EAAEqU,MAAF,CAASb,WAAWvQ,MAAX,CAAkBwQ,aAAlB,CAAT,CAAV,CAAvE;AACA;AACD,EAxEmE,CA0EpE;;;AACAhU,YAAWC,MAAX,CAAkB+S,KAAlB,CAAwB6B,yCAAxB,CAAkEpK,QAAQyI,GAA1E,EAA+E,CAA/E,EAAkFzI,QAAQlJ,EAA1F,EA3EoE,CA6EpE;AACA;;AACAvB,YAAWC,MAAX,CAAkB2T,aAAlB,CAAgCkB,gCAAhC,CAAiErK,QAAQyI,GAAzE,EAA8EzI,QAAQK,CAAR,CAAUrJ,GAAxF;AAEA,QAAOgJ,OAAP;AAEA,CAnFD,EAmFGzK,WAAWqB,SAAX,CAAqB0C,QAArB,CAA8BG,GAnFjC,EAmFsC,sBAnFtC,gE;;;;;;;;;;;;;;;;;;;;;;;;;ACFA,4BACAlE,WAAW4H,SAAX,GAAuB;AAAA;;AAAA;AAAA;AAAA;AAAA;;AACtB;;;GADsB,0BAMtBmN,UANsB;AAAA,sBAMXrM,QANW,EAMDhH,QANC,EAMS;AAC9B,OAAI,KAAKkG,SAAL,CAAec,QAAf,KAA4B,KAAKd,SAAL,CAAec,QAAf,EAAyBqE,OAAzB,IAAoC,IAApE,EAA0E;AACzE,UAAM,IAAI7L,OAAOsD,KAAX,CAAiB,sBAAjB,EAAyC,2CAAzC,CAAN;AACA;;AACD,OAAI,KAAKoD,SAAL,CAAec,QAAf,KAA4B,IAAhC,EAAsC;AACrC,SAAKd,SAAL,CAAec,QAAf,IAA2B,EAA3B;AACA;;AACD,UAAO,KAAKd,SAAL,CAAec,QAAf,EAAyBqE,OAAzB,GAAmCrL,QAA1C;AACA;;AAdqB;AAAA;;AAAA,2BAgBtBsT,WAhBsB;AAAA,uBAgBVtM,QAhBU,EAgBAhH,QAhBA,EAgBU;AAC/B,OAAI,KAAKkG,SAAL,CAAec,QAAf,KAA4B,KAAKd,SAAL,CAAec,QAAf,EAAyBuM,QAAzB,IAAqC,IAArE,EAA2E;AAC1E,UAAM,IAAI/T,OAAOsD,KAAX,CAAiB,kBAAjB,EAAqC,6CAArC,CAAN;AACA;;AACD,OAAI,KAAKoD,SAAL,CAAec,QAAf,KAA4B,IAAhC,EAAsC;AACrC,SAAKd,SAAL,CAAec,QAAf,IAA2B,EAA3B;AACA;;AACD,UAAO,KAAKd,SAAL,CAAec,QAAf,EAAyBuM,QAAzB,GAAoCvT,QAA3C;AACA;;AAxBqB;AAAA;;AAAA,2BAyBtBwT,WAzBsB;AAAA,uBAyBVxM,QAzBU,EAyBA;AACrB,UAAO,KAAKd,SAAL,CAAec,QAAf,KAA4B,KAAKd,SAAL,CAAec,QAAf,EAAyBuM,QAA5D;AACA;;AA3BqB;AAAA,MA8BtB;;;;;;AA9BsB,2BAoCtBE,UApCsB;AAAA,sBAoCXC,KApCW,EAoCJ1M,QApCI,EAoCMX,UApCN,EAoCkB;AACvC,UAAO,KAAKH,SAAL,CAAec,QAAf,KAA4B,KAAKd,SAAL,CAAec,QAAf,EAAyBqE,OAArD,IAAgE,KAAKnF,SAAL,CAAec,QAAf,EAAyBqE,OAAzB,CAAiCxK,IAAjC,CAAsC6S,KAAtC,EAA6CrN,UAA7C,CAAvE;AACA;;AAtCqB;AAAA;;AAAA;AAAA,EAAkCJ,eAAlC,IAAvB,sG;;;;;;;;;;;ACDA,IAAIgL,eAAJ;AAAWzJ,OAAO8E,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACyE,WAAOzE,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAEXlO,WAAWqB,SAAX,CAAqB8C,GAArB,CAAyB,kBAAzB,EAA6C,UAASsG,OAAT,EAAkBmI,IAAlB,EAAwB;AACpE;AACA,KAAInI,QAAQoI,QAAZ,EAAsB;AACrB,SAAOpI,OAAP;AACA;;AAED,KAAIA,QAAQlJ,EAAR,IAAc0O,KAAK6C,GAAL,CAASH,OAAOlI,QAAQlJ,EAAf,EAAmBwR,IAAnB,EAAT,IAAsC,KAAxD,EAA+D;AAC9D,SAAOtI,OAAP;AACA;;AAED,KAAI4K,qBAAJ;AACA,KAAMC,mBAAmB,EAAzB;AACA,KAAMC,gBAAgB3C,KAAKxH,CAAL,KAAW,GAAjC;;AAEA,KAAImK,aAAJ,EAAmB;AAClBD,mBAAiB7K,QAAQyI,GAAR,CAAYtM,OAAZ,CAAoB6D,QAAQK,CAAR,CAAUrJ,GAA9B,EAAmC,EAAnC,CAAjB,IAA2D,CAA3D;AAEA4T,iBAAezK,QAAQC,EAAR,CAAW,kBAAX,EAA+B;AAC7CiB,SAAMrB,QAAQK,CAAR,CAAUC;AAD6B,GAA/B,CAAf;AAIA,EAPD,MAOO;AACN,MAAIN,QAAQ6J,QAAZ,EAAsB;AACrB7J,WAAQ6J,QAAR,CAAiBxS,OAAjB,CAAyB,UAASyS,OAAT,EAAkB;AAC1Ce,qBAAiBf,QAAQ9S,GAAzB,IAAgC,CAAhC;AACA,IAFD;AAGA;;AAED4T,iBAAezK,QAAQC,EAAR,CAAW,uBAAX,EAAoC;AAClDiB,SAAMrB,QAAQK,CAAR,CAAUC,QADkC;AAElD6H,SAAMA,KAAKlP;AAFuC,GAApC,CAAf;AAIA;;AAED,KAAM8R,iBAAiB,UAAC5C,IAAD,EAAO6C,GAAP,EAAe;AACrC,MAAMC,WAAW1V,WAAW4H,SAAX,CAAqBgB,YAArB,CAAkCgK,KAAKxH,CAAvC,EAA0CqK,GAA1C,CAAjB;AACA,MAAMtV,OAAOe,OAAOE,WAAP,CAAmBsU,WAAWA,SAAS9O,OAAT,CAAiB,KAAjB,EAAwB,EAAxB,CAAX,GAAyC,EAA5D,CAAb;AACA,MAAMyL,QAAQ,CACb,cADa,EAEb,oBAFa,EAGb,qBAHa,EAIb,4BAJa,EAKb,wBALa,EAMZsD,IANY,CAMP,GANO,CAAd;;AAOA,MAAMlL,UAAUG,QAAQC,EAAR,CAAW,sBAAX,CAAhB;;AACA,2EAAqEwH,KAArE,kBAAuFlS,IAAvF,WAAkGsK,OAAlG;AACA,EAZD;;AAcA,KAAMmL,iBAAiB,iFAAvB;AACA,KAAIC,cAAcnC,EAAEzI,UAAF,CAAaR,QAAQT,GAArB,CAAlB;AAEAS,WAAUzK,WAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,eAAzB,EAA0C0F,OAA1C,CAAV;;AACA,KAAIA,QAAQqL,MAAR,IAAkBrL,QAAQqL,MAAR,CAAe7Q,MAAf,GAAwB,CAA9C,EAAiD;AAChDwF,UAAQqL,MAAR,CAAehU,OAAf,CAAuB,UAACiU,KAAD,EAAW;AACjCA,SAAM9D,IAAN,GAAa8D,MAAM9D,IAAN,CAAWrL,OAAX,CAAmB,oBAAnB,EAAyC,QAAzC,CAAb;AACAiP,iBAAcA,YAAYjP,OAAZ,CAAoBmP,MAAMA,KAA1B,EAAiCA,MAAM9D,IAAvC,CAAd;AACA,GAHD;AAIA;;AAED,KAAM+D,SAAShW,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgC5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,KAA2C,EAA3E,CAAf;AACA,KAAMsV,SAASjW,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgC5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,KAA2C,EAA3E,CAAf;AACAkV,eAAcA,YAAYjP,OAAZ,CAAoB,MAApB,EAA4B,OAA5B,CAAd;AAEA5G,YAAWC,MAAX,CAAkB2T,aAAlB,CAAgCsC,yBAAhC,CAA0DtD,KAAKnR,GAA/D,EAAoEK,OAApE,CAA4E,UAAC2T,GAAD,EAAS;AACpF,MAAIA,IAAIU,oBAAR,EAA8B;AAC7B,UAAOb,iBAAiBG,IAAI3K,CAAJ,CAAMrJ,GAAvB,CAAP;AACA,GAFD,MAEO;AACN,WAAQgU,IAAIW,kBAAZ;AACC,SAAK,KAAL;AACCd,sBAAiBG,IAAI3K,CAAJ,CAAMrJ,GAAvB,IAA8B,OAA9B;AACA;;AACD,SAAK,UAAL;AACC,SAAI6T,iBAAiBG,IAAI3K,CAAJ,CAAMrJ,GAAvB,CAAJ,EAAiC;AAChC6T,uBAAiBG,IAAI3K,CAAJ,CAAMrJ,GAAvB,IAA8B,OAA9B;AACA;;AACD;;AACD,SAAK,SAAL;AACC,YAAO6T,iBAAiBG,IAAI3K,CAAJ,CAAMrJ,GAAvB,CAAP;AACA;;AACD,SAAK,SAAL;AACC;AAbF;AAeA;AACD,EApBD;AAsBA,KAAM4U,qBAAqBzU,OAAOC,IAAP,CAAYyT,gBAAZ,CAA3B;AAEA,KAAIgB,oBAAJ;AAEA,KAAMC,aAAa,EAAnB;;AACA,KAAIvW,WAAW4H,SAAX,CAAqBa,aAArB,CAAmCmK,KAAKxH,CAAxC,CAAJ,EAAgD;AAC/CpL,aAAWC,MAAX,CAAkB2T,aAAlB,CAAgC4C,sBAAhC,CAAuD5D,KAAKnR,GAA5D,EAAiE4U,kBAAjE,EAAqFvU,OAArF,CAA6F,UAAC2T,GAAD,EAAS;AACrGc,cAAWd,IAAI3K,CAAJ,CAAMrJ,GAAjB,IAAwB+T,eAAe5C,IAAf,EAAqB6C,GAArB,CAAxB;AACA,GAFD;AAGA,EAJD,MAIO;AACNa,gBAAcd,eAAe5C,IAAf,EAAqB;AAAElP,SAAMkP,KAAKlP;AAAb,GAArB,CAAd;AACA;;AAED,KAAI2S,mBAAmBpR,MAAnB,GAA4B,CAAhC,EAAmC;AAClC,MAAMwR,iBAAiBzW,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwByC,0BAAxB,CAAmDL,kBAAnD,EAAuEhC,KAAvE,EAAvB;;AAEA,MAAIoC,kBAAkBA,eAAexR,MAAf,GAAwB,CAA9C,EAAiD;AAChD,OAAM0R,WAAW3W,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,WAAxB,CAAjB;AAEA8V,kBAAe3U,OAAf,CAAuB,UAACgK,IAAD,EAAU;AAChC,QAAIA,KAAKpL,QAAL,IAAiBoL,KAAKpL,QAAL,CAAc8T,WAA/B,IAA8C1I,KAAKpL,QAAL,CAAc8T,WAAd,CAA0BoC,qBAAxE,IAAiG9K,KAAKpL,QAAL,CAAc8T,WAAd,CAA0BoC,qBAA1B,KAAoD,UAArJ,IAAmKtB,iBAAiBxJ,KAAKrK,GAAtB,MAA+B,OAAtM,EAA+M;AAC9M;AACA,KAH+B,CAKhC;;;AACA,QAAImR,KAAKxH,CAAL,KAAW,GAAX,IAAkBwH,KAAKuB,SAAL,CAAexN,OAAf,CAAuBmF,KAAKf,QAA5B,MAA0C,CAAC,CAAjE,EAAoE;AACnE;AACA;;AAEDe,SAAK+K,MAAL,CAAYvD,IAAZ,CAAiB,UAACpM,KAAD,EAAW;AAC3B,SAAIA,MAAM4P,QAAV,EAAoB;AACnB5P,cAAQ;AACP6P,WAAI7P,MAAM8P,OADH;AAEPlF,aAAM9R,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,YAAxB,CAFC;AAGPsW,sBAAcN,QAAd,UAA6BtB,YAHtB;AAIPrK,aAAMgL,SAASH,WAAT,GAAuBD,cAAvB,IAAyCW,WAAWzK,KAAKrK,GAAhB,KAAwB6U,WAAjE,IAAgFL;AAJ/E,OAAR;AAOA/U,aAAO+E,KAAP,CAAa,YAAM;AAClBiR,aAAM5F,IAAN,CAAWpK,KAAX;AACA,OAFD;AAIA,aAAO,IAAP;AACA;AACD,KAfD;AAgBA,IA1BD;AA2BA;AACD;;AAED,QAAOuD,OAAP;AAEA,CAxID,EAwIGzK,WAAWqB,SAAX,CAAqB0C,QAArB,CAA8BG,GAxIjC,EAwIsC,oBAxItC,mE;;;;;;;;;;;ACFA,IAAIyO,eAAJ;AAAWzJ,OAAO8E,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACyE,WAAOzE,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAGXlO,WAAWqB,SAAX,CAAqB8C,GAArB,CAAyB,kBAAzB,EAA6C,UAASsG,OAAT,EAAkBmI,IAAlB,EAAwB;AACpE;AACA,KAAInI,QAAQoI,QAAZ,EAAsB;AACrB,SAAOpI,OAAP;AACA;;AAED,KAAIA,QAAQlJ,EAAR,IAAc0O,KAAK6C,GAAL,CAASH,OAAOlI,QAAQlJ,EAAf,EAAmBwR,IAAnB,EAAT,IAAsC,KAAxD,EAA+D;AAC9D,SAAOtI,OAAP;AACA;;AAED,KAAMqB,OAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoC1M,QAAQK,CAAR,CAAUrJ,GAA9C,CAAb,CAVoE,CAYpE;;;AAGA,KAAMf,WAAW,EAAjB,CAfoE,CAiBpE;;;;;;;;;AAQA,UAAS0W,aAAT,CAAuB/S,EAAvB,EAA2BgC,IAA3B,EAAiC;AAChC,MAAM6E,QAAQ;AACbmM,WAAQ,CAAE,wBAAF,EAA4B,0BAA5B,CADK;AAEbC,YAAS,CAAE,uBAAF,EAA2B,yBAA3B;AAFI,GAAd;AAKA,SAAQ5W,SAASwK,MAAM7E,IAAN,EAAY,CAAZ,CAAT,EAAyBM,OAAzB,CAAiCtC,EAAjC,MAAyC,CAAC,CAA1C,IAA+C3D,SAASwK,MAAM7E,IAAN,EAAY,CAAZ,CAAT,EAAyBM,OAAzB,CAAiCtC,EAAjC,MAAyC,CAAC,CAAjG;AACA,EAhCmE,CAkCpE;;;;;;;;;AAQA,UAAS8O,wBAAT,CAAkC1I,OAAlC,EAA2C2I,UAA3C,EAAuD;AACtD,MAAI,CAAEA,UAAF,IAAgBA,WAAWnO,MAAX,KAAsB,CAA1C,EAA6C;AAAE,UAAO,KAAP;AAAe;;AAE9D,MAAIoO,MAAM,KAAV;AACAD,aAAWE,IAAX,CAAgB,UAASC,SAAT,EAAoB;AACnC,OAAMC,SAAS,IAAIC,MAAJ,CAAWC,EAAEC,YAAF,CAAeJ,SAAf,CAAX,EAAsC,GAAtC,CAAf;;AACA,OAAIC,OAAOtR,IAAP,CAAYuI,QAAQT,GAApB,CAAJ,EAA8B;AAC7BqJ,UAAM,IAAN;AACA,WAAO,IAAP;AACA;AACD,GAND;AAQA,SAAOA,GAAP;AACA;;AAED3S,UAAS6W,wBAAT,GAAoC,EAApC;AACA7W,UAAS8W,sBAAT,GAAkC,EAAlC;AACA9W,UAAS+W,uBAAT,GAAmC,EAAnC;AACA/W,UAASgX,qBAAT,GAAiC,EAAjC;AACAhX,UAASiX,4BAAT,GAAwC,EAAxC;AAEA,KAAMC,gCAAgC5X,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCiE,iCAAhC,CAAkEjF,KAAKnR,GAAvE,CAAtC;AACAmW,+BAA8B9V,OAA9B,CAAsC,UAASgW,YAAT,EAAuB;AAC5D,MAAIA,aAAa3B,oBAAjB,EAAuC;AACtCzV,YAAS8W,sBAAT,CAAgCnV,IAAhC,CAAqCyV,aAAahN,CAAb,CAAerJ,GAApD;AACAf,YAASgX,qBAAT,CAA+BrV,IAA/B,CAAoCyV,aAAahN,CAAb,CAAerJ,GAAnD;AACA,GAHD,MAGO;AACN,OAAIqW,aAAaC,oBAAb,KAAsC,KAA1C,EAAiD;AAChDrX,aAAS6W,wBAAT,CAAkClV,IAAlC,CAAuCyV,aAAahN,CAAb,CAAerJ,GAAtD;AACA,IAFD,MAEO,IAAIqW,aAAaC,oBAAb,KAAsC,SAA1C,EAAqD;AAC3DrX,aAAS8W,sBAAT,CAAgCnV,IAAhC,CAAqCyV,aAAahN,CAAb,CAAerJ,GAApD;AACA;;AACD,OAAIqW,aAAaE,uBAAb,KAAyC,KAA7C,EAAoD;AACnDtX,aAAS+W,uBAAT,CAAiCpV,IAAjC,CAAsCyV,aAAahN,CAAb,CAAerJ,GAArD;AACA,IAFD,MAEO,IAAIqW,aAAaE,uBAAb,KAAyC,SAA7C,EAAwD;AAC9DtX,aAASgX,qBAAT,CAA+BrV,IAA/B,CAAoCyV,aAAahN,CAAb,CAAerJ,GAAnD;AACA;AACD;;AACDf,WAASiX,4BAAT,CAAsCG,aAAahN,CAAb,CAAerJ,GAArD,IAA4DqW,aAAaG,2BAAzE;AACA,EAjBD;AAmBA,KAAIC,kBAAkB,EAAtB;AACA,KAAIC,sBAAsB,EAA1B;AACA,KAAMC,sBAAsB,EAA5B;AAEA,KAAMhF,aAAapT,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBC,kCAAxB,CAA2DtB,KAAKuB,SAAhE,EAA2E;AAAEC,UAAQ;AAAE,UAAO,CAAT;AAAY,sCAAmC;AAA/C;AAAV,EAA3E,EAA0IC,KAA1I,EAAnB;AAEAjB,YAAWtR,OAAX,CAAmB,UAASgK,IAAT,EAAe;AACjC,MAAIqH,yBAAyB1I,OAAzB,EAAkCqB,KAAKpL,QAAL,CAAc8T,WAAd,CAA0BpB,UAA5D,CAAJ,EAA6E;AAC5EgF,uBAAoB/V,IAApB,CAAyByJ,IAAzB;AACA;AACD,EAJD;AAMA,KAAIuM,qBAAJ,CA/FoE,CAgGpE;;AACA,KAAIrY,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,mBAAxB,CAAJ,EAAkD;AACjD0X,iBAAe5N,QAAQT,GAAvB;AACA,EAFD,MAEO;AACNqO,iBAAe,GAAf;AACA;;AAED,KAAIC,sBAAJ;AACA,KAAIC,kBAAJ;;AACA,KAAIvY,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,yBAAxB,CAAJ,EAAwD;AACvD2X,kBAAgBxM,KAAKf,QAArB;AACAwN,oBAAiB3F,KAAKlP,IAAtB;AACA,EAHD,MAGO;AACN4U,kBAAgB,EAAhB;AACAC,cAAY,EAAZ;AACA;;AAED,KAAI3F,KAAKxH,CAAL,IAAU,IAAV,IAAkBwH,KAAKxH,CAAL,KAAW,GAAjC,EAAsC;AACrC,MAAMoN,kBAAkB/N,QAAQyI,GAAR,CAAYtM,OAAZ,CAAoB6D,QAAQK,CAAR,CAAUrJ,GAA9B,EAAmC,EAAnC,CAAxB;AACA,MAAMgX,gBAAgBzY,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwByE,OAAxB,CAAgC;AACrDjX,QAAK+W;AADgD,GAAhC,EAEnB;AACFpE,WAAQ;AACPrJ,cAAU,CADH;AAEP4N,sBAAkB;AAFX;AADN,GAFmB,CAAtB,CAFqC,CAWrC;;AACA,MAAIF,iBAAiB,IAArB,EAA2B;AAC1BzY,cAAW4Y,SAAX,CAAqBxK,MAArB,CAA4B3D,OAA5B,EAAqC,CAACgO,cAAchX,GAAf,CAArC,QACMqK,KAAKf,QADX,UAC0BN,QAAQT,GADlC,EAC0C,gBAD1C;AAGA;;AACD,MAAKyO,iBAAiB,IAAlB,IAA2BrB,cAAcoB,eAAd,EAA+B,QAA/B,CAA/B,EAAyE;AACxExY,cAAW6Y,aAAX,CAAyBC,UAAzB,CAAoCL,cAAchX,GAAlD,EAAuD,cAAvD,EAAuE;AACtEiQ,WAAO1R,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,kBAAxB,IAA8CmL,KAAKpI,IAAnD,SAA+DoI,KAAKf,QADL;AAEtEkH,UAAMxH,QAAQT,GAFwD;AAGtE+O,cAAUrY,SAASiX,4BAAT,CAAsCc,cAAchX,GAApD,CAH4D;AAItEgQ,aAAS;AACRhQ,UAAKgJ,QAAQhJ,GADL;AAERyR,UAAKzI,QAAQyI,GAFL;AAGR8F,aAAQvO,QAAQK,CAHR;AAIRzE,WAAMuM,KAAKxH,CAJH;AAKR1H,WAAMkP,KAAKlP;AALH;AAJ6D,IAAvE;AAYA;;AAED,MAAK+U,iBAAiB,IAAlB,IAA2BrB,cAAcoB,eAAd,EAA+B,SAA/B,CAA/B,EAA0E;AACzE,OAAI/F,KAAKwG,OAAL,KAAiB,IAAjB,IAAyBR,cAAcE,gBAAd,KAAmC,QAAhE,EAA0E;AACzE3Y,eAAW+Q,gBAAX,CAA4BO,IAA5B,CAAiC;AAChCL,aAAQxG,QAAQyI,GADgB;AAEhCnI,eAAUuN,aAFsB;AAGhC7N,cAAS4N,YAHuB;AAIhC5G,cAAS;AACRvF,YAAMhL,OAAOE,WAAP,EADE;AAER8R,WAAKzI,QAAQyI,GAFL;AAGR8F,cAAQvO,QAAQK,CAHR;AAIRzE,YAAMuM,KAAKxH,CAJH;AAKR1H,YAAMkP,KAAKlP;AALH,MAJuB;AAWhC8N,cAAS;AACR3H,cAAQ4O,cAAchX;AADd;AAXuB,KAAjC;AAeA,WAAOgJ,OAAP;AACA;AACD;AAED,EArDD,MAqDO;AACN,MAAMsJ,aAAa,EAAnB;;AACA,MAAItJ,QAAQ6J,QAAR,IAAoB,IAAxB,EAA8B;AAC7B7J,WAAQ6J,QAAR,CAAiBxS,OAAjB,CAAyB,UAASyS,OAAT,EAAkB;AAC1C,WAAOR,WAAW1R,IAAX,CAAgBkS,QAAQ9S,GAAxB,CAAP;AACA,IAFD;AAGA;;AACD,MAAMqS,QAAQC,WAAWpN,OAAX,CAAmB,KAAnB,IAA4B,CAAC,CAA3C;AACA,MAAMuS,SAASnF,WAAWpN,OAAX,CAAmB,MAAnB,IAA6B,CAAC,CAA7C;;AACA,MAAIoN,WAAW9O,MAAX,GAAoB,CAApB,IAAyBvE,SAAS6W,wBAAT,CAAkCtS,MAAlC,GAA2C,CAAxE,EAA2E;AAC1E,OAAIkU,oBAAoB5Y,EAAE6Y,KAAF,CAAQrF,UAAR,EAAoBrT,SAAS6W,wBAA7B,CAAxB;;AACA4B,uBAAoB5Y,EAAE8Y,UAAF,CAAaF,iBAAb,EAAgCzY,SAAS8W,sBAAzC,CAApB;AAEA,OAAI8B,yBAAyBtZ,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBvP,IAAxB,CAA6B;AACzDjD,SAAK;AACJ8X,UAAKJ;AADD;AADoD,IAA7B,EAI1B;AACF/E,YAAQ;AACP3S,UAAK,CADE;AAEPsJ,eAAU,CAFH;AAGPyO,aAAQ;AAHD;AADN,IAJ0B,EAU1BnF,KAV0B,EAA7B;;AAWA,OAAIzB,KAAKxH,CAAL,KAAW,GAAX,IAAkB,CAAC0I,KAAvB,EAA8B;AAC7B,QAAM2F,WAAW,UAASC,kBAAT,EAA6B;AAC7C,SAAIA,mBAAmBF,MAAvB,EAA+B;AAC9BtY,aAAOyY,SAAP,CAAiBD,mBAAmBjY,GAApC,EAAyC,YAAW;AACnD,cAAOP,OAAOqB,IAAP,CAAY,UAAZ,EAAwBqQ,KAAKnR,GAA7B,CAAP;AACA,OAFD;AAGA;AACD,KAND;;AAOA,yBAAiC6X,sBAAjC,kHAAyD;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,SAA9CI,kBAA8C;;AACxD,SAAI9G,KAAKuB,SAAL,CAAexN,OAAf,CAAuB+S,mBAAmB3O,QAA1C,MAAwD,CAAC,CAA7D,EAAgE;AAC/D0O,eAASC,kBAAT;AACA;AACD;AACD;;AAED,OAAI9G,KAAKxH,CAAL,KAAW,GAAf,EAAoB;AACnBkO,6BAAyB/Y,EAAEuE,MAAF,CAASwU,sBAAT,EAAiC,UAACI,kBAAD,EAAwB;AACjF,YAAO9G,KAAKuB,SAAL,CAAexN,OAAf,CAAuB+S,mBAAmB3O,QAA1C,MAAwD,CAAC,CAAhE;AACA,KAFwB,CAAzB;AAGA;;AAEDmN,qBAAkB3X,EAAEqZ,KAAF,CAAQN,sBAAR,EAAgC,KAAhC,CAAlB;AACA;;AAED,MAAIvF,WAAW9O,MAAX,GAAoB,CAApB,IAAyBvE,SAAS+W,uBAAT,CAAiCxS,MAAjC,GAA0C,CAAvE,EAA0E;AACzE,OAAI4U,mBAAmBtZ,EAAE6Y,KAAF,CAAQrF,UAAR,EAAoBrT,SAAS+W,uBAA7B,CAAvB;;AACAoC,sBAAmBtZ,EAAE8Y,UAAF,CAAaQ,gBAAb,EAA+BnZ,SAASgX,qBAAxC,CAAnB;AAEA,OAAIoC,wBAAwB9Z,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBvP,IAAxB,CAA6B;AACxDjD,SAAK;AACJ8X,UAAKM;AADD;AADmD,IAA7B,EAIzB;AACFzF,YAAQ;AACP3S,UAAK,CADE;AAEPsJ,eAAU,CAFH;AAGP4N,uBAAkB;AAHX;AADN,IAJyB,EAUzBtE,KAVyB,EAA5B;;AAYA,OAAIzB,KAAKxH,CAAL,KAAW,GAAf,EAAoB;AACnB0O,4BAAwBvZ,EAAEuE,MAAF,CAASgV,qBAAT,EAAgC,UAACJ,kBAAD,EAAwB;AAC/E,YAAO9G,KAAKuB,SAAL,CAAexN,OAAf,CAAuB+S,mBAAmB3O,QAA1C,MAAwD,CAAC,CAAhE;AACA,KAFuB,CAAxB;AAGA;;AAEDoN,yBAAsB5X,EAAEqZ,KAAF,CAAQrZ,EAAEmG,MAAF,CAASoT,qBAAT,EAAgC,UAAShO,IAAT,EAAe;AAC5E,WAAOA,KAAK6M,gBAAL,KAA0B,QAAjC;AACA,IAF6B,CAAR,EAElB,KAFkB,CAAtB;AAGA;;AAED,MAAI,CAAC7E,SAASoF,MAAV,KAAqBtG,KAAKuB,SAA1B,IAAuCvB,KAAKuB,SAAL,CAAelP,MAAf,GAAwB,CAAnE,EAAsE;AACrEjF,cAAWC,MAAX,CAAkBgU,KAAlB,CAAwBvP,IAAxB,CAA6B;AAC5BqG,cAAU;AACTwO,UAAK3G,KAAKuB;AADD,KADkB;AAI5B1S,SAAK;AACJsY,UAAKjO,KAAKrK;AADN;AAJuB,IAA7B,EAOG;AACF2S,YAAQ;AACP3S,UAAK,CADE;AAEPsJ,eAAU,CAFH;AAGPiP,aAAQ,CAHD;AAIPrB,uBAAkB;AAJX;AADN,IAPH,EAcG7W,OAdH,CAcW,UAASgK,IAAT,EAAe;AACzB,QAAI,CAAC,QAAD,EAAW,MAAX,EAAmB,MAAnB,EAA2BmO,QAA3B,CAAoCnO,KAAKkO,MAAzC,KAAoD,CAACtZ,SAAS8W,sBAAT,IAAmC,EAApC,EAAwCyC,QAAxC,CAAiDnO,KAAKrK,GAAtD,MAA+D,KAAvH,EAA8H;AAC7HyW,qBAAgB7V,IAAhB,CAAqByJ,KAAKrK,GAA1B;AACA;;AACD,QAAIqS,SAAShI,KAAK6M,gBAAL,KAA0B,QAAnC,IAA+C,CAACjY,SAASgX,qBAAT,IAAkC,EAAnC,EAAuCuC,QAAvC,CAAgDnO,KAAKrK,GAArD,MAA8D,KAAjH,EAAwH;AACvH,YAAO0W,oBAAoB9V,IAApB,CAAyByJ,KAAKrK,GAA9B,CAAP;AACA;AACD,IArBD;AAsBA;;AAED,MAAI2W,oBAAoBnT,MAApB,GAA6B,CAAjC,EAAoC;AACnC,OAAM+O,gBAAgBzT,EAAEqZ,KAAF,CAAQxB,mBAAR,EAA6B,KAA7B,CAAtB;;AACAF,qBAAkBA,gBAAgB1U,MAAhB,CAAuBwQ,aAAvB,CAAlB;AACAmE,yBAAsBA,oBAAoB3U,MAApB,CAA2BwQ,aAA3B,CAAtB;AACA;;AAEDkE,oBAAkB3X,EAAE2Z,OAAF,CAAU3Z,EAAEoU,OAAF,CAAUpU,EAAEqU,MAAF,CAASsD,eAAT,CAAV,CAAV,EAAgDzN,QAAQK,CAAR,CAAUrJ,GAA1D,CAAlB;AACA0W,wBAAsB5X,EAAE2Z,OAAF,CAAU3Z,EAAEoU,OAAF,CAAUpU,EAAEqU,MAAF,CAASuD,mBAAT,CAAV,CAAV,EAAoD1N,QAAQK,CAAR,CAAUrJ,GAA9D,CAAtB;;AAEA,MAAIyW,gBAAgBjT,MAAhB,GAAyB,CAA7B,EAAgC;AAC/B,yBAA+BiT,eAA/B,yHAAgD;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,QAArCiC,gBAAqC;AAC/C,QAAIzI,cAAa5F,KAAKf,QAAtB;;AACA,QAAI6H,KAAKlP,IAAT,EAAe;AACdgO,uBAAiBkB,KAAKlP,IAAtB;AACA;;AACD1D,eAAW6Y,aAAX,CAAyBC,UAAzB,CAAoCqB,gBAApC,EAAsD,cAAtD,EAAsE;AACrEzI,iBADqE;AAErEO,WAAMxH,QAAQT,GAFuD;AAGrE+O,eAAUrY,SAASiX,4BAAT,CAAsCwC,gBAAtC,CAH2D;AAIrE1I,cAAS;AACRhQ,WAAKgJ,QAAQhJ,GADL;AAERyR,WAAKzI,QAAQyI,GAFL;AAGR8F,cAAQvO,QAAQK,CAHR;AAIRzE,YAAMuM,KAAKxH,CAJH;AAKR1H,YAAMkP,KAAKlP;AALH;AAJ4D,KAAtE;AAYA;AACD;;AAED,MAAIyU,oBAAoBlT,MAApB,GAA6B,CAAjC,EAAoC;AACnC,OAAIwN,KAAKwG,OAAL,KAAiB,IAArB,EAA2B;AAC1BjZ,eAAW+Q,gBAAX,CAA4BO,IAA5B,CAAiC;AAChCL,aAAQxG,QAAQyI,GADgB;AAEhC3B,eAAUgH,SAFsB;AAGhCxN,eAAUuN,aAHsB;AAIhC7N,cAAS4N,YAJuB;AAKhC5G,cAAS;AACRvF,YAAMhL,OAAOE,WAAP,EADE;AAER8R,WAAKzI,QAAQyI,GAFL;AAGR8F,cAAQvO,QAAQK,CAHR;AAIRzE,YAAMuM,KAAKxH,CAJH;AAKR1H,YAAMkP,KAAKlP;AALH,MALuB;AAYhC8N,cAAS;AACR3H,cAAQ;AACP0P,YAAKpB;AADE;AADA;AAZuB,KAAjC;AAkBA;AACD;;AAED,MAAMiC,qBAAqB7Z,EAAEqU,MAAF,CAASsD,gBAAgB1U,MAAhB,CAAuB2U,mBAAvB,CAAT,CAA3B;;AACA,MAAIvF,KAAKxH,CAAL,KAAW,GAAf,EAAoB;AACnBpL,cAAW4Y,SAAX,CAAqBxK,MAArB,CAA4B3D,OAA5B,EAAqC2P,kBAArC,QACMtO,KAAKf,QADX,UAC0BN,QAAQT,GADlC,EAC0C,gBAD1C;AAEA,GAHD,MAGO;AACNhK,cAAW4Y,SAAX,CAAqBxK,MAArB,CAA4B3D,OAA5B,EAAqC2P,kBAArC,QACMtO,KAAKf,QADX,UAC0BN,QAAQT,GADlC,EAC0C,SAD1C;AAEA;AACD;;AAED,QAAOS,OAAP;AAEA,CA3UD,EA2UGzK,WAAWqB,SAAX,CAAqB0C,QAArB,CAA8BG,GA3UjC,EA2UsC,2BA3UtC,4D;;;;;;;;;;;ACHA,IAAMmW,MAAMC,IAAIrM,OAAJ,CAAY,KAAZ,CAAZ;;AAEA,IAAIsM,uBAAuB,EAA3B;AACA,IAAIC,uBAAuB,EAA3B;AACA,IAAIC,sBAAsB,KAA1B;AACA,IAAIC,oBAAoB,KAAxB;AAEA1a,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,6BAAxB,EAAuD,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AAC3EwY,wBAAuBha,EAAEsC,GAAF,CAAMd,MAAM4D,KAAN,CAAY,GAAZ,CAAN,EAAwB,UAACgV,MAAD;AAAA,SAAYA,OAAOla,IAAP,EAAZ;AAAA,EAAxB,CAAvB;AACA,CAFD;AAGAT,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,6BAAxB,EAAuD,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AAC3EyY,wBAAuBja,EAAEsC,GAAF,CAAMd,MAAM4D,KAAN,CAAY,GAAZ,CAAN,EAAwB,UAACgV,MAAD;AAAA,SAAYA,OAAOla,IAAP,EAAZ;AAAA,EAAxB,CAAvB;AACA,CAFD;AAGAT,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uCAAxB,EAAiE,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AACrF0Y,uBAAsB1Y,KAAtB;AACA,CAFD;AAGA/B,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,4BAAxB,EAAsD,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AAC1E2Y,qBAAoB3Y,KAApB;AACA,CAFD;;AAIA/B,WAAW4a,mBAAX,GAAiC,UAAS1T,KAAT,EAAgB;AAChD,KAAM2T,kBAAkB,uIAAxB;;AACA,KAAI,CAACA,gBAAgB3Y,IAAhB,CAAqBgF,KAArB,CAAL,EAAkC;AACjC,QAAM,IAAIhG,OAAOsD,KAAX,CAAiB,qBAAjB,qBAA0D0C,KAA1D,EAAoE;AAAE,eAAU,gCAAZ;AAA8CA;AAA9C,GAApE,CAAN;AACA;;AAED,KAAM4T,cAAc5T,MAAM6T,MAAN,CAAa7T,MAAM8T,WAAN,CAAkB,GAAlB,IAAyB,CAAtC,CAApB,CANgD,CAQhD;;AACA,KAAIR,qBAAqB7T,OAArB,CAA6BmU,WAA7B,MAA8C,CAAC,CAAnD,EAAsD;AACrD,MAAIP,qBAAqB5T,OAArB,CAA6BmU,WAA7B,MAA8C,CAAC,CAA/C,IAAqDL,uBAAuBza,WAAW0S,2BAAX,CAAuC/L,OAAvC,CAA+CmU,WAA/C,MAAgE,CAAC,CAAjJ,EAAqJ;AACpJ,SAAM,IAAI5Z,OAAOsD,KAAX,CAAiB,gCAAjB,EAAmD,iCAAnD,EAAsF;AAAE,gBAAU;AAAZ,IAAtF,CAAN;AACA;AACD;;AAED,KAAIkW,iBAAJ,EAAuB;AACtB,MAAI;AACHxZ,UAAO+Z,SAAP,CAAiBZ,IAAIa,SAArB,EAAgCJ,WAAhC;AACA,GAFD,CAEE,OAAOK,CAAP,EAAU;AACX,SAAM,IAAIja,OAAOsD,KAAX,CAAiB,sBAAjB,EAAyC,gBAAzC,EAA2D;AAAE,gBAAU;AAAZ,IAA3D,CAAN;AACA;AACD;AACD,CAtBD,2H;;;;;;;;;;;ACpBA,IAAI4W,WAAJ;AAAOlS,OAAO8E,KAAP,CAAaC,QAAQ,IAAR,CAAb,EAA2B;AAAA,sBAASC,CAAT,EAAW;AAACkN,OAAGlN,CAAH;AAAK;AAAjB,CAA3B,EAA8C,CAA9C;;AAEP,SAASmN,YAAT,GAAwB;AACvB,KAAI;AACHD,KAAGE,QAAH,CAAY,aAAZ;AACA,SAAO,IAAP;AACA,EAHD,CAGE,OAAOtY,GAAP,EAAY;AACb,SAAO,KAAP;AACA;AACD;;AAED,SAASuY,eAAT,GAA2B;AAC1B,KAAI;AACH,SAAOH,GAAGI,YAAH,CAAgB,mBAAhB,EAAqC,MAArC,EAA6C7U,OAA7C,CAAqD,QAArD,MAAmE,CAAC,CAA3E;AACA,EAFD,CAEE,OAAO3D,GAAP,EAAY;AACb,SAAO,KAAP;AACA;AACD;;AAED,SAAS+M,KAAT,GAAiB;AAChB,QAAOsL,kBAAkBE,iBAAzB;AACA;;AAED,IAAIE,iBAAJ;;AACAzb,WAAWyb,QAAX,GAAsB,YAAW;AAChC,KAAIA,aAAaC,SAAjB,EAA4B;AAC3BD,aAAW1L,OAAX;AACA;;AAED,QAAO0L,QAAP;AACA,CAND,2H;;;;;;;;;;;ACxBAzb,WAAW2b,wBAAX,GAAsC,UAAS7P,IAAT,EAAe8P,QAAf,EAAyB;AAC9D5b,YAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,2BAAzB,EAAsD+G,IAAtD;AACA,KAAM+P,eAAe7b,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwB8I,qBAAxB,CAA8C,IAA9C,EAAoD,CAAC,GAAD,EAAM,GAAN,CAApD,EAAgE;AAAC1H,UAAQ;AAACD,cAAW;AAAZ;AAAT,EAAhE,EAA0FE,KAA1F,EAArB;AACAwH,cAAa/Z,OAAb,CAAqB,UAAC8Q,IAAD,EAAU;AAE9B;AACA,MAAMmJ,QAAQnJ,KAAKoJ,EAAL,IAAW,CAAChc,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BpQ,KAAKrK,GAApC,EAAyC,eAAzC,CAA1B;AACAzB,aAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmJ,eAAxB,CAAwCvJ,KAAKnR,GAA7C,EAAkDqK,KAAKf,QAAvD,EAAiEgR,KAAjE;;AAEA,MAAI,CAAC/b,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCwI,wBAAhC,CAAyDxJ,KAAKnR,GAA9D,EAAmEqK,KAAKrK,GAAxE,CAAL,EAAmF;AAElF;AACAzB,cAAWC,MAAX,CAAkB2T,aAAlB,CAAgCyI,qBAAhC,CAAsDzJ,IAAtD,EAA4D9G,IAA5D,EAAkE;AACjEvK,QAAI,IAAIC,IAAJ,EAD6D;AAEjE8a,UAAM,IAF2D;AAGjEC,WAAO,IAH0D;AAIjEC,YAAQ;AAJyD,IAAlE,EAHkF,CAUlF;;AACA,OAAI,CAACZ,QAAL,EAAe;AACd5b,eAAWC,MAAX,CAAkBwc,QAAlB,CAA2BC,+BAA3B,CAA2D9J,KAAKnR,GAAhE,EAAqEqK,IAArE;AACA;AACD;AACD,EArBD;AAsBA,CAzBD,2H;;;;;;;;;;;ACAA9L,WAAW2c,aAAX,GAA2B,UAASzJ,GAAT,EAAcpH,IAAd,EAAoB8Q,OAApB,EAA6BhB,QAA7B,EAAuC;AACjE,KAAMtW,MAAM,IAAI9D,IAAJ,EAAZ;AACA,KAAMoR,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAAb,CAFiE,CAIjE;;AACA,KAAM4E,eAAe9X,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCwI,wBAAhC,CAAyDlJ,GAAzD,EAA8DpH,KAAKrK,GAAnE,CAArB;;AACA,KAAIqW,YAAJ,EAAkB;AACjB;AACA;;AAED,KAAIlF,KAAKxH,CAAL,KAAW,GAAX,IAAkBwH,KAAKxH,CAAL,KAAW,GAAjC,EAAsC;AACrCpL,aAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,gBAAzB,EAA2C+G,IAA3C,EAAiD8G,IAAjD;AACA;;AAED,KAAMmJ,QAAQnJ,KAAKoJ,EAAL,IAAW,CAAChc,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BpQ,KAAKrK,GAApC,EAAyC,eAAzC,CAA1B;AACAzB,YAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmJ,eAAxB,CAAwCjJ,GAAxC,EAA6CpH,KAAKf,QAAlD,EAA4DgR,KAA5D;AACA/b,YAAWC,MAAX,CAAkB2T,aAAlB,CAAgCyI,qBAAhC,CAAsDzJ,IAAtD,EAA4D9G,IAA5D,EAAkE;AACjEvK,MAAI+D,GAD6D;AAEjEgX,QAAM,IAF2D;AAGjEC,SAAO,IAH0D;AAIjEC,UAAQ;AAJyD,EAAlE;;AAOA,KAAI,CAACZ,QAAL,EAAe;AACd,MAAIgB,OAAJ,EAAa;AACZ5c,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2BI,gCAA3B,CAA4D3J,GAA5D,EAAiEpH,IAAjE,EAAuE;AACtEvK,QAAI+D,GADkE;AAEtEwF,OAAG;AACFrJ,UAAKmb,QAAQnb,GADX;AAEFsJ,eAAU6R,QAAQ7R;AAFhB;AAFmE,IAAvE;AAOA,GARD,MAQO;AACN/K,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2BC,+BAA3B,CAA2DxJ,GAA3D,EAAgEpH,IAAhE,EAAsE;AAAEvK,QAAI+D;AAAN,IAAtE;AACA;AACD;;AAED,KAAIsN,KAAKxH,CAAL,KAAW,GAAX,IAAkBwH,KAAKxH,CAAL,KAAW,GAAjC,EAAsC;AACrClK,SAAO+E,KAAP,CAAa,YAAW;AACvBjG,cAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,eAAzB,EAA0C+G,IAA1C,EAAgD8G,IAAhD;AACA,GAFD;AAGA;;AAED,QAAO,IAAP;AACA,CA5CD,2H;;;;;;;;;;;ACAA5S,WAAW8c,WAAX,GAAyB,UAAS5J,GAAT,EAAc;AACtClT,YAAWC,MAAX,CAAkB+S,KAAlB,CAAwB+J,WAAxB,CAAoC7J,GAApC;AACAlT,YAAWC,MAAX,CAAkB2T,aAAlB,CAAgCoJ,eAAhC,CAAgD9J,GAAhD;AAEAlT,YAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,mBAAzB,EAA8C/E,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAA9C,EAAwFhS,OAAO4K,IAAP,EAAxF;AACA,CALD,0H;;;;;;;;;;;;ACAA9L,WAAWid,yBAAX,GAAuC,UAAClS,QAAD;AACtC,MAAAmS,iBAAA;AAAAA,sBAAoB,EAApB;ACEC,SDDDld,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,8BAAxB,EAAwD,UAAAwc,KAAA;ACErD,WDFqD,UAACnb,GAAD,EAAMD,KAAN;AACvD,UAAAqP,CAAA,EAAAgM,GAAA,EAAA7Z,KAAA,EAAA8Z,kBAAA;AAAAH,0BAAoB3c,EAAEsC,GAAF,CAAMd,MAAM4D,KAAN,CAAY,GAAZ,CAAN,EAAwB,UAACoF,QAAD;ACItC,eDJoDA,SAAStK,IAAT,ECIpD;ADJc,QAApB;;AACA,UAAGyc,kBAAkBjY,MAAlB,KAA8B,CAAjC;AACC,aAAAmM,IAAA,GAAAgM,MAAAF,kBAAAjY,MAAA,EAAAmM,IAAAgM,GAAA,EAAAhM,GAAA;ACMOiM,+BAAqBH,kBAAkB9L,CAAlB,CAArB;ADLN7N,kBAAY,IAAAkQ,MAAA,CAAO,MAAMC,EAAEC,YAAF,CAAe0J,kBAAf,CAAN,GAA2C,GAAlD,EAAuD,GAAvD,CAAZ;;AACA,cAAgB9Z,MAAMrB,IAAN,CAAWwR,EAAEjT,IAAF,CAAOiT,EAAEC,YAAF,CAAe5I,QAAf,CAAP,CAAX,CAAhB;AAAA,mBAAO,KAAP;ACQO;ADXT;ACaK;;ADTL,aAAO,CAAI7J,OAAOoc,KAAP,CAAa5E,OAAb,CAAqB;AAAE3N,kBAAU;AAAEwS,kBAAa,IAAA9J,MAAA,CAAO,MAAMC,EAAEjT,IAAF,CAAOiT,EAAEC,YAAF,CAAe5I,QAAf,CAAP,CAAN,GAAyC,GAAhD,EAAqD,GAArD;AAAf;AAAZ,OAArB,CAAX;AANuD,KCErD;ADFqD,SAAxD,CCCC;ADHqC,CAAvC,0H;;;;;;;;;;;AEAA/K,WAAWwd,sBAAX,GAAoC,UAAStW,KAAT,EAAgB;AACnD,QAAO,CAAChG,OAAOoc,KAAP,CAAa5E,OAAb,CAAqB;AAAE,oBAAkB;AAAE6E,WAAS,IAAI9J,MAAJ,OAAgBC,EAAEjT,IAAF,CAAOiT,EAAEC,YAAF,CAAezM,KAAf,CAAP,CAAhB,QAAmD,GAAnD;AAAX;AAApB,EAArB,CAAR;AACA,CAFD,0H;;;;;;;;;;;ACAA,wBACAlH,WAAWyd,UAAX,GAAwB,UAASpX,IAAT,EAAe3C,IAAf,EAAqBga,KAArB,EAA4BC,OAA5B,EAAqCC,QAArC,EAA6D;AAAA,KAAdC,SAAc,uEAAJ,EAAI;AACpFna,QAAOgQ,EAAEjT,IAAF,CAAOiD,IAAP,CAAP;AACAga,SAAQhK,EAAEjT,IAAF,CAAOid,KAAP,CAAR;AACAC,WAAU,GAAGna,MAAH,CAAUma,OAAV,CAAV;;AAEA,KAAI,CAACja,IAAL,EAAW;AACV,QAAM,IAAIxC,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAE,eAAU;AAAZ,GAAvD,CAAN;AACA;;AAEDkZ,SAAQ1d,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwB6J,iBAAxB,CAA0CJ,KAA1C,EAAiD;AAAEtJ,UAAQ;AAAErJ,aAAU;AAAZ;AAAV,EAAjD,CAAR;;AACA,KAAI,CAAC2S,KAAL,EAAY;AACX,QAAM,IAAIxc,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAE,eAAU;AAAZ,GAAvD,CAAN;AACA;;AAED,KAAIuZ,uBAAJ;;AACA,KAAI;AACHA,mBAAiB,IAAItK,MAAJ,OAAgBzT,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uBAAxB,CAAhB,OAAjB;AACA,EAFD,CAEE,OAAO8N,KAAP,EAAc;AACfsP,mBAAiB,IAAItK,MAAJ,CAAW,mBAAX,CAAjB;AACA;;AAED,KAAI,CAACsK,eAAe7b,IAAf,CAAoBwB,IAApB,CAAL,EAAgC;AAC/B,QAAM,IAAIxC,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAE,eAAU;AAAZ,GAAvD,CAAN;AACA;;AAED,KAAMc,MAAM,IAAI9D,IAAJ,EAAZ;;AACA,KAAI,CAACjB,EAAEgG,QAAF,CAAWoX,OAAX,EAAoBD,MAAM3S,QAA1B,CAAL,EAA0C;AACzC4S,UAAQtb,IAAR,CAAaqb,MAAM3S,QAAnB;AACA,EA5BmF,CA8BpF;;;AACA,KAAI6H,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBgL,aAAxB,CAAsCta,IAAtC,CAAX;;AACA,KAAIkP,IAAJ,EAAU;AACT,MAAIA,KAAKqL,QAAT,EAAmB;AAClB,SAAM,IAAI/c,OAAOsD,KAAX,CAAiB,+BAAjB,6CAA4Fd,IAA5F,EAAqG;AAAE,gBAAU,uBAAZ;AAAqC+H,eAAW/H;AAAhD,IAArG,CAAN;AACA,GAFD,MAEO;AACN,SAAM,IAAIxC,OAAOsD,KAAX,CAAiB,8BAAjB,4BAA0Ed,IAA1E,eAA2F;AAAE,gBAAU,uBAAZ;AAAqC+H,eAAW/H;AAAhD,IAA3F,CAAN;AACA;AACD;;AAED,KAAI2C,SAAS,GAAb,EAAkB;AACjBrG,aAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,qBAAzB,EAAgD2Y,KAAhD,EAAuD;AACtDtS,MAAG,GADmD;AAEtD1H,aAFsD;AAGtDnC,OAAI+D,GAHkD;AAItD0W,OAAI4B,aAAa,IAJqC;AAKtDM,WAAQN,aAAa,IALiC;AAMtDzJ,cAAWwJ,OAN2C;AAOtD7S,MAAG;AACFrJ,SAAKic,MAAMjc,GADT;AAEFsJ,cAAU2S,MAAM3S;AAFd;AAPmD,GAAvD;AAYA;;AAED8S,aAAYjc,OAAOuc,MAAP,CAAc,EAAd,EAAkBN,SAAlB,EAA6B;AACxCtc,MAAI+D,GADoC;AAExC0W,MAAI4B,aAAa,IAFuB;AAGxCM,UAAQN,aAAa;AAHmB,EAA7B,CAAZ;AAMAhL,QAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBoL,kCAAxB,CAA2D/X,IAA3D,EAAiE3C,IAAjE,EAAuEga,KAAvE,EAA8EC,OAA9E,EAAuFE,SAAvF,CAAP;;AAEA,sBAAuBF,OAAvB,kHAAgC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,MAArB5S,QAAqB;AAC/B,MAAMsT,SAASre,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwB6J,iBAAxB,CAA0C/S,QAA1C,EAAoD;AAAEqJ,WAAQ;AAAErJ,cAAU;AAAZ;AAAV,GAApD,CAAf;;AACA,MAAI,CAACsT,MAAL,EAAa;AACZ;AACA,GAJ8B,CAM/B;;;AACA,MAAIT,aAAa,IAAb,IAAqB,CAAC5d,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BmC,OAAO5c,GAAtC,EAA2C,eAA3C,CAA1B,EAAuF;AACtFzB,cAAWC,MAAX,CAAkB+S,KAAlB,CAAwBsL,oBAAxB,CAA6C1L,KAAKnR,GAAlD,EAAuDsJ,QAAvD;AACA;;AAED,MAAMwT,QAAQ;AAAEjC,SAAM;AAAR,GAAd;;AAEA,MAAIvR,aAAa2S,MAAM3S,QAAvB,EAAiC;AAChCwT,SAAMC,EAAN,GAAWlZ,GAAX;AACA;;AAEDtF,aAAWC,MAAX,CAAkB2T,aAAlB,CAAgCyI,qBAAhC,CAAsDzJ,IAAtD,EAA4DyL,MAA5D,EAAoEE,KAApE;AACA;;AAEDve,YAAWic,KAAX,CAAiBwC,YAAjB,CAA8Bf,MAAMjc,GAApC,EAAyC,CAAC,OAAD,CAAzC,EAAoDmR,KAAKnR,GAAzD;;AAEA,KAAI4E,SAAS,GAAb,EAAkB;AACjBnF,SAAO+E,KAAP,CAAa,YAAM;AAClBjG,cAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,oBAAzB,EAA+C2Y,KAA/C,EAAsD9K,IAAtD;AACA,GAFD;AAGA,EAJD,MAIO,IAAIvM,SAAS,GAAb,EAAkB;AACxBnF,SAAO+E,KAAP,CAAa,YAAM;AAClBjG,cAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,yBAAzB,EAAoD2Y,KAApD,EAA2D9K,IAA3D;AACA,GAFD;AAGA;;AAED,QAAO;AACNM,OAAKN,KAAKnR;AADJ,EAAP;AAGA,CAlGD,4H;;;;;;;;;;;ACDA,wBACAzB,WAAW0e,aAAX,GAA2B,UAASjU,OAAT,EAAkBqB,IAAlB,EAAwB;AAClD,KAAM6S,cAAc3e,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,qBAAxB,CAApB;AACA,KAAMie,oBAAoB5e,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,CAA1B;AACA,KAAIke,mBAAJ;;AAEA,KAAIF,WAAJ,EAAiB;AAChB,MAAIC,iBAAJ,EAAuB;AACtB5e,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2BqC,yBAA3B,CAAqDrU,QAAQhJ,GAA7D;AACA,GAFD,MAEO;AACNzB,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2BsC,aAA3B,CAAyCtU,QAAQhJ,GAAjD,EAAsD,IAAtD;AACA;;AAED,MAAIgJ,QAAQuU,IAAR,IAAgBvU,QAAQuU,IAAR,CAAavd,GAAjC,EAAsC;AACrCzB,cAAWC,MAAX,CAAkBgf,OAAlB,CAA0BC,MAA1B,CAAiCzU,QAAQuU,IAAR,CAAavd,GAA9C,EAAmD;AAAE0d,UAAM;AAAEC,cAAS;AAAX;AAAR,IAAnD;AACA;AACD,EAVD,MAUO;AACN,MAAI,CAACR,iBAAL,EAAwB;AACvBC,gBAAa7e,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2BtF,WAA3B,CAAuC1M,QAAQhJ,GAA/C,CAAb;AACAzB,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2B4C,UAA3B,CAAsC5U,QAAQhJ,GAA9C;AACA;;AAED,MAAIgJ,QAAQuU,IAAR,IAAgBvU,QAAQuU,IAAR,CAAavd,GAAjC,EAAsC;AACrC6d,cAAWC,MAAX,CAAkB9U,QAAQuU,IAAR,CAAavd,GAA/B;AACA;;AAEDP,SAAO+E,KAAP,CAAa,YAAW;AACvBjG,cAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,oBAAzB,EAA+C8Z,UAA/C;AACA,GAFD;AAGA;;AAED,KAAID,iBAAJ,EAAuB;AACtB5e,aAAWC,MAAX,CAAkBwc,QAAlB,CAA2B+C,uBAA3B,CAAmD/U,QAAQhJ,GAA3D,EAAgEqK,IAAhE;AACA,EAFD,MAEO;AACN9L,aAAW6Y,aAAX,CAAyB4G,UAAzB,CAAoChV,QAAQyI,GAA5C,EAAiD,eAAjD,EAAkE;AAAEzR,QAAKgJ,QAAQhJ;AAAf,GAAlE;AACA;AACD,CAnCD,2H;;;;;;;;;;;ACDA,wBACAzB,WAAW0f,UAAX,GAAwB,UAAS7V,MAAT,EAAiB;AACxC,KAAMiC,OAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCtN,MAApC,CAAb;AAEA7J,YAAWC,MAAX,CAAkBwc,QAAlB,CAA2BkD,cAA3B,CAA0C9V,MAA1C,EAHwC,CAGW;;AACnD7J,YAAWC,MAAX,CAAkB2T,aAAlB,CAAgCgM,YAAhC,CAA6C/V,MAA7C,EAAqD/H,OAArD,CAA6D,UAACgW,YAAD,EAAkB;AAC9E,MAAMlF,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCW,aAAa5E,GAAjD,CAAb;;AACA,MAAIN,IAAJ,EAAU;AACT,OAAIA,KAAKxH,CAAL,KAAW,GAAX,IAAkBwH,KAAKuB,SAAL,CAAelP,MAAf,KAA0B,CAAhD,EAAmD;AAClDjF,eAAWC,MAAX,CAAkB+S,KAAlB,CAAwBqM,UAAxB,CAAmCvH,aAAa5E,GAAhD,EADkD,CACI;AACtD;;AACD,OAAIN,KAAKxH,CAAL,KAAW,GAAf,EAAoB;AACnBpL,eAAWC,MAAX,CAAkB2T,aAAlB,CAAgCiM,cAAhC,CAA+C/H,aAAa5E,GAA5D;AACAlT,eAAWC,MAAX,CAAkBwc,QAAlB,CAA2BoD,cAA3B,CAA0C/H,aAAa5E,GAAvD;AACA;AACD;AACD,EAXD;AAaAlT,YAAWC,MAAX,CAAkB2T,aAAlB,CAAgC+L,cAAhC,CAA+C9V,MAA/C,EAjBwC,CAiBgB;;AACxD7J,YAAWC,MAAX,CAAkB+S,KAAlB,CAAwB8M,8BAAxB,CAAuD,GAAvD,EAA4DhU,KAAKf,QAAjE,EAlBwC,CAkBoC;;AAC5E/K,YAAWC,MAAX,CAAkB+S,KAAlB,CAAwB+M,qBAAxB,CAA8CjU,KAAKf,QAAnD,EAnBwC,CAmBsB;AAE9D;;AACA,KAAIe,KAAKkU,YAAL,KAAsB,QAAtB,IAAkClU,KAAKkU,YAAL,KAAsB,KAA5D,EAAmE;AAClEC,+BAA6BC,UAA7B,CAAwCC,mBAAuBrU,KAAKf,QAA5B,UAAxC;AACA;;AAED/K,YAAWC,MAAX,CAAkBmgB,YAAlB,CAA+BC,eAA/B,CAA+CxW,MAA/C,EA1BwC,CA0BgB;;AAExD7J,YAAWC,MAAX,CAAkBgU,KAAlB,CAAwBoL,UAAxB,CAAmCxV,MAAnC,EA5BwC,CA4BI;AAC5C,CA7BD,2H;;;;;;;;;;;ACDA,wBACA7J,WAAWsgB,eAAX,GAA6B,gBAAkC;AAAA,KAAxBzW,MAAwB,QAAxBA,MAAwB;AAAA,KAAhBnD,MAAgB,QAAhBA,MAAgB;AAAA,KAAR6Z,KAAQ,QAARA,KAAQ;AAC9D,KAAInM,SAAS;AACZ1Q,QAAM,CADM;AAEZqH,YAAU,CAFE;AAGZiP,UAAQ,CAHI;AAIZwG,aAAW,CAJC;AAKZna,QAAM,CALM;AAMZmT,UAAQ;AANI,EAAb;;AASA,KAAIxZ,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BrS,MAA/B,EAAuC,2BAAvC,CAAJ,EAAyE;AACxEuK,WAAS7T,EAAEkgB,MAAF,CAASrM,MAAT,EAAiB;AACzByC,WAAQ,CADiB;AAEzB6J,UAAO,CAFkB;AAGzB/H,qBAAkB,CAHO;AAIzBgI,cAAW,CAJc;AAKzBC,cAAW,CALc;AAMzBC,aAAU,CANe;AAOzBC,0BAAuB,CAPE;AAQzBC,gCAA6B,CARJ;AASzBC,UAAO,CATkB;AAUzBC,iBAAc;AAVW,GAAjB,CAAT;AAYA,EAbD,MAaO,IAAIV,UAAU,CAAd,EAAiB;AACvBA,UAAQ,CAAR;AACA;;AAED7Z,UAASgN,EAAEjT,IAAF,CAAOiG,MAAP,CAAT;;AAEA,KAAI,CAACA,MAAD,IAAW6Z,UAAU,CAAzB,EAA4B;AAC3B,SAAO7E,SAAP;AACA;;AAED,KAAMnS,UAAU;AACf6K,gBADe;AAEfmM,cAFe;AAGfW,QAAM;AAAEnW,aAAU;AAAZ;AAHS,EAAhB;;AAMA,KAAIrE,MAAJ,EAAY;AACX,MAAI6Z,UAAU,CAAd,EAAiB;AAChB,UAAOvgB,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkN,cAAxB,CAAuCza,MAAvC,EAA+C6C,OAA/C,CAAP;AACA,GAFD,MAEO;AACN,OAAM6X,YAAY,IAAI3N,MAAJ,CAAWC,EAAEC,YAAF,CAAejN,MAAf,CAAX,EAAmC,GAAnC,CAAlB;AACA,UAAO1G,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBoN,gCAAxB,CAAyDD,SAAzD,EAAoE7X,OAApE,CAAP;AACA;AACD;;AAED,QAAOvJ,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBvP,IAAxB,CAA6B,EAA7B,EAAiC6E,OAAjC,CAAP;AACA,CAjDD,2H;;;;;;;;;;;ACDA,wBACAvJ,WAAWshB,iCAAX;AAA+C,UAASC,kCAAT,OAAoJ;AAAA,MAAtGC,aAAsG,QAAtGA,aAAsG;AAAA,MAAvFC,QAAuF,QAAvFA,QAAuF;AAAA,uBAA7Epb,IAA6E;AAAA,MAA7EA,IAA6E,6BAAxE,EAAwE;AAAA,mCAApEqb,qBAAoE;AAAA,MAApEA,qBAAoE,yCAA9C,KAA8C;AAAA,8BAAvCC,WAAuC;AAAA,MAAvCA,WAAuC,oCAA3B,IAA2B;AAAA,+BAArBC,YAAqB;AAAA,MAArBA,YAAqB,qCAAR,IAAQ;AAClM,MAAIhP,aAAJ,CADkM,CAGlM;;AACA,MAAI6O,SAASI,UAAT,CAAoB,GAApB,CAAJ,EAA8B;AAC7BJ,cAAWA,SAASK,SAAT,CAAmB,CAAnB,CAAX;AACAlP,UAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwB+O,iBAAxB,CAA0CN,QAA1C,CAAP;AACA,GAHD,MAGO,IAAIA,SAASI,UAAT,CAAoB,GAApB,KAA4Bxb,SAAS,GAAzC,EAA8C;AACpD;AACAob,cAAWA,SAAS7a,OAAT,CAAiB,GAAjB,EAAsB,EAAtB,CAAX;AAEA,OAAIob,iBAAJ;;AACA,OAAIN,qBAAJ,EAA2B;AAC1BM,eAAWhiB,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCsK,QAApC,CAAX;AACA,IAFD,MAEO;AACNO,eAAWhiB,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwByE,OAAxB,CAAgC;AAC1CuJ,UAAK,CAAC;AAAExgB,WAAKggB;AAAP,MAAD,EAAoB;AAAE1W,gBAAU0W;AAAZ,MAApB;AADqC,KAAhC,CAAX;AAGA;;AAED,OAAMvO,MAAM3S,EAAE2hB,QAAF,CAAWF,QAAX,IAAuB,CAACR,aAAD,EAAgBQ,SAASvgB,GAAzB,EAA8Byf,IAA9B,GAAqCvL,IAArC,CAA0C,EAA1C,CAAvB,GAAuE8L,QAAnF;AACA7O,UAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAAP,CAdoD,CAgBpD;;AACA,OAAI,CAAC3S,EAAE2hB,QAAF,CAAWtP,IAAX,CAAL,EAAuB;AACtB;AACA;AACA,QAAI,CAACrS,EAAE2hB,QAAF,CAAWF,QAAX,CAAL,EAA2B;AAC1B,SAAIJ,YAAJ,EAAkB;AACjB,YAAM,IAAI1gB,OAAOsD,KAAX,CAAiB,iBAAjB,CAAN;AACA,MAFD,MAEO;AACN;AACA;AACD;;AAEDoO,WAAO1R,OAAOyY,SAAP,CAAiB6H,aAAjB,EAAgC,YAAW;AAAA,wBACnCtgB,OAAOqB,IAAP,CAAY,qBAAZ,EAAmCyf,SAASjX,QAA5C,CADmC;AAAA,SAC1CmI,GAD0C,gBAC1CA,GAD0C;;AAEjD,YAAOlT,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAAP;AACA,KAHM,CAAP;AAIA;AACD,GAjCM,MAiCA;AACN;AACAN,UAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwB+O,iBAAxB,CAA0CN,QAA1C,CAAP;AACA,GA3CiM,CA6ClM;;;AACA,MAAI,CAAC7O,IAAD,IAASgP,YAAb,EAA2B;AAC1B,SAAM,IAAI1gB,OAAOsD,KAAX,CAAiB,iBAAjB,CAAN;AACA,GAFD,MAEO,IAAI,CAACoO,IAAL,EAAW;AACjB;AACA,GAlDiM,CAoDlM;AACA;AACA;;;AACA,MAAIvM,QAAQuM,KAAKxH,CAAL,KAAW/E,IAAvB,EAA6B;AAC5B,OAAIub,YAAJ,EAAkB;AACjB,UAAM,IAAI1gB,OAAOsD,KAAX,CAAiB,iBAAjB,CAAN;AACA,IAFD,MAEO;AACN;AACA;AACD,GA7DiM,CA+DlM;AACA;;;AACA,MAAIoO,KAAKxH,CAAL,KAAW,GAAX,IAAkBuW,WAAtB,EAAmC;AAClC,OAAMlM,MAAMzV,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCwI,wBAAhC,CAAyDxJ,KAAKnR,GAA9D,EAAmE+f,aAAnE,CAAZ;;AAEA,OAAI,CAAC/L,GAAL,EAAU;AACTvU,WAAOyY,SAAP,CAAiB6H,aAAjB,EAAgC,YAAW;AAC1C,YAAOtgB,OAAOqB,IAAP,CAAY,UAAZ,EAAwBqQ,KAAKnR,GAA7B,CAAP;AACA,KAFD;AAGA;AACD;;AAED,SAAOmR,IAAP;AACA;;AA5ED,QAAwD2O,kCAAxD;AAAA,2H;;;;;;;;;;;ACDAvhB,WAAWmiB,kBAAX,GAAgC,UAASjP,GAAT,EAAcpH,IAAd,EAAoB;AACnD,KAAM8G,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAAb;;AAEA,KAAIN,IAAJ,EAAU;AACT5S,aAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,iBAAzB,EAA4C+G,IAA5C,EAAkD8G,IAAlD;AACA5S,aAAWC,MAAX,CAAkB+S,KAAlB,CAAwBoP,kBAAxB,CAA2ClP,GAA3C,EAAgDpH,KAAKf,QAArD;;AAEA,MAAI6H,KAAKuB,SAAL,CAAexN,OAAf,CAAuBmF,KAAKf,QAA5B,MAA0C,CAAC,CAA/C,EAAkD;AACjD,OAAMsX,cAAcvW,IAApB;AACA9L,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2B6F,gCAA3B,CAA4DpP,GAA5D,EAAiEmP,WAAjE;AACA;;AAED,MAAIzP,KAAKxH,CAAL,KAAW,GAAf,EAAoB;AACnBpL,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2B8F,8BAA3B,CAA0D,QAA1D,EAAoErP,GAApE,EAAyEpH,IAAzE;AACA;;AAED9L,aAAWC,MAAX,CAAkB2T,aAAlB,CAAgC4O,uBAAhC,CAAwDtP,GAAxD,EAA6DpH,KAAKrK,GAAlE;AAEAP,SAAO+E,KAAP,CAAa,YAAW;AACvBjG,cAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,gBAAzB,EAA2C+G,IAA3C,EAAiD8G,IAAjD;AACA,GAFD;AAGA;AACD,CAtBD,2H;;;;;;;;;;;ACAA,sBACA5S,WAAWyiB,QAAX,GAAsB,UAAS5Y,MAAT,EAAiB6Y,QAAjB,EAA2B;AAChD,KAAM5W,OAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCtN,MAApC,CAAb;;AACA,KAAM8Y,gBAAgBpiB,EAAEqZ,KAAF,CAAQ5Z,WAAWic,KAAX,CAAiB2G,QAAjB,EAAR,EAAqC,KAArC,CAAtB;;AAEA,KAAIF,SAASjhB,GAAT,IAAgBoI,WAAW6Y,SAASjhB,GAApC,IAA2C,CAACzB,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BrS,MAA/B,EAAuC,sBAAvC,CAAhD,EAAgH;AAC/G,QAAM,IAAI3I,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,6BAA7C,EAA4E;AAAEsF,WAAQ,oBAAV;AAAgC3B,WAAQ;AAAxC,GAA5E,CAAN;AACA;;AAED,KAAI,CAACua,SAASjhB,GAAV,IAAiB,CAACzB,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BrS,MAA/B,EAAuC,aAAvC,CAAtB,EAA6E;AAC5E,QAAM,IAAI3I,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,4BAA7C,EAA2E;AAAEsF,WAAQ,oBAAV;AAAgC3B,WAAQ;AAAxC,GAA3E,CAAN;AACA;;AAED,KAAIua,SAAS1B,KAAT,IAAkBzgB,EAAE8Y,UAAF,CAAaqJ,SAAS1B,KAAtB,EAA6B2B,aAA7B,EAA4C1d,MAA5C,GAAqD,CAA3E,EAA8E;AAC7E,QAAM,IAAI/D,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,2CAA7C,EAA0F;AAAEsF,WAAQ,oBAAV;AAAgC3B,WAAQ;AAAxC,GAA1F,CAAN;AACA;;AAED,KAAIua,SAAS1B,KAAT,IAAkBzgB,EAAEoG,OAAF,CAAU+b,SAAS1B,KAAnB,EAA0B,OAA1B,KAAsC,CAAxD,IAA6D,CAAChhB,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BrS,MAA/B,EAAuC,mBAAvC,CAAlE,EAA+H;AAC9H,QAAM,IAAI3I,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,gCAA7C,EAA+E;AAAEsF,WAAQ,oBAAV;AAAgC3B,WAAQ;AAAxC,GAA/E,CAAN;AACA;;AAED,KAAI,CAACua,SAASjhB,GAAV,IAAiB,CAACiS,EAAEjT,IAAF,CAAOiiB,SAAShf,IAAhB,CAAtB,EAA6C;AAC5C,QAAM,IAAIxC,OAAOsD,KAAX,CAAiB,6BAAjB,EAAgD,4BAAhD,EAA8E;AAAEsF,WAAQ,oBAAV;AAAgC+Y,UAAO;AAAvC,GAA9E,CAAN;AACA;;AAED,KAAI,CAACH,SAASjhB,GAAV,IAAiB,CAACiS,EAAEjT,IAAF,CAAOiiB,SAAS3X,QAAhB,CAAtB,EAAiD;AAChD,QAAM,IAAI7J,OAAOsD,KAAX,CAAiB,6BAAjB,EAAgD,gCAAhD,EAAkF;AAAEsF,WAAQ,oBAAV;AAAgC+Y,UAAO;AAAvC,GAAlF,CAAN;AACA;;AAED,KAAI9E,uBAAJ;;AAEA,KAAI;AACHA,mBAAiB,IAAItK,MAAJ,OAAgBzT,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uBAAxB,CAAhB,OAAjB;AACA,EAFD,CAEE,OAAOwa,CAAP,EAAU;AACX4C,mBAAiB,IAAItK,MAAJ,CAAW,mBAAX,CAAjB;AACA;;AAED,KAAIiP,SAAS3X,QAAT,IAAqB,CAACgT,eAAe7b,IAAf,CAAoBwgB,SAAS3X,QAA7B,CAA1B,EAAkE;AACjE,QAAM,IAAI7J,OAAOsD,KAAX,CAAiB,kCAAjB,EAAyDjE,EAAEuiB,MAAF,CAASJ,SAAS3X,QAAlB,CAAzD,+BAAiH;AAAEjB,WAAQ,oBAAV;AAAgCiZ,UAAOL,SAAS3X,QAAhD;AAA0D8X,UAAO;AAAjE,GAAjH,CAAN;AACA;;AAED,KAAI,CAACH,SAASjhB,GAAV,IAAiB,CAACihB,SAASvb,QAA/B,EAAyC;AACxC,QAAM,IAAIjG,OAAOsD,KAAX,CAAiB,6BAAjB,EAAgD,gCAAhD,EAAkF;AAAEsF,WAAQ,oBAAV;AAAgC+Y,UAAO;AAAvC,GAAlF,CAAN;AACA;;AAED,KAAI,CAACH,SAASjhB,GAAd,EAAmB;AAClB,MAAI,CAACzB,WAAWid,yBAAX,CAAqCyF,SAAS3X,QAA9C,CAAL,EAA8D;AAC7D,SAAM,IAAI7J,OAAOsD,KAAX,CAAiB,yBAAjB,EAAgDjE,EAAEuiB,MAAF,CAASJ,SAAS3X,QAAlB,CAAhD,4BAAqG;AAAEjB,YAAQ,oBAAV;AAAgC+Y,WAAOH,SAAS3X;AAAhD,IAArG,CAAN;AACA;;AAED,MAAI2X,SAASxb,KAAT,IAAkB,CAAClH,WAAWwd,sBAAX,CAAkCkF,SAASxb,KAA3C,CAAvB,EAA0E;AACzE,SAAM,IAAIhG,OAAOsD,KAAX,CAAiB,yBAAjB,EAAgDjE,EAAEuiB,MAAF,CAASJ,SAASxb,KAAlB,CAAhD,4BAAkG;AAAE4C,YAAQ,oBAAV;AAAgC+Y,WAAOH,SAASxb;AAAhD,IAAlG,CAAN;AACA;;AAEDlH,aAAW4a,mBAAX,CAA+B8H,SAASxb,KAAxC,EATkB,CAWlB;;AACA,MAAM8b,aAAa;AAClBjY,aAAU2X,SAAS3X,QADD;AAElB5D,aAAUub,SAASvb,QAFD;AAGlB8b,wBAAqBP,SAASO;AAHZ,GAAnB;;AAKA,MAAIP,SAASxb,KAAb,EAAoB;AACnB8b,cAAW9b,KAAX,GAAmBwb,SAASxb,KAA5B;AACA;;AAED,MAAMzF,MAAMyhB,SAASF,UAAT,CAAoBA,UAApB,CAAZ;;AAEA,MAAMG,aAAa;AAClBhE,SAAM;AACLzb,UAAMgf,SAAShf,IADV;AAELsd,WAAO0B,SAAS1B,KAAT,IAAkB,CAAC,MAAD;AAFpB;AADY,GAAnB;;AAOA,MAAI0B,SAAS5B,qBAAb,EAAoC;AACnCqC,cAAWhE,IAAX,CAAgB2B,qBAAhB,GAAwC4B,SAAS5B,qBAAjD;AACA;;AAED,MAAI4B,SAAS5L,QAAb,EAAuB;AACtBqM,cAAWhE,IAAX,CAAgB,mBAAhB,IAAuC,IAAvC;AACA;;AAEDje,SAAOoc,KAAP,CAAa4B,MAAb,CAAoB;AAAEzd;AAAF,GAApB,EAA6B0hB,UAA7B;;AAEA,MAAIT,SAASU,gBAAb,EAA+B;AAC9B,OAAMpN,SAAShW,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgC5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,KAA2C,EAA3E,CAAf;AACA,OAAMsV,SAASjW,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgC5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,KAA2C,EAA3E,CAAf;AAEA,OAAIsW,gBAAJ;AACA,OAAIjM,aAAJ;;AAEA,OAAIhL,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,oCAAxB,CAAJ,EAAmE;AAClEsW,cAAUjX,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,gCAAxB,CAAV;AACAqK,WAAOhL,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,yBAAxB,CAAP;AACA,IAHD,MAGO;AACNsW,cAAUrM,QAAQC,EAAR,CAAW,wCAAX,EAAqD;AAAEwY,UAAKvX,KAAK3B,QAAL,IAAiBnK,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,UAAxB,CAAjB,IAAwD;AAA/D,KAArD,CAAV;AACAqK,WAAOJ,QAAQC,EAAR,CAAW,iCAAX,EAA8C;AAAEwY,UAAKvX,KAAK3B,QAAL,IAAiBnK,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,UAAxB,CAAjB,IAAwD;AAA/D,KAA9C,CAAP;AACA;;AAEDsW,aAAUjX,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgCqQ,OAAhC,CAAV;AACAjM,UAAOhL,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgCoE,IAAhC,EAAsC;AAC5CtH,UAAMgf,SAAShf,IAD6B;AAE5CwD,WAAOwb,SAASxb,KAF4B;AAG5CC,cAAUub,SAASvb;AAHyB,IAAtC,CAAP;AAMA,OAAMD,QAAQ;AACb6P,QAAI2L,SAASxb,KADA;AAEb4K,UAAM9R,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,YAAxB,CAFO;AAGbsW,oBAHa;AAIbjM,UAAMgL,SAAShL,IAAT,GAAgBiL;AAJT,IAAd;AAOA/U,UAAO+E,KAAP,CAAa,YAAW;AACvB,QAAI;AACHiR,WAAM5F,IAAN,CAAWpK,KAAX;AACA,KAFD,CAEE,OAAOuH,KAAP,EAAc;AACf,WAAM,IAAIvN,OAAOsD,KAAX,CAAiB,yBAAjB,mCAA4EiK,MAAMhE,OAAlF,EAA8F;AAAE,kBAAU,qBAAZ;AAAmCA,eAASgE,MAAMhE;AAAlD,MAA9F,CAAN;AACA;AACD,IAND;AAOA;;AAEDiY,WAASjhB,GAAT,GAAeA,GAAf;;AAEA,MAAIzB,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,MAAyD,IAAzD,IAAiE+hB,SAASxb,KAA9E,EAAqF;AACpF,OAAMoc,cAAcC,SAASC,QAAT,CAAkBd,SAASxb,KAA3B,EAAkC;AAAC,eAAS,KAAV;AAAiBuc,UAAM,GAAvB;AAA4BC,YAAQ;AAApC,IAAlC,CAApB;;AAEA,OAAI;AACH1jB,eAAW2jB,aAAX,CAAyBjB,QAAzB,EAAmCY,WAAnC,EAAgD,EAAhD,EAAoD,KAApD;AACA,IAFD,CAEE,OAAOnI,CAAP,EAAU,CACX;AACA;AACD;;AAED,SAAO1Z,GAAP;AACA,EA3FD,MA2FO;AACN;AACA,MAAIihB,SAAS3X,QAAb,EAAuB;AACtB/K,cAAW4jB,WAAX,CAAuBlB,SAASjhB,GAAhC,EAAqCihB,SAAS3X,QAA9C;AACA;;AAED,MAAI2X,SAAShf,IAAb,EAAmB;AAClB1D,cAAW6jB,WAAX,CAAuBnB,SAASjhB,GAAhC,EAAqCihB,SAAShf,IAA9C;AACA;;AAED,MAAIgf,SAASxb,KAAb,EAAoB;AACnBlH,cAAW8jB,QAAX,CAAoBpB,SAASjhB,GAA7B,EAAkCihB,SAASxb,KAA3C;AACA;;AAED,MAAIwb,SAASvb,QAAT,IAAqBub,SAASvb,QAAT,CAAkB1G,IAAlB,EAArB,IAAiDT,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BrS,MAA/B,EAAuC,0BAAvC,CAArD,EAAyH;AACxHqZ,YAASa,WAAT,CAAqBrB,SAASjhB,GAA9B,EAAmCihB,SAASvb,QAAT,CAAkB1G,IAAlB,EAAnC;AACA;;AAED,MAAM0iB,cAAa;AAClBhE,SAAM;AADY,GAAnB;;AAIA,MAAIuD,SAAS1B,KAAb,EAAoB;AACnBmC,eAAWhE,IAAX,CAAgB6B,KAAhB,GAAwB0B,SAAS1B,KAAjC;AACA;;AAED,MAAI0B,SAAS5B,qBAAb,EAAoC;AACnCqC,eAAWhE,IAAX,CAAgB2B,qBAAhB,GAAwC4B,SAAS5B,qBAAjD;AACA;;AAED,MAAI4B,SAAS5L,QAAb,EAAuB;AACtBqM,eAAWhE,IAAX,CAAgB,mBAAhB,IAAuCuD,SAAS5L,QAAhD;AACA;;AAED5V,SAAOoc,KAAP,CAAa4B,MAAb,CAAoB;AAAEzd,QAAKihB,SAASjhB;AAAhB,GAApB,EAA2C0hB,WAA3C;AAEA,SAAO,IAAP;AACA;AACD,CA7KD,4H;;;;;;;;;;;ACDAnjB,WAAWgkB,gBAAX,GAA8B,UAASna,MAAT,EAAiBoa,QAAjB,EAA2B;AACxD,KAAIvQ,EAAEjT,IAAF,CAAOT,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uBAAxB,CAAP,MAA6D,EAAjE,EAAqE;AACpE,MAAIujB,yBAAJ;;AACA,MAAI;AACHA,sBAAmBC,KAAKja,KAAL,CAAWlK,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uBAAxB,CAAX,CAAnB;AACA,GAFD,CAEE,OAAOwa,CAAP,EAAU;AACX,SAAM,IAAIja,OAAOsD,KAAX,CAAiB,gCAAjB,EAAmD,gCAAnD,CAAN;AACA;;AAED,MAAMyc,eAAe,EAArB;AAEArf,SAAOC,IAAP,CAAYqiB,gBAAZ,EAA8BpiB,OAA9B,CAAsC,UAACsiB,SAAD,EAAe;AACpD,OAAMvB,QAAQqB,iBAAiBE,SAAjB,CAAd;AAEAnD,gBAAamD,SAAb,IAA0BH,SAASG,SAAT,CAA1B;;AACA,OAAIvB,MAAMwB,QAAN,IAAkB,CAACJ,SAASG,SAAT,CAAvB,EAA4C;AAC3C,UAAM,IAAIljB,OAAOsD,KAAX,CAAiB,sCAAjB,aAAmE4f,SAAnE,mBAA6F;AAAEta,aAAQ;AAAV,KAA7F,CAAN;AACA;;AAED,OAAI+Y,MAAMxc,IAAN,KAAe,QAAf,IAA2Bwc,MAAMtZ,OAAN,CAAc5C,OAAd,CAAsBsd,SAASG,SAAT,CAAtB,MAA+C,CAAC,CAA/E,EAAkF;AACjF,UAAM,IAAIljB,OAAOsD,KAAX,CAAiB,sCAAjB,uBAA6E4f,SAA7E,kBAAsG;AAAEta,aAAQ;AAAV,KAAtG,CAAN;AACA;;AAED,OAAI+Y,MAAMyB,SAAN,IAAmBL,SAASG,SAAT,EAAoBnf,MAApB,GAA6B4d,MAAMyB,SAA1D,EAAqE;AACpE,UAAM,IAAIpjB,OAAOsD,KAAX,CAAiB,sCAAjB,2BAAiF4f,SAAjF,SAAgGvB,MAAMyB,SAAtG,EAAoH;AAAExa,aAAQ;AAAV,KAApH,CAAN;AACA;;AAED,OAAI+Y,MAAM0B,SAAN,IAAmBN,SAASG,SAAT,EAAoBnf,MAApB,GAA6B4d,MAAM0B,SAA1D,EAAqE;AACpE,UAAM,IAAIrjB,OAAOsD,KAAX,CAAiB,sCAAjB,2BAAiF4f,SAAjF,SAAgGvB,MAAM0B,SAAtG,EAAoH;AAAEza,aAAQ;AAAV,KAApH,CAAN;AACA;AACD,GAnBD,EAVoE,CA+BpE;;AACA9J,aAAWC,MAAX,CAAkBgU,KAAlB,CAAwBuQ,eAAxB,CAAwC3a,MAAxC,EAAgDoX,YAAhD;AAEArf,SAAOC,IAAP,CAAYof,YAAZ,EAA0Bnf,OAA1B,CAAkC,UAACsiB,SAAD,EAAe;AAChD,OAAI,CAACF,iBAAiBE,SAAjB,EAA4BK,iBAAjC,EAAoD;AACnD;AACA;;AAED,OAAMA,oBAAoBP,iBAAiBE,SAAjB,EAA4BK,iBAAtD;AACA,OAAMvF,SAAS,EAAf;;AACA,OAAIuF,kBAAkBC,KAAtB,EAA6B;AAC5BxF,WAAOyF,SAAP,GAAmB,EAAnB;AACAzF,WAAOyF,SAAP,CAAiBF,kBAAkB5B,KAAnC,IAA4C5B,aAAamD,SAAb,CAA5C;AACA,IAHD,MAGO;AACNlF,WAAOC,IAAP,GAAc,EAAd;AACAD,WAAOC,IAAP,CAAYsF,kBAAkB5B,KAA9B,IAAuC5B,aAAamD,SAAb,CAAvC;AACA;;AAEDpkB,cAAWC,MAAX,CAAkBgU,KAAlB,CAAwBiL,MAAxB,CAA+BrV,MAA/B,EAAuCqV,MAAvC;AACA,GAhBD;AAkBA,SAAO,IAAP;AACA;AACD,CAvDD,2H;;;;;;;;;;;;ACAAlf,WAAW4kB,WAAX,GAAyB,UAAC9Y,IAAD,EAAOrB,OAAP,EAAgBmI,IAAhB,EAAsBiS,MAAtB;AACxB,MAAApjB,GAAA,EAAAqjB,kBAAA,EAAAC,YAAA,EAAAC,IAAA;;ACCC,MAAIH,UAAU,IAAd,EAAoB;ADFyBA,aAAS,KAAT;ACI5C;;ADHF,MAAG,CAAI/Y,IAAJ,IAAY,CAAIrB,OAAhB,IAA2B,CAAImI,KAAKnR,GAAvC;AACC,WAAO,KAAP;ACKC;;ADHF,MAAOgJ,QAAAlJ,EAAA,QAAP;AACCkJ,YAAQlJ,EAAR,GAAiB,IAAAC,IAAA,EAAjB;ACKC;;ADHFiJ,UAAQK,CAAR,GAAYvK,EAAE0kB,IAAF,CAAOnZ,IAAP,EAAa,CAAC,KAAD,EAAO,UAAP,CAAb,CAAZ;;AAEA,MAAG,CAAIoZ,MAAMhjB,IAAN,CAAWuI,QAAQT,GAAnB,EAAwBjE,MAAxB,CAAP;AACC0E,YAAQT,GAAR,GAAc,EAAd;ACIC;;ADFFS,UAAQyI,GAAR,GAAcN,KAAKnR,GAAnB;;AAEA,MAAOmR,KAAAuB,SAAA,YAAmBvB,KAAKuB,SAAL,CAAelP,MAAf,KAAyB,CAAnD;AACC8f,mBAAe/kB,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCvE,KAAKnR,GAAzC,CAAf;;AACA,QAAGsjB,gBAAA,IAAH;AACCnS,aAAOmS,YAAP;AADD;AAGCnS,WAAKuB,SAAL,GAAiB,EAAjB;AALF;ACSE;;ADFF,MAAG1J,QAAQ0a,SAAR,KAAuB,KAA1B;AACC,QAAGH,OAAOva,QAAQT,GAAR,CAAYpE,KAAZ,CAAkB,8IAAlB,CAAV;AACC6E,cAAQua,IAAR,GAAeA,KAAKniB,GAAL,CAAS,UAAC+O,GAAD;ACInB,eDJ4B;AAAAA,eAAKA;AAAL,SCI5B;ADJU,QAAf;AAFF;ACWE;;ADPFnH,YAAUzK,WAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,mBAAzB,EAA8C0F,OAA9C,CAAV;AAGAqa,uBAAqB,IAArB;;AACA,MAAGra,QAAQqa,kBAAX;AACCA,yBAAqBra,QAAQqa,kBAA7B;AACA,WAAOra,QAAQqa,kBAAf;ACOC;;ADLF,MAAGra,QAAAhJ,GAAA,YAAiBojB,MAApB;AACCpjB,UAAMgJ,QAAQhJ,GAAd;AACA,WAAOgJ,QAAQhJ,GAAf;AACAzB,eAAWC,MAAX,CAAkBwc,QAAlB,CAA2BoI,MAA3B,CAAkC;AAACpjB,WAAKA,GAAN;AAAW,eAASgJ,QAAQK,CAAR,CAAUrJ;AAA9B,KAAlC,EAAsEgJ,OAAtE;AACAA,YAAQhJ,GAAR,GAAcA,GAAd;AAJD;AAMCgJ,YAAQhJ,GAAR,GAAczB,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2B2I,MAA3B,CAAkC3a,OAAlC,CAAd;ACUC,GDjDsB,CAyCxB;;;;AAGAvJ,SAAO+E,KAAP,CAAa;AAEZwE,YAAQqa,kBAAR,GAA6BA,kBAA7B;ACUE,WDTF9kB,WAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,kBAAzB,EAA6C0F,OAA7C,EAAsDmI,IAAtD,CCSE;ADZH;AAKA,SAAOnI,OAAP;AAjDwB,CAAzB,0H;;;;;;;;;;;;AEAA,IAAA4a,eAAA,EAAAC,cAAA,EAAAC,GAAA,EAAAC,IAAA;AAAAH,kBAAkB,EAAlB;;ACIA,IAAI,CAACE,MAAMhZ,QAAQC,GAAR,CAAYiZ,gBAAnB,KAAwC,IAA5C,EAAkD;AAChDF,MDJ4B5f,KCI5B,CDJkC,GCIlC,EDJuC7D,OCIvC,CDJ+C,UAAC4jB,SAAD;ACK7C,WDJHL,gBAAgBK,SAAhB,IAA6B,CCI1B;ADLJ,GCIE;AAGD;;ADJDJ,iBAAiB,EAAjB;;ACQA,IAAI,CAACE,OAAOjZ,QAAQC,GAAR,CAAYmZ,eAApB,KAAwC,IAA5C,EAAkD;AAChDH,ODR2B7f,KCQ3B,CDRiC,GCQjC,EDRsC7D,OCQtC,CDR8C,UAAC4jB,SAAD;ACS5C,WDRHJ,eAAeI,SAAf,IAA4B,CCQzB;ADTJ,GCQE;AAGD;;ADRD1lB,WAAWU,QAAX,CAAoBklB,OAApB,GAA8B,EAA9B,C,CAEA;;;;;;;AAMA5lB,WAAWU,QAAX,CAAoByD,GAApB,GAA0B,UAAC1C,GAAD,EAAMM,KAAN,EAAawH,OAAb;AAGzB,MAAAsc,IAAA,EAAAC,eAAA,EAAApiB,IAAA,EAAAwO,KAAA,EAAA6T,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,gBAAA;;ACWC,MAAI5c,WAAW,IAAf,EAAqB;ADdgBA,cAAU,EAAV;ACgBpC;;ADbF,MAAG,CAAI9H,GAAJ,IACEM,SAAA,QAAe,QAAAwK,OAAA,oBAAAA,YAAA,QAAAwZ,OAAAxZ,QAAAC,GAAA,YAAAuZ,KAAA,uBAAAtkB,GAAA,4BADpB;AAEE,WAAO,KAAP;ACcA;;AACD,MAAI,CAACokB,OAAO7lB,WAAWU,QAAX,CAAoBklB,OAA5B,EAAqCliB,OAAO6F,QAAQ6c,KAApD,KAA8D,IAAlE,EAAwE;AACtEP,SAAKniB,IAAL,IDd2C,CCc3C;AACD;;ADbF6F,UAAQ8c,YAAR,GAAuBtkB,KAAvB;AACAwH,UAAQ+c,WAAR,GAAsB,cAAtB;AACA/c,UAAQgd,MAAR,GAAiB,KAAjB;AACAhd,UAAQid,OAAR,GAAkBjd,QAAQid,OAAR,IAAmB,KAArC;;ACeC,MAAIjd,QAAQkd,MAAR,IAAkB,IAAtB,EAA4B;ADd7Bld,YAAQkd,MAAR,GAAkBzmB,WAAWU,QAAX,CAAoBklB,OAApB,CAA4Brc,QAAQ6c,KAApC,GAAlB;ACgBE;;ADdF,MAAG7c,QAAAmd,WAAA,QAAH;AACCnd,YAAQmd,WAAR,GAAsBvC,KAAKwC,SAAL,CAAepd,QAAQmd,WAAvB,CAAtB;ACgBC;;ADdF,MAAGnd,QAAAqd,gBAAA,QAAH;AACCrd,YAAQqd,gBAAR,GAA2BzC,KAAKwC,SAAL,CAAepd,QAAQqd,gBAAvB,CAA3B;ACgBC;;ADdF,MAAG,QAAAra,OAAA,oBAAAA,YAAA,QAAAyZ,OAAAzZ,QAAAC,GAAA,YAAAwZ,KAAAvkB,GAAA,4BAAH;AACCM,YAAQwK,QAAQC,GAAR,CAAY/K,GAAZ,CAAR;;AACA,QAAGM,MAAM8kB,WAAN,OAAuB,MAA1B;AACC9kB,cAAQ,IAAR;AADD,WAEK,IAAGA,MAAM8kB,WAAN,OAAuB,OAA1B;AACJ9kB,cAAQ,KAAR;ACgBE;;ADfHwH,YAAQud,eAAR,GAA0B/kB,KAA1B;AACAwH,YAAQ+c,WAAR,GAAsB,iBAAtB;AAPD,SASK,IAAG,EAAAL,OAAA/kB,OAAAR,QAAA,YAAAulB,KAAAxkB,GAAA,mBAAH;AACJM,YAAQb,OAAOR,QAAP,CAAgBe,GAAhB,CAAR;AACA8H,YAAQwd,mBAAR,GAA8BhlB,KAA9B;AACAwH,YAAQ+c,WAAR,GAAsB,qBAAtB;ACgBC;;ADdF,MAAO/c,QAAAyd,SAAA,QAAP;AACCzd,YAAQyd,SAAR,GAAoBvlB,GAApB;ACgBC;;ADbF,MAAO8H,QAAA0d,eAAA,QAAP;AACC1d,YAAQ0d,eAAR,GAA6BxlB,MAAI,cAAjC;ACeC;;ADbF,MAAG4jB,gBAAA5jB,GAAA,SAAH;AACC8H,YAAQid,OAAR,GAAkB,IAAlB;ACeC;;ADbF,MAAGlB,eAAA7jB,GAAA,SAAH;AACC8H,YAAQgd,MAAR,GAAiB,IAAjB;ACeC;;ADbF,MAAG,QAAAha,OAAA,oBAAAA,YAAA,QAAA2Z,OAAA3Z,QAAAC,GAAA,YAAA0Z,KAAA,uBAAAzkB,GAAA,4BAAH;AACCM,YAAQwK,QAAQC,GAAR,CAAY,uBAAuB/K,GAAnC,CAAR;;AACA,QAAGM,MAAM8kB,WAAN,OAAuB,MAA1B;AACC9kB,cAAQ,IAAR;AADD,WAEK,IAAGA,MAAM8kB,WAAN,OAAuB,OAA1B;AACJ9kB,cAAQ,KAAR;ACeE;;ADdHwH,YAAQxH,KAAR,GAAgBA,KAAhB;AACAwH,YAAQud,eAAR,GAA0B/kB,KAA1B;AACAwH,YAAQ+c,WAAR,GAAsB,iBAAtB;ACgBC;;ADdFH,qBACC;AAAAhH,UAAM5V,OAAN;AACA2d,kBACC;AAAAvG,iBAAW,IAAInf,IAAJ;AAAX;AAFD,GADD;;AAKA,MAAG+H,QAAA5G,MAAA,QAAH;AACCwjB,qBAAiBe,YAAjB,CAA8BvkB,MAA9B,GAAuC4G,QAAQ5G,MAA/C;AACA,WAAO4G,QAAQ5G,MAAf;ACiBC;;ADfF,MAAO4G,QAAAxH,KAAA,QAAP;AACC,QAAGwH,QAAQ4d,KAAR,KAAiB,IAApB;AACChB,uBAAiBhH,IAAjB,CAAsBpd,KAAtB,GAA8BwH,QAAQ8c,YAAtC;AADD;AAGCF,uBAAiBe,YAAjB,CAA8BnlB,KAA9B,GAAsCA,KAAtC;AAJF;ACsBE;;ADhBFmQ,UAAQ3R,EAAEkgB,MAAF,CAAS;AAAEhf,SAAKA;AAAP,GAAT,EAAuB0kB,iBAAiBhH,IAAxC,CAAR;;AAEA,MAAO5V,QAAA6d,OAAA,QAAP;AACCjB,qBAAiBkB,MAAjB,GAA0B;AAAED,eAAS;AAAX,KAA1B;AACAlV,UAAMkV,OAAN,GAAgB;AAAEE,eAAS;AAAX,KAAhB;ACuBC;;ADrBFxB,oBAAkB9lB,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BC,EAA3B,CAA8B9O,OAA9B,CAAsCxG,KAAtC,CAAlB;;AAEA,MAAG4T,mBAAA,IAAH;AACC,QAAOA,gBAAAnjB,MAAA,YAA4BwjB,iBAAAe,YAAA,CAAAvkB,MAAA,QAAnC;AACCwjB,uBAAiBhH,IAAjB,CAAsBxc,MAAtB,GAA+BwjB,iBAAiBe,YAAjB,CAA8BvkB,MAA7D;AACA,aAAOwjB,iBAAiBe,YAAjB,CAA8BvkB,MAArC;AAHF;AAAA;AAKCwjB,qBAAiBhH,IAAjB,CAAsB5d,EAAtB,GAA2B,IAAIC,IAAJ,EAA3B;ACuBC;;ADrBF,SAAOxB,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2B1C,MAA3B,CAAkC;AAAEpjB,SAAKA;AAAP,GAAlC,EAAgD0kB,gBAAhD,CAAP;AAxFyB,CAA1B,C,CA4FA;;;;;AAIAnmB,WAAWU,QAAX,CAAoB+mB,QAApB,GAA+B,UAAChmB,GAAD,EAAM8H,OAAN,EAAoB5E,EAApB;AC0B7B,MAAI4E,WAAW,IAAf,EAAqB;AD1BcA,cAAU,EAAV;AC4BlC;;ADzBF,MAAG,CAAI9H,GAAP;AACC,WAAO,KAAP;AC2BC;;ADzBF,MAAGlB,EAAEmnB,UAAF,CAAane,OAAb,CAAH;AACC5E,SAAK4E,OAAL;AACAA,cAAU,EAAV;AC2BC;;ADzBF,MAAOA,QAAAyd,SAAA,QAAP;AACCzd,YAAQyd,SAAR,GAAoBvlB,GAApB;AC2BC;;ADzBF,MAAO8H,QAAA0d,eAAA,QAAP;AACC1d,YAAQ0d,eAAR,GAA6BxlB,MAAI,cAAjC;AC2BC;;ADzBF8H,UAAQhI,EAAR,GAAa,IAAIC,IAAJ,EAAb;AACA+H,UAAQid,OAAR,GAAkB,KAAlB;AACAjd,UAAQgd,MAAR,GAAiB,KAAjB;;AAEA,MAAGlB,gBAAA5jB,GAAA,SAAH;AACC8H,YAAQid,OAAR,GAAkB,IAAlB;AC0BC;;ADxBF,MAAGlB,eAAA7jB,GAAA,SAAH;AACC8H,YAAQgd,MAAR,GAAiB,IAAjB;AC0BC;;ADxBFvmB,aAAWC,MAAX,CAAkBsnB,QAAlB,CAA2B1C,MAA3B,CAAkC;AAAEpjB,SAAKA;AAAP,GAAlC,EACC;AAAA0d,UAAM5V,OAAN;AACA2d,kBACC;AAAA7gB,YAAM,OAAN;AACAsa,iBAAW,IAAInf,IAAJ;AADX;AAFD,GADD;;AAMA,MAAGmD,MAAA,IAAH;AACCA,OAAGpC,IAAH,CACC;AAAA4B,WAAK,UAACE,EAAD,EAAKtC,KAAL,EAAYwH,OAAZ;AC6BA,YAAIA,WAAW,IAAf,EAAqB;AD7BTA,oBAAU,EAAV;AC+BX;;AD9BLA,gBAAQ6c,KAAR,GAAgB3kB,GAAhB;ACgCI,eD/BJzB,WAAWU,QAAX,CAAoByD,GAApB,CAAwBE,EAAxB,EAA4BtC,KAA5B,EAAmCwH,OAAnC,CC+BI;ADjCL;AAIA6d,eAAS,UAACA,OAAD,EAAUziB,EAAV;ACgCJ,eD/BJA,GAAGpC,IAAH,CACC;AAAA4B,eAAK,UAACE,EAAD,EAAKtC,KAAL,EAAYwH,OAAZ;ACgCE,gBAAIA,WAAW,IAAf,EAAqB;ADhCXA,wBAAU,EAAV;ACkCT;;ADjCPA,oBAAQ6c,KAAR,GAAgB3kB,GAAhB;AACA8H,oBAAQ6d,OAAR,GAAkBA,OAAlB;ACmCM,mBDlCNpnB,WAAWU,QAAX,CAAoByD,GAApB,CAAwBE,EAAxB,EAA4BtC,KAA5B,EAAmCwH,OAAnC,CCkCM;ADrCP;AAAA,SADD,CC+BI;ADpCL;AAAA,KADD;ACiDC;ADlF4B,CAA/B,C,CAgDA;;;;;AAIAvJ,WAAWU,QAAX,CAAoB2e,UAApB,GAAiC,UAAC5d,GAAD;AAGhC,MAAG,CAAIA,GAAP;AACC,WAAO,KAAP;ACsCC;;ADpCF,SAAOzB,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BlI,UAA3B,CAAsC5d,GAAtC,CAAP;AANgC,CAAjC,C,CASA;;;;;AAIAzB,WAAWU,QAAX,CAAoBinB,UAApB,GAAiC,UAAClmB,GAAD,EAAMM,KAAN,EAAaY,MAAb;AAGhC,MAAG,CAAIlB,GAAJ,IAAeM,SAAA,IAAlB;AACC,WAAO,KAAP;ACsCC;;ADpCF,MAAGY,UAAA,IAAH;AACC,WAAO3C,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BK,wBAA3B,CAAoDnmB,GAApD,EAAyDM,KAAzD,EAAgEY,MAAhE,CAAP;ACsCC;;ADpCF,SAAO3C,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BM,eAA3B,CAA2CpmB,GAA3C,EAAgDM,KAAhD,CAAP;AATgC,CAAjC,C,CAYA;;;;;AAIA/B,WAAWU,QAAX,CAAoBonB,iBAApB,GAAwC,UAACrmB,GAAD,EAAM8H,OAAN;AAGvC,MAAG,CAAI9H,GAAJ,IAAe8H,WAAA,IAAlB;AACC,WAAO,KAAP;ACsCC;;ADpCF,SAAOvJ,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BO,iBAA3B,CAA6CrmB,GAA7C,EAAkD8H,OAAlD,CAAP;AANuC,CAAxC,C,CASA;;;;;AAIAvJ,WAAWU,QAAX,CAAoBqnB,SAApB,GAAgC,UAACtmB,GAAD;AAG/B,MAAOA,OAAA,IAAP;AACC,WAAO,KAAP;ACsCC;;ADpCF,SAAOzB,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BM,eAA3B,CAA2CpmB,GAA3C,EAAgD,MAAhD,CAAP;AAN+B,CAAhC,C,CASA;;;;AAGAzB,WAAWU,QAAX,CAAoBsnB,IAApB,GAA2B;AAC1B,MAAA3Y,EAAA,EAAA+B,CAAA,EAAAgM,GAAA,EAAA2I,IAAA,EAAAkC,OAAA;AAAAjoB,aAAWU,QAAX,CAAoByC,WAApB,GAAkC,IAAlC;AACAnD,aAAWC,MAAX,CAAkBsnB,QAAlB,CAA2B7iB,IAA3B,GAAkCwjB,OAAlC,CACC;AAAAC,WAAO,UAACC,MAAD;AACNlnB,aAAOR,QAAP,CAAgB0nB,OAAO3mB,GAAvB,IAA8B2mB,OAAOrmB,KAArC;;AACA,UAAGqmB,OAAO5b,GAAP,KAAc,IAAjB;AACCD,gBAAQC,GAAR,CAAY4b,OAAO3mB,GAAnB,IAA0B2mB,OAAOrmB,KAAjC;ACyCG;;AACD,aDzCH/B,WAAWU,QAAX,CAAoBwC,IAApB,CAAyBklB,OAAO3mB,GAAhC,EAAqC2mB,OAAOrmB,KAA5C,EAAmD/B,WAAWU,QAAX,CAAoByC,WAAvE,CCyCG;AD7CJ;AAKAklB,aAAS,UAACD,MAAD;AACRlnB,aAAOR,QAAP,CAAgB0nB,OAAO3mB,GAAvB,IAA8B2mB,OAAOrmB,KAArC;;AACA,UAAGqmB,OAAO5b,GAAP,KAAc,IAAjB;AACCD,gBAAQC,GAAR,CAAY4b,OAAO3mB,GAAnB,IAA0B2mB,OAAOrmB,KAAjC;AC2CG;;AACD,aD3CH/B,WAAWU,QAAX,CAAoBwC,IAApB,CAAyBklB,OAAO3mB,GAAhC,EAAqC2mB,OAAOrmB,KAA5C,EAAmD/B,WAAWU,QAAX,CAAoByC,WAAvE,CC2CG;ADpDJ;AAUAmlB,aAAS,UAACF,MAAD;AACR,aAAOlnB,OAAOR,QAAP,CAAgB0nB,OAAO3mB,GAAvB,CAAP;;AACA,UAAG2mB,OAAO5b,GAAP,KAAc,IAAjB;AACC,eAAOD,QAAQC,GAAR,CAAY4b,OAAO3mB,GAAnB,CAAP;AC6CG;;AACD,aD7CHzB,WAAWU,QAAX,CAAoBwC,IAApB,CAAyBklB,OAAO3mB,GAAhC,EAAqC,MAArC,EAAgDzB,WAAWU,QAAX,CAAoByC,WAApE,CC6CG;AD3DJ;AAAA,GADD;AAgBAnD,aAAWU,QAAX,CAAoByC,WAApB,GAAkC,KAAlC;AAEA4iB,SAAA/lB,WAAAU,QAAA,CAAA6nB,gBAAA;AAAAN,YAAA;;ACgDC,ODhDD7W,IAAA,GAAAgM,MAAA2I,KAAA9gB,MCgDC,EDhDDmM,IAAAgM,GCgDC,EDhDDhM,GCgDC,EDhDD;ACiDG/B,SAAK0W,KAAK3U,CAAL,CAAL;AACA6W,YAAQ5lB,IAAR,CDjDFgN,GAAGnO,OAAOR,QAAV,CCiDE;ADlDH;;ACoDC,SAAOunB,OAAP;ADxEyB,CAA3B;;AAwBAjoB,WAAWU,QAAX,CAAoB6nB,gBAApB,GAAuC,EAAvC;;AAEAvoB,WAAWU,QAAX,CAAoB8nB,kBAApB,GAAyC,UAACnZ,EAAD;AACxCrP,aAAWU,QAAX,CAAoB6nB,gBAApB,CAAqClmB,IAArC,CAA0CgN,EAA1C;;AACA,MAAGrP,WAAWU,QAAX,CAAoByC,WAApB,KAAmC,KAAtC;ACoDG,WDnDFkM,GAAGnO,OAAOR,QAAV,CCmDE;AACD;ADvDsC,CAAzC,4H;;;;;;;;;;;AEpPAV,WAAW2jB,aAAX,GAA2B,UAAS7X,IAAT,EAAe2c,OAAf,EAAwBC,WAAxB,EAAqCC,OAArC,EAA8C;AACxE,KAAIC,iBAAJ;AACA,KAAIrW,cAAJ;;AAEA,KAAIoW,YAAY,UAAhB,EAA4B;AAC3B,SAAO3oB,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwB4U,eAAxB,CAAwC/c,KAAKrK,GAA7C,EAAkDknB,OAAlD,CAAP;AACA,EAFD,MAEO,IAAIA,YAAY,KAAhB,EAAuB;AAC7B,MAAIxjB,SAAS,IAAb;;AAEA,MAAI;AACHA,YAAS2jB,KAAKnoB,GAAL,CAAS8nB,OAAT,EAAkB;AAAEM,uBAAmB;AAACH,eAAU;AAAX;AAArB,IAAlB,CAAT;AACA,GAFD,CAEE,OAAOna,KAAP,EAAc;AACf,OAAIA,MAAMua,QAAN,CAAeC,UAAf,KAA8B,GAAlC,EAAuC;AACtCpjB,YAAQC,GAAR,iEAA2E2iB,OAA3E,cAA6F3c,KAAKf,QAAlG,QAAgH0D,KAAhH;AACA,UAAM,IAAIvN,OAAOsD,KAAX,CAAiB,2BAAjB,uDAAkGikB,OAAlG,cAAoH3c,KAAKf,QAAzH,EAAsI;AAAE,iBAAU,0BAAZ;AAAwC6G,UAAK6W,OAA7C;AAAsD1d,eAAUe,KAAKf;AAArE,KAAtI,CAAN;AACA;AACD;;AAED,MAAI5F,OAAO8jB,UAAP,KAAsB,GAA1B,EAA+B;AAC9BpjB,WAAQC,GAAR,4BAAsCX,OAAO8jB,UAA7C,+BAAmFR,OAAnF;AACA,SAAM,IAAIvnB,OAAOsD,KAAX,CAAiB,0BAAjB,2BAAqEikB,OAArE,EAAiF;AAAE,gBAAU,0BAAZ;AAAwC7W,SAAK6W;AAA7C,IAAjF,CAAN;AACA;;AAED,MAAI,CAAC,YAAYvmB,IAAZ,CAAiBiD,OAAO+jB,OAAP,CAAe,cAAf,CAAjB,CAAL,EAAuD;AACtDrjB,WAAQC,GAAR,sDAAgEX,OAAO+jB,OAAP,CAAe,cAAf,CAAhE,+BAA0HT,OAA1H;AACA,SAAM,IAAIvnB,OAAOsD,KAAX,CAAiB,0BAAjB,2BAAqEikB,OAArE,EAAiF;AAAE,gBAAU,0BAAZ;AAAwC7W,SAAK6W;AAA7C,IAAjF,CAAN;AACA;;AAEDG,aAAW,QAAX;AACArW,UAAQpN,OAAOgkB,OAAf;AACAT,gBAAcvjB,OAAO+jB,OAAP,CAAe,cAAf,CAAd;AACA,EAzBM,MAyBA,IAAIP,YAAY,MAAhB,EAAwB;AAC9BC,aAAW,QAAX;AACArW,UAAQkW,OAAR;AACA,EAHM,MAGA;AACN,MAAMW,WAAWC,eAAeC,YAAf,CAA4Bb,OAA5B,CAAjB;AACAG,aAAW,QAAX;AACArW,UAAQ6W,SAAS7W,KAAjB;AACAmW,gBAAcU,SAASV,WAAvB;AACA;;AAED,KAAMa,KAAKF,eAAeG,cAAf,CAA8B,IAAIC,MAAJ,CAAWlX,KAAX,EAAkBqW,QAAlB,CAA9B,CAAX;AACA3I,8BAA6BC,UAA7B,CAAwCC,mBAAuBrU,KAAKf,QAA5B,UAAxC;AACA,KAAM2e,KAAKzJ,6BAA6B0J,iBAA7B,CAA+CxJ,mBAAuBrU,KAAKf,QAA5B,UAA/C,EAA6F2d,WAA7F,CAAX;AACAgB,IAAGhb,EAAH,CAAM,KAAN,EAAaxN,OAAOyN,eAAP,CAAuB,YAAW;AAC9CzN,SAAO2P,UAAP,CAAkB,YAAW;AAC5B7Q,cAAWC,MAAX,CAAkBgU,KAAlB,CAAwB4U,eAAxB,CAAwC/c,KAAKrK,GAA7C,EAAkDknB,OAAlD;AACA3oB,cAAW6Y,aAAX,CAAyB+Q,YAAzB,CAAsC,cAAtC,EAAsD;AAAC7e,cAAUe,KAAKf;AAAhB,IAAtD;AACA,GAHD,EAGG,GAHH;AAIA,EALY,CAAb;AAMAwe,IAAGM,IAAH,CAAQH,EAAR;AACA,CAnDD,2H;;;;;;;;;;;;ACAA1pB,WAAW8pB,YAAX,GAA0B,UAACjgB,MAAD,EAASkB,QAAT;AACzB,MAAAgf,UAAA,EAAAC,iBAAA,EAAAvb,KAAA,EAAAwb,QAAA,EAAAlM,cAAA,EAAAmM,gBAAA,EAAA3E,GAAA,EAAAgE,EAAA,EAAAZ,OAAA,EAAA7c,IAAA,EAAA4d,EAAA;AAAA3e,aAAW2I,EAAEjT,IAAF,CAAOsK,QAAP,CAAX;;AACA,MAAG,CAAIlB,MAAJ,IAAc,CAAIkB,QAArB;AACC,WAAO,KAAP;ACEC;;ADAF;AACCgT,qBAAqB,IAAAtK,MAAA,CAAO,MAAMzT,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uBAAxB,CAAN,GAAyD,GAAhE,CAArB;AADD,WAAAwpB,MAAA;AAGCpM,qBAAqB,IAAAtK,MAAA,CAAO,mBAAP,CAArB;ACEC;;ADAF,MAAG,CAAIsK,eAAe7b,IAAf,CAAoB6I,QAApB,CAAP;AACC,WAAO,KAAP;ACEC;;ADAFe,SAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCtN,MAApC,CAAP;;AAGA,MAAGiC,KAAKf,QAAL,KAAiBA,QAApB;AACC,WAAOe,IAAP;ACAC;;ADEFoe,qBAAmBpe,KAAKf,QAAxB;;AAGA,MAAK,CAACmf,gBAAD,IAAqB,EAAEnf,SAAS8b,WAAT,OAA0BqD,iBAAiBrD,WAAjB,EAA5B,CAA1B;AACC,SAAO7mB,WAAWid,yBAAX,CAAqClS,QAArC,CAAP;AACC,aAAO,KAAP;AAFF;ACCE;;ADIF;AACC,QAAG,CAAImf,gBAAJ,MAAA3E,MAAAzZ,KAAA+K,MAAA,YAAA0O,IAAsCtgB,MAAtC,GAAsC,MAAtC,IAA+C,CAA/C,IAAqDjF,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,CAAxD;AACCuiB,eAASkH,mBAAT,CAA6Bte,KAAKrK,GAAlC;AAFF;AAAA,WAAA0oB,MAAA;AAGM1b,YAAA0b,MAAA;ACAJ;;ADEFre,OAAKf,QAAL,GAAgBA,QAAhB;;AAGA,MAAG,CAAImf,gBAAJ,IAAyBlqB,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,MAAwD,IAApF;AACCqpB,wBAAoBK,2BAA2Bve,IAA3B,CAApB;;AACA,SAAA6c,OAAA,2CAAAqB,iBAAA;ACFID,mBAAaC,kBAAkBrB,OAAlB,CAAb;;ADGH,UAAGA,YAAa,UAAhB;AACC3oB,mBAAW2jB,aAAX,CAAyB7X,IAAzB,EAA+Bie,WAAWO,IAA1C,EAAgDP,WAAWrB,WAA3D,EAAwEC,OAAxE;AACAsB,mBAAW,IAAX;AACA;AAHD;AAKCA,mBAAWF,UAAX;ACDG;ADLL;;AAOA,QAAGE,YAAA,IAAH;AACCjqB,iBAAW2jB,aAAX,CAAyB7X,IAAzB,EAA+Bme,SAASK,IAAxC,EAA8CL,SAASvB,WAAvD,EAAoE,UAApE;AAVF;ACYE;;ADCF,MAAGwB,gBAAH;AACClqB,eAAWC,MAAX,CAAkBwc,QAAlB,CAA2B8N,0BAA3B,CAAsDze,KAAKrK,GAA3D,EAAgEsJ,QAAhE;AACA/K,eAAWC,MAAX,CAAkBwc,QAAlB,CAA2B+N,4BAA3B,CAAwD1e,KAAKrK,GAA7D,EAAkEsJ,QAAlE;AAEA/K,eAAWC,MAAX,CAAkBwc,QAAlB,CAA2BgO,aAA3B,CAAyCP,gBAAzC,EAA2DpoB,OAA3D,CAAmE,UAACkI,GAAD;AAClE,UAAA0gB,UAAA;AAAAA,mBAAa1gB,IAAIA,GAAJ,CAAQpD,OAAR,CAAoB,IAAA6M,MAAA,CAAO,MAAIyW,gBAAX,EAA+B,IAA/B,CAApB,EAA0D,MAAInf,QAA9D,CAAb;ACCG,aDAH/K,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2BkO,mDAA3B,CAA+E3gB,IAAIvI,GAAnF,EAAwFyoB,gBAAxF,EAA0Gnf,QAA1G,EAAoH2f,UAApH,CCAG;ADFJ;AAIA1qB,eAAWC,MAAX,CAAkB+S,KAAlB,CAAwB4X,eAAxB,CAAwCV,gBAAxC,EAA0Dnf,QAA1D;AACA/K,eAAWC,MAAX,CAAkB+S,KAAlB,CAAwB6X,oBAAxB,CAA6CX,gBAA7C,EAA+Dnf,QAA/D;AACA/K,eAAWC,MAAX,CAAkB+S,KAAlB,CAAwB8X,6BAAxB,CAAsDhf,KAAKrK,GAA3D,EAAgEsJ,QAAhE;AAEA/K,eAAWC,MAAX,CAAkB2T,aAAlB,CAAgCmX,uBAAhC,CAAwDjf,KAAKrK,GAA7D,EAAkEsJ,QAAlE;AACA/K,eAAWC,MAAX,CAAkB2T,aAAlB,CAAgCoX,gCAAhC,CAAiEd,gBAAjE,EAAmFnf,QAAnF;AAEAwe,SAAKtJ,6BAA6BgL,qBAA7B,CAAmD9K,mBAAsB+J,mBAAiB,MAAvC,CAAnD,CAAL;;AACA,QAAGX,MAAA,IAAH;AACCtJ,mCAA6BC,UAA7B,CAAwCC,mBAAsBpV,WAAS,MAA/B,CAAxC;AACA2e,WAAKzJ,6BAA6B0J,iBAA7B,CAA+CxJ,mBAAsBpV,WAAS,MAA/B,CAA/C,EAAsFwe,GAAGb,WAAzF,CAAL;AACAgB,SAAGhb,EAAH,CAAM,KAAN,EAAaxN,OAAOyN,eAAP,CAAuB;ACD/B,eDEJsR,6BAA6BC,UAA7B,CAAwCC,mBAAsB+J,mBAAiB,MAAvC,CAAxC,CCFI;ADCQ,QAAb;AAEAX,SAAG2B,UAAH,CAAcrB,IAAd,CAAmBH,EAAnB;AArBF;ACsBE;;ADEF1pB,aAAWC,MAAX,CAAkBgU,KAAlB,CAAwB2P,WAAxB,CAAoC9X,KAAKrK,GAAzC,EAA8CsJ,QAA9C;AACA,SAAOe,IAAP;AAzEyB,CAA1B;;AA2EA9L,WAAW4jB,WAAX,GAAyB5jB,WAAWmP,WAAX,CAAuBC,aAAvB,CAAqCpP,WAAW8pB,YAAhD,EAA8D,CAA9D,EAAiE,KAAjE,EACxB;AAAA,KAAG;AAAM,WAAO,CAAI5oB,OAAO2I,MAAP,EAAJ,IAAuB,CAAI7J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,sBAAhD,CAAlC;AAAT;AAAA,CADwB,CAAzB,0H;;;;;;;;;;;AE3EA7J,WAAWmrB,YAAX,GAA0B,UAASthB,MAAT,EAAiBnG,IAAjB,EAAuB;AAChDA,QAAOgQ,EAAEjT,IAAF,CAAOiD,IAAP,CAAP;;AACA,KAAI,CAACmG,MAAD,IAAW,CAACnG,IAAhB,EAAsB;AACrB,SAAO,KAAP;AACA;;AAED,KAAMoI,OAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCtN,MAApC,CAAb,CANgD,CAQhD;;AACA,KAAIiC,KAAKpI,IAAL,KAAcA,IAAlB,EAAwB;AACvB,SAAOoI,IAAP;AACA,EAX+C,CAahD;;;AACA9L,YAAWC,MAAX,CAAkBgU,KAAlB,CAAwBmX,OAAxB,CAAgCtf,KAAKrK,GAArC,EAA0CiC,IAA1C;AACAoI,MAAKpI,IAAL,GAAYA,IAAZ;;AAEA,KAAI1D,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,kBAAxB,MAAgD,IAApD,EAA0D;AACzDX,aAAW6Y,aAAX,CAAyB+Q,YAAzB,CAAsC,mBAAtC,EAA2D;AAC1DnoB,QAAKqK,KAAKrK,GADgD;AAE1DiC,SAAMoI,KAAKpI,IAF+C;AAG1DqH,aAAUe,KAAKf;AAH2C,GAA3D;AAKA;;AAED,QAAOe,IAAP;AACA,CA1BD;;AA4BA9L,WAAW6jB,WAAX,GAAyB7jB,WAAWmP,WAAX,CAAuBC,aAAvB,CAAqCpP,WAAWmrB,YAAhD,EAA8D,CAA9D,EAAiE,KAAjE,EAAwE;AAChG,EADgG,cAC5F;AAAE,SAAO,CAACjqB,OAAO2I,MAAP,EAAD,IAAoB,CAAC7J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,sBAAhD,CAA5B;AAAsG,EADZ,CACa;;AADb,CAAxE,CAAzB,0H;;;;;;;;;;;AC5BA7J,WAAWqrB,SAAX,GAAuB,UAASxhB,MAAT,EAAiB3C,KAAjB,EAAwB;AAC9CA,SAAQwM,EAAEjT,IAAF,CAAOyG,KAAP,CAAR;;AACA,KAAI,CAAC2C,MAAL,EAAa;AACZ,QAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAE,eAAU;AAAZ,GAAvD,CAAN;AACA;;AAED,KAAI,CAAC0C,KAAL,EAAY;AACX,QAAM,IAAIhG,OAAOsD,KAAX,CAAiB,qBAAjB,EAAwC,eAAxC,EAAyD;AAAE,eAAU;AAAZ,GAAzD,CAAN;AACA;;AAEDxE,YAAW4a,mBAAX,CAA+B1T,KAA/B;AAEA,KAAM4E,OAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCtN,MAApC,CAAb,CAZ8C,CAc9C;;AACA,KAAIiC,KAAK+K,MAAL,IAAe/K,KAAK+K,MAAL,CAAY,CAAZ,CAAf,IAAiC/K,KAAK+K,MAAL,CAAY,CAAZ,EAAeG,OAAf,KAA2B9P,KAAhE,EAAuE;AACtE,SAAO4E,IAAP;AACA,EAjB6C,CAmB9C;;;AACA,KAAI,CAAC9L,WAAWwd,sBAAX,CAAkCtW,KAAlC,CAAL,EAA+C;AAC9C,QAAM,IAAIhG,OAAOsD,KAAX,CAAiB,yBAAjB,EAAgD0C,KAAhD,4BAA+E;AAAE,eAAU,WAAZ;AAAyB2b,UAAO3b;AAAhC,GAA/E,CAAN;AACA,EAtB6C,CAwB9C;;;AACAlH,YAAWC,MAAX,CAAkBgU,KAAlB,CAAwB6P,QAAxB,CAAiChY,KAAKrK,GAAtC,EAA2CyF,KAA3C;AACA4E,MAAK5E,KAAL,GAAaA,KAAb;AACA,QAAO4E,IAAP;AACA,CA5BD;;AA8BA9L,WAAW8jB,QAAX,GAAsB9jB,WAAWmP,WAAX,CAAuBC,aAAvB,CAAqCpP,WAAWqrB,SAAhD,EAA2D,CAA3D,EAA8D,KAA9D,EAAqE;AAC1F,EAD0F,cACtF;AAAE,SAAO,CAACnqB,OAAO2I,MAAP,EAAD,IAAoB,CAAC7J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,sBAAhD,CAA5B;AAAsG,EADlB,CACmB;;AADnB,CAArE,CAAtB,0H;;;;;;;;;;;AC9BA7J,WAAWsrB,aAAX,GAA2B,UAASpY,GAAT,EAAc;AACxClT,YAAWC,MAAX,CAAkB+S,KAAlB,CAAwBuY,aAAxB,CAAsCrY,GAAtC;AACAlT,YAAWC,MAAX,CAAkB2T,aAAlB,CAAgC4X,iBAAhC,CAAkDtY,GAAlD;AACA,CAHD,0H;;;;;;;;;;;ACAAlT,WAAWyrB,aAAX,GAA2B,UAAShhB,OAAT,EAAkBqB,IAAlB,EAAwB;AAClD;AACA,KAAI9L,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,qBAAxB,CAAJ,EAAoD;AACnDX,aAAWC,MAAX,CAAkBwc,QAAlB,CAA2BqC,yBAA3B,CAAqDrU,QAAQhJ,GAA7D;AACA;;AAEDgJ,SAAQoI,QAAR,GAAmB,IAAIrR,IAAJ,EAAnB;AACAiJ,SAAQihB,QAAR,GAAmB;AAClBjqB,OAAKqK,KAAKrK,GADQ;AAElBsJ,YAAUe,KAAKf;AAFG,EAAnB;AAKA,KAAMia,OAAOva,QAAQT,GAAR,CAAYpE,KAAZ,CAAkB,8IAAlB,CAAb;;AACA,KAAIof,IAAJ,EAAU;AACTva,UAAQua,IAAR,GAAeA,KAAKniB,GAAL,CAAS,UAAC+O,GAAD,EAAS;AAAE,UAAO;AAAEA;AAAF,IAAP;AAAiB,GAArC,CAAf;AACA;;AAEDnH,WAAUzK,WAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,mBAAzB,EAA8C0F,OAA9C,CAAV;AAEA,KAAMkhB,SAASlhB,QAAQhJ,GAAvB;AACA,QAAOgJ,QAAQhJ,GAAf;AAEAzB,YAAWC,MAAX,CAAkBwc,QAAlB,CAA2ByC,MAA3B,CAAkC;AAAEzd,OAAKkqB;AAAP,EAAlC,EAAmD;AAAExM,QAAM1U;AAAR,EAAnD;AAEA,KAAMmI,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoC1M,QAAQyI,GAA5C,CAAb;AAEAhS,QAAO+E,KAAP,CAAa,YAAW;AACvBjG,aAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,kBAAzB,EAA6C/E,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2BtF,WAA3B,CAAuCwU,MAAvC,CAA7C,EAA6F/Y,IAA7F;AACA,EAFD;AAGA,CA7BD,2H;;;;;;;;;;;;ACAA,IAAA9E,IAAA;AAAA,IAAAR,QAAA,GAAAA,KAAA;AAAAtN,WAAW6Y,aAAX,GAA2B;AACb,WAAA+S,MAAA;AACZ,QAAAC,IAAA;AAAAA,WAAO,IAAP;AAEA,SAACC,KAAD,GAAS,KAAT;AAEA,SAACC,SAAD,GAAiB,IAAA7qB,OAAO8qB,QAAP,CAAgB,YAAhB,CAAjB;AACA,SAACC,YAAD,GAAoB,IAAA/qB,OAAO8qB,QAAP,CAAgB,eAAhB,CAApB;AACA,SAACE,UAAD,GAAkB,IAAAhrB,OAAO8qB,QAAP,CAAgB,aAAhB,CAAlB;AACA,SAACG,eAAD,GAAuB,IAAAjrB,OAAO8qB,QAAP,CAAgB,mBAAhB,CAAvB;AACA,SAACI,UAAD,GAAkB,IAAAlrB,OAAO8qB,QAAP,CAAgB,aAAhB,CAAlB;AAGA,SAACD,SAAD,CAAWM,UAAX,CAAsB,MAAtB;AACA,SAACJ,YAAD,CAAcI,UAAd,CAAyB,MAAzB;AACA,SAACH,UAAD,CAAYG,UAAZ,CAAuB,MAAvB;AACA,SAACF,eAAD,CAAiBE,UAAjB,CAA4B;AAC3B,UAAAlf,IAAA,EAAAgO,CAAA,EAAAmR,SAAA,EAAAlb,CAAA,EAAAgM,GAAA,EAAAmI,GAAA,EAAAC,IAAA,EAAAvU,MAAA,EAAA6G,YAAA,EAAAyU,aAAA,EAAAzgB,IAAA;AAD4BwgB,kBAAA/e,UAAA,IAAWJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAX;AAC5BgY,YAAc+G,UAAU3mB,KAAV,CAAgB,GAAhB,CAAd,EAACsL,SAAAsU,IAAA,EAAD,EAASpK,IAAAoK,IAAA,EAAT;AAEAzZ,aAAO5K,OAAOoc,KAAP,CAAa5E,OAAb,CAAqB,KAAC7O,MAAtB,EAA8B;AAACuK,gBAAQ;AAACrJ,oBAAU;AAAX;AAAT,OAA9B,CAAP;;AACA,UAAG/K,WAAAC,MAAA,CAAA2T,aAAA,CAAAwI,wBAAA,CAAAnL,MAAA,OAAApH,MAAA,SAAH;AACC0iB,wBAAgBvsB,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgC4Y,wBAAhC,CAAyDvb,MAAzD,EAAiE,KAACpH,MAAlE,EAA0EwK,KAA1E,EAAhB;;AACA,aAAAjD,IAAA,GAAAgM,MAAAmP,cAAAtnB,MAAA,EAAAmM,IAAAgM,GAAA,EAAAhM,GAAA;ACMM0G,yBAAeyU,cAAcnb,CAAd,CAAf;ADLL,WAAAoU,OAAAxlB,WAAW6Y,aAAX,EAAyBC,UAAzB,CAAAtL,KAAA,CAAAgY,IAAA,EAAoC,CAAA1N,aAAahN,CAAb,CAAerJ,GAAf,EAAoB0Z,CAApB,EAAuB3X,MAAvB,CAAuB8J,MAAA/K,IAAA,CAAA4K,IAAA,CAAvB,CAApC;AAHF;ACWI;;ADNJ,aAAO,KAAP;AATD;AAWA,SAACif,UAAD,CAAYC,UAAZ,CAAuB,QAAvB;AAEA,SAACN,SAAD,CAAWU,SAAX,CAAqB,KAArB;AAEA,SAACR,YAAD,CAAcQ,SAAd,CAAwB,QAAxB;AAEA,SAACP,UAAD,CAAYO,SAAZ,CAAsB,UAACH,SAAD;AACrB,UAAA1Z,IAAA,EAAA3B,MAAA,EAAAnF,IAAA;;AAAA,UAAO,KAAAjC,MAAA,QAAP;AAAqB,eAAO,KAAP;ACOjB;;ADLJoH,eAASqb,UAAU3mB,KAAV,CAAgB,GAAhB,EAAqB,CAArB,CAAT;AAEAmG,aAAO5K,OAAOoc,KAAP,CAAa5E,OAAb,CAAqB,KAAC7O,MAAtB,EAA8B;AAACuK,gBAAQ;AAACrJ,oBAAU;AAAX;AAAT,OAA9B,CAAP;AACA6H,aAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoClG,MAApC,CAAP;;AACA,UAAG2B,KAAKxH,CAAL,KAAU,GAAV,IAAkBwH,KAAK1E,CAAL,CAAOzM,GAAP,KAAcqK,KAAKrK,GAAxC;AACC,eAAO,IAAP;ACUG;;ADRJ,aAAOmR,KAAKuB,SAAL,CAAexN,OAAf,CAAuBmF,KAAKf,QAA5B,IAAwC,CAAC,CAAhD;AAVD;AAYA,SAACohB,eAAD,CAAiBM,SAAjB,CAA2B,MAA3B;AAEA,SAACL,UAAD,CAAYK,SAAZ,CAAsB,UAACH,SAAD;AACrB,UAAAziB,MAAA;AAAAA,eAASyiB,UAAU3mB,KAAV,CAAgB,GAAhB,EAAqB,CAArB,CAAT;AACA,aAAO,KAAAkE,MAAA,YAAa,KAACA,MAAD,KAAWA,MAA/B;AAFD;AA9CY;;AC6DZ+hB,SAAOve,SAAP,CDVDqf,SCUC,GDVU;AACV,QAAAvf,IAAA,EAAAmf,SAAA;AADWA,gBAAA/e,UAAA,IAAWJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAX;;AACX,QAAsC,KAACue,KAAD,KAAU,IAAhD;AAAAjmB,cAAQC,GAAR,CAAY,WAAZ,EAAyByH,SAAzB;ACcG;;ADZHJ,SAAKwf,OAAL,CAAaL,SAAb;ACcE,WDbF,KAACP,SAAD,CAAWa,IAAX,CAAgBpf,KAAhB,CAAsB,KAACue,SAAvB,EAAkC5e,IAAlC,CCaE;ADjBQ,GCUV;;AAUAye,SAAOve,SAAP,CDdDuc,YCcC,GDda;AACb,QAAAzc,IAAA,EAAAmf,SAAA;AADcA,gBAAA/e,UAAA,IAAWJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAX;;AACd,QAAyC,KAACue,KAAD,KAAU,IAAnD;AAAAjmB,cAAQC,GAAR,CAAY,cAAZ,EAA4ByH,SAA5B;ACkBG;;ADhBHJ,SAAKwf,OAAL,CAAaL,SAAb;ACkBE,WDjBF,KAACL,YAAD,CAAcW,IAAd,CAAmBpf,KAAnB,CAAyB,KAACye,YAA1B,EAAwC9e,IAAxC,CCiBE;ADrBW,GCcb;;AAUAye,SAAOve,SAAP,CDlBDoS,UCkBC,GDlBW;AACX,QAAAtS,IAAA,EAAAmf,SAAA,EAAA1Z,IAAA;AADYA,WAAArF,UAAA,IAAM+e,YAAA/e,UAAA,EAAN,EAAiBJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAjB;;AACZ,QAAuC,KAACue,KAAD,KAAU,IAAjD;AAAAjmB,cAAQC,GAAR,CAAY,YAAZ,EAA0ByH,SAA1B;ACsBG;;ADpBHJ,SAAKwf,OAAL,CAAgB/Z,OAAK,GAAL,GAAQ0Z,SAAxB;ACsBE,WDrBF,KAACJ,UAAD,CAAYU,IAAZ,CAAiBpf,KAAjB,CAAuB,KAAC0e,UAAxB,EAAoC/e,IAApC,CCqBE;ADzBS,GCkBX;;AAUAye,SAAOve,SAAP,CDtBDyL,UCsBC,GDtBW;AACX,QAAA3L,IAAA,EAAAmf,SAAA,EAAAziB,MAAA;AADYA,aAAA0D,UAAA,IAAQ+e,YAAA/e,UAAA,EAAR,EAAmBJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAnB;;AACZ,QAAuC,KAACue,KAAD,KAAU,IAAjD;AAAAjmB,cAAQC,GAAR,CAAY,YAAZ,EAA0ByH,SAA1B;AC0BG;;ADxBHJ,SAAKwf,OAAL,CAAgB9iB,SAAO,GAAP,GAAUyiB,SAA1B;AC0BE,WDzBF,KAACF,UAAD,CAAYQ,IAAZ,CAAiBpf,KAAjB,CAAuB,KAAC4e,UAAxB,EAAoCjf,IAApC,CCyBE;AD7BS,GCsBX;;AAUAye,SAAOve,SAAP,CDzBDwf,uBCyBC,GDzBwB;AACxB,QAAA1f,IAAA,EAAAmf,SAAA;AADyBA,gBAAA/e,UAAA,IAAWJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAX;;AACzB,QAAsC,KAACue,KAAD,KAAU,IAAhD;AAAAjmB,cAAQC,GAAR,CAAY,WAAZ,EAAyByH,SAAzB;AC6BG;;AD3BHJ,SAAKwf,OAAL,CAAaL,SAAb;AC6BE,WD5BF,KAACP,SAAD,CAAWe,oBAAX,CAAgCtf,KAAhC,CAAsC,KAACue,SAAvC,EAAkD5e,IAAlD,CC4BE;ADhCsB,GCyBxB;;AAUAye,SAAOve,SAAP,CD7BD0f,0BC6BC,GD7B2B;AAC3B,QAAA5f,IAAA,EAAAmf,SAAA;AAD4BA,gBAAA/e,UAAA,IAAWJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAX;;AAC5B,QAAyC,KAACue,KAAD,KAAU,IAAnD;AAAAjmB,cAAQC,GAAR,CAAY,cAAZ,EAA4ByH,SAA5B;ACiCG;;AD/BHJ,SAAKwf,OAAL,CAAaL,SAAb;ACiCE,WDhCF,KAACL,YAAD,CAAca,oBAAd,CAAmCtf,KAAnC,CAAyC,KAACye,YAA1C,EAAwD9e,IAAxD,CCgCE;ADpCyB,GC6B3B;;AAUAye,SAAOve,SAAP,CDjCD2f,wBCiCC,GDjCyB;AACzB,QAAA7f,IAAA,EAAAmf,SAAA,EAAA1Z,IAAA;AAD0BA,WAAArF,UAAA,IAAM+e,YAAA/e,UAAA,EAAN,EAAiBJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAjB;;AAC1B,QAAmD,KAACue,KAAD,KAAU,IAA7D;AAAAjmB,cAAQC,GAAR,CAAY,wBAAZ,EAAsCyH,SAAtC;ACqCG;;ADnCHJ,SAAKwf,OAAL,CAAgB/Z,OAAK,GAAL,GAAQ0Z,SAAxB;ACqCE,WDpCF,KAACJ,UAAD,CAAYY,oBAAZ,CAAiCtf,KAAjC,CAAuC,KAAC0e,UAAxC,EAAoD/e,IAApD,CCoCE;ADxCuB,GCiCzB;;AAUAye,SAAOve,SAAP,CDrCD4f,wBCqCC,GDrCyB;AACzB,QAAA9f,IAAA,EAAAmf,SAAA,EAAAziB,MAAA;AAD0BA,aAAA0D,UAAA,IAAQ+e,YAAA/e,UAAA,EAAR,EAAmBJ,OAAA,KAAAI,UAAAtI,MAAA,GAAAqI,MAAA/K,IAAA,CAAAgL,SAAA,SAAnB;;AAC1B,QAAmD,KAACue,KAAD,KAAU,IAA7D;AAAAjmB,cAAQC,GAAR,CAAY,wBAAZ,EAAsCyH,SAAtC;ACyCG;;ADvCHJ,SAAKwf,OAAL,CAAgB9iB,SAAO,GAAP,GAAUyiB,SAA1B;ACyCE,WDxCF,KAACF,UAAD,CAAYU,oBAAZ,CAAiCtf,KAAjC,CAAuC,KAAC4e,UAAxC,EAAoDjf,IAApD,CCwCE;AD5CuB,GCqCzB;;AAUA,SAAOye,MAAP;AAED,CDhJ0B,KAA3B;;AAyGA9d,OAAO,UAACwe,SAAD,EAAYvhB,QAAZ;AACN,MAAAoQ,CAAA,EAAAoK,GAAA,EAAA3S,IAAA,EAAA9G,IAAA;AAAAyZ,QAAY+G,UAAU3mB,KAAV,CAAgB,GAAhB,CAAZ,EAACiN,OAAA2S,IAAA,EAAD,EAAOpK,IAAAoK,IAAA,EAAP;;AAEA,MAAGpK,MAAK,QAAR;AACC,WAAO,IAAP;AC0CC;;ADxCF,MAAGA,MAAK,QAAR;AACCrP,WAAO5K,OAAOoc,KAAP,CAAa5E,OAAb,CAAqB,KAAC7O,MAAtB,EAA8B;AAACuK,cAAQ;AAACrJ,kBAAU;AAAX;AAAT,KAA9B,CAAP;;AACA,SAAAe,QAAA,OAAGA,KAAMf,QAAT,GAAS,MAAT,MAAqBA,QAArB;AACC,aAAO,IAAP;AAHF;ACkDE;;AD7CF,SAAO,KAAP;AAXM,CAAP;;AAaA/K,WAAW6Y,aAAX,CAAyBqT,UAAzB,CAAoCG,UAApC,CAA+Cve,IAA/C,0E;;;;;;;;;;;;;;;;;;;;;AEtHA,IAAIof,qBAAJ;AAAiBhkB,OAAO8E,KAAP,CAAaC,QAAQ,WAAR,CAAb,EAAkC;AAAA,sBAASC,CAAT,EAAW;AAACgf,iBAAahf,CAAb;AAAe;AAA3B,CAAlC,EAA+D,CAA/D;AAAkE,IAAIif,wBAAJ;AAAoBjkB,OAAO8E,KAAP,CAAaC,QAAQ,cAAR,CAAb,EAAqC;AAAA,sBAASC,CAAT,EAAW;AAACif,oBAAgBjf,CAAhB;AAAkB;AAA9B,CAArC,EAAqE,CAArE;AAGvGlO,WAAWC,MAAX,CAAkBmtB,aAAlB,GAAkC,IAAIlsB,OAAOmsB,mBAAX,EAAlC;;IAEMC,U;AACL,qBAAYC,WAAZ,EAAyBC,QAAzB,EAAmC;AAAA;AAClC,OAAKC,GAAL,GAAW,IAAIP,YAAJ,CAAiBK,WAAjB,EAA8B,IAA9B,CAAX;AACA,OAAKG,KAAL,GAAa,KAAKD,GAAL,CAASC,KAAtB;AACA,OAAKC,cAAL,GAAsB,KAAKF,GAAL,CAASE,cAA/B;AACA,OAAKjqB,IAAL,GAAY,KAAK+pB,GAAL,CAAS/pB,IAArB;AAEA,OAAKkqB,SAAL,GAAiBJ,aAAa,IAA9B;AAEA,OAAKK,KAAL,GAAa,IAAIV,eAAJ,CAAoB,IAApB,CAAb,CARkC,CASlC;;AACA,OAAKze,EAAL,GAAU,KAAKmf,KAAL,CAAWnf,EAAX,CAAcof,IAAd,CAAmB,KAAKD,KAAxB,CAAV;AACA,OAAKjB,IAAL,GAAY,KAAKiB,KAAL,CAAWjB,IAAX,CAAgBkB,IAAhB,CAAqB,KAAKD,KAA1B,CAAZ;AACA,OAAKE,cAAL,GAAsB,KAAKF,KAAL,CAAWE,cAAX,CAA0BD,IAA1B,CAA+B,KAAKD,KAApC,CAAtB;AACA,OAAKG,2BAAL,GAAmC,KAAKH,KAAL,CAAWG,2BAAX,CAAuCF,IAAvC,CAA4C,KAAKD,KAAjD,CAAnC,CAbkC,CAclC;;AAEA,OAAKrG,EAAL,GAAU,IAAV;;AAEA,MAAI,KAAKoG,SAAT,EAAoB;AACnB,QAAKpG,EAAL,GAAU,IAAI,KAAKyG,WAAT,CAAqB,KAAKP,KAA1B,EAAiC,KAAjC,CAAV;AACA;AACD;;sBAcDQ,a;yBAAcnnB,I,EAAM;AACnB,UAAO;AACNsN,SADM,cACE;AACP,YAAOtN,IAAP;AACA,KAHK;AAINonB,SAJM,cAIE;AACP,YAAOpnB,KAAK9B,MAAZ;AACA,KANK;AAONnD,WAPM,YAOEuN,EAPF,EAOM;AACX,YAAOtI,KAAKjF,OAAL,CAAauN,EAAb,CAAP;AACA;AATK,IAAP;AAWA;;;;;sBAED+e,Y;0BAAa,6BAA+B;AAAA;;AAC3C,UAAO,YAAKX,GAAL,EAASW,YAAT,YAAyB7gB,SAAzB,CAAP;AACA;;;;;sBAED7I,I;kBAAO;AACN,OAAI;AAAA;;AACH,WAAO,gBAAK,KAAK2pB,MAAV,GAAkB3pB,IAAlB,gBAA0B6I,SAA1B,CAAP;AACA,IAFD,CAEE,OAAO4N,CAAP,EAAU;AAAA;;AACX,yBAAQ1M,KAAR,kBAAc,mBAAd,EAAmC0M,CAAnC,oCAAyC5N,SAAzC;AACA;AACD;;;;;sBAEDmL,O;qBAAU;AACT,OAAI;AAAA;;AACH,WAAO,iBAAK,KAAK2V,MAAV,GAAkB3V,OAAlB,iBAA6BnL,SAA7B,CAAP;AACA,IAFD,CAEE,OAAO4N,CAAP,EAAU;AAAA;;AACX,0BAAQ1M,KAAR,mBAAc,mBAAd,EAAmC0M,CAAnC,oCAAyC5N,SAAzC;AACA;AACD;;;;;sBAED4J,W;yBAAc;AACb,OAAI;AAAA;;AACH,WAAO,iBAAK,KAAKkX,MAAV,GAAkBlX,WAAlB,iBAAiC5J,SAAjC,CAAP;AACA,IAFD,CAEE,OAAO4N,CAAP,EAAU;AAAA;;AACX,0BAAQ1M,KAAR,mBAAc,mBAAd,EAAmC0M,CAAnC,oCAAyC5N,SAAzC;AACA;AACD;;;;;sBAED+gB,Y;wBAAaC,G,EAAKhlB,O,EAAS;AAC1BwG,SAAMwe,GAAN,EAAW,CAACxoB,MAAD,CAAX;;AAEA,OAAI;AACH,WAAO,KAAK,KAAKsoB,MAAV,EAAkBC,YAAlB,CAA+BC,GAA/B,EAAoChlB,OAApC,CAAP;AACA,IAFD,CAEE,OAAO4R,CAAP,EAAU;AAAA;;AACX,0BAAQ1M,KAAR,mBAAc,mBAAd,EAAmC0M,CAAnC,oCAAyC5N,SAAzC;AACA;AACD;;;;;sBAED6X,M;oBAAO,UAAY;AAAA;;AAClB,UAAO,aAAKqI,GAAL,EAASrI,MAAT,aAAmB7X,SAAnB,CAAP;AACA;;;;;sBAED2R,M;oBAAO,0BAA4B;AAAA;;AAClC,UAAO,aAAKuO,GAAL,EAASvO,MAAT,aAAmB3R,SAAnB,CAAP;AACA;;;;;sBAEDsX,M;oBAAO,iBAAmB;AAAA;;AACzB,UAAO,aAAK4I,GAAL,EAAS5I,MAAT,aAAmBtX,SAAnB,CAAP;AACA;;;;;sBAED3I,M;oBAAO,SAAW;AAAA;;AACjB,UAAO,aAAK6oB,GAAL,EAAS7oB,MAAT,aAAmB2I,SAAnB,CAAP;AACA;;;;;sBAEDihB,c;4BAAiB;AAAA;;AAChB,UAAO,aAAKf,GAAL,EAASe,cAAT,aAA2BjhB,SAA3B,CAAP;AACA;;;;;sBAEDkhB,K;mBAAQ;AAAA;;AACP,UAAO,aAAKhB,GAAL,EAASgB,KAAT,aAAkBlhB,SAAlB,CAAP;AACA;;;;;sBAEDmhB,I;kBAAO;AAAA;;AACN,UAAO,aAAKjB,GAAL,EAASiB,IAAT,aAAiBnhB,SAAjB,CAAP;AACA;;;;;sBAEDohB,W;yBAAc;AAAA;;AACb,UAAO,aAAKlB,GAAL,EAASkB,WAAT,aAAwBphB,SAAxB,CAAP;AACA;;;;;sBAEDqhB,S;uBAAY;AAAA;;AACX,UAAO,cAAKnB,GAAL,EAASmB,SAAT,cAAsBrhB,SAAtB,CAAP;AACA;;;;;sBAEDshB,c;4BAAiB;AAAA;;AAChB,UAAO,cAAKpB,GAAL,EAASoB,cAAT,cAA2BthB,SAA3B,CAAP;AACA;;;;;sBAEDuhB,Y;0BAAe;AAAA;;AACd,UAAO,cAAKrB,GAAL,EAASqB,YAAT,cAAyBvhB,SAAzB,CAAP;AACA;;;;;sBAEDwhB,S;uBAAU,kBAAoB;AAAA;;AAC7B,UAAO,cAAKtB,GAAL,EAASsB,SAAT,cAAsBxhB,SAAtB,CAAP;AACA;;;;;sBAEDyhB,qB;mCAAsB,6BAA+B;AAAA;;AACpD,UAAO,cAAKvB,GAAL,EAASuB,qBAAT,cAAkCzhB,SAAlC,CAAP;AACA;;;MAED;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;mBAzJe;AACd,OAAIvN,WAAWC,MAAX,CAAkBmtB,aAAlB,CAAgCzsB,GAAhC,OAA0C,KAA9C,EAAqD;AACpD,WAAO,KAAP;AACA;;AAED,UAAO,KAAKitB,SAAZ;AACA;;;mBAEY;AACZ,UAAO,KAAKJ,QAAL,KAAkB,IAAlB,GAAyB,OAAzB,GAAmC,KAA1C;AACA;;;;;AAmJFxtB,WAAWC,MAAX,CAAkBgvB,KAAlB,GAA0B3B,UAA1B,yF;;;;;;;;;;;;AC1LA,IAAA7M,SAAA,UAAAyO,KAAA,EAAAC,MAAA;AAAA,WAAAntB,GAAA,2CAAAmtB,MAAA;AAAA,QAAAC,QAAA7sB,IAAA,CAAA4sB,MAAA,EAAAntB,GAAA,GAAAktB,MAAAltB,GAAA,IAAAmtB,OAAAntB,GAAA;AAAA;;AAAA,WAAAqtB,IAAA;AAAA,SAAApB,WAAA,GAAAiB,KAAA;AAAA;;AAAAG,OAAAhiB,SAAA,GAAA8hB,OAAA9hB,SAAA;AAAA6hB,QAAA7hB,SAAA,OAAAgiB,IAAA;AAAAH,QAAAI,SAAA,GAAAH,OAAA9hB,SAAA;AAAA,SAAA6hB,KAAA;AAAA;AAAA,ICCEE,UAAU,GAAGG,cDDf;;AAAAvvB,WAAWC,MAAX,CAAkBwc,QAAlB,GAA6B,eAAA+S,UAAA;ACI3B/O,SAAOmL,MAAP,EAAe4D,UAAf;;ADHY,WAAA5D,MAAA;AACZA,WAAA0D,SAAA,CAAArB,WAAA,CAAA1rB,IAAA,OAAM,SAAN;;AAEA,SAACssB,cAAD,CAAgB;AAAE,aAAO,CAAT;AAAY,YAAM;AAAlB,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,YAAM;AAAR,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,eAAS;AAAX,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,kBAAY;AAAd,KAAhB,EAAmC;AAAEY,cAAQ;AAAV,KAAnC;AACA,SAACZ,cAAD,CAAgB;AAAE,sBAAgB;AAAlB,KAAhB,EAAuC;AAAEY,cAAQ;AAAV,KAAvC;AACA,SAACZ,cAAD,CAAgB;AAAE,aAAO,CAAT;AAAY,WAAK,CAAjB;AAAoB,eAAS;AAA7B,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,kBAAY;AAAd,KAAhB,EAAmC;AAAEa,0BAAoB;AAAtB,KAAnC;AACA,SAACb,cAAD,CAAgB;AAAE,aAAO;AAAT,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,kBAAY;AAAd,KAAhB,EAAmC;AAAEY,cAAQ;AAAV,KAAnC;AACA,SAACZ,cAAD,CAAgB;AAAE,2BAAqB;AAAvB,KAAhB,EAA4C;AAAEY,cAAQ;AAAV,KAA5C;AACA,SAACZ,cAAD,CAAgB;AAAE,gBAAU;AAAZ,KAAhB,EAAiC;AAAEY,cAAQ;AAAV,KAAjC;AACA,SAACZ,cAAD,CAAgB;AAAE,mBAAa;AAAf,KAAhB,EAAoC;AAAEY,cAAQ;AAAV,KAApC;AACA,SAACZ,cAAD,CAAgB;AAAE,kBAAY;AAAd,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,oBAAc,CAAhB;AAAmB,iBAAW;AAA9B,KAAhB,EAAmD;AAAEY,cAAQ;AAAV,KAAnD;AAhBY;;ACuEZ7D,SAAOve,SAAP,CDpDDod,aCoDC,GDpDc,UAAC1f,QAAD,EAAWxB,OAAX;AACd,QAAA2I,KAAA;AAAAA,YACC;AAAA,2BAAqBnH;AAArB,KADD;AAGA,WAAO,KAACrG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJc,GCoDd;;AAQAqiB,SAAOve,SAAP,CDtDDsiB,6BCsDC,GDtD8B,UAAC5kB,QAAD,EAAWmI,GAAX,EAAgB3J,OAAhB;AAC9B,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eAAS;AAAErF,aAAK;AAAP,OAAT;AACA,2BAAqBhP,QADrB;AAEA,aAAOmI;AAFP,KADD;AAKA,WAAO,KAACxO,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAN8B,GCsD9B;;AAYAqiB,SAAOve,SAAP,CD1DDuiB,mBC0DC,GD1DoB,UAAC3e,MAAD,EAAS1H,OAAT;AACpB,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAGA7G,WAAKjC;AAHL,KADD;AAMA,WAAO,KAACvM,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAPoB,GC0DpB;;AAWAqiB,SAAOve,SAAP,CD5DDwiB,qCC4DC,GD5DsC,UAAC5e,MAAD,EAAS/F,KAAT,EAAgB3B,OAAhB;AACtC,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAGA7G,WAAKjC;AAHL,KADD;;AAMA,QAAGiU,MAAMhjB,IAAN,CAAWgJ,KAAX,EAAkB,CAACnF,MAAD,CAAlB,KAAgCmF,MAAMjG,MAAN,GAAe,CAAlD;AACCiN,YAAM9G,CAAN,GACC;AAAA0kB,cAAM5kB;AAAN,OADD;ACgEE;;AD7DH,WAAO,KAACxG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAXsC,GC4DtC;;AAgBAqiB,SAAOve,SAAP,CD/DD0iB,qBC+DC,GD/DsB,UAAC9e,MAAD,EAAS1H,OAAT;AACtB,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eAAS,IAAT;AACAlM,WAAKjC;AADL,KADD;AAIA,WAAO,KAACvM,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AALsB,GC+DtB;;AASAqiB,SAAOve,SAAP,CDjED2iB,iCCiEC,GDjEkC,UAAC/e,MAAD,EAASgf,SAAT,EAAoB1mB,OAApB;AAClC,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAEA7G,WAAKjC,MAFL;AAGA1P,UACC;AAAA2uB,aAAKD;AAAL;AAJD,KADD;AAOA,WAAO,KAACvrB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AARkC,GCiElC;;AAcAqiB,SAAOve,SAAP,CDrED8iB,kCCqEC,GDrEmC,UAAClf,MAAD,EAASgf,SAAT,EAAoB1mB,OAApB;AACnC,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAEA7G,WAAKjC,MAFL;AAGA1P,UACC;AAAA6uB,aAAKH;AAAL;AAJD,KADD;AAOA,WAAO,KAACvrB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AARmC,GCqEnC;;AAcAqiB,SAAOve,SAAP,CDzEDgjB,2CCyEC,GDzE4C,UAACpf,MAAD,EAASgf,SAAT,EAAoB1mB,OAApB;AAC5C,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAEA7G,WAAKjC,MAFL;AAGA1P,UACC;AAAA+uB,cAAML;AAAN;AAJD,KADD;AAOA,WAAO,KAACvrB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAR4C,GCyE5C;;AAcAqiB,SAAOve,SAAP,CD7EDkjB,oCC6EC,GD7EqC,UAACtf,MAAD,EAASuf,cAAT,EAAyBC,eAAzB,EAA0ClnB,OAA1C;AACrC,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAEA7G,WAAKjC,MAFL;AAGA1P,UACC;AAAA2uB,aAAKM,cAAL;AACAJ,aAAKK;AADL;AAJD,KADD;AAQA,WAAO,KAAC/rB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AATqC,GC6ErC;;AAeAqiB,SAAOve,SAAP,CDjFDqjB,6CCiFC,GDjF8C,UAACzf,MAAD,EAASuf,cAAT,EAAyBC,eAAzB,EAA0ClnB,OAA1C;AAC9C,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAEA7G,WAAKjC,MAFL;AAGA1P,UACC;AAAAovB,cAAMH,cAAN;AACAF,cAAMG;AADN;AAJD,KADD;AAQA,WAAO,KAAC/rB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAT8C,GCiF9C;;AAeAqiB,SAAOve,SAAP,CDrFDujB,oDCqFC,GDrFqD,UAAC3f,MAAD,EAASgf,SAAT,EAAoB/kB,KAApB,EAA2B3B,OAA3B;AACrD,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAEA7G,WAAKjC,MAFL;AAGA1P,UACC;AAAA6uB,aAAKH;AAAL;AAJD,KADD;;AAOA,QAAG/K,MAAMhjB,IAAN,CAAWgJ,KAAX,EAAkB,CAACnF,MAAD,CAAlB,KAAgCmF,MAAMjG,MAAN,GAAe,CAAlD;AACCiN,YAAM9G,CAAN,GACC;AAAA0kB,cAAM5kB;AAAN,OADD;AC2FE;;ADxFH,WAAO,KAACxG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAZqD,GCqFrD;;AAmBAqiB,SAAOve,SAAP,CD1FDwjB,sDC0FC,GD1FuD,UAAC5f,MAAD,EAASuf,cAAT,EAAyBC,eAAzB,EAA0CvlB,KAA1C,EAAiD3B,OAAjD;AACvD,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eACC;AAAArF,aAAK;AAAL,OADD;AAEA7G,WAAKjC,MAFL;AAGA1P,UACC;AAAA2uB,aAAKM,cAAL;AACAJ,aAAKK;AADL;AAJD,KADD;;AAQA,QAAGvL,MAAMhjB,IAAN,CAAWgJ,KAAX,EAAkB,CAACnF,MAAD,CAAlB,KAAgCmF,MAAMjG,MAAN,GAAe,CAAlD;AACCiN,YAAM9G,CAAN,GACC;AAAA0kB,cAAM5kB;AAAN,OADD;ACgGE;;AD7FH,WAAO,KAACxG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAbuD,GC0FvD;;AAoBAqiB,SAAOve,SAAP,CD/FDyjB,wCC+FC,GD/FyC,UAACb,SAAD,EAAY1mB,OAAZ;AACzC,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eAAS;AAAErF,aAAK;AAAP,OAAT;AACAkI,WAAK,CACJ;AAAA1gB,YACC;AAAA2uB,eAAKD;AAAL;AADD,OADI,EAIJ;AAAA,oBACC;AAAAC,eAAKD;AAAL;AADD,OAJI;AADL,KADD;AAUA,WAAO,KAACvrB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAXyC,GC+FzC;;AAqBAqiB,SAAOve,SAAP,CDvGD0jB,uBCuGC,GDvGwB,UAAClnB,MAAD,EAASoH,MAAT,EAAiB1H,OAAjB;AACxB,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eAAS;AAAErF,aAAK;AAAP,OAAT;AACA,qBAAelQ,MADf;AAEAqJ,WAAKjC;AAFL,KADD;AAKA,WAAO,KAACvM,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AANwB,GCuGxB;;AAYAqiB,SAAOve,SAAP,CD3GD2jB,gBC2GC,GD3GiB,UAAC/f,MAAD,EAAS1H,OAAT;AACjB,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG;AAAE2O,aAAK;AAAP,OAAH;AACAqF,eAAS;AAAErF,aAAK;AAAP,OADT;AAEAkX,cAAQ,IAFR;AAGA/d,WAAKjC;AAHL,KADD;AAMA,WAAO,KAACvM,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAPiB,GC2GjB;;AAeAqiB,SAAOve,SAAP,CDjHD6jB,mBCiHC,GDjHoB,UAACjgB,MAAD,EAAS1H,OAAT;AACpB,QAAA2I,KAAA;AAAAA,YACC;AAAAkN,eAAS;AAAErF,aAAK;AAAP,OAAT;AACAoX,iBAAW,IADX;AAEAje,WAAKjC;AAFL,KADD;AAKA,WAAO,KAACvM,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AANoB,GCiHpB;;AAYAqiB,SAAOve,SAAP,CDrHD+jB,gBCqHC,GDrHiB,UAAC7nB,OAAD;AACjB,QAAA2I,KAAA,EAAAqT,GAAA,EAAAC,IAAA,EAAAO,IAAA;;ACsHE,QAAIxc,WAAW,IAAf,EAAqB;ADvHLA,gBAAU,EAAV;ACyHf;;ADxHH2I,YAAQ;AAAE3Q,UAAI;AAAE+lB,iBAAS;AAAX;AAAN,KAAR;AACA/d,YAAQ2X,IAAR,GAAe;AAAE3f,UAAI,CAAC;AAAP,KAAf;AACAgI,YAAQgX,KAAR,GAAgB,CAAhB;AAEA,YAAAgF,MAAA,KAAA7gB,IAAA,CAAAwN,KAAA,EAAA3I,OAAA,oBAAAgc,IAAAlR,KAAA,mBAAAmR,OAAAD,IAAAlR,KAAA,eAAA0R,OAAAP,KAAA,cAAAO,KAA4CxkB,EAA5C,GAA4C,MAA5C,GAA4C,MAA5C,GAA4C,MAA5C,GAA4C,MAA5C;AALiB,GCqHjB;;AAiBAqqB,SAAOve,SAAP,CD/HDgkB,yBC+HC,GD/H0B,UAACne,GAAD,EAAMoe,UAAN,EAAkB/nB,OAAlB;AAC1B,QAAA2I,KAAA;AAAAA,YACC;AAAAgB,WAAKA,GAAL;AACAzR,WACC;AAAA8X,aAAK+X;AAAL;AAFD,KADD;AAKA,WAAO,KAAC5sB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAN0B,GC+H1B;;AAWAqiB,SAAOve,SAAP,CDlIDkkB,6BCkIC,GDlI8B,UAACC,UAAD,EAAaC,OAAb;AAC9B,QAAAvf,KAAA;AAAAA,YACC;AAAAsf,kBAAYA,UAAZ;AACAC,eAASA;AADT,KADD;AAIA,WAAO,KAAC/Y,OAAD,CAASxG,KAAT,CAAP;AAL8B,GCkI9B;;AASA0Z,SAAOve,SAAP,CDpIDqkB,gBCoIC,GDpIiB,UAACD,OAAD;AACjB,QAAAvf,KAAA;AAAAA,YACC;AAAAuf,eAASA;AAAT,KADD;AAGA,WAAO,KAAC/Y,OAAD,CAASxG,KAAT,CAAP;AAJiB,GCoIjB;;AAQA0Z,SAAOve,SAAP,CDtIDyR,yBCsIC,GDtI0B,UAACrd,GAAD;AAC1B,QAAAkwB,EAAA,EAAAvJ,MAAA;AAAAuJ,SAAK3xB,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCjW,OAAO2I,MAAP,EAApC,CAAL;AACAue,aAAS,KAACjR,WAAD,CAAa1V,GAAb,CAAT;AACA2mB,WAAOhJ,OAAP,GAAiB,IAAjB;AACAgJ,WAAO+G,MAAP,GAAgB/G,OAAO3mB,GAAvB;AACA2mB,WAAOvV,QAAP,GAAkB,IAAIrR,IAAJ,EAAlB;AACA4mB,WAAOsD,QAAP,GACC;AAAAjqB,WAAKP,OAAO2I,MAAP,EAAL;AACAkB,gBAAU4mB,GAAG5mB;AADb,KADD;AAGA,WAAOqd,OAAO3mB,GAAd;AACA,WAAO,KAAC2jB,MAAD,CAAQgD,MAAR,CAAP;AAV0B,GCsI1B;;AAeAwD,SAAOve,SAAP,CDxID0R,aCwIC,GDxIc,UAACtd,GAAD,EAAM8kB,MAAN;AACd,QAAArU,KAAA,EAAAgN,MAAA;;ACyIE,QAAIqH,UAAU,IAAd,EAAoB;AD1IFA,eAAO,IAAP;AC4IjB;;AD3IHrU,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAC,iBAASmH;AAAT;AADD,KADD;AAIA,WAAO,KAACrH,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARc,GCwId;;AAgBA0M,SAAOve,SAAP,CD9IDmS,uBC8IC,GD9IwB,UAAC/d,GAAD,EAAMqK,IAAN;AACxB,QAAAoG,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAnV,aAAK,EAAL;AACAoB,WAAG,IADH;AAEA4Z,cAAM,EAFN;AAGA1Q,kBAAU,EAHV;AAIAsd,qBAAa,EAJb;AAKAC,mBAAW,EALX;AAMAhf,kBAAc,IAAArR,IAAA,EANd;AAOAkqB,kBACC;AAAAjqB,eAAKqK,KAAKrK,GAAV;AACAsJ,oBAAUe,KAAKf;AADf;AARD;AADD,KADD;AAaA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAjBwB,GC8IxB;;AAuBA0M,SAAOve,SAAP,CDlJDykB,sBCkJC,GDlJuB,UAACrwB,GAAD,EAAMswB,QAAN,EAAgBd,MAAhB,EAA6Be,QAA7B;AACvB,QAAA9f,KAAA,EAAAgN,MAAA;;ACmJE,QAAI+R,UAAU,IAAd,EAAoB;ADpJiBA,eAAO,IAAP;ACsJpC;;AACD,QAAIe,YAAY,IAAhB,EAAsB;ADvJ4BA,iBAAS,CAAT;ACyJjD;;ADxJH9f,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAA8R,gBAAQA,MAAR;AACAe,kBAAUA,YAAY,IAAIxwB,IAAJ,EADtB;AAEAuwB,kBAAUA;AAFV;AADD,KADD;AAMA,WAAO,KAAC7S,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAVuB,GCkJvB;;AAqBA0M,SAAOve,SAAP,CD3JD4kB,yBC2JC,GD3J0B,UAACxnB,OAAD,EAAUynB,WAAV,EAAuBC,WAAvB,EAAoChB,SAApC,EAAoDiB,WAApD;AAC1B,QAAApoB,GAAA,EAAAkI,KAAA,EAAAgN,MAAA;;AC4JE,QAAIiS,aAAa,IAAjB,EAAuB;AD7JqCA,kBAAU,IAAV;AC+J3D;;AACD,QAAIiB,eAAe,IAAnB,EAAyB;ADhKmDA,oBAAY,CAAZ;ACkK3E;;ADjKHlgB,YACC;AAAAzQ,WAAKgJ,QAAQhJ;AAAb,KADD;AAGAuI,UAAM,QAAQS,QAAQT,GAAhB,GAAsB,KAA5B;AAEAkV,aACC;AAAAC,YACC;AAAAnV,aAAKA,GAAL;AACAmnB,mBAAWA,SADX;AAEAiB,qBAAaA,eAAe,IAAI5wB,IAAJ,EAF5B;AAGA2wB,qBAAaA,WAHb;AAIAD,qBAAaA;AAJb;AADD,KADD;AAQA,WAAO,KAAChT,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAd0B,GC2J1B;;AAwBA0M,SAAOve,SAAP,CDnKDglB,WCmKC,GDnKY,UAAC5wB,GAAD,EAAMujB,IAAN;AACZ,QAAA9S,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAA6F,cAAMA;AAAN;AADD,KADD;AAIA,WAAO,KAAC9F,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARY,GCmKZ;;AAaA0M,SAAOve,SAAP,CDtKDkd,0BCsKC,GDtK2B,UAAC1gB,MAAD,EAASkB,QAAT;AAC3B,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAA,eAASrI;AAAT,KADD;AAGAqV,aACC;AAAAC,YACC;AAAA,sBAAcpU;AAAd;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAR2B,GCsK3B;;AAeA1G,SAAOve,SAAP,CD3KDmd,4BC2KC,GD3K6B,UAAC3gB,MAAD,EAASkB,QAAT;AAC7B,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAA,sBAAgBrI;AAAhB,KADD;AAGAqV,aACC;AAAAC,YACC;AAAA,6BAAqBpU;AAArB;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAR6B,GC2K7B;;AAeA1G,SAAOve,SAAP,CDhLDsd,mDCgLC,GDhLoD,UAAClpB,GAAD,EAAM8wB,WAAN,EAAmBC,WAAnB,EAAgCC,UAAhC;AACpD,QAAAvgB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA,GAAL;AACA,2BAAqB8wB;AADrB,KADD;AAIArT,aACC;AAAAC,YACC;AAAA,+BAAuBqT,WAAvB;AACA,eAAOC;AADP;AADD,KADD;AAKA,WAAO,KAACvT,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAVoD,GCgLpD;;AAeA0M,SAAOve,SAAP,CDnLDqlB,kBCmLC,GDnLmB,UAACjxB,GAAD,EAAMoI,MAAN,EAAc8oB,OAAd;AACnB,QAAAzgB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;;AAGA,QAAGkxB,OAAH;AACCzT,eACC;AAAAyF,mBACC;AAAAgO,mBAAS;AAAElxB,iBAAKoI;AAAP;AAAT;AADD,OADD;AADD;AAKCqV,eACC;AAAA0T,eACC;AAAAD,mBAAS;AAAElxB,iBAAKP,OAAO2I,MAAP;AAAP;AAAT;AADD,OADD;AC+LE;;AD3LH,WAAO,KAACqV,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAbmB,GCmLnB;;AAyBA0M,SAAOve,SAAP,CD7LDwlB,kBC6LC,GD7LmB;AACnB,QAAA3gB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAA4gB,WAAK;AAAExL,iBAAS;AAAX;AAAL,KADD;AAGApI,aACC;AAAA6T,eACC;AAAA,eAAO;AAAP;AADD,KADD;AAIA,WAAO,KAAC7T,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AARmB,GC6LnB;;AAiBA1G,SAAOve,SAAP,CDpMD2lB,qBCoMC,GDpMsB,UAACvxB,GAAD,EAAMmwB,WAAN;AACtB,QAAA1f,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAyS,qBAAaA;AAAb;AADD,KADD;AAIA,WAAO,KAAC1S,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARsB,GCoMtB;;AAaA0M,SAAOve,SAAP,CDvMD4lB,uBCuMC,GDvMwB,UAACxxB,GAAD,EAAM+vB,UAAN,EAAkBC,OAAlB;AACxB,QAAAvf,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAqS,oBAAYA,UAAZ;AACAC,iBAASA;AADT;AADD,KADD;AAKA,WAAO,KAACvS,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AATwB,GCuMxB;;AAcA0M,SAAOve,SAAP,CDxMD6lB,kCCwMC,GDxMmC,UAAC7sB,IAAD,EAAO4K,MAAP,EAAexG,OAAf,EAAwBqB,IAAxB,EAA8B+R,SAA9B;AACnC,QAAAuK,MAAA,EAAAxV,IAAA;AAAAA,WAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoClG,MAApC,EAA4C;AAAEmD,cAAQ;AAAE8J,gBAAQ;AAAV;AAAV,KAA5C,CAAP;;AACA,SAAAtL,QAAA,OAAGA,KAAMsL,MAAT,GAAS,MAAT,MAAmB,KAAnB;AACC;AC8ME;;AD7MHkK,aACC;AAAAhd,SAAG/E,IAAH;AACA6M,WAAKjC,MADL;AAEA1P,UAAI,IAAIC,IAAJ,EAFJ;AAGAwI,WAAKS,OAHL;AAIAK,SACC;AAAArJ,aAAKqK,KAAKrK,GAAV;AACAsJ,kBAAUe,KAAKf;AADf,OALD;AAOAooB,iBAAW;AAPX,KADD;;AAUA5yB,MAAEkgB,MAAF,CAAS2H,MAAT,EAAiBvK,SAAjB;;AAEAuK,WAAO3mB,GAAP,GAAa,KAAC+sB,cAAD,CAAgBpG,MAAhB,CAAb;AACApoB,eAAWC,MAAX,CAAkB+S,KAAlB,CAAwBC,eAAxB,CAAwCL,KAAKnR,GAA7C,EAAkD,CAAlD;AACA,WAAO2mB,MAAP;AAlBmC,GCwMnC;;AA2BAwD,SAAOve,SAAP,CD/MDqP,+BC+MC,GD/MgC,UAACzL,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AAChC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,IAApC,EAA0CjiB,MAA1C,EAAkDxG,OAAlD,EAA2DqB,IAA3D,EAAiE+R,SAAjE,CAAP;AAFgC,GC+MhC;;AAMA+N,SAAOve,SAAP,CDjNDiV,gCCiNC,GDjNiC,UAACrR,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AACjC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,IAApC,EAA0CjiB,MAA1C,EAAkDxG,OAAlD,EAA2DqB,IAA3D,EAAiE+R,SAAjE,CAAP;AAFiC,GCiNjC;;AAMA+N,SAAOve,SAAP,CDnND+lB,kCCmNC,GDnNmC,UAACniB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AACnC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,IAApC,EAA0CjiB,MAA1C,EAAkDxG,OAAlD,EAA2DqB,IAA3D,EAAiE+R,SAAjE,CAAP;AAFmC,GCmNnC;;AAMA+N,SAAOve,SAAP,CDrNDwP,gCCqNC,GDrNiC,UAAC5L,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AACjC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,IAApC,EAA0CjiB,MAA1C,EAAkDxG,OAAlD,EAA2DqB,IAA3D,EAAiE+R,SAAjE,CAAP;AAFiC,GCqNjC;;AAMA+N,SAAOve,SAAP,CDvNDkV,8BCuNC,GDvN+B,UAACjZ,OAAD,EAAU2H,MAAV,EAAkBnF,IAAlB,EAAwB+R,SAAxB;AAC/B,WAAO,KAACqV,kCAAD,CAAoC,SAApC,EAA+CjiB,MAA/C,EAAuD3H,OAAvD,EAAgEwC,IAAhE,EAAsE+R,SAAtE,CAAP;AAD+B,GCuN/B;;AAIA+N,SAAOve,SAAP,CDxNDgmB,gCCwNC,GDxNiC,UAACpiB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AACjC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,YAApC,EAAkDjiB,MAAlD,EAA0DxG,OAA1D,EAAmEqB,IAAnE,EAAyE+R,SAAzE,CAAP;AAFiC,GCwNjC;;AAMA+N,SAAOve,SAAP,CD1NDimB,kCC0NC,GD1NmC,UAACriB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AACnC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,cAApC,EAAoDjiB,MAApD,EAA4DxG,OAA5D,EAAqEqB,IAArE,EAA2E+R,SAA3E,CAAP;AAFmC,GC0NnC;;AAMA+N,SAAOve,SAAP,CD5NDkmB,mCC4NC,GD5NoC,UAACtiB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AACpC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,eAApC,EAAqDjiB,MAArD,EAA6DxG,OAA7D,EAAsEqB,IAAtE,EAA4E+R,SAA5E,CAAP;AAFoC,GC4NpC;;AAMA+N,SAAOve,SAAP,CD9NDmmB,uCC8NC,GD9NwC,UAACviB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AACxC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,mBAApC,EAAyDjiB,MAAzD,EAAiExG,OAAjE,EAA0EqB,IAA1E,EAAgF+R,SAAhF,CAAP;AAFwC,GC8NxC;;AAMA+N,SAAOve,SAAP,CDhODomB,+BCgOC,GDhOgC,UAACxiB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AAChC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,WAApC,EAAiDjiB,MAAjD,EAAyDxG,OAAzD,EAAkEqB,IAAlE,EAAwE+R,SAAxE,CAAP;AAFgC,GCgOhC;;AAMA+N,SAAOve,SAAP,CDlODqmB,mCCkOC,GDlOoC,UAACziB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AACpC,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,eAApC,EAAqDjiB,MAArD,EAA6DxG,OAA7D,EAAsEqB,IAAtE,EAA4E+R,SAA5E,CAAP;AAFoC,GCkOpC;;AAMA+N,SAAOve,SAAP,CDpODsmB,4CCoOC,GDpO6C,UAAC1iB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AAC7C,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,yBAApC,EAA+DjiB,MAA/D,EAAuExG,OAAvE,EAAgFqB,IAAhF,EAAsF+R,SAAtF,CAAP;AAF6C,GCoO7C;;AAMA+N,SAAOve,SAAP,CDtODumB,8CCsOC,GDtO+C,UAAC3iB,MAAD,EAASnF,IAAT,EAAe+R,SAAf;AAC/C,QAAApT,OAAA;AAAAA,cAAUqB,KAAKf,QAAf;AACA,WAAO,KAACmoB,kCAAD,CAAoC,2BAApC,EAAiEjiB,MAAjE,EAAyExG,OAAzE,EAAkFqB,IAAlF,EAAwF+R,SAAxF,CAAP;AAF+C,GCsO/C;;AAMA+N,SAAOve,SAAP,CDvODgS,UCuOC,GDvOW,UAAC5d,GAAD;AACX,QAAAyQ,KAAA;AAAAA,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGA,WAAO,KAACmD,MAAD,CAAQsN,KAAR,CAAP;AAJW,GCuOX;;AAQA0Z,SAAOve,SAAP,CDzODwS,cCyOC,GDzOe,UAAC5O,MAAD;AACf,QAAAiB,KAAA;AAAAA,YACC;AAAAgB,WAAKjC;AAAL,KADD;AAGA,WAAO,KAACrM,MAAD,CAAQsN,KAAR,CAAP;AAJe,GCyOf;;AAQA0Z,SAAOve,SAAP,CD3ODsS,cC2OC,GD3Oe,UAAC9V,MAAD;AACf,QAAAqI,KAAA;AAAAA,YACC;AAAA,eAASrI;AAAT,KADD;AAGA,WAAO,KAACjF,MAAD,CAAQsN,KAAR,CAAP;AAJe,GC2Of;;AAQA0Z,SAAOve,SAAP,CD7ODwmB,kBC6OC,GD7OmB,UAACC,MAAD;AACnB,WAAO,KAACpb,OAAD,CAAS;AAAE,kBAAYob;AAAd,KAAT,CAAP;AADmB,GC6OnB;;AAMA,SAAOlI,MAAP;AAED,CDjsB4B,CAAkB5rB,WAAWC,MAAX,CAAkBgvB,KAApC,IAA7B,gG;;;;;;;;;;;;;;;;;;;;;;;;;AEAAjvB,WAAWC,MAAX,CAAkB8zB,OAAlB,GAA4B;AAAA;;AAC3B,mBAAc;AAAA;AAAA,wDACb,iCAAM,SAAN,CADa;AAEb;;AAH0B,kBAI3BC,qCAJ2B;AAAA,iDAIWvpB,OAJX,EAIoBhB,WAJpB,EAIiCI,MAJjC,EAIyCgU,SAJzC,EAIoD;AAC9E,OAAMuK,SAAS;AACd3d,oBADc;AAEdhB,4BAFc;AAGdlI,QAAI,IAAIC,IAAJ,EAHU;AAIdqI;AAJc,IAAf;;AAMAtJ,KAAEkgB,MAAF,CAAS2H,MAAT,EAAiBvK,SAAjB;;AACAuK,UAAO3mB,GAAP,GAAa,KAAK2jB,MAAL,CAAYgD,MAAZ,CAAb;AACA,UAAOA,MAAP;AACA;;AAd0B;AAAA;;AAAA;AAAA,EAAkBpoB,WAAWC,MAAX,CAAkBgvB,KAApC,IAA5B,8F;;;;;;;;;;;;ACAA,IAAAgF,UAAA;AAAA,IAAAxT,SAAA,UAAAyO,KAAA,EAAAC,MAAA;AAAA,WAAAntB,GAAA,2CAAAmtB,MAAA;AAAA,QAAAC,QAAA7sB,IAAA,CAAA4sB,MAAA,EAAAntB,GAAA,GAAAktB,MAAAltB,GAAA,IAAAmtB,OAAAntB,GAAA;AAAA;;AAAA,WAAAqtB,IAAA;AAAA,SAAApB,WAAA,GAAAiB,KAAA;AAAA;;AAAAG,OAAAhiB,SAAA,GAAA8hB,OAAA9hB,SAAA;AAAA6hB,QAAA7hB,SAAA,OAAAgiB,IAAA;AAAAH,QAAAI,SAAA,GAAAH,OAAA9hB,SAAA;AAAA,SAAA6hB,KAAA;AAAA;AAAA,ICEEE,UAAU,GAAGG,cDFf;;AAAM0E,aAAA,UAAAzE,UAAA;ACKJ/O,SAAOwT,UAAP,EAAmBzE,UAAnB;;ADJY,WAAAyE,UAAA;AACZA,eAAA3E,SAAA,CAAArB,WAAA,CAAAzgB,KAAA,OAAMD,SAAN;;AAEA,SAACshB,cAAD,CAAgB;AAAE,cAAQ;AAAV,KAAhB,EAA+B;AAAEja,cAAQ,CAAV;AAAa6a,cAAQ;AAArB,KAA/B;AACA,SAACZ,cAAD,CAAgB;AAAE,iBAAW;AAAb,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,mBAAa;AAAf,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,WAAK;AAAP,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,eAAS;AAAX,KAAhB;AAEA,SAAKhB,KAAL,CAAWqG,mBAAX,CAA+B7xB,IAA/B,CAAoC,MAApC,EAA4C,IAA5C;AACA,SAAKwrB,KAAL,CAAWc,WAAX,CAAuB,CAAC,GAAD,EAAM,MAAN,CAAvB,EAAsC,QAAtC;AACA,SAAKd,KAAL,CAAWtkB,OAAX,GAAqB;AAAC6K,cAAQ;AAACD,mBAAW;AAAZ;AAAT,KAArB;AAXY;;ACmCZ8f,aAAW5mB,SAAX,CDtBD0U,iBCsBC,GDtBkB,UAACoS,SAAD,EAAY5qB,OAAZ;AAClB,QAAA2I,KAAA;AAAAA,YAAQ;AACP+P,WAAK,CAAC;AACLxgB,aAAK0yB;AADA,OAAD,EAEF;AACFzwB,cAAMywB;AADJ,OAFE;AADE,KAAR;AAQA,WAAO,KAAKzb,OAAL,CAAaxG,KAAb,EAAoB3I,OAApB,CAAP;AATkB,GCsBlB;;AAcA0qB,aAAW5mB,SAAX,CDzBD+mB,iBCyBC,GDzBkB,UAAC3yB,GAAD,EAAM8H,OAAN;AAClB,QAAA2I,KAAA;AAAAA,YACC;AAAAmiB,iBAAW5yB;AAAX,KADD;AAGA,WAAO,KAACiX,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AAJkB,GCyBlB;;AAQA0qB,aAAW5mB,SAAX,CD3BD2Q,aC2BC,GD3Bc,UAACta,IAAD,EAAO6F,OAAP;AACd,QAAA2I,KAAA;AAAAA,YACC;AAAAxO,YAAMA;AAAN,KADD;AAGA,WAAO,KAACgV,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AAJc,GC2Bd;;AAQA0qB,aAAW5mB,SAAX,CD7BDinB,oBC6BC,GD7BqB,UAAC5wB,IAAD,EAAO2C,IAAP,EAAakD,OAAb;AACrB,QAAA2I,KAAA;AAAAA,YACC;AAAAxO,YAAMA,IAAN;AACA0H,SAAG/E;AADH,KADD;AAIA,WAAO,KAACqS,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AALqB,GC6BrB;;AASA0qB,aAAW5mB,SAAX,CD/BDknB,6BC+BC,GD/B8B,UAAC9yB,GAAD,EAAMsJ,QAAN,EAAgBxB,OAAhB;AAC9B,QAAA2I,KAAA;AAAAA,YACC;AAAAzQ,WAAKA,GAAL;AACA0S,iBAAWpJ;AADX,KADD;AAIA,WAAO,KAAC2N,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AAL8B,GC+B9B;;AASA0qB,aAAW5mB,SAAX,CDjCDmnB,yCCiCC,GDjC0C,UAAC9wB,IAAD,EAAO2C,IAAP,EAAa0E,QAAb,EAAuBxB,OAAvB;AAC1C,QAAA2I,KAAA;AAAAA,YACC;AAAAxO,YAAMA,IAAN;AACA0H,SAAG/E,IADH;AAEA8N,iBACC;AAAA4F,aAAKhP;AAAL;AAHD,KADD;AAMA,WAAO,KAAC2N,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AAP0C,GCiC1C;;AAYA0qB,aAAW5mB,SAAX,CDjCDonB,QCiCC,GDjCS,UAACxjB,MAAD,EAAS1H,OAAT;AACT,WAAO,KAAC7E,IAAD,CAAM;AAAEjD,WAAKwP;AAAP,KAAN,EAAuB1H,OAAvB,CAAP;AADS,GCiCT;;AAMA0qB,aAAW5mB,SAAX,CDpCDqnB,SCoCC,GDpCU,UAACC,OAAD,EAAUprB,OAAV;AACV,WAAO,KAAC7E,IAAD,CAAM;AAAEjD,WAAK;AAAA8X,aAAK,GAAG/V,MAAH,CAAUmxB,OAAV;AAAL;AAAP,KAAN,EAAuCprB,OAAvC,CAAP;AADU,GCoCV;;AAQA0qB,aAAW5mB,SAAX,CDzCDunB,UCyCC,GDzCW,UAACvuB,IAAD,EAAOkD,OAAP;AACX,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E;AAAH,KADD;AAGA,WAAO,KAAC3B,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJW,GCyCX;;AAQA0qB,aAAW5mB,SAAX,CD3CDwnB,WC2CC,GD3CY,UAAC3pB,KAAD,EAAQ3B,OAAR;AACZ,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SACC;AAAAmO,aAAKrO;AAAL;AADD,KADD;AAIA,WAAO,KAACxG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AALY,GC2CZ;;AAUA0qB,aAAW5mB,SAAX,CD9CDuS,YC8CC,GD9Ca,UAAC/V,MAAD,EAASN,OAAT;AACb,QAAA2I,KAAA;AAAAA,YACC;AAAA,eAASrI;AAAT,KADD;AAGA,WAAO,KAACnF,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJa,GC8Cb;;AAQA0qB,aAAW5mB,SAAX,CDhDDynB,wBCgDC,GDhDyB,UAACjrB,MAAD,EAASN,OAAT;AACzB,QAAAxC,IAAA,EAAAmL,KAAA;;AAAA,QAAG,KAAKsb,QAAR;AACCzmB,aAAO/G,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCgM,YAAhC,CAA6C/V,MAA7C,EAAqDwK,KAArD,EAAP;AACAtN,aAAOA,KAAKlE,GAAL,CAAS,UAACO,IAAD;AACf,YAAGA,KAAK2xB,KAAR;AACC,iBAAO3xB,KAAK2xB,KAAZ;ACkDI;;ADjDLlvB,gBAAQC,GAAR,CAAY,6BAAZ,EAA2C1C,IAA3C;AACA,eAAO,EAAP;AAJM,QAAP;AAKA,aAAO,KAAK8qB,aAAL,CAAmB,KAAKF,2BAAL,CAAiCjnB,IAAjC,EAAuCwC,OAAvC,CAAnB,CAAP;ACoDE;;ADlDHxC,WAAO/G,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCgM,YAAhC,CAA6C/V,MAA7C,EAAqD;AAACuK,cAAQ;AAAClB,aAAK;AAAN;AAAT,KAArD,EAAyEmB,KAAzE,EAAP;AACAtN,WAAOA,KAAKlE,GAAL,CAAS,UAACO,IAAD;ACwDZ,aDxDsBA,KAAK8P,GCwD3B;ADxDG,MAAP;AAEAhB,YACC;AAAAzQ,WACC;AAAA8X,aAAKxS;AAAL;AADD,KADD;AC6DE,WDzDF,KAAKrC,IAAL,CAAUwN,KAAV,EAAiB3I,OAAjB,CCyDE;AD1EuB,GCgDzB;;AA6BA0qB,aAAW5mB,SAAX,CD1DD2nB,oCC0DC,GD1DqC,UAACnrB,MAAD,EAASorB,UAAT,EAAqB1rB,OAArB;AACrC,QAAAxC,IAAA,EAAAwnB,GAAA,EAAArc,KAAA;;AAAA,QAAG,KAAKsb,QAAR;AACCzmB,aAAO/G,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCgM,YAAhC,CAA6C/V,MAA7C,EAAqDwK,KAArD,EAAP;AACAtN,aAAOA,KAAKlE,GAAL,CAAS,UAACO,IAAD;AACf,YAAGA,KAAK2xB,KAAR;AACC,iBAAO3xB,KAAK2xB,KAAZ;AC4DI;;AD3DLlvB,gBAAQC,GAAR,CAAY,6BAAZ,EAA2C1C,IAA3C;AACA,eAAO,EAAP;AAJM,QAAP;AAKA2D,aAAOA,KAAKL,MAAL,CAAY,UAACtD,IAAD;AC8Dd,eD9DwBA,KAAK6xB,UAAL,GAAkBA,UC8D1C;AD9DE,QAAP;AACA,aAAO,KAAK/G,aAAL,CAAmB,KAAKF,2BAAL,CAAiCjnB,IAAjC,EAAuCwC,OAAvC,CAAnB,CAAP;ACgEE;;AD9DHglB,UAAMvuB,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCgM,YAAhC,CAA6C/V,MAA7C,EAAqD;AAACuK,cAAQ;AAAClB,aAAK;AAAN;AAAT,KAArD,EAAyEmB,KAAzE,EAAN;AACAka,UAAMA,IAAI1rB,GAAJ,CAAQ,UAACO,IAAD;ACoEV,aDpEoBA,KAAK8P,GCoEzB;ADpEE,MAAN;AAEAhB,YACC;AAAAzQ,WACC;AAAA8X,aAAKgV;AAAL,OADD;AAEA0G,kBACC;AAAA/E,aAAK+E;AAAL;AAHD,KADD;AC4EE,WDtEF,KAAKvwB,IAAL,CAAUwN,KAAV,EAAiB3I,OAAjB,CCsEE;AD1FmC,GC0DrC;;AAmCA0qB,aAAW5mB,SAAX,CDvED6nB,oBCuEC,GDvEqB,UAACxxB,IAAD,EAAO6F,OAAP;AACrB,QAAA4rB,SAAA,EAAAjjB,KAAA;AAAAijB,gBAAgB,IAAA1hB,MAAA,CAAOC,EAAEjT,IAAF,CAAOiT,EAAEC,YAAF,CAAejQ,IAAf,CAAP,CAAP,EAAqC,GAArC,CAAhB;AAEAwO,YACC;AAAA+P,WAAK,CACJ;AAAAve,cAAMyxB;AAAN,OADI,EAGJ;AAAA/pB,WAAG,GAAH;AACA+I,mBAAWghB;AADX,OAHI;AAAL,KADD;AAQA,WAAO,KAACzwB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAXqB,GCuErB;;AAgBA0qB,aAAW5mB,SAAX,CD1ED+nB,qCC0EC,GD1EsC,UAAC1xB,IAAD,EAAOwH,KAAP,EAAc3B,OAAd;AACtC,QAAA0Y,GAAA,EAAA7Q,CAAA,EAAAgM,GAAA,EAAA+X,SAAA,EAAAE,GAAA,EAAAnjB,KAAA,EAAA7L,IAAA;AAAA8uB,gBAAgB,IAAA1hB,MAAA,CAAOC,EAAEjT,IAAF,CAAOiT,EAAEC,YAAF,CAAejQ,IAAf,CAAP,CAAP,EAAqC,GAArC,CAAhB;AAEAue,UAAM,EAAN;;AACA,SAAA7Q,IAAA,GAAAgM,MAAAlS,MAAAjG,MAAA,EAAAmM,IAAAgM,GAAA,EAAAhM,GAAA;AC2EI/K,aAAO6E,MAAMkG,CAAN,CAAP;AD1EHikB,YAAM;AAAC3xB,cAAMyxB,SAAP;AAAkB/pB,WAAG/E,KAAKA;AAA1B,OAAN;;AACA,UAAGA,KAAA0E,QAAA,QAAH;AACCsqB,YAAIlhB,SAAJ,GAAgB9N,KAAK0E,QAArB;AC+EG;;AD9EJ,UAAG1E,KAAAkoB,GAAA,QAAH;AACC8G,YAAI5zB,GAAJ,GAAU;AAAA8X,eAAKlT,KAAKkoB;AAAV,SAAV;ACkFG;;ADjFJtM,UAAI5f,IAAJ,CAASgzB,GAAT;AAND;;AAQAnjB,YACC;AAAA+P,WAAKA;AAAL,KADD;AAGA,WAAO,KAACvd,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAfsC,GC0EtC;;AA0BA0qB,aAAW5mB,SAAX,CDnFDioB,+BCmFC,GDnFgC,UAACpqB,KAAD,EAAQ3B,OAAR;AAEhC,QAAA0Y,GAAA,EAAA7Q,CAAA,EAAAgM,GAAA,EAAAiY,GAAA,EAAAnjB,KAAA,EAAA7L,IAAA;AAAA4b,UAAM,EAAN;;AACA,SAAA7Q,IAAA,GAAAgM,MAAAlS,MAAAjG,MAAA,EAAAmM,IAAAgM,GAAA,EAAAhM,GAAA;ACoFI/K,aAAO6E,MAAMkG,CAAN,CAAP;ADnFHikB,YAAM;AAACjqB,WAAG/E,KAAKA;AAAT,OAAN;;AACA,UAAGA,KAAA0E,QAAA,QAAH;AACCsqB,YAAIlhB,SAAJ,GAAgB9N,KAAK0E,QAArB;ACuFG;;ADtFJ,UAAG1E,KAAAkoB,GAAA,QAAH;AACC8G,YAAI5zB,GAAJ,GAAU;AAAA8X,eAAKlT,KAAKkoB;AAAV,SAAV;AC0FG;;ADzFJtM,UAAI5f,IAAJ,CAASgzB,GAAT;AAND;;AAQAnjB,YACC;AAAA+P,WAAKA;AAAL,KADD;AAGA,WAAO,KAACvd,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAdgC,GCmFhC;;AAwBA0qB,aAAW5mB,SAAX,CD3FDkoB,4BC2FC,GD3F6B,UAAC7xB,IAAD,EAAOwH,KAAP,EAAc3B,OAAd;AAC7B,QAAA4rB,SAAA,EAAAjjB,KAAA;AAAAijB,gBAAgB,IAAA1hB,MAAA,CAAOC,EAAEjT,IAAF,CAAOiT,EAAEC,YAAF,CAAejQ,IAAf,CAAP,CAAP,EAAqC,GAArC,CAAhB;AAEAwO,YACC;AAAA9G,SACC;AAAAmO,aAAKrO;AAAL,OADD;AAEA+W,WAAK,CACJ;AAAAve,cAAMyxB;AAAN,OADI,EAGJ;AAAA/pB,WAAG,GAAH;AACA+I,mBAAWghB;AADX,OAHI;AAFL,KADD;AAUA,WAAO,KAACzwB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAb6B,GC2F7B;;AAmBA0qB,aAAW5mB,SAAX,CD/FDmoB,iBC+FC,GD/FkB,UAAC9xB,IAAD,EAAO2C,IAAP,EAAakD,OAAb;AAClB,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E,IAAH;AACA3C,YAAMA;AADN,KADD;AAIA,WAAO,KAACgB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AALkB,GC+FlB;;AASA0qB,aAAW5mB,SAAX,CDjGDooB,2BCiGC,GDjG4B,UAAC/xB,IAAD,EAAO2C,IAAP,EAAakD,OAAb;AAC5B,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E,IAAH;AACA3C,YAAMA,IADN;AAEA,iBACC;AAAAqW,aAAK;AAAL;AAHD,KADD;AAMA,WAAO,KAACrV,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAP4B,GCiG5B;;AAYA0qB,aAAW5mB,SAAX,CDpGDqoB,sCCoGC,GDpGuC,UAAChyB,IAAD,EAAO2C,IAAP,EAAa0E,QAAb,EAAuBxB,OAAvB;AACvC,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E,IAAH;AACA3C,YAAMA,IADN;AAEAyQ,iBACC;AAAA4F,aAAKhP;AAAL;AAHD,KADD;AAMA,WAAO,KAACrG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAPuC,GCoGvC;;AAYA0qB,aAAW5mB,SAAX,CDvGDsoB,0BCuGC,GDvG2B,UAACjyB,IAAD,EAAOwH,KAAP,EAAc3B,OAAd;AAC3B,QAAA4rB,SAAA,EAAAjjB,KAAA;AAAAijB,gBAAgB,IAAA1hB,MAAA,CAAO,MAAMC,EAAEjT,IAAF,CAAOiT,EAAEC,YAAF,CAAejQ,IAAf,CAAP,CAAb,EAA2C,GAA3C,CAAhB;AAEAwO,YACC;AAAA9G,SACC;AAAAmO,aAAKrO;AAAL,OADD;AAEA+W,WAAK,CACJ;AAAAve,cAAMyxB;AAAN,OADI,EAGJ;AAAA/pB,WAAG,GAAH;AACA+I,mBAAWghB;AADX,OAHI;AAFL,KADD;AAUA,WAAO,KAACzwB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAb2B,GCuG3B;;AAmBA0qB,aAAW5mB,SAAX,CD3GDyO,qBC2GC,GD3GsB,UAAC8Z,YAAD,EAAe1qB,KAAf,EAAsB3B,OAAtB;AACtB,QAAA2I,KAAA;AAAAA,YACC;AAAA,iBAAS0jB,YAAT;AACAxqB,SACC;AAAAmO,aAAKrO;AAAL;AAFD,KADD;AAKA,WAAO,KAACxG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AANsB,GC2GtB;;AAWA0qB,aAAW5mB,SAAX,CD9GDwoB,4BC8GC,GD9G6B,UAACxvB,IAAD,EAAO0E,QAAP,EAAiBxB,OAAjB;AAC7B,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E,IAAH;AACA8N,iBAAWpJ;AADX,KADD;AAIA,WAAO,KAACrG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAL6B,GC8G7B;;AASA0qB,aAAW5mB,SAAX,CDhHDyoB,6BCgHC,GDhH8B,UAACzvB,IAAD,EAAO0E,QAAP,EAAiBxB,OAAjB;AAC9B,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E,IAAH;AACA8N,iBAAW;AAAE4hB,cAAM,GAAGvyB,MAAH,CAAUuH,QAAV;AAAR;AADX,KADD;AAIA,WAAO,KAACrG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAL8B,GCgH9B;;AAWA0qB,aAAW5mB,SAAX,CDpHD2oB,yCCoHC,GDpH0C,UAAC9qB,KAAD,EAAQrB,MAAR,EAAgBkB,QAAhB,EAA0BxB,OAA1B;AAC1C,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SACC;AAAAmO,aAAKrO;AAAL,OADD;AAEA+qB,WACC;AAAAlc,aAAKlQ;AAAL,OAHD;AAIAsK,iBAAWpJ;AAJX,KADD;AAOA,WAAO,KAACrG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAR0C,GCoH1C;;AAcA0qB,aAAW5mB,SAAX,CDxHD6oB,wBCwHC,GDxHyB,UAACnrB,QAAD,EAAWxB,OAAX;AACzB,QAAA2I,KAAA;AAAAA,YACC;AAAAiC,iBAAWpJ;AAAX,KADD;AAGA,WAAO,KAACrG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJyB,GCwHzB;;AAQA0qB,aAAW5mB,SAAX,CD1HD8oB,iBC0HC,GD1HkB,UAAC9vB,IAAD,EAAO3C,IAAP,EAAa6F,OAAb;AAClB,QAAA2I,KAAA;;AAAA,QAAG,KAAKsb,QAAR;AACC,aAAO,KAAKK,KAAL,CAAWuI,WAAX,CAAuB,QAAvB,EAAiC,CAAC/vB,IAAD,EAAO3C,IAAP,CAAjC,EAA+C6F,OAA/C,CAAP;AC4HE;;AD1HH2I,YACC;AAAAxO,YAAMA,IAAN;AACA0H,SAAG/E;AADH,KADD;AAIA,WAAO,KAAC3B,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AARkB,GC0HlB;;AAYA0qB,aAAW5mB,SAAX,CD5HDgpB,mCC4HC,GD5HoC,UAAChwB,IAAD,EAAO3C,IAAP,EAAaqH,QAAb,EAAuBxB,OAAvB;AACpC,QAAA2I,KAAA;AAAAA,YACC;AAAAxO,YAAMA,IAAN;AACA0H,SAAG/E,IADH;AAEA8N,iBAAWpJ;AAFX,KADD;AAKA,WAAO,KAACrG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AANoC,GC4HpC;;AAUA0qB,aAAW5mB,SAAX,CD9HDipB,6BC8HC,GD9H8B,UAACjwB,IAAD,EAAOkwB,gBAAP,EAAyBhtB,OAAzB;AAC9B,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E;AAAH,KADD;;AAGA,QAAGkwB,gBAAH;AACCrkB,YAAM+L,QAAN,GAAiB,IAAjB;AADD;AAGC/L,YAAM+L,QAAN,GAAiB;AAAElE,aAAK;AAAP,OAAjB;ACkIE;;ADhIH,WAAO,KAACrV,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAT8B,GC8H9B;;AAeA0qB,aAAW5mB,SAAX,CDjIDmpB,YCiIC,GDjIa,UAAC/0B,GAAD,EAAM4yB,SAAN;AACb,QAAAniB,KAAA,EAAAgN,MAAA;AAAAmV,gBAAY,GAAG7wB,MAAH,CAAU6wB,SAAV,CAAZ;AACAniB,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAyF,iBACC;AAAA0P,mBACC;AAAAoC,iBAAOpC;AAAP;AADD;AADD,KADD;AAKA,WAAO,KAACnV,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAVa,GCiIb;;AAgBA+U,aAAW5mB,SAAX,CDrID0P,WCqIC,GDrIY,UAACtb,GAAD;AACZ,QAAAyQ,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAlB,kBAAU;AAAV;AADD,KADD;AAIA,WAAO,KAACiB,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARY,GCqIZ;;AAaA+U,aAAW5mB,SAAX,CDxIDke,aCwIC,GDxIc,UAAC9pB,GAAD;AACd,QAAAyQ,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAlB,kBAAU;AAAV;AADD,KADD;AAIA,WAAO,KAACiB,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARc,GCwId;;AAaA+U,aAAW5mB,SAAX,CD3ID8O,eC2IC,GD3IgB,UAAC1a,GAAD,EAAMsJ,QAAN,EAAgBgR,KAAhB;AAChB,QAAA7J,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAyF,iBACC;AAAAxQ,mBAAWpJ;AAAX;AADD,KADD;;AAIA,QAAGgR,KAAH;AACCmD,aAAOyF,SAAP,CAAiB5I,KAAjB,GAAyBhR,QAAzB;AC8IE;;AD5IH,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAXgB,GC2IhB;;AAgBA+U,aAAW5mB,SAAX,CD9IDqpB,gBC8IC,GD9IiB,UAACj1B,GAAD,EAAM0S,SAAN;AACjB,QAAAjC,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAyF,iBACC;AAAAxQ,mBACC;AAAAsiB,iBAAOtiB;AAAP;AADD;AADD,KADD;AAKA,WAAO,KAAC+K,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AATiB,GC8IjB;;AAeA+U,aAAW5mB,SAAX,CDlJDspB,iBCkJC,GDlJkB,UAACjzB,IAAD,EAAOqH,QAAP;AAClB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAxO,YAAMA;AAAN,KADD;AAGAwb,aACC;AAAAyF,iBACC;AAAAxQ,mBAAWpJ;AAAX;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARkB,GCkJlB;;AAaA+U,aAAW5mB,SAAX,CDrJD+U,kBCqJC,GDrJmB,UAAC3gB,GAAD,EAAMsJ,QAAN;AACnB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAA0T,aACC;AAAAze,mBAAWpJ;AAAX;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARmB,GCqJnB;;AAaA+U,aAAW5mB,SAAX,CDxJDupB,mBCwJC,GDxJoB,UAACn1B,GAAD,EAAM0S,SAAN;AACpB,QAAAjC,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAA0T,aACC;AAAAze,mBACC;AAAAoF,eAAKpF;AAAL;AADD;AADD,KADD;AAKA,WAAO,KAAC+K,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAToB,GCwJpB;;AAeA+U,aAAW5mB,SAAX,CD5JD0S,qBC4JC,GD5JsB,UAAChV,QAAD;AACtB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAiC,iBAAWpJ;AAAX,KADD;AAGAmU,aACC;AAAA0T,aACC;AAAAze,mBAAWpJ;AAAX;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AARsB,GC4JtB;;AAeA2B,aAAW5mB,SAAX,CDjKDwpB,oBCiKC,GDjKqB,UAACnzB,IAAD,EAAOqH,QAAP;AACrB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAxO,YAAMA;AAAN,KADD;AAGAwb,aACC;AAAA0T,aACC;AAAAze,mBAAWpJ;AAAX;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARqB,GCiKrB;;AAaA+U,aAAW5mB,SAAX,CDpKDypB,WCoKC,GDpKY,UAACr1B,GAAD,EAAMiC,IAAN;AACZ,QAAAwO,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAzb,cAAMA;AAAN;AADD,KADD;AAIA,WAAO,KAACwb,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARY,GCoKZ;;AAaA+U,aAAW5mB,SAAX,CDvKD4F,eCuKC,GDvKgB,UAACxR,GAAD,EAAMs1B,GAAN;AAChB,QAAA7kB,KAAA,EAAAgN,MAAA;;ACwKE,QAAI6X,OAAO,IAAX,EAAiB;ADzKGA,YAAI,CAAJ;AC2KnB;;AD1KH7kB,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAA8X,YACC;AAAAC,cAAMF;AAAN;AADD,KADD;AAIA,WAAO,KAAC7X,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARgB,GCuKhB;;AAgBA+U,aAAW5mB,SAAX,CD7KDwH,yCC6KC,GD7K0C,UAACpT,GAAD,EAAMs1B,GAAN,EAAaG,oBAAb;AAC1C,QAAAhlB,KAAA,EAAAgN,MAAA;;AC8KE,QAAI6X,OAAO,IAAX,EAAiB;AD/K6BA,YAAI,CAAJ;ACiL7C;;ADhLH7kB,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAgY,YAAID;AAAJ,OADD;AAEAF,YACC;AAAAC,cAAMF;AAAN;AAHD,KADD;AAMA,WAAO,KAAC7X,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAV0C,GC6K1C;;AAmBA+U,aAAW5mB,SAAX,CDpLDud,eCoLC,GDpLgB,UAACV,gBAAD,EAAmBnf,QAAnB;AAChB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAiC,iBAAW+V;AAAX,KADD;AAGAhL,aACC;AAAAC,YACC;AAAA,uBAAepU;AAAf;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AARgB,GCoLhB;;AAeA2B,aAAW5mB,SAAX,CDzLDwd,oBCyLC,GDzLqB,UAACX,gBAAD,EAAmBnf,QAAnB;AACrB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAA6J,aAAOmO;AAAP,KADD;AAGAhL,aACC;AAAAC,YACC;AAAA,mBAAWpU;AAAX;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AARqB,GCyLrB;;AAeA2B,aAAW5mB,SAAX,CD9LDyd,6BC8LC,GD9L8B,UAACjhB,MAAD,EAASkB,QAAT;AAC9B,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAA,eAASrI;AAAT,KADD;AAGAqV,aACC;AAAAC,YACC;AAAA,sBAAcpU;AAAd;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAR8B,GC8L9B;;AAeA2B,aAAW5mB,SAAX,CDnMD+pB,eCmMC,GDnMgB,UAAC31B,GAAD,EAAM41B,QAAN;AAChB,QAAAnlB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;;AAGA,SAAA41B,YAAA,OAAGA,SAAU52B,IAAV,EAAH,GAAG,MAAH,MAAyB,EAAzB;AACCye,eACC;AAAAC,cACC;AAAAmY,4BAAkB,IAAlB;AACAD,oBAAUA;AADV;AADD,OADD;AADD;AAMCnY,eACC;AAAAC,cACC;AAAAmY,4BAAkB;AAAlB,SADD;AAEAjQ,gBACC;AAAAgQ,oBAAU;AAAV;AAHD,OADD;AC8ME;;ADxMH,WAAO,KAACnY,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAhBgB,GCmMhB;;AAyBA+U,aAAW5mB,SAAX,CD1MDkqB,WC0MC,GD1MY,UAAC91B,GAAD,EAAMqK,IAAN;AACZ,QAAAoG,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAArU,WACC;AAAArJ,eAAKqK,KAAKrK,GAAV;AACAsJ,oBAAUe,KAAKf;AADf;AADD;AADD,KADD;AAMA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAVY,GC0MZ;;AAgBA+U,aAAW5mB,SAAX,CD9MDmqB,WC8MC,GD9MY,UAAC/1B,GAAD,EAAM4E,IAAN;AACZ,QAAA6L,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAEAyd,aACC;AAAAC,YACC;AAAA/T,WAAG/E;AAAH;AADD,KADD;;AAGA,QAAGA,SAAQ,GAAX;AACC6Y,aAAOmI,MAAP,GAAgB;AAAC,mBAAS;AAAV,OAAhB;ACqNE;;ADnNH,WAAO,KAACnI,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AATY,GC8MZ;;AAkBA+U,aAAW5mB,SAAX,CDrNDoqB,YCqNC,GDrNa,UAACh2B,GAAD,EAAMi2B,KAAN;AACb,QAAAxlB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAuY,eAAOA;AAAP;AADD,KADD;AAIA,WAAO,KAACxY,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARa,GCqNb;;AAaA+U,aAAW5mB,SAAX,CDxNDsqB,mBCwNC,GDxNoB,UAACl2B,GAAD,EAAMm2B,YAAN;AACpB,QAAA1lB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAAyY,sBAAcA;AAAd;AADD,KADD;AAIA,WAAO,KAAC1Y,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARoB,GCwNpB;;AAaA+U,aAAW5mB,SAAX,CD3NDiR,oBC2NC,GD3NqB,UAAC7c,GAAD,EAAMsJ,QAAN;AACrB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAyF,iBACC;AAAA5I,eAAOhR;AAAP;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARqB,GC2NrB;;AAaA+U,aAAW5mB,SAAX,CD9NDwqB,sBC8NC,GD9NuB,UAACp2B,GAAD,EAAMsJ,QAAN;AACvB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAA0T,aACC;AAAA7W,eAAOhR;AAAP;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARuB,GC8NvB;;AAaA+U,aAAW5mB,SAAX,CDjODyqB,eCiOC,GDjOgB,UAACr2B,GAAD,EAAMm0B,YAAN;AAChB,QAAA1jB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAC,YACC;AAAA,mBAASyW,iBAAgB;AAAzB;AADD,KADD;AAIA,WAAO,KAAC1W,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARgB,GCiOhB;;AAaA+U,aAAW5mB,SAAX,CDpOD0qB,mBCoOC,GDpOoB,UAACt2B,GAAD,EAAMi2B,KAAN,EAAaM,IAAb;AACpB,QAAAC,OAAA,EAAAC,SAAA,EAAAhZ,MAAA;AAAA+Y,cAAU,EAAV;AACAC,gBAAY,EAAZ;;AAEA,QAAGR,SAAA,IAAH;AACC,UAAG,CAAIn3B,EAAE43B,OAAF,CAAUzkB,EAAEjT,IAAF,CAAOi3B,KAAP,CAAV,CAAP;AACCO,gBAAQP,KAAR,GAAgBhkB,EAAEjT,IAAF,CAAOi3B,KAAP,CAAhB;AADD;AAGCQ,kBAAUR,KAAV,GAAkB,CAAlB;AAJF;AC0OG;;ADpOH,QAAGM,QAAA,IAAH;AACC,UAAG,CAAIz3B,EAAE43B,OAAF,CAAUzkB,EAAEjT,IAAF,CAAOu3B,IAAP,CAAV,CAAP;AACCC,gBAAQD,IAAR,GAAetkB,EAAEjT,IAAF,CAAOu3B,IAAP,EAAaryB,KAAb,CAAmB,GAAnB,EAAwB9C,GAAxB,CAA4B,UAAAsa,KAAA;ACsOrC,iBDtOqC,UAACib,GAAD;AAAS,mBAAO1kB,EAAEjT,IAAF,CAAO23B,GAAP,CAAP;AAAT,WCsOrC;ADtOqC,eAA5B,CAAf;AADD;AAGCF,kBAAUF,IAAV,GAAiB,CAAjB;AAJF;AC+OG;;ADzOH9Y,aAAS,EAAT;;AAEA,QAAG,CAAI3e,EAAE43B,OAAF,CAAUF,OAAV,CAAP;AACC/Y,aAAOC,IAAP,GAAc8Y,OAAd;AC0OE;;ADxOH,QAAG,CAAI13B,EAAE43B,OAAF,CAAUD,SAAV,CAAP;AACChZ,aAAOmI,MAAP,GAAgB6Q,SAAhB;AC0OE;;ADxOH,QAAG33B,EAAE43B,OAAF,CAAUjZ,MAAV,CAAH;AACC;AC0OE;;ADxOH,WAAO,KAACA,MAAD,CAAQ;AAAEzd,WAAKA;AAAP,KAAR,EAAsByd,MAAtB,CAAP;AA3BoB,GCoOpB;;AAqCA+U,aAAW5mB,SAAX,CD3OD+Q,kCC2OC,GD3OmC,UAAC/X,IAAD,EAAO3C,IAAP,EAAaoI,IAAb,EAAmBqI,SAAnB,EAA8B0J,SAA9B;AACnC,QAAAjL,IAAA;AAAAA,WACC;AAAAlP,YAAMA,IAAN;AACA0H,SAAG/E,IADH;AAEA8N,iBAAWA,SAFX;AAGA8iB,YAAM,CAHN;AAIAnsB,SACC;AAAArJ,aAAKqK,KAAKrK,GAAV;AACAsJ,kBAAUe,KAAKf;AADf;AALD,KADD;;AASAxK,MAAEkgB,MAAF,CAAS7N,IAAT,EAAeiL,SAAf;;AAEAjL,SAAKnR,GAAL,GAAW,KAAC2jB,MAAD,CAAQxS,IAAR,CAAX;AACA,WAAOA,IAAP;AAbmC,GC2OnC;;AAiBAqhB,aAAW5mB,SAAX,CD7ODgrB,uBC6OC,GD7OwB,UAAC52B,GAAD,EAAM4E,IAAN,EAAY3C,IAAZ,EAAkBma,SAAlB;AACxB,QAAAjL,IAAA;AAAAA,WACC;AAAAnR,WAAKA,GAAL;AACAF,UAAQ,IAAAC,IAAA,EADR;AAEA4J,SAAG/E,IAFH;AAGA3C,YAAMA,IAHN;AAIAyQ,iBAAW,EAJX;AAKA8iB,YAAM;AALN,KADD;;AAQA12B,MAAEkgB,MAAF,CAAS7N,IAAT,EAAeiL,SAAf;;AAEA,SAACuH,MAAD,CAAQxS,IAAR;AACA,WAAOA,IAAP;AAZwB,GC6OxB;;AAeAqhB,aAAW5mB,SAAX,CD5ODgS,UC4OC,GD5OW,UAAC5d,GAAD;AACX,QAAAyQ,KAAA;AAAAA,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGA,WAAO,KAACmD,MAAD,CAAQsN,KAAR,CAAP;AAJW,GC4OX;;AAQA+hB,aAAW5mB,SAAX,CD9ODyS,8BC8OC,GD9O+B,UAACzZ,IAAD,EAAO0E,QAAP;AAC/B,QAAAmH,KAAA;AAAAA,YACC;AAAA9G,SAAG/E,IAAH;AACA8N,iBAAWpJ;AADX,KADD;AAIA,WAAO,KAACnG,MAAD,CAAQsN,KAAR,CAAP;AAL+B,GC8O/B;;AASA,SAAO+hB,UAAP;AAED,CD12BK,CAAmBj0B,WAAWC,MAAX,CAAkBgvB,KAArC;;AAwnBNjvB,WAAWC,MAAX,CAAkB+S,KAAlB,GAA8B,IAAAihB,UAAA,CAAW,MAAX,EAAmB,IAAnB,CAA9B,uE;;;;;;;;;;;;AExnBA,IAAAqE,aAAA;AAAA,IAAA7X,SAAA,UAAAyO,KAAA,EAAAC,MAAA;AAAA,WAAAntB,GAAA,2CAAAmtB,MAAA;AAAA,QAAAC,QAAA7sB,IAAA,CAAA4sB,MAAA,EAAAntB,GAAA,GAAAktB,MAAAltB,GAAA,IAAAmtB,OAAAntB,GAAA;AAAA;;AAAA,WAAAqtB,IAAA;AAAA,SAAApB,WAAA,GAAAiB,KAAA;AAAA;;AAAAG,OAAAhiB,SAAA,GAAA8hB,OAAA9hB,SAAA;AAAA6hB,QAAA7hB,SAAA,OAAAgiB,IAAA;AAAAH,QAAAI,SAAA,GAAAH,OAAA9hB,SAAA;AAAA,SAAA6hB,KAAA;AAAA;AAAA,ICEEE,UAAU,GAAGG,cDFf;;AAAM+I,gBAAA,UAAA9I,UAAA;ACKJ/O,SAAO6X,aAAP,EAAsB9I,UAAtB;;ADJY,WAAA8I,aAAA;AACZA,kBAAAhJ,SAAA,CAAArB,WAAA,CAAAzgB,KAAA,OAAMD,SAAN;;AAEA,SAACshB,cAAD,CAAgB;AAAE,iBAAW;AAAb,KAAhB,EAAkC;AAAEY,cAAQ;AAAV,KAAlC;AACA,SAACZ,cAAD,CAAgB;AAAE,gBAAU;AAAZ,KAAhB,EAAiC;AAAEY,cAAQ;AAAV,KAAjC;AAJY;;ACoBZ6I,gBAAcjrB,SAAd,CDbDonB,QCaC,GDbS,UAAChzB,GAAD;AACT,QAAAyQ,KAAA;AAAAA,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGA,WAAO,KAACiD,IAAD,CAAMwN,KAAN,CAAP;AAJS,GCaT;;AAQAomB,gBAAcjrB,SAAd,CDfDkrB,oBCeC,GDfqB,UAAC92B,GAAD;AACrB,QAAAyQ,KAAA;AAAAA,YACC;AAAAzQ,WAAKA,GAAL;AACA8kB,cAAQ;AAAExM,aAAK;AAAP;AADR,KADD;AAIA,WAAO,KAACrB,OAAD,CAASxG,KAAT,CAAP;AALqB,GCerB;;AAWAomB,gBAAcjrB,SAAd,CDnBDqnB,SCmBC,GDnBU,UAACjzB,GAAD;AACV,QAAAyQ,KAAA;;ACoBE,QAAIzQ,OAAO,IAAX,EAAiB;ADrBRA,YAAM,EAAN;ACuBR;;ADtBHA,UAAM,GAAG+B,MAAH,CAAU/B,GAAV,CAAN;AAEAyQ,YACC;AAAAzQ,WACC;AAAA8X,aAAK9X;AAAL;AADD,KADD;AAIA,WAAO,KAACiD,IAAD,CAAMwN,KAAN,CAAP;AAPU,GCmBV;;AAcAomB,gBAAcjrB,SAAd,CDxBDmrB,UCwBC,GDxBW,UAACvsB,IAAD,EAAO1C,OAAP;AACX,QAAA2I,KAAA;AAAAA,YACC;AAAAjG,YAAMA;AAAN,KADD;AAGA,WAAO,KAACvH,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJW,GCwBX;;AAQA+uB,gBAAcjrB,SAAd,CD1BDorB,UC0BC,GD1BW,UAAClvB,OAAD;AACX,QAAA2I,KAAA;AAAAA,YACC;AAAA,gBAAQ;AAAR,KADD;AAGA,WAAO,KAACxN,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJW,GC0BX;;AAQA+uB,gBAAcjrB,SAAd,CD5BDqrB,mBC4BC,GD5BoB,UAACnK,GAAD;AACpB,QAAA7nB,MAAA;;AC6BE,QAAI6nB,OAAO,IAAX,EAAiB;AD9BEA,YAAM,EAAN;ACgClB;;AD/BH7nB,aACC;AAAA6f,cAAQ;AAAExM,aAAK;AAAP,OAAR;AACA,gBAAQ;AADR,KADD;;AAIA,QAAGwU,IAAItpB,MAAJ,GAAa,CAAhB;AACCyB,aAAOjF,GAAP,GACC;AAAA8X,aAAKgV;AAAL,OADD;ACqCE;;ADlCH,WAAO,KAAC7pB,IAAD,CAAMgC,MAAN,EAAc;AAAE0N,cAAQ;AAAA3S,aAAK,CAAL;AAAQM,eAAO;AAAf;AAAV,KAAd,CAAP;AAToB,GC4BpB;;AAwBAu2B,gBAAcjrB,SAAd,CDzCDsrB,+BCyCC,GDzCgC,UAACC,SAAD;AAChC,QAAAlyB,MAAA;AAAAA,aACC;AAAA6f,cAAQ;AAAExM,aAAK;AAAP,OAAR;AACA,gBAAQ,IADR;AAEAkb,kBACC;AAAA/E,aAAK0I;AAAL;AAHD,KADD;AAMA,WAAO,KAACl0B,IAAD,CAAMgC,MAAN,EAAc;AAAE0N,cAAQ;AAAA3S,aAAK,CAAL;AAAQM,eAAO;AAAf;AAAV,KAAd,CAAP;AAPgC,GCyChC;;AAmBAu2B,gBAAcjrB,SAAd,CDnDDwrB,oBCmDC,GDnDqB;AACrB,WAAO,KAACn0B,IAAD,CAAM;AACZ6hB,cAAQ;AAAExM,aAAK;AAAP,OADI;AAEZ,gBAAQ;AAAEA,aAAK;AAAP;AAFI,KAAN,CAAP;AADqB,GCmDrB;;AAWAue,gBAAcjrB,SAAd,CDxDDyrB,aCwDC,GDxDc,UAACvvB,OAAD;AACd,WAAO,KAAC7E,IAAD,CAAM;AAAE6hB,cAAQ;AAAExM,aAAK;AAAP;AAAV,KAAN,EAAiCxQ,OAAjC,CAAP;AADc,GCwDd;;AAQA+uB,gBAAcjrB,SAAd,CD7DD0rB,yBC6DC,GD7D0B,UAACH,SAAD;AAC1B,WAAO,KAACl0B,IAAD,CAAM;AACZ6hB,cAAQ;AAAExM,aAAK;AAAP,OADI;AAEZkb,kBACC;AAAA/E,aAAK0I;AAAL;AAHW,KAAN,CAAP;AAD0B,GC6D1B;;AAWAN,gBAAcjrB,SAAd,CDhEDwa,eCgEC,GDhEgB,UAACpmB,GAAD,EAAMM,KAAN;AAChB,QAAAmQ,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAsU,eAAS;AAAEzM,aAAK;AAAP,OAAT;AACAhY,aAAO;AAAEgY,aAAKhY;AAAP,OADP;AAEAN,WAAKA;AAFL,KADD;AAKAyd,aACC;AAAAC,YACC;AAAApd,eAAOA;AAAP;AADD,KADD;AAIA,WAAO,KAACmd,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAVgB,GCgEhB;;AAmBAoZ,gBAAcjrB,SAAd,CDvEDua,wBCuEC,GDvEyB,UAACnmB,GAAD,EAAMM,KAAN,EAAaY,MAAb;AACzB,QAAAuP,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAsU,eAAS;AAAEzM,aAAK;AAAP,OAAT;AACAhY,aAAO;AAAEgY,aAAKhY;AAAP,OADP;AAEAN,WAAKA;AAFL,KADD;AAKAyd,aACC;AAAAC,YACC;AAAApd,eAAOA,KAAP;AACAY,gBAAQA;AADR;AADD,KADD;AAKA,WAAO,KAACuc,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAXyB,GCuEzB;;AAoBAoZ,gBAAcjrB,SAAd,CD9ED2rB,wBC8EC,GD9EyB,UAACv3B,GAAD,EAAMM,KAAN;AACzB,QAAAmQ,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA,GAAL;AACA8kB,cAAQ;AAAExM,aAAK;AAAP,OADR;AAEAyM,eAAS;AAAEzM,aAAK;AAAP;AAFT,KADD;AAKAmF,aACC;AAAAC,YACC;AAAApd,eAAOA;AAAP;AADD,KADD;AAIA,WAAO,KAACmd,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAVyB,GC8EzB;;AAmBAoZ,gBAAcjrB,SAAd,CDrFDya,iBCqFC,GDrFkB,UAACrmB,GAAD,EAAM8H,OAAN;AAClB,QAAA2I,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAsU,eAAS;AAAEzM,aAAK;AAAP,OAAT;AACAtY,WAAKA;AADL,KADD;AAIAyd,aACC;AAAAC,YAAM5V;AAAN,KADD;AAGA,WAAO,KAAC2V,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARkB,GCqFlB;;AAcAoZ,gBAAcjrB,SAAd,CDxFD4rB,oBCwFC,GDxFqB,UAACx3B,GAAD,EAAMM,KAAN;AACrB,QAAAqmB,MAAA;AAAAA,aACC;AAAA3mB,WAAKA,GAAL;AACAM,aAAOA,KADP;AAEAm3B,kBAAY,IAAI13B,IAAJ;AAFZ,KADD;AAKA,WAAO,KAAC4jB,MAAD,CAAQgD,MAAR,CAAP;AANqB,GCwFrB;;AAUAkQ,gBAAcjrB,SAAd,CDzFDgS,UCyFC,GDzFW,UAAC5d,GAAD;AACX,QAAAyQ,KAAA;AAAAA,YACC;AAAAsU,eAAS;AAAEzM,aAAK;AAAP,OAAT;AACAtY,WAAKA;AADL,KADD;AAIA,WAAO,KAACmD,MAAD,CAAQsN,KAAR,CAAP;AALW,GCyFX;;AAWA,SAAOomB,aAAP;AAED,CD9OK,CAAsBt4B,WAAWC,MAAX,CAAkBgvB,KAAxC;;AA+INjvB,WAAWC,MAAX,CAAkBsnB,QAAlB,GAAiC,IAAA+Q,aAAA,CAAc,UAAd,EAA0B,IAA1B,CAAjC,6D;;;;;;;;;;;;AE/IA,IAAAa,kBAAA;AAAA,IAAA1Y,SAAA,UAAAyO,KAAA,EAAAC,MAAA;AAAA,WAAAntB,GAAA,2CAAAmtB,MAAA;AAAA,QAAAC,QAAA7sB,IAAA,CAAA4sB,MAAA,EAAAntB,GAAA,GAAAktB,MAAAltB,GAAA,IAAAmtB,OAAAntB,GAAA;AAAA;;AAAA,WAAAqtB,IAAA;AAAA,SAAApB,WAAA,GAAAiB,KAAA;AAAA;;AAAAG,OAAAhiB,SAAA,GAAA8hB,OAAA9hB,SAAA;AAAA6hB,QAAA7hB,SAAA,OAAAgiB,IAAA;AAAAH,QAAAI,SAAA,GAAAH,OAAA9hB,SAAA;AAAA,SAAA6hB,KAAA;AAAA;AAAA,ICEEE,UAAU,GAAGG,cDFf;;AAAM4J,qBAAA,UAAA3J,UAAA;ACKJ/O,SAAO0Y,kBAAP,EAA2B3J,UAA3B;;ADJY,WAAA2J,kBAAA;AACZA,uBAAA7J,SAAA,CAAArB,WAAA,CAAAzgB,KAAA,OAAMD,SAAN;;AAEA,SAACshB,cAAD,CAAgB;AAAE,aAAO,CAAT;AAAY,eAAS;AAArB,KAAhB,EAA0C;AAAEja,cAAQ;AAAV,KAA1C;AACA,SAACia,cAAD,CAAgB;AAAE,aAAO,CAAT;AAAY,eAAS,CAArB;AAAwB,eAAS;AAAjC,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,aAAO,CAAT;AAAY,eAAS;AAArB,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,eAAS,CAAX;AAAc,cAAQ,CAAtB;AAAyB,WAAK;AAA9B,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,eAAS,CAAX;AAAc,cAAQ,CAAtB;AAAyB,WAAK,CAA9B;AAAiC,cAAQ;AAAzC,KAAhB,EAA8D;AAAEja,cAAQ;AAAV,KAA9D;AACA,SAACia,cAAD,CAAgB;AAAE,cAAQ;AAAV,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,eAAS;AAAX,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,gBAAU;AAAZ,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,YAAM;AAAR,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,YAAM;AAAR,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,2BAAqB;AAAvB,KAAhB,EAA4C;AAAEY,cAAQ;AAAV,KAA5C;AACA,SAACZ,cAAD,CAAgB;AAAE,8BAAwB;AAA1B,KAAhB,EAA+C;AAAEY,cAAQ;AAAV,KAA/C;AACA,SAACZ,cAAD,CAAgB;AAAE,iCAA2B;AAA7B,KAAhB,EAAkD;AAAEY,cAAQ;AAAV,KAAlD;AACA,SAACZ,cAAD,CAAgB;AAAE,4BAAsB;AAAxB,KAAhB,EAA6C;AAAEY,cAAQ;AAAV,KAA7C;AACA,SAACZ,cAAD,CAAgB;AAAE,uBAAiB;AAAnB,KAAhB,EAAwC;AAAEY,cAAQ;AAAV,KAAxC;AACA,SAACZ,cAAD,CAAgB;AAAE,+BAAyB;AAA3B,KAAhB,EAAgD;AAAEY,cAAQ;AAAV,KAAhD;AAEA,SAAK5B,KAAL,CAAWc,WAAX,CAAuB,KAAvB,EAA8B,OAA9B;AACA,SAAKd,KAAL,CAAWc,WAAX,CAAuB,OAAvB,EAAgC,OAAhC;AACA,SAAKd,KAAL,CAAWc,WAAX,CAAuB,MAAvB,EAA+B,OAA/B;AACA,SAAKd,KAAL,CAAWc,WAAX,CAAuB,CAAC,KAAD,EAAQ,OAAR,CAAvB,EAAyC,QAAzC;AACA,SAAKd,KAAL,CAAWc,WAAX,CAAuB,CAAC,MAAD,EAAS,OAAT,CAAvB,EAA0C,QAA1C;AAxBY;;ACwFZwK,qBAAmB9rB,SAAnB,CD5DD+O,wBC4DC,GD5DyB,UAACnL,MAAD,EAASpH,MAAT;AACzB,QAAAqI,KAAA;;AAAA,QAAG,KAAKsb,QAAR;AACC,aAAO,KAAKK,KAAL,CAAWuI,WAAX,CAAuB,WAAvB,EAAoC,CAACnlB,MAAD,EAASpH,MAAT,CAApC,EAAsDwK,KAAtD,EAAP;AC8DE;;AD7DHnC,YACC;AAAAgB,WAAKjC,MAAL;AACA,eAASpH;AADT,KADD;AAIA,WAAO,KAAC6O,OAAD,CAASxG,KAAT,CAAP;AAPyB,GC4DzB;;AAYAinB,qBAAmB9rB,SAAnB,CD/DD+rB,0BC+DC,GD/D2B,UAAC7nB,QAAD,EAAW1H,MAAX;AAC3B,QAAAqI,KAAA;;AAAA,QAAG,KAAKsb,QAAR;AACC,aAAO,KAAKK,KAAL,CAAWuI,WAAX,CAAuB,YAAvB,EAAqC,CAAC7kB,QAAD,EAAW1H,MAAX,CAArC,EAAyDwK,KAAzD,EAAP;ACiEE;;ADhEHnC,YACC;AAAAxO,YAAM6N,QAAN;AACA,eAAS1H;AADT,KADD;AAIA,WAAO,KAAC6O,OAAD,CAASxG,KAAT,CAAP;AAP2B,GC+D3B;;AAYAinB,qBAAmB9rB,SAAnB,CDjEDuS,YCiEC,GDjEa,UAAC/V,MAAD,EAASN,OAAT;AACb,QAAA2I,KAAA;;AAAA,QAAG,KAAKsb,QAAR;AACC,aAAO,KAAKK,KAAL,CAAWuI,WAAX,CAAuB,OAAvB,EAAgCvsB,MAAhC,EAAwCN,OAAxC,CAAP;ACmEE;;ADjEH2I,YACC;AAAA,eAASrI;AAAT,KADD;AAGA,WAAO,KAACnF,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAPa,GCiEb;;AAWA4vB,qBAAmB9rB,SAAnB,CDnEDgsB,wBCmEC,GDnEyB,UAACxvB,MAAD,EAAS+uB,SAAT,EAAoBrvB,OAApB;AACzB,QAAA2I,KAAA;AAAAA,YACC;AAAA,eAASrI,MAAT;AACAorB,kBACC;AAAA/E,aAAK0I;AAAL;AAFD,KADD;AAKA,WAAO,KAACl0B,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AANyB,GCmEzB;;AAWA4vB,qBAAmB9rB,SAAnB,CDrEDisB,oBCqEC,GDrEqB,UAACroB,MAAD,EAAS+P,KAAT,EAAgBzX,OAAhB;AACrB,QAAA2I,KAAA;AAAA8O,YAAQ,GAAGxd,MAAH,CAAUwd,KAAV,CAAR;AACA9O,YACC;AAAA,aAAOjB,MAAP;AACA,eAAS;AAAEsI,aAAKyH;AAAP;AADT,KADD;AAIA,WAAO,KAACtc,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AANqB,GCqErB;;AAYA4vB,qBAAmB9rB,SAAnB,CDzEDunB,UCyEC,GDzEW,UAAC1pB,KAAD,EAAQ3B,OAAR;AACX,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SACC;AAAAmO,aAAKrO;AAAL;AADD,KADD;AAIA,WAAO,KAACxG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AALW,GCyEX;;AAUA4vB,qBAAmB9rB,SAAnB,CD5EDksB,mBC4EC,GD5EoB,UAAClzB,IAAD,EAAOwD,MAAP,EAAeN,OAAf;AACpB,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E,IAAH;AACA,eAASwD;AADT,KADD;AAIA,WAAO,KAACnF,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AALoB,GC4EpB;;AASA4vB,qBAAmB9rB,SAAnB,CD9EDmsB,uBC8EC,GD9EwB,UAACnzB,IAAD,EAAO3C,IAAP,EAAamG,MAAb,EAAqBN,OAArB;AACxB,QAAA2I,KAAA;AAAAA,YACC;AAAA9G,SAAG/E,IAAH;AACA3C,YAAMA,IADN;AAEA,eAASmG;AAFT,KADD;AAKA,WAAO,KAACnF,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AANwB,GC8ExB;;AAUA4vB,qBAAmB9rB,SAAnB,CDhFDosB,YCgFC,GDhFa,UAACxoB,MAAD,EAAS1H,OAAT;AACb,QAAA2I,KAAA;;AAAA,QAAG,KAAKsb,QAAR;AACC,aAAO,KAAKK,KAAL,CAAWuI,WAAX,CAAuB,KAAvB,EAA8BnlB,MAA9B,EAAsC1H,OAAtC,CAAP;ACkFE;;ADhFH2I,YACC;AAAAgB,WAAKjC;AAAL,KADD;AAGA,WAAO,KAACvM,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAPa,GCgFb;;AAWA4vB,qBAAmB9rB,SAAnB,CDlFDmf,wBCkFC,GDlFyB,UAACvb,MAAD,EAASpH,MAAT,EAAiBN,OAAjB;AACzB,QAAA2I,KAAA;AAAAA,YACC;AAAAgB,WAAKjC,MAAL;AACA,eACC;AAAA8I,aAAKlQ;AAAL;AAFD,KADD;AAKA,WAAO,KAACnF,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AANyB,GCkFzB;;AAWA4vB,qBAAmB9rB,SAAnB,CDrFDqsB,WCqFC,GDrFY,UAACnwB,OAAD;AACZ,QAAA2I,KAAA,EAAAqT,GAAA,EAAAC,IAAA,EAAAO,IAAA;;ACsFE,QAAIxc,WAAW,IAAf,EAAqB;ADvFVA,gBAAU,EAAV;ACyFV;;ADxFH2I,YAAQ;AAAEsM,UAAI;AAAE8I,iBAAS;AAAX;AAAN,KAAR;AACA/d,YAAQ2X,IAAR,GAAe;AAAE1C,UAAI,CAAC;AAAP,KAAf;AACAjV,YAAQgX,KAAR,GAAgB,CAAhB;AAEA,YAAAgF,MAAA,KAAA7gB,IAAA,CAAAwN,KAAA,EAAA3I,OAAA,oBAAAgc,IAAAlR,KAAA,mBAAAmR,OAAAD,IAAAlR,KAAA,eAAA0R,OAAAP,KAAA,cAAAO,KAA4CvH,EAA5C,GAA4C,MAA5C,GAA4C,MAA5C,GAA4C,MAA5C,GAA4C,MAA5C;AALY,GCqFZ;;AAiBA2a,qBAAmB9rB,SAAnB,CD/FDmJ,sBC+FC,GD/FuB,UAACvF,MAAD,EAAS0oB,OAAT;AACvB,QAAAznB,KAAA;AAAAA,YACC;AAAAgB,WAAKjC,MAAL;AACA,eACC;AAAAsI,aAAKogB;AAAL;AAFD,KADD;AAKA,WAAO,KAACj1B,IAAD,CAAMwN,KAAN,CAAP;AANuB,GC+FvB;;AAWAinB,qBAAmB9rB,SAAnB,CDjGD2P,eCiGC,GDjGgB,UAAC/L,MAAD;AAChB,QAAAiB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC;AAAL,KADD;AAGAiO,aACC;AAAAC,YACC;AAAA5C,eAAO,KAAP;AACAD,cAAM,KADN;AAEA2B,kBAAU;AAFV;AADD,KADD;AAMA,WAAO,KAACiB,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAVgB,GCiGhB;;AAiBA6G,qBAAmB9rB,SAAnB,CDtGDme,iBCsGC,GDtGkB,UAACva,MAAD;AAClB,QAAAiB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC;AAAL,KADD;AAGAiO,aACC;AAAAC,YACC;AAAA5C,eAAO,KAAP;AACAD,cAAM,IADN;AAEA2B,kBAAU;AAFV;AADD,KADD;AAMA,WAAO,KAACiB,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAVkB,GCsGlB;;AAiBA6G,qBAAmB9rB,SAAnB,CD3GDusB,qBC2GC,GD3GsB,UAAC3oB,MAAD,EAASpH,MAAT;AACtB,QAAAqI,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC,MAAL;AACA,eAASpH;AADT,KADD;AAIAqV,aACC;AAAAC,YACC;AAAA5C,eAAO,KAAP;AACAD,cAAM;AADN;AADD,KADD;AAKA,WAAO,KAAC4C,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAVsB,GC2GtB;;AAeAia,qBAAmB9rB,SAAnB,CD9GDwsB,qBC8GC,GD9GsB,UAAC5oB,MAAD,EAASpH,MAAT;AACtB,QAAAqI,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC,MAAL;AACA,eAASpH;AADT,KADD;AAIAqV,aACC;AAAAC,YACC;AAAA7C,cAAM;AAAN;AADD,KADD;AAIA,WAAO,KAAC4C,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AATsB,GC8GtB;;AAcAia,qBAAmB9rB,SAAnB,CDjHDysB,0BCiHC,GDjH2B,UAAC7oB,MAAD,EAASpH,MAAT;AAC3B,QAAAqI,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC,MAAL;AACA,eAASpH;AADT,KADD;AAIAqV,aACC;AAAAC,YACC;AAAA7C,cAAM,IAAN;AACAC,eAAO,KADP;AAEAC,gBAAQ,CAFR;AAGAgC,YAAI,IAAIhd,IAAJ;AAHJ;AADD,KADD;AAOA,WAAO,KAAC0d,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAZ2B,GCiH3B;;AAiBAia,qBAAmB9rB,SAAnB,CDpHD0sB,4BCoHC,GDpH6B,UAAC9oB,MAAD,EAASpH,MAAT,EAAiBmwB,2BAAjB;AAC7B,QAAA9nB,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC,MAAL;AACA,eAASpH;AADT,KADD;AAIAqV,aACC;AAAAC,YACC;AAAA7C,cAAM,IAAN;AACAC,eAAO,IADP;AAEAiC,YAAIwb;AAFJ;AADD,KADD;AAMA,WAAO,KAAC9a,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAX6B,GCoH7B;;AAgBAia,qBAAmB9rB,SAAnB,CDvHD4sB,4BCuHC,GDvH6B,UAAChpB,MAAD,EAASpH,MAAT,EAAiBqwB,QAAjB;AAC7B,QAAAhoB,KAAA,EAAAgN,MAAA;;ACwHE,QAAIgb,YAAY,IAAhB,EAAsB;ADzHsBA,iBAAS,IAAT;AC2H3C;;AD1HHhoB,YACC;AAAAgB,WAAKjC,MAAL;AACA,eAASpH;AADT,KADD;AAIAqV,aACC;AAAAC,YACC;AAAAgb,WAAGD;AAAH;AADD,KADD;AAIA,WAAO,KAAChb,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAT6B,GCuH7B;;AAiBAia,qBAAmB9rB,SAAnB,CD7HD+sB,0BC6HC,GD7H2B,UAACnpB,MAAD,EAASvN,IAAT;AAC3B,QAAAwO,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC;AAAL,KADD;AAGAiO,aACC;AAAAC,YACC;AAAAzb,cAAMA,IAAN;AACA6Y,eAAO;AADP;AADD,KADD;AAKA,WAAO,KAAC2C,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAT2B,GC6H3B;;AAgBA6G,qBAAmB9rB,SAAnB,CDlIDgtB,kBCkIC,GDlImB,UAACppB,MAAD,EAASvN,IAAT;AACnB,QAAAwO,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC;AAAL,KADD;AAGAiO,aACC;AAAAC,YACC;AAAAzb,cAAMA;AAAN;AADD,KADD;AAIA,WAAO,KAACwb,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AARmB,GCkInB;;AAeA6G,qBAAmB9rB,SAAnB,CDvID0d,uBCuIC,GDvIwB,UAAClhB,MAAD,EAASkB,QAAT;AACxB,QAAAmH,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAA,eAASrI;AAAT,KADD;AAGAqV,aACC;AAAAC,YACC;AAAA,sBAAcpU;AAAd;AADD,KADD;AAIA,WAAO,KAACmU,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AARwB,GCuIxB;;AAeA6G,qBAAmB9rB,SAAnB,CD5ID2d,gCC4IC,GD5IiC,UAACsP,OAAD,EAAU52B,IAAV;AACjC,QAAAwO,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAxO,YAAM42B,OAAN;AACAlvB,SAAG;AADH,KADD;AAIA8T,aACC;AAAAC,YACC;AAAAzb,cAAMA;AAAN;AADD,KADD;AAIA,WAAO,KAACwb,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AATiC,GC4IjC;;AAgBA6G,qBAAmB9rB,SAAnB,CDjJDwG,yCCiJC,GDjJ0C,UAAC5C,MAAD,EAASpH,MAAT,EAAiBktB,GAAjB;AAC1C,QAAA7kB,KAAA,EAAAgN,MAAA;;ACkJE,QAAI6X,OAAO,IAAX,EAAiB;ADnJwCA,YAAI,CAAJ;ACqJxD;;ADpJH7kB,YACC;AAAAgB,WAAKjC,MAAL;AACA7F,SAAG,GADH;AAEA,eACC;AAAA2O,aAAKlQ;AAAL;AAHD,KADD;AAMAqV,aACC;AAAAC,YACC;AAAA5C,eAAO,IAAP;AACAD,cAAM;AADN,OADD;AAGA0a,YACC;AAAAxa,gBAAQua;AAAR;AAJD,KADD;AAOA,WAAO,KAAC7X,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAd0C,GCiJ1C;;AA0BA6G,qBAAmB9rB,SAAnB,CD3JDoH,iCC2JC,GD3JkC,UAACxD,MAAD,EAASpH,MAAT,EAAiBktB,GAAjB;AAClC,QAAA7kB,KAAA,EAAAgN,MAAA;;AC4JE,QAAI6X,OAAO,IAAX,EAAiB;AD7JgCA,YAAI,CAAJ;AC+JhD;;AD9JH7kB,YACC;AAAAgB,WAAKjC,MAAL;AACA,eACC;AAAA8I,aAAKlQ;AAAL;AAFD,KADD;AAKAqV,aACC;AAAAC,YACC;AAAA5C,eAAO,IAAP;AACAD,cAAM;AADN,OADD;AAGA0a,YACC;AAAAxa,gBAAQua;AAAR;AAJD,KADD;AAOA,WAAO,KAAC7X,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAbkC,GC2JlC;;AAyBA6G,qBAAmB9rB,SAAnB,CDrKDqH,4BCqKC,GDrK6B,UAACzD,MAAD,EAAS0oB,OAAT,EAAkB5C,GAAlB;AAC7B,QAAA7kB,KAAA,EAAAgN,MAAA;;ACsKE,QAAI6X,OAAO,IAAX,EAAiB;ADvK4BA,YAAI,CAAJ;ACyK5C;;ADxKH7kB,YACC;AAAAgB,WAAKjC,MAAL;AACA,eACC;AAAAsI,aAAKogB;AAAL;AAFD,KADD;AAKAza,aACC;AAAAC,YACC;AAAA5C,eAAO,IAAP;AACAD,cAAM;AADN,OADD;AAGA0a,YACC;AAAAxa,gBAAQua;AAAR;AAJD,KADD;AAOA,WAAO,KAAC7X,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAb6B,GCqK7B;;AAyBA6G,qBAAmB9rB,SAAnB,CD/KDyH,gCC+KC,GD/KiC,UAAC7D,MAAD,EAASpH,MAAT;AACjC,QAAAqI,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC,MAAL;AACA,eACC;AAAA8I,aAAKlQ;AAAL,OAFD;AAGAoY,WAAK,CACJ;AAAE1F,eAAO;AAAExC,eAAK;AAAP;AAAT,OADI,EAEJ;AAAEuC,cAAM;AAAEvC,eAAK;AAAP;AAAR,OAFI;AAHL,KADD;AASAmF,aACC;AAAAC,YACC;AAAA5C,eAAO,IAAP;AACAD,cAAM;AADN;AADD,KADD;AAKA,WAAO,KAAC4C,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AAfiC,GC+KjC;;AA8BA6G,qBAAmB9rB,SAAnB,CD5LDktB,kBC4LC,GD5LmB,UAACrnB,GAAD,EAAMsT,OAAN,EAAegU,OAAf;AACnB,QAAAtoB,KAAA,EAAAuoB,MAAA,EAAAvb,MAAA,EAAAwb,OAAA;AAAAxoB,YACC;AAAAgB,WAAKA,GAAL;AACA,eAASsT;AADT,KADD;AAIAtH,aACC;AAAAC,YACC;AAAAqH,iBAAS;AAAT;AADD,KADD;AAIAiU,aACC;AAAAvnB,WAAKA,GAAL;AACA,eAASsnB;AADT,KADD;AAIAE,cACC;AAAAvb,YACC;AAAAqb,iBAAS;AAAT;AADD,KADD;AAIA,WAAO,KAACtb,MAAD,CAAQhN,KAAR,EAAegN,MAAf,KAA2B,KAACA,MAAD,CAAQub,MAAR,EAAgBC,OAAhB,CAAlC;AAjBmB,GC4LnB;;AAuBAvB,qBAAmB9rB,SAAnB,CDhMDstB,oBCgMC,GDhMqB,UAACznB,GAAD,EAAMsT,OAAN,EAAegU,OAAf;AACrB,QAAAtoB,KAAA,EAAAuoB,MAAA,EAAAvb,MAAA,EAAAwb,OAAA;AAAAxoB,YACC;AAAAgB,WAAKA,GAAL;AACA,eAASsT;AADT,KADD;AAIAtH,aACC;AAAAmI,cACC;AAAAb,iBAAS;AAAT;AADD,KADD;AAIAiU,aACC;AAAAvnB,WAAKA,GAAL;AACA,eAASsnB;AADT,KADD;AAIAE,cACC;AAAArT,cACC;AAAAmT,iBAAS;AAAT;AADD,KADD;AAIA,WAAO,KAACtb,MAAD,CAAQhN,KAAR,EAAegN,MAAf,KAA2B,KAACA,MAAD,CAAQub,MAAR,EAAgBC,OAAhB,CAAlC;AAjBqB,GCgMrB;;AAuBAvB,qBAAmB9rB,SAAnB,CDpMDutB,kBCoMC,GDpMmB,UAAC3pB,MAAD,EAAS5K,IAAT;AACnB,QAAA6L,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAgB,WAAKjC;AAAL,KADD;AAGAiO,aACC;AAAAC,YACC;AAAA/T,WAAG/E;AAAH;AADD,KADD;AAIA,WAAO,KAAC6Y,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AARmB,GCoMnB;;AAeA6G,qBAAmB9rB,SAAnB,CDzMDwtB,WCyMC,GDzMY,UAACp5B,GAAD,EAAMwK,IAAN;AACZ,QAAAiG,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAyF,iBACC;AAAA3D,eAAO/U;AAAP;AADD,KADD;AAIA,WAAO,KAACiT,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARY,GCyMZ;;AAaAia,qBAAmB9rB,SAAnB,CD5MDytB,cC4MC,GD5Me,UAACr5B,GAAD,EAAMwK,IAAN;AACf,QAAAiG,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAA0T,aACC;AAAA5R,eAAO/U;AAAP;AADD,KADD;AAIA,WAAO,KAACiT,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AARe,GC4Mf;;AAaAia,qBAAmB9rB,SAAnB,CD/MD0tB,qBC+MC,GD/MsB,UAAChwB,QAAD,EAAWkT,QAAX;AACtB,QAAA/L,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAA9G,SAAG,GAAH;AACA1H,YAAMqH;AADN,KADD;AAIAmU,aACC;AAAAC,YACC;AAAAlB,kBAAUA;AAAV;AADD,KADD;AAIA,WAAO,KAACiB,MAAD,CAAQhN,KAAR,EAAegN,MAAf,EAAuB;AAAEoT,aAAO;AAAT,KAAvB,CAAP;AATsB,GC+MtB;;AAgBA6G,qBAAmB9rB,SAAnB,CDnNDgP,qBCmNC,GDnNsB,UAACzJ,IAAD,EAAO9G,IAAP,EAAa+R,SAAb;AACtB,QAAA/F,YAAA;AAAAA,mBACC;AAAAwE,YAAM,KAAN;AACAC,aAAO,KADP;AAEAC,cAAQ,CAFR;AAGAjb,UAAIqR,KAAKrR,EAHT;AAIA2R,WAAKN,KAAKnR,GAJV;AAKAiC,YAAMkP,KAAKlP,IALX;AAMA0H,SAAGwH,KAAKxH,CANR;AAOAN,SACC;AAAArJ,aAAKqK,KAAKrK,GAAV;AACAsJ,kBAAUe,KAAKf;AADf;AARD,KADD;;AAYAxK,MAAEkgB,MAAF,CAAS3I,YAAT,EAAuB+F,SAAvB;;AAEA,WAAO,KAACuH,MAAD,CAAQtN,YAAR,CAAP;AAfsB,GCmNtB;;AAmBAqhB,qBAAmB9rB,SAAnB,CDnNDsS,cCmNC,GDnNe,UAAC9V,MAAD;AACf,QAAAqI,KAAA;AAAAA,YACC;AAAA,eAASrI;AAAT,KADD;AAGA,WAAO,KAACjF,MAAD,CAAQsN,KAAR,CAAP;AAJe,GCmNf;;AAQAinB,qBAAmB9rB,SAAnB,CDrNDwS,cCqNC,GDrNe,UAAC5O,MAAD;AACf,QAAAiB,KAAA;AAAAA,YACC;AAAAgB,WAAKjC;AAAL,KADD;AAGA,WAAO,KAACrM,MAAD,CAAQsN,KAAR,CAAP;AAJe,GCqNf;;AAQAinB,qBAAmB9rB,SAAnB,CDvNDmV,uBCuNC,GDvNwB,UAACvR,MAAD,EAASpH,MAAT;AACxB,QAAAqI,KAAA;AAAAA,YACC;AAAAgB,WAAKjC,MAAL;AACA,eAASpH;AADT,KADD;AAIA,WAAO,KAACjF,MAAD,CAAQsN,KAAR,CAAP;AALwB,GCuNxB;;AASA,SAAOinB,kBAAP;AAED,CDhpBK,CAA2Bn5B,WAAWC,MAAX,CAAkBgvB,KAA7C;;AAqbNjvB,WAAWC,MAAX,CAAkB2T,aAAlB,GAAsC,IAAAulB,kBAAA,CAAmB,cAAnB,EAAmC,IAAnC,CAAtC,+C;;;;;;;;;;;;AErbA,IAAA1Y,SAAA,UAAAyO,KAAA,EAAAC,MAAA;AAAA,WAAAntB,GAAA,2CAAAmtB,MAAA;AAAA,QAAAC,QAAA7sB,IAAA,CAAA4sB,MAAA,EAAAntB,GAAA,GAAAktB,MAAAltB,GAAA,IAAAmtB,OAAAntB,GAAA;AAAA;;AAAA,WAAAqtB,IAAA;AAAA,SAAApB,WAAA,GAAAiB,KAAA;AAAA;;AAAAG,OAAAhiB,SAAA,GAAA8hB,OAAA9hB,SAAA;AAAA6hB,QAAA7hB,SAAA,OAAAgiB,IAAA;AAAAH,QAAAI,SAAA,GAAAH,OAAA9hB,SAAA;AAAA,SAAA6hB,KAAA;AAAA;AAAA,ICCEE,UAAU,GAAGG,cDDf;;AAAAvvB,WAAWC,MAAX,CAAkBgf,OAAlB,GAA4B,eAAAuQ,UAAA;ACI1B/O,SAAOmL,MAAP,EAAe4D,UAAf;;ADHY,WAAA5D,MAAA;AACZA,WAAA0D,SAAA,CAAArB,WAAA,CAAA1rB,IAAA,OAAM,SAAN;;AAEA,SAACssB,cAAD,CAAgB;AAAE,aAAO;AAAT,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,oBAAc;AAAhB,KAAhB;AAJY;;ACeZjD,SAAOve,SAAP,CDTD2tB,wBCSC,GDTyB,UAAC/pB,MAAD,EAASsP,KAAT;AACzB,QAAA0a,WAAA,EAAAC,SAAA;AAAAA,gBACC;AAAAhoB,WAAKjC,MAAL;AACAkqB,gBAAU,IADV;AAEAC,iBAAW,KAFX;AAGAhc,eACC;AAAArF,aAAK;AAAL;AAJD,KADD;AAOAkhB,kBACC;AAAA1a,aAAOA,KAAP;AACAW,YACC;AAAAma,oBAAY,CAAC;AAAb,OAFD;AAGAjnB,cACC;AAAA3S,aAAK,CAAL;AACAoI,gBAAQ,CADR;AAEAqJ,aAAK,CAFL;AAGAxP,cAAM,CAHN;AAIA+F,qBAAa,CAJb;AAKApD,cAAM,CALN;AAMAuL,aAAK,CANL;AAOAypB,oBAAY;AAPZ;AAJD,KADD;AAcA,WAAO,KAAC32B,IAAD,CAAMw2B,SAAN,EAAiBD,WAAjB,CAAP;AAtByB,GCSzB;;AA6BArP,SAAOve,SAAP,CDdDiuB,cCcC,GDde,UAACrqB,MAAD,EAASpH,MAAT,EAAiB0xB,KAAjB,EAAwBvc,IAAxB,EAA8BT,KAA9B;AACf,QAAA6K,QAAA,EAAA7D,GAAA;AAAA6D,eACC;AAAAlW,WAAKjC,MAAL;AACApH,cAAQA,MADR;AAEA0xB,aAAOA,KAFP;AAGAJ,gBAAU,KAHV;AAIAC,iBAAW,IAJX;AAKAI,gBAAU,CALV;AAMAC,iBAAW/nB,EAAEzM,YAAF,CAAe+X,KAAKtb,IAApB,EAA0B,GAA1B,CANX;AAOA23B,kBAAgB,IAAA75B,IAAA;AAPhB,KADD;;AAUAjB,MAAEkgB,MAAF,CAAS2I,QAAT,EAAmBpK,IAAnB,EAAyBT,KAAzB;;AAEA,QAAG,EAAAgH,MAAA,KAAAmI,KAAA,CAAAgO,MAAA,YAAAnW,IAAAH,MAAA,kBAAH;AACCpG,aAAO,KAAC0O,KAAD,CAAOgO,MAAP,CAActW,MAAd,CAAqBgE,QAArB,CAAP;AADD;AAGCpK,aAAO,KAACoG,MAAD,CAAQgE,QAAR,CAAP;ACeE;;ADbH,WAAOpK,IAAP;AAlBe,GCcf;;AAqBA4M,SAAOve,SAAP,CDfDsuB,kBCeC,GDfmB,UAACC,MAAD,EAAS/xB,MAAT,EAAiBmV,IAAjB;AACnB,QAAAtY,MAAA,EAAA6e,GAAA,EAAApgB,MAAA,EAAA+Z,MAAA;;AAAA,QAAG,CAAI0c,MAAP;AACC;ACiBE;;ADfHl1B,aACC;AAAAjF,WAAKm6B,MAAL;AACA/xB,cAAQA;AADR,KADD;AAIAqV,aACC;AAAAC,YACC;AAAAgc,kBAAU,IAAV;AACAC,mBAAW,KADX;AAEAI,kBAAU;AAFV;AADD,KADD;AAMAtc,WAAOC,IAAP,GAAc5e,EAAEkgB,MAAF,CAASzB,IAAT,EAAeE,OAAOC,IAAtB,CAAd;;AAEA,QAAG,EAAAoG,MAAA,KAAAmI,KAAA,CAAAgO,MAAA,YAAAnW,IAAAH,MAAA,kBAAH;AACCjgB,eAAS,KAACuoB,KAAD,CAAOgO,MAAP,CAAcxc,MAAd,CAAqBxY,MAArB,EAA6BwY,MAA7B,CAAT;AADD;AAGC/Z,eAAS,KAAC+Z,MAAD,CAAQxY,MAAR,EAAgBwY,MAAhB,CAAT;ACiBE;;ADfH,WAAO/Z,MAAP;AArBmB,GCenB;;AAyBA,SAAOymB,MAAP;AAED,CD7F2B,CAAkB5rB,WAAWC,MAAX,CAAkBgvB,KAApC,IAA5B,+F;;;;;;;;;;;;AEAA,IAAA4M,UAAA;AAAA,IAAApb,SAAA,UAAAyO,KAAA,EAAAC,MAAA;AAAA,WAAAntB,GAAA,2CAAAmtB,MAAA;AAAA,QAAAC,QAAA7sB,IAAA,CAAA4sB,MAAA,EAAAntB,GAAA,GAAAktB,MAAAltB,GAAA,IAAAmtB,OAAAntB,GAAA;AAAA;;AAAA,WAAAqtB,IAAA;AAAA,SAAApB,WAAA,GAAAiB,KAAA;AAAA;;AAAAG,OAAAhiB,SAAA,GAAA8hB,OAAA9hB,SAAA;AAAA6hB,QAAA7hB,SAAA,OAAAgiB,IAAA;AAAAH,QAAAI,SAAA,GAAAH,OAAA9hB,SAAA;AAAA,SAAA6hB,KAAA;AAAA;AAAA,ICEEE,UAAU,GAAGG,cDFf;;AAAMsM,aAAA,UAAArM,UAAA;ACKJ/O,SAAOob,UAAP,EAAmBrM,UAAnB;;ADJY,WAAAqM,UAAA;AACZA,eAAAvM,SAAA,CAAArB,WAAA,CAAAzgB,KAAA,OAAMD,SAAN;;AAEA,SAACshB,cAAD,CAAgB;AAAE,eAAS;AAAX,KAAhB,EAAgC;AAAEY,cAAQ;AAAV,KAAhC;AACA,SAACZ,cAAD,CAAgB;AAAE,cAAQ;AAAV,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,mBAAa;AAAf,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,gBAAU;AAAZ,KAAhB;AACA,SAACA,cAAD,CAAgB;AAAE,gBAAU;AAAZ,KAAhB,EAAiC;AAAEY,cAAQ;AAAV,KAAjC;AACA,SAACZ,cAAD,CAAgB;AAAE,0BAAoB;AAAtB,KAAhB,EAA2C;AAAEY,cAAQ;AAAV,KAA3C;AACA,SAACZ,cAAD,CAAgB;AAAE,cAAQ;AAAV,KAAhB;AAEA,SAAKhB,KAAL,CAAWc,WAAX,CAAuB,UAAvB,EAAmC,QAAnC;AAXY;;ACsCZkN,aAAWxuB,SAAX,CDzBD+mB,iBCyBC,GDzBkB,UAAC3yB,GAAD,EAAM8H,OAAN;AAClB,WAAO,KAACmP,OAAD,CAAS;AAAE2b,iBAAW5yB;AAAb,KAAT,EAA6B8H,OAA7B,CAAP;AADkB,GCyBlB;;AAMAsyB,aAAWxuB,SAAX,CD5BDyQ,iBC4BC,GD5BkB,UAAC/S,QAAD,EAAWxB,OAAX;AAClB,QAAA2I,KAAA;AAAAA,YACC;AAAAnH,gBAAUA;AAAV,KADD;AAGA,WAAO,KAAC2N,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AAJkB,GC4BlB;;AAQAsyB,aAAWxuB,SAAX,CD9BDyuB,qBC8BC,GD9BsB,UAACC,YAAD,EAAexyB,OAAf;AACtB,QAAA2I,KAAA;AAAAA,YACC;AAAA,wBAAsB,IAAAuB,MAAA,CAAO,MAAMC,EAAEC,YAAF,CAAeooB,YAAf,CAAN,GAAqC,GAA5C,EAAiD,GAAjD;AAAtB,KADD;AAGA,WAAO,KAACrjB,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AAJsB,GC8BtB;;AAQAsyB,aAAWxuB,SAAX,CDhCD2uB,YCgCC,GDhCa,UAACC,KAAD,EAAQ1yB,OAAR;AACb,QAAA2I,KAAA;AAAAA,YACC;AAAA+pB,aAAOA;AAAP,KADD;AAGA,WAAO,KAACvjB,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AAJa,GCgCb;;AAQAsyB,aAAWxuB,SAAX,CDlCD6uB,wBCkCC,GDlCyB,UAACz6B,GAAD,EAAMsU,KAAN,EAAaxM,OAAb;AACzB,QAAA2I,KAAA;AAAAA,YACC;AAAAzQ,WAAKA,GAAL;AACA,iDAA4CyhB,SAASiZ,eAAT,CAAyBpmB,KAAzB;AAD5C,KADD;AAIA,WAAO,KAAC2C,OAAD,CAASxG,KAAT,EAAgB3I,OAAhB,CAAP;AALyB,GCkCzB;;AASAsyB,aAAWxuB,SAAX,CDlCDonB,QCkCC,GDlCS,UAAC5qB,MAAD;AACT,QAAAqI,KAAA;AAAAA,YACC;AAAAzQ,WAAKoI;AAAL,KADD;AAGA,WAAO,KAACnF,IAAD,CAAMwN,KAAN,CAAP;AAJS,GCkCT;;AAQA2pB,aAAWxuB,SAAX,CDpCD+uB,mBCoCC,GDpCoB,UAAC7yB,OAAD;AACpB,QAAA2I,KAAA;AAAAA,YACC;AAAAnH,gBACC;AAAAuc,iBAAS;AAAT,OADD;AAEAtN,cACC;AAAAT,aAAK,CAAC,QAAD,EAAW,MAAX,EAAmB,MAAnB;AAAL;AAHD,KADD;AAMA,WAAO,KAAC7U,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAPoB,GCoCpB;;AAaAsyB,aAAWxuB,SAAX,CDvCD8T,cCuCC,GDvCe,UAACpW,QAAD,EAAWxB,OAAX;AACf,QAAA2I,KAAA;AAAAA,YACC;AAAAnH,gBAAUA;AAAV,KADD;AAGA,WAAO,KAACrG,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJe,GCuCf;;AAQAsyB,aAAWxuB,SAAX,CDzCD6G,kCCyCC,GDzCmC,UAACC,SAAD,EAAY5K,OAAZ;AACnC,QAAA2I,KAAA,EAAA/M,MAAA;;AAAA,QAAG,KAAKqoB,QAAR;AACCroB,eACC;AAAAkP,eAAO;AACN,iBAAOrU,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwB8Z,cAAxB,CAAuC,YAAvC,EAAqDhnB,IAArD,GAA4DL,MAA5D,CAAmE,UAAC0hB,MAAD;AACzE,mBAAOjU,UAAUxN,OAAV,CAAkByhB,OAAOrd,QAAzB,IAAqC,CAAC,CAA7C;AADM,YAAP;AADD;AAGAojB,eAAO;AACN,iBAAOhpB,OAAOkP,KAAP,GAAepP,MAAtB;AAJD;AAKAnD,iBAAS,UAACuN,EAAD;AACR,iBAAOlK,OAAOkP,KAAP,GAAevS,OAAf,CAAuBuN,EAAvB,CAAP;AAND;AAAA,OADD;AAQA,aAAOlK,MAAP;ACgDE;;AD9CH+M,YACC;AAAAnH,gBAAU;AAAEwO,aAAKpF;AAAP,OAAV;AACA,2CACC;AAAAmT,iBAAS;AAAT;AAFD,KADD;AAKA,WAAO,KAAC5iB,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAjBmC,GCyCnC;;AA6BAsyB,aAAWxuB,SAAX,CDnDDgvB,6CCmDC,GDnD8C,UAACC,UAAD,EAAaC,UAAb,EAA8BhzB,OAA9B;AAC9C,QAAA2I,KAAA,EAAAsqB,SAAA;;ACoDE,QAAID,cAAc,IAAlB,EAAwB;ADrDiCA,mBAAa,EAAb;ACuDxD;;AACD,QAAIhzB,WAAW,IAAf,EAAqB;ADxDqDA,gBAAU,EAAV;AC0DzE;;ADzDH,QAAG,CAAIhJ,EAAEk8B,OAAF,CAAUF,UAAV,CAAP;AACCA,mBAAa,CAAEA,UAAF,CAAb;AC2DE;;ADzDHC,gBAAgB,IAAA/oB,MAAA,CAAOC,EAAEC,YAAF,CAAe2oB,UAAf,CAAP,EAAmC,GAAnC,CAAhB;AACApqB,YAAQ;AACP+P,WAAK,CAAC;AACLlX,kBAAUyxB;AADL,OAAD,EAEF;AACF94B,cAAM84B;AADJ,OAFE,CADE;AAMPhjB,cAAQ,IAND;AAOPnT,YAAM;AACLkT,aAAK,CAAC,MAAD,EAAS,KAAT;AADA,OAPC;AAUPmjB,YAAM,CAAC;AACN3xB,kBAAU;AACTuc,mBAAS;AADA;AADJ,OAAD,EAIH;AACFvc,kBAAU;AACT+kB,gBAAMyM;AADG;AADR,OAJG;AAVC,KAAR;AAqBA,WAAO,KAAC73B,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AA1B8C,GCmD9C;;AAuCAsyB,aAAWxuB,SAAX,CD9DDsvB,uBC8DC,GD9DwB,UAACL,UAAD,EAAaC,UAAb,EAA8BhzB,OAA9B;AACxB,QAAA2I,KAAA,EAAAsqB,SAAA;;AC+DE,QAAID,cAAc,IAAlB,EAAwB;ADhEWA,mBAAa,EAAb;ACkElC;;AACD,QAAIhzB,WAAW,IAAf,EAAqB;ADnE+BA,gBAAU,EAAV;ACqEnD;;ADpEH,QAAG,CAAIhJ,EAAEk8B,OAAF,CAAUF,UAAV,CAAP;AACCA,mBAAa,CAAEA,UAAF,CAAb;ACsEE;;ADpEHC,gBAAgB,IAAA/oB,MAAA,CAAOC,EAAEC,YAAF,CAAe2oB,UAAf,CAAP,EAAmC,GAAnC,CAAhB;AACApqB,YACC;AAAAwqB,YAAM,CACL;AACCljB,gBAAQ,IADT;AAECyI,aAAK,CACJ;AACClX,oBAAUyxB;AADX,SADI,EAIJ;AACC94B,gBAAM84B;AADP,SAJI;AAFN,OADK,EAYL;AACCzxB,kBAAU;AAAEuc,mBAAS,IAAX;AAAiBwI,gBAAMyM;AAAvB;AADX,OAZK;AAAN,KADD;AAkBA,WAAO,KAAC73B,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAvBwB,GC8DxB;;AAkCAsyB,aAAWxuB,SAAX,CDvEDuvB,yBCuEC,GDvE0B,UAACC,cAAD,EAAiBtzB,OAAjB;AAC1B,QAAA2I,KAAA;AAAAA,YACC;AAAAnH,gBACC;AAAAuc,iBAAS;AAAT,OADD;AAGArF,WAAK,CACJ;AAACve,cAAMm5B;AAAP,OADI,EAEJ;AAAC9xB,kBAAU8xB;AAAX,OAFI,CAHL;AAQAx2B,YACC;AAAAkT,aAAK,CAAC,MAAD;AAAL;AATD,KADD;AAYA,WAAO,KAAC7U,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAb0B,GCuE1B;;AAoBAsyB,aAAWxuB,SAAX,CD5EDgU,gCC4EC,GD5EiC,UAACyb,0BAAD,EAA6BvzB,OAA7B;AACjC,QAAA2I,KAAA;AAAAA,YACC;AAAA+P,WAAK,CACJ;AAACve,cAAMo5B;AAAP,OADI,EAEJ;AAAC/xB,kBAAU+xB;AAAX,OAFI,EAGJ;AAAC,0BAAkBA;AAAnB,OAHI,CAAL;AAKAz2B,YACC;AAAAkT,aAAK,CAAC,MAAD,EAAS,KAAT;AAAL;AAND,KADD;AASA,WAAO,KAAC7U,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAViC,GC4EjC;;AAmBAsyB,aAAWxuB,SAAX,CDnFD0vB,aCmFC,GDnFc,UAACxzB,OAAD;AACd,QAAA2I,KAAA;AAAAA,YACC;AAAA8qB,YAAM;AAAN,KADD;AAGA,WAAO,KAACt4B,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJc,GCmFd;;AAQAsyB,aAAWxuB,SAAX,CDrFD4vB,cCqFC,GDrFe,UAAC1zB,OAAD;AACf,QAAA2I,KAAA;AAAAA,YACC;AAAAgrB,aAAO;AAAP,KADD;AAGA,WAAO,KAACx4B,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AAJe,GCqFf;;AAQAsyB,aAAWxuB,SAAX,CDvFD8vB,YCuFC,GDvFa,UAAC5zB,OAAD;AACb,QAAA2I,KAAA,EAAAqT,GAAA,EAAAC,IAAA,EAAAO,IAAA;;ACwFE,QAAIxc,WAAW,IAAf,EAAqB;ADzFTA,gBAAU,EAAV;AC2FX;;AD1FH2I,YAAQ;AAAE0O,iBAAW;AAAE0G,iBAAS;AAAX;AAAb,KAAR;AACA/d,YAAQ2X,IAAR,GAAe;AAAEN,iBAAW,CAAC;AAAd,KAAf;AACArX,YAAQgX,KAAR,GAAgB,CAAhB;AAEA,YAAAgF,MAAA,KAAA7gB,IAAA,CAAAwN,KAAA,EAAA3I,OAAA,oBAAAgc,IAAAlR,KAAA,mBAAAmR,OAAAD,IAAAlR,KAAA,eAAA0R,OAAAP,KAAA,cAAAO,KAA4CnF,SAA5C,GAA4C,MAA5C,GAA4C,MAA5C,GAA4C,MAA5C,GAA4C,MAA5C;AALa,GCuFb;;AAiBAib,aAAWxuB,SAAX,CDjGD+vB,oBCiGC,GDjGqB,UAACjpB,SAAD,EAAY5K,OAAZ;AACrB,QAAA2I,KAAA;AAAAA,YACC;AAAAnH,gBACC;AAAAwO,aAAKpF;AAAL;AADD,KADD;AAIA,WAAO,KAACzP,IAAD,CAAMwN,KAAN,EAAa3I,OAAb,CAAP;AALqB,GCiGrB;;AAUAsyB,aAAWxuB,SAAX,CDnGDmpB,YCmGC,GDnGa,UAAC/0B,GAAD,EAAM4yB,SAAN;AACb,QAAAniB,KAAA,EAAAgN,MAAA;AAAAmV,gBAAY,GAAG7wB,MAAH,CAAU6wB,SAAV,CAAZ;AAEAniB,YACC;AAAAzQ,WAAKA;AAAL,KADD;AAGAyd,aACC;AAAAyF,iBACC;AAAA0P,mBACC;AAAAoC,iBAAOpC;AAAP;AADD;AADD,KADD;AAKA,WAAO,KAACnV,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAXa,GCmGb;;AAgBA2c,aAAWxuB,SAAX,CDtGDgwB,mBCsGC,GDtGoB,UAAC57B,GAAD;AACpB,QAAAyd,MAAA;AAAAA,aACC;AAAAC,YACC;AAAAyB,mBAAW,IAAIpf,IAAJ;AAAX;AADD,KADD;AAIA,WAAO,KAAC0d,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALoB,GCsGpB;;AAUA2c,aAAWxuB,SAAX,CDzGDiwB,YCyGC,GDzGa,UAAC77B,GAAD,EAAM87B,WAAN,EAAmBC,SAAnB;AACb,QAAAC,YAAA,EAAAve,MAAA;AAAAA,aACC;AAAAC,YAAM;AAAN,KADD;AAGAse,mBAAe,cAAYF,WAAZ,GAAwB,KAAvC;AACAre,WAAOC,IAAP,CAAYse,YAAZ,IAA4BD,SAA5B;AAEA,WAAO,KAACte,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AAPa,GCyGb;;AAUA2c,aAAWxuB,SAAX,CD1GDuW,WC0GC,GD1GY,UAACniB,GAAD,EAAMsJ,QAAN;AACZ,QAAAmU,MAAA;AAAAA,aACC;AAAAC,YAAM;AAAApU,kBAAUA;AAAV;AAAN,KADD;AAGA,WAAO,KAACmU,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AAJY,GC0GZ;;AAUA2c,aAAWxuB,SAAX,CD9GDyW,QC8GC,GD9GS,UAACriB,GAAD,EAAMyF,KAAN;AACT,QAAAgY,MAAA;AAAAA,aACC;AAAAC,YACC;AAAAtI,gBAAQ,CACP;AAAAG,mBAAS9P,KAAT;AACA4P,oBAAU;AADV,SADO;AAAR;AADD,KADD;AAOA,WAAO,KAACoI,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AARS,GC8GT;;AAeA2c,aAAWxuB,SAAX,CDnHDqwB,gBCmHC,GDnHiB,UAACj8B,GAAD,EAAMyF,KAAN;AACjB,QAAAgL,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA,GAAL;AACAoV,cACC;AAAA8mB,oBACC;AAAA3mB,mBAAS9P,KAAT;AACA4P,oBAAU;AADV;AADD;AAFD,KADD;AAOAoI,aACC;AAAAC,YACC;AAAA,6BAAqB;AAArB;AADD,KADD;AAIA,WAAO,KAACD,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAZiB,GCmHjB;;AAmBA2c,aAAWxuB,SAAX,CDxHD+d,OCwHC,GDxHQ,UAAC3pB,GAAD,EAAMiC,IAAN;AACR,QAAAwb,MAAA;AAAAA,aACC;AAAAC,YACC;AAAAzb,cAAMA;AAAN;AADD,KADD;AAIA,WAAO,KAACwb,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALQ,GCwHR;;AAUA2c,aAAWxuB,SAAX,CD3HDmX,eC2HC,GD3HgB,UAAC/iB,GAAD,EAAM2S,MAAN;AAChB,QAAApS,GAAA,EAAAkd,MAAA,EAAAnd,KAAA,EAAA67B,MAAA;AAAAA,aAAS,EAAT;;AACA,SAAA57B,GAAA,2CAAAoS,MAAA;AC6HIrS,cAAQqS,OAAOpS,GAAP,CAAR;AD5HH47B,aAAO,kBAAgB57B,GAAvB,IAAgCD,KAAhC;AADD;;AAGAmd,aACC;AAAAC,YAAMye;AAAN,KADD;AAGA,WAAO,KAAC1e,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AARgB,GC2HhB;;AAaA2c,aAAWxuB,SAAX,CD9HDwb,eC8HC,GD9HgB,UAACpnB,GAAD,EAAM4sB,MAAN;AAChB,QAAAnP,MAAA;AAAAA,aACC;AAAAC,YACC;AAAAa,sBAAcqO;AAAd;AADD,KADD;AAIA,WAAO,KAACnP,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALgB,GC8HhB;;AAUA2c,aAAWxuB,SAAX,CDjIDwwB,iBCiIC,GDjIkB,UAACp8B,GAAD;AAClB,QAAAyd,MAAA;AAAAA,aACC;AAAAmI,cACC;AAAArH,sBAAc;AAAd;AADD,KADD;AAIA,WAAO,KAACd,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALkB,GCiIlB;;AAUA2c,aAAWxuB,SAAX,CDpIDywB,aCoIC,GDpIc,UAACr8B,GAAD,EAAM+X,MAAN;AACd,QAAA0F,MAAA;;ACqIE,QAAI1F,UAAU,IAAd,EAAoB;ADtIFA,eAAO,IAAP;ACwIjB;;ADvIH0F,aACC;AAAAC,YACC;AAAA3F,gBAAQA;AAAR;AADD,KADD;AAIA,WAAO,KAAC0F,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALc,GCoId;;AAaA2c,aAAWxuB,SAAX,CD1ID0wB,iBC0IC,GD1IkB,UAACvkB,MAAD;AAClB,QAAA0F,MAAA;AAAAA,aACC;AAAAC,YACC;AAAA3F,gBAAQA;AAAR;AADD,KADD;AAIA,WAAO,KAAC0F,MAAD,CAAQ,EAAR,EAAYA,MAAZ,EAAoB;AAAEoT,aAAO;AAAT,KAApB,CAAP;AALkB,GC0IlB;;AAYAuJ,aAAWxuB,SAAX,CD/ID2wB,gBC+IC,GD/IiB,UAACv8B,GAAD;AACjB,QAAAyd,MAAA;AAAAA,aACC;AAAAC,YACC;AAAA,uCAAgC;AAAhC;AADD,KADD;AAIA,WAAO,KAACD,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALiB,GC+IjB;;AAUA2c,aAAWxuB,SAAX,CDlJD4wB,0BCkJC,GDlJ2B,UAACx8B,GAAD;AAC3B,QAAAyd,MAAA;AAAAA,aACC;AAAAmI,cACC;AAAA,iCAA0B,IAA1B;AACA,uCAAgC;AADhC;AADD,KADD;AAKA,WAAO,KAACnI,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AAN2B,GCkJ3B;;AAWA2c,aAAWxuB,SAAX,CDrJD6wB,wCCqJC,GDrJyC,UAACz8B,GAAD,EAAMqf,qBAAN,EAA6BC,2BAA7B;AACzC,QAAA7B,MAAA;AAAAA,aACC;AAAAmI,cACC;AAAA,6BAAqB;AAArB,OADD;AAEAlI,YACC;AAAA,iCAA0B2B,qBAA1B;AACA,uCAA+BC;AAD/B;AAHD,KADD;AAOA,WAAO,KAAC7B,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AARyC,GCqJzC;;AAcA2c,aAAWxuB,SAAX,CDzJD8wB,WCyJC,GDzJY,UAAC18B,GAAD,EAAM0I,QAAN;AACZ,QAAA+U,MAAA;AAAAA,aACC;AAAAC,YACC;AAAAhV,kBAAUA;AAAV;AADD,KADD;AAIA,WAAO,KAAC+U,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALY,GCyJZ;;AAUA2c,aAAWxuB,SAAX,CD5JD+wB,UC4JC,GD5JW,UAAC38B,GAAD,EAAM48B,OAAN;AACX,QAAAnf,MAAA;AAAAA,aACC;AAAAC,YACC;AAAA,4BAAoBkf;AAApB;AADD,KADD;AAIA,WAAO,KAACnf,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALW,GC4JX;;AAUA2c,aAAWxuB,SAAX,CD/JDixB,cC+JC,GD/Je,UAAC78B,GAAD,EAAM+S,WAAN;AACf,QAAA0K,MAAA;AAAAA,aACC;AAAAC,YACC;AAAA,gCAAwB3K;AAAxB;AADD,KADD;AAIA,WAAO,KAAC0K,MAAD,CAAQzd,GAAR,EAAayd,MAAb,CAAP;AALe,GC+Jf;;AAUA2c,aAAWxuB,SAAX,CDlKDkxB,YCkKC,GDlKa,UAAC98B,GAAD,EAAM+e,SAAN;AACb,QAAAtO,KAAA,EAAAgN,MAAA;AAAAhN,YACC;AAAAzQ,WAAKA,GAAL;AACA+e,iBACC;AAAAzG,aAAKyG;AAAL;AAFD,KADD;AAKAtB,aACC;AAAAC,YACC;AAAAqB,mBAAWA;AAAX;AADD,KADD;AAIA,WAAO,KAACtB,MAAD,CAAQhN,KAAR,EAAegN,MAAf,CAAP;AAVa,GCkKb;;AAgBA2c,aAAWxuB,SAAX,CDtKDmxB,YCsKC,GDtKa,UAAC/8B,GAAD,EAAMsF,IAAN;AACb,QAAAkxB,OAAA,EAAAC,SAAA,EAAAhZ,MAAA;AAAA+Y,cAAU,EAAV;AACAC,gBAAY,EAAZ;;AAEA,QAAGnxB,KAAArD,IAAA,QAAH;AACC,UAAG,CAAInD,EAAE43B,OAAF,CAAUzkB,EAAEjT,IAAF,CAAOsG,KAAKrD,IAAZ,CAAV,CAAP;AACCu0B,gBAAQv0B,IAAR,GAAegQ,EAAEjT,IAAF,CAAOsG,KAAKrD,IAAZ,CAAf;AADD;AAGCw0B,kBAAUx0B,IAAV,GAAiB,CAAjB;AAJF;AC4KG;;ADtKH,QAAGqD,KAAAG,KAAA,QAAH;AACC,UAAG,CAAI3G,EAAE43B,OAAF,CAAUzkB,EAAEjT,IAAF,CAAOsG,KAAKG,KAAZ,CAAV,CAAP;AACC+wB,gBAAQphB,MAAR,GAAiB,CAChB;AAAAG,mBAAStD,EAAEjT,IAAF,CAAOsG,KAAKG,KAAZ;AAAT,SADgB,CAAjB;AADD;AAKCgxB,kBAAUrhB,MAAV,GAAmB,CAAnB;AANF;ACiLG;;ADzKH,QAAG9P,KAAA2Z,KAAA,QAAH;AACC,UAAG,CAAIngB,EAAE43B,OAAF,CAAUzkB,EAAEjT,IAAF,CAAOsG,KAAK2Z,KAAZ,CAAV,CAAP;AACCuX,gBAAQvX,KAAR,GAAgB,CACf;AAAA+d,uBAAa/qB,EAAEjT,IAAF,CAAOsG,KAAK2Z,KAAZ;AAAb,SADe,CAAhB;AADD;AAKCwX,kBAAUxX,KAAV,GAAkB,CAAlB;AANF;ACoLG;;AD5KHxB,aAAS,EAAT;;AAEA,QAAG,CAAI3e,EAAE43B,OAAF,CAAUF,OAAV,CAAP;AACC/Y,aAAOC,IAAP,GAAc8Y,OAAd;AC6KE;;AD3KH,QAAG,CAAI13B,EAAE43B,OAAF,CAAUD,SAAV,CAAP;AACChZ,aAAOmI,MAAP,GAAgB6Q,SAAhB;AC6KE;;AD3KH,QAAG33B,EAAE43B,OAAF,CAAUjZ,MAAV,CAAH;AACC,aAAO,IAAP;AC6KE;;AD3KH,WAAO,KAACA,MAAD,CAAQ;AAAEzd,WAAKA;AAAP,KAAR,EAAsByd,MAAtB,CAAP;AArCa,GCsKb;;AAgDA2c,aAAWxuB,SAAX,CD9KDqxB,MC8KC,GD9KO,UAAC33B,IAAD;AACP,QAAA+E,IAAA;AAAAA,WACC;AAAA6U,iBAAW,IAAInf,IAAJ,EAAX;AACAwe,oBAAc;AADd,KADD;;AAIAzf,MAAEkgB,MAAF,CAAS3U,IAAT,EAAe/E,IAAf;;AAEA,WAAO,KAACqe,MAAD,CAAQtZ,IAAR,CAAP;AAPO,GC8KP;;AAUA+vB,aAAWxuB,SAAX,CD7KDgS,UC6KC,GD7KW,UAAC5d,GAAD;AACX,WAAO,KAACmD,MAAD,CAAQnD,GAAR,CAAP;AADW,GC6KX,CDlkBI,CAwZL;;;;;;;;ACuLCo6B,aAAWxuB,SAAX,CDhLDqJ,0BCgLC,GDhL2B,UAACioB,QAAD;AAC3B,QAAAzsB,KAAA;AAAAA,YACC;AAAAzQ,WACC;AAAA8X,aAAKolB;AAAL,OADD;AAEAnlB,cAAQ,IAFR;AAGAQ,cAAQ,SAHR;AAIArB,wBACC;AAAAoB,aAAK;AAAL,OALD;AAMA,yBAAmB;AANnB,KADD;AASA,WAAO,KAACrV,IAAD,CAAMwN,KAAN,EAAa;AAAEkC,cAAQ;AAAE1Q,cAAM,CAAR;AAAWqH,kBAAU,CAArB;AAAwB8L,gBAAQ,CAAhC;AAAmC,sDAA8C;AAAjF;AAAV,KAAb,CAAP;AAV2B,GCgL3B;;AAuBA,SAAOglB,UAAP;AAED,CDxmBK,CAAmB77B,WAAWC,MAAX,CAAkBgvB,KAArC;;AA2aNjvB,WAAWC,MAAX,CAAkBgU,KAAlB,GAA8B,IAAA4nB,UAAA,CAAW36B,OAAOoc,KAAlB,EAAyB,IAAzB,CAA9B,iE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE3aA,IAAIshB,aAAJ;AAAS11B,OAAO8E,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAAC0wB,SAAK1wB,CAAL;AAAO;AAAnB,CAA/B,EAAoD,CAApD;AAAuD,IAAI2wB,qBAAJ;AAAiB31B,OAAO8E,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAC4wB,aAAD,YAAc3wB,CAAd,EAAgB;AAAC2wB,iBAAa3wB,CAAb;AAAe;AAAhC,CAA/B,EAAiE,CAAjE;AAAoE,IAAI4wB,mBAAJ;AAAe51B,OAAO8E,KAAP,CAAaC,QAAQ,aAAR,CAAb,EAAoC;AAAA,sBAASC,CAAT,EAAW;AAAC4wB,eAAW5wB,CAAX;AAAa;AAAzB,CAApC,EAA+D,CAA/D;AAMpK,IAAMrB,SAAS,IAAIC,MAAJ,CAAW,WAAX,CAAf;AAEA,IAAMiyB,SAASH,KAAKI,OAAL,CAAaC,GAA5B;AACA,IAAMC,SAASN,KAAKI,OAAL,CAAajlB,GAA5B;;AAEA6kB,KAAKI,OAAL,CAAaC,GAAb,GAAmB,UAASE,CAAT,EAAYC,CAAZ,EAAe;AACjC,KAAIhyB,MAAMqvB,OAAN,CAAc0C,CAAd,CAAJ,EAAsB;AACrB,SAAOA,EAAEx4B,OAAF,CAAUy4B,CAAV,MAAiB,CAAC,CAAzB;AACA;;AACD,QAAOL,OAAOI,CAAP,EAAUC,CAAV,CAAP;AACA,CALD;;AAOAR,KAAKI,OAAL,CAAajlB,GAAb,GAAmB,UAASolB,CAAT,EAAYC,CAAZ,EAAe;AACjC,KAAIhyB,MAAMqvB,OAAN,CAAc0C,CAAd,CAAJ,EAAsB;AACrB,SAAOA,EAAEx4B,OAAF,CAAUy4B,CAAV,MAAiB,CAAC,CAAzB;AACA;;AACD,QAAOF,OAAOC,CAAP,EAAUC,CAAV,CAAP;AACA,CALD;;AAOA,IAAMC,SAAST,KAAKI,OAAL,CAAazlB,GAA5B;;AACAqlB,KAAKI,OAAL,CAAazlB,GAAb,GAAmB,UAAS4lB,CAAT,EAAYC,CAAZ,EAAe;AACjC,KAAIhyB,MAAMqvB,OAAN,CAAc0C,CAAd,CAAJ,EAAsB;AACrB,SAAOA,EAAE7rB,IAAF,CAAO;AAAA,UAAQ+rB,OAAOC,IAAP,EAAaF,CAAb,CAAR;AAAA,GAAP,CAAP;AACA;;AACD,QAAOC,OAAOF,CAAP,EAAUC,CAAV,CAAP;AACA,CALD;;AAOAR,KAAKI,OAAL,CAAalP,IAAb,GAAoB,UAASqP,CAAT,EAAYC,CAAZ,EAAe;AAClC,QAAO,CAACR,KAAKI,OAAL,CAAazlB,GAAb,CAAiB4lB,CAAjB,EAAoBC,CAApB,CAAR;AACA,CAFD;;AAIAR,KAAKI,OAAL,CAAajJ,IAAb,GAAoB,UAASoJ,CAAT,EAAYC,CAAZ,EAAe;AAClC,QAAOA,EAAEG,KAAF,CAAQ;AAAA,SAAQJ,EAAEllB,QAAF,CAAWulB,IAAX,CAAR;AAAA,EAAR,CAAP;AACA,CAFD;;AAIAZ,KAAKI,OAAL,CAAa1X,OAAb,GAAuB,UAAS6X,CAAT,EAAYC,CAAZ,EAAe;AACrC,KAAIA,CAAJ,EAAO;AACN,SAAOR,KAAKI,OAAL,CAAajlB,GAAb,CAAiBolB,CAAjB,EAAoBzjB,SAApB,CAAP;AACA;;AAED,QAAOkjB,KAAKI,OAAL,CAAaC,GAAb,CAAiBE,CAAjB,EAAoBzjB,SAApB,CAAP;AACA,CAND;;AAQAkjB,KAAKI,OAAL,CAAarB,UAAb,GAA0B,UAASwB,CAAT,EAAYC,CAAZ,EAAe;AACxC,QAAO7+B,EAAEk/B,SAAF,CAAYN,CAAZ,EAAeC,CAAf,CAAP;AACA,CAFD;;AAIA,IAAMM,SAAS,CACd,MADc,EAEd,MAFc,EAGd,IAHc,EAId,iBAJc,CAAf;;AAOA,SAASC,gBAAT,CAA0BC,MAA1B,EAAkC;AACjCA,QAAOC,MAAP,GAAgB,EAAhB;;AADiC,uBAGtBC,QAHsB;AAIhC,MAAI,OAAOF,OAAOE,QAAP,CAAP,KAA4B,UAA5B,IAA0CJ,OAAO/4B,OAAP,CAAem5B,QAAf,MAA6B,CAAC,CAA5E,EAA+E;AAC9EF,UAAOC,MAAP,CAAcC,QAAd,IAA0B;AACzBC,WAAO,CADkB;AAEzB16B,UAAM,CAFmB;AAGzB26B,SAAK;AAHoB,IAA1B;AAKA,OAAMC,aAAaL,OAAOE,QAAP,CAAnB;;AACAF,UAAOE,QAAP,IAAmB,YAAkB;AAAA,sCAAN3yB,IAAM;AAANA,SAAM;AAAA;;AAEpC,QAAIyyB,OAAOM,MAAP,KAAkB,IAAtB,EAA4B;AAC3B,YAAOD,WAAWzyB,KAAX,CAAiBoyB,MAAjB,EAAyBzyB,IAAzB,CAAP;AACA;;AAED,QAAMgzB,YAAYngC,WAAWyF,YAAX,CAAwBH,GAAxB,EAAlB;AACA,QAAMH,SAAS86B,WAAWzyB,KAAX,CAAiBoyB,MAAjB,EAAyBzyB,IAAzB,CAAf;AACA,QAAM9H,OAAO4K,KAAKmwB,KAAL,CAAWpgC,WAAWyF,YAAX,CAAwBH,GAAxB,KAAgC66B,SAA3C,IAAwD,IAArE;AACAP,WAAOC,MAAP,CAAcC,QAAd,EAAwBz6B,IAAxB,IAAgCA,IAAhC;AACAu6B,WAAOC,MAAP,CAAcC,QAAd,EAAwBC,KAAxB;AACAH,WAAOC,MAAP,CAAcC,QAAd,EAAwBE,GAAxB,GAA8BJ,OAAOC,MAAP,CAAcC,QAAd,EAAwBz6B,IAAxB,GAA+Bu6B,OAAOC,MAAP,CAAcC,QAAd,EAAwBC,KAArF;AAEA,WAAO56B,MAAP;AACA,IAdD;AAeA;AA1B+B;;AAGjC,MAAK,IAAM26B,QAAX,2CAAuBF,MAAvB,GAA+B;AAAA,QAApBE,QAAoB;AAwB9B;;AAEDO,aAAY,YAAW;AACtB,OAAK,IAAMP,QAAX,2CAAuBF,OAAOC,MAA9B,GAAsC;AACrC,OAAID,OAAOC,MAAP,CAActQ,cAAd,CAA6BuQ,QAA7B,KAA0CF,OAAOC,MAAP,CAAcC,QAAd,EAAwBz6B,IAAxB,GAA+B,CAA7E,EAAgF;AAC/E,QAAM2yB,OAAO,eAAc8H,QAAd,kBAA0CF,OAAOjS,cAAjD,CAAb;AACA3tB,eAAWyF,YAAX,CAAwBC,MAAxB,CAA+B,oBAA/B,EAAqDk6B,OAAOC,MAAP,CAAcC,QAAd,EAAwBE,GAA7E,EAAkFhI,IAAlF;AACAh4B,eAAWyF,YAAX,CAAwBoK,SAAxB,CAAkC,yBAAlC,EAA6D+vB,OAAOC,MAAP,CAAcC,QAAd,EAAwBz6B,IAArF,EAA2F2yB,IAA3F;AACAh4B,eAAWyF,YAAX,CAAwBoK,SAAxB,CAAkC,qBAAlC,EAAyD+vB,OAAOC,MAAP,CAAcC,QAAd,EAAwBC,KAAjF,EAAwF/H,IAAxF;AACA4H,WAAOC,MAAP,CAAcC,QAAd,EAAwBE,GAAxB,GAA8B,CAA9B;AACAJ,WAAOC,MAAP,CAAcC,QAAd,EAAwBz6B,IAAxB,GAA+B,CAA/B;AACAu6B,WAAOC,MAAP,CAAcC,QAAd,EAAwBC,KAAxB,GAAgC,CAAhC;AACA;AACD;AACD,EAZD,EAYG,KAZH;;AAcAH,QAAOU,YAAP,GAAsB,YAAW;AAChC,MAAMC,QAAQ,EAAd;;AACA,OAAK,IAAMT,QAAX,2CAAuBF,OAAOC,MAA9B,GAAsC;AACrC,OAAID,OAAOC,MAAP,CAActQ,cAAd,CAA6BuQ,QAA7B,CAAJ,EAA4C;AAC3CS,UAAMl+B,IAAN,CAAW,CAAC4N,KAAKmwB,KAAL,CAAWR,OAAOC,MAAP,CAAcC,QAAd,EAAwBE,GAAxB,GAA4B,GAAvC,IAA4C,GAA7C,EAAkDF,QAAlD,CAAX;AACA;AACD;;AACD,SAAOv/B,EAAE6E,MAAF,CAASm7B,KAAT,EAAgB,UAASnY,MAAT,EAAiB;AACvC,UAAOA,OAAO,CAAP,CAAP;AACA,GAFM,CAAP;AAGA,EAVD;AAWA;;IAEKoY,O;;;;;mBACLC,Y;0BAAa,oBAAsB,CAAE;;;;;mBACrCC,Y;0BAAa,8BAAgC,CAAE;;;;;mBAC/CC,c;4BAAe,oBAAsB,CAAE;;;;;;;;AAGxC,IAAMnZ,KAAK,IAAIoX,IAAJ,CAAS,kBAAT,EAA6B;AAACgC,UAASJ;AAAV,CAA7B,CAAX;;IAEMrT,e;;;AACL,0BAAYO,KAAZ,EAAmB;AAAA;;AAAA,6DAClB,wBADkB;;AAGlBiS;AAEA,QAAKkB,OAAL,GAAe,EAAf;AACA,QAAK3M,mBAAL,GAA2B,CAAC,YAAD,CAA3B;AAEA,QAAKhiB,KAAL,GAAa,EAAb;AACA,QAAK3I,OAAL,GAAe,EAAf;;AAEA,QAAKolB,WAAL,CAAiB,KAAjB,EAAwB,QAAxB;;AAEA,QAAKmS,KAAL,GAAa,EAAb;;AAEA,QAAKpyB,EAAL,CAAQ,UAAR,EAAoB,YAAa;AAAA,sCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,SAAV,EAAqB,UAArB,SAAoCzf,IAApC;AAA4C,GAA/E;;AACA,QAAKuB,EAAL,CAAQ,SAAR,EAAmB,YAAa;AAAA,sCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,SAAV,EAAqB,SAArB,SAAmCzf,IAAnC;AAA2C,GAA7E;;AACA,QAAKuB,EAAL,CAAQ,SAAR,EAAmB,YAAa;AAAA,sCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,SAAV,EAAqB,SAArB,SAAmCzf,IAAnC;AAA2C,GAA7E;;AAEA,QAAKuB,EAAL,CAAQ,cAAR,EAAwB,YAAa;AAAA,sCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,cAAV,EAA0B,UAA1B,SAAyCzf,IAAzC;AAAiD,GAAxF;;AACA,QAAKuB,EAAL,CAAQ,cAAR,EAAwB,YAAa;AAAA,sCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,cAAV,EAA0B,SAA1B,SAAwCzf,IAAxC;AAAgD,GAAvF;;AACA,QAAKuB,EAAL,CAAQ,cAAR,EAAwB,YAAa;AAAA,sCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,cAAV,EAA0B,SAA1B,SAAwCzf,IAAxC;AAAgD,GAAvF;;AAEA,QAAKuB,EAAL,CAAQ,UAAR,EAAoB,YAAa;AAAA,sCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,MAAV,EAAkB,UAAlB,SAAiCzf,IAAjC;AAAyC,GAA5E;;AACA,QAAKuB,EAAL,CAAQ,SAAR,EAAmB,YAAa;AAAA,sCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,MAAV,EAAkB,SAAlB,SAAgCzf,IAAhC;AAAwC,GAA1E;;AACA,QAAKuB,EAAL,CAAQ,cAAR,EAAwB,YAAa;AAAA,uCAATvB,IAAS;AAATA,QAAS;AAAA;;AAAE,SAAKyf,IAAL,eAAU,MAAV,EAAkB,SAAlB,SAAgCzf,IAAhC;AAAwC,GAA/E;;AAEA,QAAKqa,EAAL,GAAUA,EAAV;AAEA,QAAKkG,KAAL,GAAaA,KAAb;AAEA,QAAKC,cAAL,GAAsB,MAAKD,KAAL,CAAWD,GAAX,CAAeE,cAArC;AACA,QAAKoT,UAAL,GAAkB,MAAKvZ,EAAL,CAAQwZ,aAAR,CAAsB,MAAKrT,cAA3B,CAAlB;AAhCkB;AAiClB;;2BAEDsT,M;kBAAOtrB,I,QAAqB;AAAA,OAAdkN,KAAc,QAAdA,KAAc;AAAA,OAAPla,IAAO,QAAPA,IAAO;AAC3B,QAAKgN,IAAL,CAAU;AAACA,cAAD;AAAOkN,gBAAP;AAAcla,cAAd;AAAoB2pB,WAAO;AAA3B,IAAV;AACA;;;;;2BAED4O,O;mBAAQvrB,I,SAAqB;AAAA,OAAdkN,KAAc,SAAdA,KAAc;AAAA,OAAPla,IAAO,SAAPA,IAAO;AAC5B,QAAKgN,IAAL,CAAU;AAACA,cAAD;AAAOkN,gBAAP;AAAcla,cAAd;AAAoB2pB,WAAO;AAA3B,IAAV;AACA;;;;;2BAED3c,I;uBAAiC;AAAA;;AAAA,OAA3BA,KAA2B,SAA3BA,IAA2B;AAAA,OAArBkN,KAAqB,SAArBA,KAAqB;AAAA,OAAdla,IAAc,SAAdA,IAAc;AAAA,OAAR2pB,KAAQ,SAARA,KAAQ;;AAChC,OAAI,CAACtyB,WAAWC,MAAX,CAAkB0V,KAAlB,CAAL,EAA8B;AAC7B9P,YAAQC,GAAR,0BAAoC6P,KAApC;AACA;AACA;;AAED3V,cAAWC,MAAX,CAAkB0V,KAAlB,EAAwBkY,KAAxB,CAA8Bnf,EAA9B,CAAiC,UAAjC,EAA6C,UAAC0Z,MAAD,EAAY;AACxD,WAAK+Y,yBAAL,CAA+B;AAACxrB,gBAAD;AAAOkN,iBAAP;AAAcla,eAAd;AAAoB2pB,iBAApB;AAA2BlK;AAA3B,KAA/B;AACA,IAFD;;AAIApoB,cAAWC,MAAX,CAAkB0V,KAAlB,EAAwBkY,KAAxB,CAA8Bnf,EAA9B,CAAiC,cAAjC,EAAiD,UAAC0Z,MAAD,EAASrV,IAAT,EAAkB;AAClE,QAAIA,KAAKpK,KAAKy4B,MAAV,CAAJ,EAAuB;AACtB,YAAKC,wBAAL,CAA8B;AAAC1rB,iBAAD;AAAOkN,kBAAP;AAAcla,gBAAd;AAAoB2pB,kBAApB;AAA2BlK;AAA3B,MAA9B;AACA;AACD,IAJD;;AAMApoB,cAAWC,MAAX,CAAkB0V,KAAlB,EAAwBkY,KAAxB,CAA8Bnf,EAA9B,CAAiC,SAAjC,EAA4C,UAAC0Z,MAAD,EAASrV,IAAT,EAAkB;AAC7D,QAAIA,KAAKpK,KAAKy4B,MAAV,CAAJ,EAAuB;AACtB,YAAKD,yBAAL,CAA+B;AAACxrB,iBAAD;AAAOkN,kBAAP;AAAcla,gBAAd;AAAoB2pB,kBAApB;AAA2BlK;AAA3B,MAA/B;AACA;AACD,IAJD;;AAMApoB,cAAWC,MAAX,CAAkB0V,KAAlB,EAAwBkY,KAAxB,CAA8Bnf,EAA9B,CAAiC,SAAjC,EAA4C,UAAC0Z,MAAD,EAAY;AACvD,WAAKiZ,wBAAL,CAA8B;AAAC1rB,gBAAD;AAAOkN,iBAAP;AAAcla,eAAd;AAAoB2pB,iBAApB;AAA2BlK;AAA3B,KAA9B;AACA,IAFD;;AAIA,QAAK1Z,EAAL,CAAQ,UAAR,EAAoB,UAAC4yB,WAAD,EAAiB;AACpC,WAAKC,wBAAL,CAA8B;AAAC5rB,gBAAD;AAAOkN,iBAAP;AAAcla,eAAd;AAAoB2pB,iBAApB;AAA2BgP;AAA3B,KAA9B;AACA,IAFD;AAIA,QAAK5yB,EAAL,CAAQ,cAAR,EAAwB,UAAC4yB,WAAD,EAAcvuB,IAAd,EAAuB;AAC9C,QAAIA,KAAKpK,KAAK64B,KAAV,CAAJ,EAAsB;AACrB,SAAIlP,UAAU,IAAd,EAAoB;AACnBgP,kBAAYze,KAAZ,IAAqB,EAArB;AACA,MAFD,MAEO;AACNye,kBAAYze,KAAZ,IAAqBnH,SAArB;AACA;AACD;AACD,IARD;AAUA,QAAKhN,EAAL,CAAQ,SAAR,EAAmB,UAAC4yB,WAAD,EAAcvuB,IAAd,EAAuB;AACzC,QAAIA,KAAKpK,KAAK64B,KAAV,CAAJ,EAAsB;AACrB,YAAKD,wBAAL,CAA8B;AAAC5rB,iBAAD;AAAOkN,kBAAP;AAAcla,gBAAd;AAAoB2pB,kBAApB;AAA2BgP;AAA3B,MAA9B;AACA;AACD,IAJD;AAKA;;;;;2BAEDH,yB;4CAAwD;AAAA,OAA7Bte,KAA6B,SAA7BA,KAA6B;AAAA,OAAtBla,IAAsB,SAAtBA,IAAsB;AAAA,OAAhB2pB,KAAgB,SAAhBA,KAAgB;AAAA,OAATlK,MAAS,SAATA,MAAS;;AACvD,OAAIqZ,eAAe,KAAKC,YAAL,CAAkB/4B,KAAK64B,KAAvB,EAA8B1C,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBzf,KAAKy4B,MAA5B,CAA9B,CAAnB;;AAEA,OAAI,CAACK,YAAL,EAAmB;AAClB;AACA;;AAED,OAAI,CAACr0B,MAAMqvB,OAAN,CAAcgF,YAAd,CAAL,EAAkC;AACjCA,mBAAe,CAACA,YAAD,CAAf;AACA;;AAED,QAAK,IAAIrwB,IAAI,CAAb,EAAgBA,IAAIqwB,aAAax8B,MAAjC,EAAyCmM,GAAzC,EAA8C;AAC7C,QAAMkwB,cAAcG,aAAarwB,CAAb,CAApB;;AACA,QAAIkhB,UAAU,IAAV,IAAkB,CAACgP,YAAYze,KAAZ,CAAvB,EAA2C;AAC1Cye,iBAAYze,KAAZ,IAAqB,EAArB;AACA;;AAED,QAAI,OAAOla,KAAKg5B,KAAZ,KAAsB,UAAtB,IAAoCh5B,KAAKg5B,KAAL,CAAWL,WAAX,EAAwBlZ,MAAxB,MAAoC,KAA5E,EAAmF;AAClF;AACA;;AAED,QAAIwZ,gBAAgBxZ,MAApB;;AAEA,QAAI,OAAOzf,KAAKk5B,SAAZ,KAA0B,UAA9B,EAA0C;AACzCD,qBAAgBj5B,KAAKk5B,SAAL,CAAeP,WAAf,EAA4BM,aAA5B,CAAhB;AACA;;AAED,QAAItP,UAAU,IAAd,EAAoB;AACnBgP,iBAAYze,KAAZ,EAAmBxgB,IAAnB,CAAwBu/B,aAAxB;AACA,KAFD,MAEO;AACNN,iBAAYze,KAAZ,IAAqB+e,aAArB;AACA;;AAED,SAAKhV,IAAL,WAAmB/J,KAAnB,gBAAsCye,WAAtC,EAAmDM,aAAnD;AACA,SAAKhV,IAAL,WAAmB/J,KAAnB,eAAqC,UAArC,EAAiDye,WAAjD,EAA8DM,aAA9D;AACA;AACD;;;;;2BAEDL,wB;2CAAkE;AAAA,OAAxC5rB,IAAwC,SAAxCA,IAAwC;AAAA,OAAlCkN,KAAkC,SAAlCA,KAAkC;AAAA,OAA3Bla,IAA2B,SAA3BA,IAA2B;AAAA,OAArB2pB,KAAqB,SAArBA,KAAqB;AAAA,OAAdgP,WAAc,SAAdA,WAAc;;AACjE,OAAIQ,UAAU9hC,WAAWC,MAAX,CAAkB0V,IAAlB,EAAwBkY,KAAxB,CAA8B6T,YAA9B,CAA2C/4B,KAAKy4B,MAAhD,EAAwDtC,WAAWn+B,GAAX,CAAe2gC,WAAf,EAA4B34B,KAAK64B,KAAjC,CAAxD,CAAd;;AAEA,OAAI,CAACp0B,MAAMqvB,OAAN,CAAcqF,OAAd,CAAL,EAA6B;AAC5BA,cAAU,CAACA,OAAD,CAAV;AACA;;AAED,QAAK,IAAI1wB,IAAI,CAAb,EAAgBA,IAAI0wB,QAAQ78B,MAA5B,EAAoCmM,GAApC,EAAyC;AACxC,QAAIgX,SAAS0Z,QAAQ1wB,CAAR,CAAb;;AAEA,QAAI,OAAOzI,KAAKg5B,KAAZ,KAAsB,UAAtB,IAAoCh5B,KAAKg5B,KAAL,CAAWL,WAAX,EAAwBlZ,MAAxB,MAAoC,KAA5E,EAAmF;AAClF;AACA;;AAED,QAAI,OAAOzf,KAAKk5B,SAAZ,KAA0B,UAA9B,EAA0C;AACzCzZ,cAASzf,KAAKk5B,SAAL,CAAeP,WAAf,EAA4BlZ,MAA5B,CAAT;AACA;;AAED,QAAIkK,UAAU,IAAd,EAAoB;AACnBgP,iBAAYze,KAAZ,EAAmBxgB,IAAnB,CAAwB+lB,MAAxB;AACA,KAFD,MAEO;AACNkZ,iBAAYze,KAAZ,IAAqBuF,MAArB;AACA;;AAED,SAAKwE,IAAL,WAAmB/J,KAAnB,gBAAsCye,WAAtC,EAAmDlZ,MAAnD;AACA,SAAKwE,IAAL,WAAmB/J,KAAnB,eAAqC,UAArC,EAAiDye,WAAjD,EAA8DlZ,MAA9D;AACA;AACD;;;;;2BAEDiZ,wB;2CAAuD;AAAA,OAA7Bxe,KAA6B,SAA7BA,KAA6B;AAAA,OAAtBla,IAAsB,SAAtBA,IAAsB;AAAA,OAAhB2pB,KAAgB,SAAhBA,KAAgB;AAAA,OAATlK,MAAS,SAATA,MAAS;;AACtD,OAAIqZ,eAAe,KAAKC,YAAL,CAAkB/4B,KAAK64B,KAAvB,EAA8B1C,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBzf,KAAKy4B,MAA5B,CAA9B,CAAnB;;AAEA,OAAI,CAACK,YAAL,EAAmB;AAClB;AACA;;AAED,OAAI,CAACr0B,MAAMqvB,OAAN,CAAcgF,YAAd,CAAL,EAAkC;AACjCA,mBAAe,CAACA,YAAD,CAAf;AACA;;AAED,QAAK,IAAIrwB,IAAI,CAAb,EAAgBA,IAAIqwB,aAAax8B,MAAjC,EAAyCmM,GAAzC,EAA8C;AAC7C,QAAMkwB,cAAcG,aAAarwB,CAAb,CAApB;;AAEA,QAAIkhB,UAAU,IAAd,EAAoB;AACnB,SAAIllB,MAAMqvB,OAAN,CAAc6E,YAAYze,KAAZ,CAAd,CAAJ,EAAuC;AACtC,UAAI,OAAOla,KAAK/D,MAAZ,KAAuB,UAA3B,EAAuC;AACtC+D,YAAK/D,MAAL,CAAY08B,YAAYze,KAAZ,CAAZ,EAAgCuF,MAAhC;AACA,OAFD,MAEO,IAAIkZ,YAAYze,KAAZ,EAAmBlc,OAAnB,CAA2ByhB,MAA3B,IAAqC,CAAC,CAA1C,EAA6C;AACnDkZ,mBAAYze,KAAZ,EAAmBkf,MAAnB,CAA0BT,YAAYze,KAAZ,EAAmBlc,OAAnB,CAA2ByhB,MAA3B,CAA1B,EAA8D,CAA9D;AACA;AACD;AACD,KARD,MAQO;AACNkZ,iBAAYze,KAAZ,IAAqBnH,SAArB;AACA;;AAED,SAAKkR,IAAL,WAAmB/J,KAAnB,eAAqCye,WAArC,EAAkDlZ,MAAlD;AACA,SAAKwE,IAAL,WAAmB/J,KAAnB,eAAqC,SAArC,EAAgDye,WAAhD,EAA6DlZ,MAA7D;AACA;AACD;;;;;2BAEDuG,W;uBAAYva,M,EAAsB;AAAA,OAAd/N,IAAc,uEAAT,OAAS;;AACjC,OAAI,CAAC+G,MAAMqvB,OAAN,CAAcroB,MAAd,CAAL,EAA4B;AAC3BA,aAAS,CAACA,MAAD,CAAT;AACA;;AAED,QAAKysB,OAAL,CAAazsB,OAAOuB,IAAP,CAAY,GAAZ,CAAb,IAAiC;AAChCtP,cADgC;AAEhC+N,kBAFgC;AAGhCrN,UAAM;AAH0B,IAAjC;AAKA;;;;;2BAEDi7B,e;2BAAgB5Z,M,EAAQ;AACvB,QAAK,IAAM6Z,SAAX,2CAAwB,KAAKpB,OAA7B,GAAsC;AACrC,QAAI,KAAKA,OAAL,CAAatR,cAAb,CAA4B0S,SAA5B,CAAJ,EAA4C;AAC3C,UAAKC,UAAL,CAAgBD,SAAhB,EAA2B7Z,MAA3B;AACA;AACD;AACD;;;;;2BAED8Z,U;sBAAWD,S,EAAW7Z,M,EAAQ;AAC7B,OAAM+Z,QAAQ,KAAKtB,OAAL,CAAaoB,SAAb,CAAd;;AACA,OAAI,CAACE,KAAL,EAAY;AACXt8B,YAAQ4I,KAAR,wBAAoCwzB,SAApC;AACA;AACA;;AAED,OAAMpgC,OAAO,EAAb;;AACA,wBAAoBsgC,MAAM/tB,MAA1B,kHAAkC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,QAAvByO,KAAuB;AACjChhB,SAAKQ,IAAL,CAAUy8B,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAV;AACA;;AACD,OAAM7gB,MAAMH,KAAK8T,IAAL,CAAU,GAAV,CAAZ;;AAEA,OAAIwsB,MAAM97B,IAAN,KAAe,QAAnB,EAA6B;AAC5B87B,UAAMp7B,IAAN,CAAW/E,GAAX,IAAkBomB,MAAlB;AACA;AACA;;AAED,OAAI+Z,MAAM97B,IAAN,KAAe,OAAnB,EAA4B;AAC3B,QAAI,CAAC87B,MAAMp7B,IAAN,CAAW/E,GAAX,CAAL,EAAsB;AACrBmgC,WAAMp7B,IAAN,CAAW/E,GAAX,IAAkB,EAAlB;AACA;;AACDmgC,UAAMp7B,IAAN,CAAW/E,GAAX,EAAgBK,IAAhB,CAAqB+lB,MAArB;AACA;AACA;AACD;;;;;2BAEDga,oB;gCAAqBha,M,EAAQ;AAC5B,QAAK,IAAM6Z,SAAX,2CAAwB,KAAKpB,OAA7B,GAAsC;AACrC,QAAI,KAAKA,OAAL,CAAatR,cAAb,CAA4B0S,SAA5B,CAAJ,EAA4C;AAC3C,UAAKI,eAAL,CAAqBJ,SAArB,EAAgC7Z,MAAhC;AACA;AACD;AACD;;;;;2BAEDia,e;2BAAgBJ,S,EAAW7Z,M,EAAQ;AAClC,OAAM+Z,QAAQ,KAAKtB,OAAL,CAAaoB,SAAb,CAAd;;AACA,OAAI,CAAC,KAAKpB,OAAL,CAAaoB,SAAb,CAAL,EAA8B;AAC7Bp8B,YAAQ4I,KAAR,wBAAoCwzB,SAApC;AACA;AACA;;AAED,OAAI,CAACE,MAAMp7B,IAAX,EAAiB;AAChB;AACA;;AAED,OAAI/E,MAAM,EAAV;;AACA,yBAAoBmgC,MAAM/tB,MAA1B,yHAAkC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,QAAvByO,KAAuB;AACjC7gB,QAAIK,IAAJ,CAASy8B,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAT;AACA;;AACD7gB,SAAMA,IAAI2T,IAAJ,CAAS,GAAT,CAAN;;AAEA,OAAIwsB,MAAM97B,IAAN,KAAe,QAAnB,EAA6B;AAC5B87B,UAAMp7B,IAAN,CAAW/E,GAAX,IAAkB0Z,SAAlB;AACA;AACA;;AAED,OAAIymB,MAAM97B,IAAN,KAAe,OAAnB,EAA4B;AAC3B,QAAI,CAAC87B,MAAMp7B,IAAN,CAAW/E,GAAX,CAAL,EAAsB;AACrB;AACA;;AACD,QAAMoP,IAAI+wB,MAAMp7B,IAAN,CAAW/E,GAAX,EAAgB2E,OAAhB,CAAwByhB,MAAxB,CAAV;;AACA,QAAIhX,IAAI,CAAC,CAAT,EAAY;AACX+wB,WAAMp7B,IAAN,CAAW/E,GAAX,EAAgB+/B,MAAhB,CAAuB3wB,CAAvB,EAA0B,CAA1B;AACA;;AACD;AACA;AACD;;;;;2BAEDswB,Y;wBAAaS,K,EAAOtgC,I,EAAM;AACzB,OAAMG,MAAM,GAAGwB,MAAH,CAAU3B,IAAV,EAAgB8T,IAAhB,CAAqB,GAArB,CAAZ;;AACA,OAAI,CAAC,KAAKkrB,OAAL,CAAasB,KAAb,CAAL,EAA0B;AACzB;AACA;;AAED,OAAI,KAAKtB,OAAL,CAAasB,KAAb,EAAoBp7B,IAAxB,EAA8B;AAC7B,QAAM5B,SAAS,KAAK07B,OAAL,CAAasB,KAAb,EAAoBp7B,IAApB,CAAyB/E,GAAzB,CAAf;;AACA,QAAImD,MAAJ,EAAY;AACX,YAAOA,MAAP;AACA;AACD;;AAED,OAAI,KAAK07B,OAAL,CAAasB,KAAb,EAAoB97B,IAApB,KAA6B,OAAjC,EAA0C;AACzC,WAAO,EAAP;AACA;AACD;;;;;2BAED+vB,W;uBAAY+L,K,EAAOtgC,I,EAAkB;AAAA;;AAAA,OAAZ0H,OAAY,uEAAJ,EAAI;AACpC,UAAO;AACN8K,WAAO,YAAM;AACZ,YAAO,OAAK2Z,2BAAL,CAAiC,OAAK0T,YAAL,CAAkBS,KAAlB,EAAyBtgC,IAAzB,CAAjC,EAAiE0H,OAAjE,CAAP;AACA,KAHK;AAKN4kB,WAAO,YAAM;AACZ,SAAM2T,UAAU,OAAK1L,WAAL,CAAiB+L,KAAjB,EAAwBtgC,IAAxB,EAA8B0H,OAA9B,EAAuC8K,KAAvC,EAAhB;;AACA,SAAIjH,MAAMqvB,OAAN,CAAcqF,OAAd,CAAJ,EAA4B;AAC3B,aAAOA,QAAQ78B,MAAf;AACA;;AACD,YAAO,CAAC68B,OAAD,GAAW,CAAX,GAAe,CAAtB;AACA,KAXK;AAaNhgC,aAAS,UAACuN,EAAD,EAAQ;AAChB,SAAMyyB,UAAU,OAAK1L,WAAL,CAAiB+L,KAAjB,EAAwBtgC,IAAxB,EAA8B0H,OAA9B,EAAuC8K,KAAvC,EAAhB;;AACA,SAAIjH,MAAMqvB,OAAN,CAAcqF,OAAd,CAAJ,EAA4B;AAC3B,aAAOA,QAAQhgC,OAAR,CAAgBuN,EAAhB,CAAP;AACA;;AACD,SAAIyyB,OAAJ,EAAa;AACZ,aAAOzyB,GAAGyyB,OAAH,CAAP;AACA;AACD;AArBK,IAAP;AAuBA;;;;;2BAED5+B,I;kBAAO;AACN,OAAI,KAAKwqB,KAAL,CAAWE,SAAX,KAAyB,KAA7B,EAAoC;AACnC;AACA;;AAED/nB,WAAQC,GAAR,CAAY,qBAAZ,EAAmC,KAAK6nB,cAAxC;AACA,QAAKf,IAAL,CAAU,YAAV;AACA,QAAKsT,MAAL,GAAc,KAAd;AACA,OAAM76B,OAAOrF,WAAWyF,YAAX,CAAwBH,GAAxB,EAAb;AACA,OAAMyB,OAAO,KAAK2mB,KAAL,CAAWlG,EAAX,CAAc9iB,IAAd,CAAmB,KAAKwN,KAAxB,EAA+B,KAAK3I,OAApC,EAA6C8K,KAA7C,EAAb;;AACA,QAAK,IAAIjD,IAAE,CAAX,EAAcA,IAAIrK,KAAK9B,MAAvB,EAA+BmM,GAA/B,EAAoC;AACnC,SAAKgU,MAAL,CAAYre,KAAKqK,CAAL,CAAZ;AACA;;AACDvL,WAAQC,GAAR,CAAYC,OAAOgB,KAAK9B,MAAZ,CAAZ,EAAiC,mBAAjC,EAAsD,KAAK0oB,cAA3D;AACA3tB,cAAWyF,YAAX,CAAwBC,MAAxB,CAA+B,YAA/B,EAA6C1F,WAAWyF,YAAX,CAAwBH,GAAxB,KAAgCD,IAA7E,EAAmF,iBAAgB,KAAKsoB,cAArB,CAAnF;AAEA,QAAK2U,SAAL;AACA,QAAKpC,MAAL,GAAc,IAAd;AACA,QAAKtT,IAAL,CAAU,WAAV;AACA;;;;;2BAED0V,S;uBAAY;AAAA;;AACX,OAAI,KAAK5U,KAAL,CAAWE,SAAX,KAAyB,KAA7B,EAAoC;AACnC;AACA;;AAED,QAAKF,KAAL,CAAWD,GAAX,CAAe/e,EAAf,CAAkB,QAAlB,EAA4B,iBAAmC;AAAA,QAAjCvG,MAAiC,SAAjCA,MAAiC;AAAA,QAAzB9D,EAAyB,SAAzBA,EAAyB;AAAA,QAArB0C,IAAqB,SAArBA,IAAqB;;AAC9D,YAAQoB,MAAR;AACC,UAAK,QAAL;AACCpB,WAAKtF,GAAL,GAAW4C,EAAX;;AACA,aAAK+gB,MAAL,CAAYre,IAAZ;;AACA;;AAED,UAAK,QAAL;AACC,aAAKsY,UAAL,CAAgBhb,EAAhB;;AACA;;AAED,UAAK,eAAL;AACC,aAAKk+B,cAAL,CAAoBl+B,EAApB,EAAwB0C,IAAxB;;AACA;;AAED,UAAK,aAAL;AACC,aAAKw7B,cAAL,CAAoBl+B,EAApB,EAAwB0C,IAAxB;;AACA;;AAED,UAAK,cAAL;AACC,aAAKmY,MAAL,CAAYnY,KAAKmL,KAAjB,EAAwBnL,KAAKmY,MAA7B,EAAqCnY,KAAKwC,OAA1C;;AACA;AApBF;AAsBA,IAvBD;AAwBA;;;;;2BAEDykB,2B;uCAA4B7oB,M,EAAoB;AAAA,OAAZoE,OAAY,uEAAJ,EAAI;;AAC/C,OAAIpE,WAAWuW,SAAX,IAAwBvW,WAAW,IAAvC,EAA6C;AAC5C,WAAOuW,SAAP;AACA;;AAED,OAAItO,MAAMqvB,OAAN,CAAct3B,MAAd,CAAJ,EAA2B;AAC1B,QAAIoE,QAAQ2X,IAAZ,EAAkB;AACjB/b,cAASA,OAAO+b,IAAP,CAAY,UAACie,CAAD,EAAIC,CAAJ,EAAU;AAC9B,UAAIoD,IAAI,CAAR;;AACA,WAAK,IAAM3f,KAAX,2CAAoBtZ,QAAQ2X,IAA5B,GAAkC;AACjC,WAAI3X,QAAQ2X,IAAR,CAAaqO,cAAb,CAA4B1M,KAA5B,CAAJ,EAAwC;AACvC,YAAM4f,YAAYl5B,QAAQ2X,IAAR,CAAa2B,KAAb,CAAlB;AACA,YAAI6f,eAAJ;AACA,YAAIC,eAAJ;;AACA,YAAI9f,MAAMlc,OAAN,CAAc,GAAd,IAAqB,CAAC,CAA1B,EAA6B;AAC5B+7B,kBAAS5D,WAAWn+B,GAAX,CAAew+B,CAAf,EAAkBtc,KAAlB,CAAT;AACA8f,kBAAS7D,WAAWn+B,GAAX,CAAey+B,CAAf,EAAkBvc,KAAlB,CAAT;AACA,SAHD,MAGO;AACN6f,kBAASvD,EAAEtc,KAAF,CAAT;AACA8f,kBAASvD,EAAEvc,KAAF,CAAT;AACA;;AACD,YAAI6f,SAASC,MAAb,EAAqB;AACpBH,aAAIC,SAAJ;AACA;AACA;;AACD,YAAIC,SAASC,MAAb,EAAqB;AACpBH,aAAI,CAACC,SAAL;AACA;AACA;AACD;AACD;;AACD,aAAOD,CAAP;AACA,MAzBQ,CAAT;AA0BA;;AAED,QAAI,OAAOj5B,QAAQq5B,IAAf,KAAwB,QAA5B,EAAsC;AACrCz9B,YAAO48B,MAAP,CAAc,CAAd,EAAiBx4B,QAAQq5B,IAAzB;AACA;;AAED,QAAI,OAAOr5B,QAAQgX,KAAf,KAAyB,QAAzB,IAAqChX,QAAQgX,KAAR,KAAkB,CAA3D,EAA8D;AAC7Dpb,YAAO48B,MAAP,CAAcx4B,QAAQgX,KAAtB;AACA;AACD;;AAED,OAAI,CAAChX,QAAQ6K,MAAb,EAAqB;AACpB7K,YAAQ6K,MAAR,GAAiB,EAAjB;AACA;;AAED,OAAMyuB,iBAAiB,EAAvB;AACA,OAAMC,cAAc,EAApB;;AAEA,QAAK,IAAMjgB,KAAX,2CAAoBtZ,QAAQ6K,MAA5B,GAAoC;AACnC,QAAI7K,QAAQ6K,MAAR,CAAemb,cAAf,CAA8B1M,KAA9B,CAAJ,EAA0C;AACzC,SAAItZ,QAAQ6K,MAAR,CAAeyO,KAAf,MAA0B,CAA9B,EAAiC;AAChCggB,qBAAexgC,IAAf,CAAoBwgB,KAApB;AACA,MAFD,MAEO,IAAItZ,QAAQ6K,MAAR,CAAeyO,KAAf,MAA0B,CAA9B,EAAiC;AACvCigB,kBAAYzgC,IAAZ,CAAiBwgB,KAAjB;AACA;AACD;AACD;;AAED,OAAIggB,eAAe59B,MAAf,GAAwB,CAAxB,IAA6B69B,YAAY79B,MAAZ,GAAqB,CAAtD,EAAyD;AACxDY,YAAQk9B,IAAR,CAAa,kCAAb;AACAF,mBAAed,MAAf,CAAsB,CAAtB,EAAyBc,eAAe59B,MAAxC;AACA;;AAED,OAAI69B,YAAY79B,MAAZ,GAAqB,CAArB,IAA0B69B,YAAYn8B,OAAZ,CAAoB,KAApB,MAA+B,CAAC,CAA9D,EAAiE;AAChEm8B,gBAAYzgC,IAAZ,CAAiB,KAAjB;AACA;;AAED,OAAM2gC,aAAa,UAAC3N,GAAD,EAAMjhB,MAAN,EAAiB;AACnC,QAAM6uB,SAAS,EAAf;AACA7uB,WAAOtS,OAAP,CAAe,UAAC+gB,KAAD,EAAW;AACzB,SAAIA,MAAMlc,OAAN,CAAc,GAAd,MAAuB,CAAC,CAA5B,EAA+B;AAC9Bm4B,iBAAWx8B,GAAX,CAAe2gC,MAAf,EAAuBpgB,KAAvB,EAA8Bic,WAAWn+B,GAAX,CAAe00B,GAAf,EAAoBxS,KAApB,CAA9B;AACA,MAFD,MAEO;AACNogB,aAAOpgB,KAAP,IAAgBwS,IAAIxS,KAAJ,CAAhB;AACA;AACD,KAND;AAOA,WAAOogB,MAAP;AACA,IAVD;;AAYA,OAAIJ,eAAe59B,MAAf,GAAwB,CAAxB,IAA6B69B,YAAY79B,MAAZ,GAAqB,CAAtD,EAAyD;AACxD,QAAImI,MAAMqvB,OAAN,CAAct3B,MAAd,CAAJ,EAA2B;AAC1BA,cAASA,OAAOtC,GAAP,CAAW,UAACulB,MAAD,EAAY;AAC/B,UAAIya,eAAe59B,MAAf,GAAwB,CAA5B,EAA+B;AAAA;;AAC9B,cAAO,aAAEi+B,IAAF,gBAAO9a,MAAP,SAAkBya,cAAlB,EAAP;AACA;;AAED,UAAIC,YAAY79B,MAAZ,GAAqB,CAAzB,EAA4B;AAC3B,cAAO+9B,WAAW5a,MAAX,EAAmB0a,WAAnB,CAAP;AACA;AACD,MARQ,CAAT;AASA,KAVD,MAUO;AACN,SAAID,eAAe59B,MAAf,GAAwB,CAA5B,EAA+B;AAAA;;AAC9B,aAAO,aAAEi+B,IAAF,gBAAO/9B,MAAP,SAAkB09B,cAAlB,EAAP;AACA;;AAED,SAAIC,YAAY79B,MAAZ,GAAqB,CAAzB,EAA4B;AAC3B,aAAO+9B,WAAW79B,MAAX,EAAmB29B,WAAnB,CAAP;AACA;AACD;AACD;;AAED,UAAO39B,MAAP;AACA;;;;;2BAEDg+B,Y;wBAAajxB,K,EAAOkxB,W,EAAa;AAAA;;AAChC,OAAI,CAAClxB,KAAL,EAAY;AACX,WAAOA,KAAP;AACA;;AAED,OAAIgT,MAAMhjB,IAAN,CAAWgQ,KAAX,EAAkBnM,MAAlB,CAAJ,EAA+B;AAC9B,WAAO;AACNtE,UAAKyQ;AADC,KAAP;AAGA;;AAED,OAAItQ,OAAOC,IAAP,CAAYqQ,KAAZ,EAAmBjN,MAAnB,GAA4B,CAA5B,IAAiCm+B,gBAAgB,YAArD,EAAmE;AAClE,QAAMC,MAAM,EAAZ;;AACA,SAAK,IAAMxgB,KAAX,2CAAoB3Q,KAApB,GAA2B;AAC1B,SAAIA,MAAMqd,cAAN,CAAqB1M,KAArB,CAAJ,EAAiC;AAAA;;AAChCwgB,UAAIhhC,IAAJ,4BACEwgB,KADF,IACU3Q,MAAM2Q,KAAN,CADV;AAGA;AACD;;AACD3Q,YAAQ;AAACwqB,WAAM2G;AAAP,KAAR;AACA;;AArB+B,0BAuBrBxgB,MAvBqB;AAwB/B,QAAI3Q,MAAMqd,cAAN,CAAqB1M,MAArB,CAAJ,EAAiC;AAChC,SAAM9gB,QAAQmQ,MAAM2Q,MAAN,CAAd;;AACA,SAAI9gB,iBAAiB0R,MAAjB,IAA2BoP,WAAU,QAAzC,EAAmD;AAClD3Q,YAAM2Q,MAAN,IAAe;AACdtF,eAAQxb;AADM,OAAf;AAGA;;AAED,SAAI8gB,WAAU,MAAV,IAAoBA,WAAU,KAAlC,EAAyC;AACxC3Q,YAAM2Q,MAAN,IAAe9gB,MAAMc,GAAN,CAAU,UAACygC,QAAD,EAAc;AACtC,cAAO,OAAKH,YAAL,CAAkBG,QAAlB,EAA4BzgB,MAA5B,CAAP;AACA,OAFc,CAAf;AAGA;;AAED,SAAIqC,MAAMhjB,IAAN,CAAWH,KAAX,EAAkBH,MAAlB,KAA6BA,OAAOC,IAAP,CAAYE,KAAZ,EAAmBkD,MAAnB,GAA4B,CAA7D,EAAgE;AAC/DiN,YAAM2Q,MAAN,IAAe,OAAKsgB,YAAL,CAAkBphC,KAAlB,EAAyB8gB,MAAzB,CAAf;AACA;AACD;AAzC8B;;AAuBhC,QAAK,IAAMA,MAAX,2CAAoB3Q,KAApB,GAA2B;AAAA,WAAhB2Q,MAAgB;AAmB1B;;AAED,UAAO3Q,KAAP;AACA;;;;;2BAEDxN,I;gBAAKwN,K,EAAmB;AAAA;AAAA;;AAAA,OAAZ3I,OAAY,uEAAJ,EAAI;AACvB,UAAO;AACN8K,WAAO,YAAM;AACZ,SAAI;AACHnC,cAAQ,OAAKixB,YAAL,CAAkBjxB,KAAlB,CAAR;AACA,aAAO,OAAK8b,2BAAL,CAAiC,OAAK+S,UAAL,CAAgBr8B,IAAhB,CAAqBwN,KAArB,CAAjC,EAA8D3I,OAA9D,CAAP;AACA,MAHD,CAGE,OAAO4R,CAAP,EAAU;AACXtV,cAAQ4I,KAAR,CAAc,6BAAd,EAA6C,OAAKkf,cAAlD;AACA9nB,cAAQ4I,KAAR,CAAc,QAAd,EAAwB0V,KAAKwC,SAAL,CAAezU,KAAf,EAAsB,IAAtB,EAA4B,CAA5B,CAAxB;AACArM,cAAQ4I,KAAR,CAAc,UAAd,EAA0B0V,KAAKwC,SAAL,CAAepd,OAAf,EAAwB,IAAxB,EAA8B,CAA9B,CAA1B;AACA1D,cAAQ4I,KAAR,CAAc0M,EAAE1W,KAAhB;AACA,YAAM0W,CAAN;AACA;AACD,KAZK;AAcNgT,WAAO,YAAM;AACZ,SAAI;AACHjc,cAAQ,OAAKixB,YAAL,CAAkBjxB,KAAlB,CAAR;AADG,UAEKqO,KAFL,GAEqBhX,OAFrB,CAEKgX,KAFL;AAAA,UAEYqiB,IAFZ,GAEqBr5B,OAFrB,CAEYq5B,IAFZ;AAGH,aAAO,OAAK5U,2BAAL,CAAiC,OAAK+S,UAAL,CAAgBr8B,IAAhB,CAAqBwN,KAArB,CAAjC,EAA8D;AAAEqO,mBAAF;AAASqiB;AAAT,OAA9D,EAA+E39B,MAAtF;AACA,MAJD,CAIE,OAAOkW,CAAP,EAAU;AACXtV,cAAQ4I,KAAR,CAAc,6BAAd,EAA6C,OAAKkf,cAAlD;AACA9nB,cAAQ4I,KAAR,CAAc,QAAd,EAAwB0V,KAAKwC,SAAL,CAAezU,KAAf,EAAsB,IAAtB,EAA4B,CAA5B,CAAxB;AACArM,cAAQ4I,KAAR,CAAc,UAAd,EAA0B0V,KAAKwC,SAAL,CAAepd,OAAf,EAAwB,IAAxB,EAA8B,CAA9B,CAA1B;AACA1D,cAAQ4I,KAAR,CAAc0M,EAAE1W,KAAhB;AACA,YAAM0W,CAAN;AACA;AACD,KA1BK;AA4BNrZ,aAAS,UAACuN,EAAD,EAAQ;AAChB,YAAO,OAAK3K,IAAL,CAAUwN,KAAV,EAAiB3I,OAAjB,EAA0B8K,KAA1B,GAAkCvS,OAAlC,CAA0CuN,EAA1C,CAAP;AACA,KA9BK;AAgCN6Y,aAAS,UAACmN,GAAD,EAAS;AAAA;;AACjBxoB,YAAOif,KAAP,CAAa,OAAK6B,cAAlB,EAAkC,2CAAlC,EAA+Ezb,KAA/E;AACA,YAAO,oBAAKwb,KAAL,CAAWlG,EAAX,EAAc9iB,IAAd,8BAAiCwjB,OAAjC,CAAyCmN,GAAzC,CAAP;AACA,KAnCK;AAqCNkO,oBAAgB,UAAClO,GAAD,EAAS;AAAA;;AACxBxoB,YAAOif,KAAP,CAAa,OAAK6B,cAAlB,EAAkC,kDAAlC,EAAsFzb,KAAtF;AACA,YAAO,qBAAKwb,KAAL,CAAWlG,EAAX,EAAc9iB,IAAd,+BAAiC6+B,cAAjC,CAAgDlO,GAAhD,CAAP;AACA,KAxCK;AA0CNmO,oBAAgB,UAACC,MAAD,EAAShuB,GAAT,EAAcsrB,UAAd,EAA6B;AAAA;;AAC5Cl0B,YAAOif,KAAP,CAAa,OAAK6B,cAAlB,EAAkC,kDAAlC,EAAsFzb,KAAtF;AACA,YAAO,qBAAKwb,KAAL,CAAWlG,EAAX,EAAc9iB,IAAd,+BAAiC8+B,cAAjC,CAAgDC,MAAhD,EAAwDhuB,GAAxD,EAA6DsrB,UAA7D,CAAP;AACA;AA7CK,IAAP;AA+CA;;;;;2BAEDroB,O;mBAAQxG,K,EAAO3I,O,EAAS;AACvB,OAAI;AACH2I,YAAQ,KAAKixB,YAAL,CAAkBjxB,KAAlB,CAAR;AACA,WAAO,KAAK8b,2BAAL,CAAiC,KAAK+S,UAAL,CAAgBroB,OAAhB,CAAwBxG,KAAxB,CAAjC,EAAiE3I,OAAjE,CAAP;AACA,IAHD,CAGE,OAAO4R,CAAP,EAAU;AACXtV,YAAQ4I,KAAR,CAAc,gCAAd,EAAgD,KAAKkf,cAArD;AACA9nB,YAAQ4I,KAAR,CAAc,QAAd,EAAwB0V,KAAKwC,SAAL,CAAezU,KAAf,EAAsB,IAAtB,EAA4B,CAA5B,CAAxB;AACArM,YAAQ4I,KAAR,CAAc,UAAd,EAA0B0V,KAAKwC,SAAL,CAAepd,OAAf,EAAwB,IAAxB,EAA8B,CAA9B,CAA1B;AACA1D,YAAQ4I,KAAR,CAAc0M,EAAE1W,KAAhB;AACA,UAAM0W,CAAN;AACA;AACD;;;;;2BAEDhE,W;uBAAY1V,G,EAAK8H,O,EAAS;AACzB,UAAO,KAAK6sB,WAAL,CAAiB,KAAjB,EAAwB30B,GAAxB,EAA6B8H,OAA7B,EAAsC8K,KAAtC,EAAP;AACA;;;;;2BAEDia,Y;wBAAaC,G,EAAKhlB,O,EAAS;AAC1B,OAAM2I,QAAQ,KAAKixB,YAAL,CAAkB;AAAE1hC,SAAK;AAAE8X,UAAKgV;AAAP;AAAP,IAAlB,CAAd;AACA,UAAO,KAAKP,2BAAL,CAAiC,KAAK+S,UAAL,CAAgBroB,OAAhB,CAAwBxG,KAAxB,CAAjC,EAAiE3I,OAAjE,CAAP;AACA;;;;;2BAEDk2B,S;qBAAUvtB,K,EAAO3I,O,EAAS;AACzB2I,WAAQ,KAAKixB,YAAL,CAAkBjxB,KAAlB,CAAR;AACA,UAAO,KAAK8b,2BAAL,CAAiC,KAAK+S,UAAL,CAAgBtB,SAAhB,CAA0BvtB,KAA1B,CAAjC,EAAmE3I,OAAnE,CAAP;AACA;;;;;2BAEDm6B,c;4BAAiB;AAAA;;AAChB,UAAO,oBAAK3C,UAAL,EAAgB2C,cAAhB,oBAAkCn2B,SAAlC,CAAP;AACA;;;;;2BAEDwgB,c;4BAAiB;AAAA;;AAChB,UAAO,qBAAKgT,UAAL,EAAgBhT,cAAhB,qBAAkCxgB,SAAlC,CAAP;AACA;;;;;2BAED6X,M;kBAAOgD,M,EAAQ;AACd,OAAIhb,MAAMqvB,OAAN,CAAcrU,MAAd,CAAJ,EAA2B;AAC1B,0BAAmBA,MAAnB,yHAA2B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,SAAhBhlB,IAAgB;AAC1B,UAAKgiB,MAAL,CAAYhiB,IAAZ;AACA;AACD,IAJD,MAIO;AACN;AACA,QAAI,KAAKuqB,cAAL,KAAwB,iBAAxB,IAA6CvF,OAAOjU,SAAxD,EAAmE;AAClE,YAAOiU,OAAOjU,SAAd;AACA;;AACD,SAAKyY,IAAL,CAAU,cAAV,EAA0BxE,MAA1B;AACA,SAAK4Z,eAAL,CAAqB5Z,MAArB;AACA,SAAK2Y,UAAL,CAAgB3b,MAAhB,CAAuBgD,MAAvB;AACA,SAAKwE,IAAL,CAAU,UAAV,EAAsBxE,MAAtB;AACA;AACD;;;;;2BAEDma,c;0BAAel+B,E,EAAI0O,I,EAAM;AAAA;;AACxB;AACA,OAAI,KAAK4a,cAAL,KAAwB,iBAAxB,IAA6C5a,KAAKoB,SAAtD,EAAiE;AAChE,WAAOpB,KAAKoB,SAAZ;AACA;;AAED,OAAMiU,SAAS,KAAKsZ,YAAL,CAAkB,KAAlB,EAAyBr9B,EAAzB,CAAf;;AACA,OAAI,CAAC+jB,MAAL,EAAa;AACZviB,YAAQ4I,KAAR,CAAc,iCAAd,EAAiD,KAAKkf,cAAtD,EAAsEtpB,EAAtE,EAA0E0O,IAA1E;AACA;AACA;;AACD,QAAKqvB,oBAAL,CAA0Bha,MAA1B;;AAEA,OAAMub,gBAAgB,aAAEzpB,OAAF,gBAAUtY,OAAOC,IAAP,CAAYkR,IAAZ,CAAV,0CAAgC,KAAKmhB,mBAArC,GAAtB;;AAEA,OAAIyP,cAAc1+B,MAAd,GAAuB,CAA3B,EAA8B;AAC7B,SAAK2nB,IAAL,CAAU,cAAV,EAA0BxE,MAA1B,EAAkCrV,IAAlC;AACA;;AAED,QAAK,IAAM/Q,GAAX,2CAAkB+Q,IAAlB,GAAwB;AACvB,QAAIA,KAAKwc,cAAL,CAAoBvtB,GAApB,CAAJ,EAA8B;AAC7B88B,gBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBpmB,GAAvB,EAA4B+Q,KAAK/Q,GAAL,CAA5B;AACA;AACD;;AAED,QAAK++B,UAAL,CAAgB7hB,MAAhB,CAAuBkJ,MAAvB;AACA,QAAK4Z,eAAL,CAAqB5Z,MAArB;;AAEA,OAAIub,cAAc1+B,MAAd,GAAuB,CAA3B,EAA8B;AAC7B,SAAK2nB,IAAL,CAAU,SAAV,EAAqBxE,MAArB,EAA6BrV,IAA7B;AACA;AACD;;;;;2BAED6wB,Y;wBAAaxb,M,EAAQlJ,M,EAAQ;AAAA;;AAC5B;AACA,OAAI,KAAKyO,cAAL,KAAwB,iBAAxB,KAA8CvF,OAAOjU,SAAP,IAAqBiU,OAAOjJ,IAAP,IAAeiJ,OAAOjJ,IAAP,CAAYhL,SAA9F,CAAJ,EAA+G;AAC9G,WAAOiU,OAAOjU,SAAd;;AACA,QAAIiU,OAAOjJ,IAAP,IAAeiJ,OAAOjJ,IAAP,CAAYhL,SAA/B,EAA0C;AACzC,YAAOiU,OAAOjJ,IAAP,CAAYhL,SAAnB;AACA;AACD;;AAED,QAAKiuB,oBAAL,CAA0Bha,MAA1B;AAEA,OAAMyb,iBAAiBjiC,OAAOC,IAAP,CAAYqd,MAAZ,EAAoBrc,GAApB,CAAwB;AAAA,WAASggB,MAAMld,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAT;AAAA,IAAxB,CAAvB;;AACA,OAAMg+B,gBAAgB,aAAEzpB,OAAF,gBAAU2pB,cAAV,0CAA6B,KAAK3P,mBAAlC,GAAtB;;AAEA,OAAIyP,cAAc1+B,MAAd,GAAuB,CAA3B,EAA8B;AAC7B,SAAK2nB,IAAL,CAAU,cAAV,EAA0BxE,MAA1B,EAAkCA,MAAlC;AACA;;AAED,OAAIlJ,OAAOC,IAAX,EAAiB;AAChB5e,MAAEoN,IAAF,CAAOuR,OAAOC,IAAd,EAAoB,UAACpd,KAAD,EAAQ8gB,KAAR,EAAkB;AACrCic,gBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBvF,KAAvB,EAA8B9gB,KAA9B;AACA,KAFD;AAGA;;AAED,OAAImd,OAAOmI,MAAX,EAAmB;AAClB9mB,MAAEoN,IAAF,CAAOuR,OAAOmI,MAAd,EAAsB,UAACtlB,KAAD,EAAQ8gB,KAAR,EAAkB;AACvCic,gBAAWgF,GAAX,CAAe1b,MAAf,EAAuBvF,KAAvB;AACA,KAFD;AAGA;;AAED,OAAI3D,OAAO6kB,IAAX,EAAiB;AAChBxjC,MAAEoN,IAAF,CAAOuR,OAAO6kB,IAAd,EAAoB,UAAChiC,KAAD,EAAQ8gB,KAAR,EAAkB;AACrC,SAAMmhB,WAAWlF,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAjB;;AACA,SAAImhB,aAAatoB,SAAb,IAA0B3Z,QAAQiiC,QAAtC,EAAgD;AAC/ClF,iBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBvF,KAAvB,EAA8B9gB,KAA9B;AACA;AACD,KALD;AAMA;;AAED,OAAImd,OAAO+kB,IAAX,EAAiB;AAChB1jC,MAAEoN,IAAF,CAAOuR,OAAO+kB,IAAd,EAAoB,UAACliC,KAAD,EAAQ8gB,KAAR,EAAkB;AACrC,SAAMmhB,WAAWlF,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAjB;;AACA,SAAImhB,aAAatoB,SAAb,IAA0B3Z,QAAQiiC,QAAtC,EAAgD;AAC/ClF,iBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBvF,KAAvB,EAA8B9gB,KAA9B;AACA;AACD,KALD;AAMA;;AAED,OAAImd,OAAO8X,IAAX,EAAiB;AAChBz2B,MAAEoN,IAAF,CAAOuR,OAAO8X,IAAd,EAAoB,UAACj1B,KAAD,EAAQ8gB,KAAR,EAAkB;AACrC,SAAImhB,WAAWlF,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAf;;AACA,SAAImhB,aAAatoB,SAAjB,EAA4B;AAC3BsoB,iBAAWjiC,KAAX;AACA,MAFD,MAEO;AACNiiC,kBAAYjiC,KAAZ;AACA;;AACD+8B,gBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBvF,KAAvB,EAA8BmhB,QAA9B;AACA,KARD;AASA;;AAED,OAAI9kB,OAAOglB,IAAX,EAAiB;AAChB3jC,MAAEoN,IAAF,CAAOuR,OAAOglB,IAAd,EAAoB,UAACniC,KAAD,EAAQ8gB,KAAR,EAAkB;AACrC,SAAImhB,WAAWlF,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAf;;AACA,SAAImhB,aAAatoB,SAAjB,EAA4B;AAC3BsoB,iBAAW,CAAX;AACA,MAFD,MAEO;AACNA,kBAAYjiC,KAAZ;AACA;;AACD+8B,gBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBvF,KAAvB,EAA8BmhB,QAA9B;AACA,KARD;AASA;;AAED,OAAI9kB,OAAO6T,OAAX,EAAoB;AACnBxyB,MAAEoN,IAAF,CAAOuR,OAAO6T,OAAd,EAAuB,UAAChxB,KAAD,EAAQ8gB,KAAR,EAAkB;AACxC,SAAMmhB,WAAWlF,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAjB;;AACA,SAAImhB,aAAatoB,SAAjB,EAA4B;AAC3BojB,iBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBrmB,KAAvB,EAA8BiiC,QAA9B;AACAlF,iBAAWgF,GAAX,CAAe1b,MAAf,EAAuBvF,KAAvB;AACA;AACD,KAND;AAOA;;AAED,OAAI3D,OAAOilB,QAAX,EAAqB;AACpB5jC,MAAEoN,IAAF,CAAOuR,OAAOilB,QAAd,EAAwB,UAACpiC,KAAD,EAAQ8gB,KAAR,EAAkB;AACzC,SAAImhB,WAAWlF,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAf;;AACA,SAAIzV,MAAMqvB,OAAN,CAAcuH,QAAd,CAAJ,EAA6B;AAC5BA,iBAAWzjC,EAAE8Y,UAAF,CAAa2qB,QAAb,EAAuBjiC,KAAvB,CAAX;AACA+8B,iBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBvF,KAAvB,EAA8BmhB,QAA9B;AACA;AACD,KAND;AAOA;;AAED,OAAI9kB,OAAOklB,IAAX,EAAiB;AAChB7jC,MAAEoN,IAAF,CAAOuR,OAAOklB,IAAd,EAAoB,UAACriC,KAAD,EAAQ8gB,KAAR,EAAkB;AACrC,SAAMmhB,WAAWlF,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAjB;;AACA,SAAIzV,MAAMqvB,OAAN,CAAcuH,QAAd,CAAJ,EAA6B;AAC5B,UAAIjiC,UAAU,CAAC,CAAf,EAAkB;AACjBiiC,gBAASK,KAAT;AACA,OAFD,MAEO;AACNL,gBAASM,GAAT;AACA;;AACDxF,iBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBvF,KAAvB,EAA8BmhB,QAA9B;AACA;AACD,KAVD;AAWA;;AAED,OAAI9kB,OAAOyF,SAAX,EAAsB;AACrBpkB,MAAEoN,IAAF,CAAOuR,OAAOyF,SAAd,EAAyB,UAAC5iB,KAAD,EAAQ8gB,KAAR,EAAkB;AAC1C,SAAImhB,WAAWlF,WAAWn+B,GAAX,CAAeynB,MAAf,EAAuBvF,KAAvB,CAAf;;AACA,SAAImhB,aAAatoB,SAAjB,EAA4B;AAC3BsoB,iBAAW,EAAX;AACA;;AACD,SAAI52B,MAAMqvB,OAAN,CAAcuH,QAAd,CAAJ,EAA6B;AAC5B,UAAM/+B,SAAS++B,SAAS/+B,MAAxB;;AAEA,UAAIlD,SAASA,MAAM00B,KAAf,IAAwBrpB,MAAMqvB,OAAN,CAAc16B,MAAM00B,KAApB,CAA5B,EAAwD;AACvD,6BAAwB10B,MAAM00B,KAA9B,yHAAqC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,YAA1B8N,SAA0B;;AACpC,YAAIP,SAASr9B,OAAT,CAAiB49B,SAAjB,MAAgC,CAAC,CAArC,EAAwC;AACvCP,kBAAS3hC,IAAT,CAAckiC,SAAd;AACA;AACD;AACD,OAND,MAMO,IAAIP,SAASr9B,OAAT,CAAiB5E,KAAjB,MAA4B,CAAC,CAAjC,EAAoC;AAC1CiiC,gBAAS3hC,IAAT,CAAcN,KAAd;AACA;;AAED,UAAIiiC,SAAS/+B,MAAT,GAAkBA,MAAtB,EAA8B;AAC7B65B,kBAAWx8B,GAAX,CAAe8lB,MAAf,EAAuBvF,KAAvB,EAA8BmhB,QAA9B;AACA;AACD;AACD,KAtBD;AAuBA;;AAED,QAAKjD,UAAL,CAAgB7hB,MAAhB,CAAuBkJ,MAAvB;AACA,QAAK4Z,eAAL,CAAqB5Z,MAArB;;AAEA,OAAIub,cAAc1+B,MAAd,GAAuB,CAA3B,EAA8B;AAC7B,SAAK2nB,IAAL,CAAU,SAAV,EAAqBxE,MAArB,EAA6BA,MAA7B;AACA;AACD;;;;;2BAEDlJ,M;kBAAOhN,K,EAAOgN,O,EAAsB;AAAA,OAAd3V,OAAc,uEAAJ,EAAI;AACnC,OAAIu4B,UAAUv4B,QAAQ+oB,KAAR,GAAgB,KAAK5tB,IAAL,CAAUwN,KAAV,EAAiBmC,KAAjB,EAAhB,GAA2C,KAAKqE,OAAL,CAAaxG,KAAb,KAAuB,EAAhF;;AACA,OAAI,CAAC9E,MAAMqvB,OAAN,CAAcqF,OAAd,CAAL,EAA6B;AAC5BA,cAAU,CAACA,OAAD,CAAV;AACA;;AAED,yBAAqBA,OAArB,yHAA8B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,QAAnB1Z,MAAmB;AAC7B,SAAKwb,YAAL,CAAkBxb,MAAlB,EAA0BlJ,OAA1B;AACA;AACD;;;;;2BAEDG,U;sBAAWhb,E,EAAI;AACd,OAAM+jB,SAAS,KAAKsZ,YAAL,CAAkB,KAAlB,EAAyBr9B,EAAzB,CAAf;;AACA,OAAI+jB,MAAJ,EAAY;AACX,SAAKwE,IAAL,CAAU,cAAV,EAA0BxE,MAA1B;AACA,SAAK2Y,UAAL,CAAgByD,WAAhB,CAA4B;AAAC/iC,UAAK4C;AAAN,KAA5B;AACA,SAAK+9B,oBAAL,CAA0Bha,MAA1B;AACA,SAAKwE,IAAL,CAAU,SAAV,EAAqBxE,MAArB;AACA;AACD;;;;;;EAtzB4ByW,Y;;AA5H9B31B,OAAOC,aAAP,CAq7BegkB,eAr7Bf,uF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA,IAAI0R,qBAAJ;AAAiB31B,OAAO8E,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAC4wB,aAAD,YAAc3wB,CAAd,EAAgB;AAAC2wB,iBAAa3wB,CAAb;AAAe;AAAhC,CAA/B,EAAiE,CAAjE;AAAjB,4BAEA,IAAMu2B,WAAW,aAAjB;AAGA,IAAMC,QAAQ,IAAIC,MAAMC,UAAV,CAAyBH,QAAzB,YAAd;;AACA,IAAI;AACHC,OAAMG,YAAN,CAAmB;AAAE9D,cAAY;AAAd,EAAnB;;AACA2D,OAAMG,YAAN,CAAmB;AAAEC,cAAY;AAAd,EAAnB,EAAsC;AAAEpV,sBAAoB,KAAK,EAAL,GAAU,EAAV,GAAe;AAArC,EAAtC;AACA,CAHD,CAGE,OAAOvU,CAAP,EAAU;AACXtV,SAAQC,GAAR,CAAYqV,CAAZ;AACA;;AAED,IAAM4pB,mBAAmBC,eAAeC,6BAAf,GAA+CC,KAA/C,CAAqDC,YAArD,IAAqE,CAAC,CAACH,eAAeC,6BAAf,GAA+CC,KAA/C,CAAqDC,YAArD,CAAkEC,YAAlK;AACA,IAAIC,iBAAiBN,gBAArB;AACA/kC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,+BAAxB,EAAyD,UAACqB,GAAD,EAAMD,KAAN,EAAgB;AACxEsjC,kBAAiBN,oBAAoBhjC,UAAU,KAA/C;AACA,CAFD;;IAIMmrB,Y;;;AACL,uBAAYQ,KAAZ,EAAmB4X,SAAnB,EAA8B;AAAA;;AAAA,6DAC7B,wBAD6B;;AAG7B,MAAIpgB,MAAMhjB,IAAN,CAAWwrB,KAAX,EAAkB3nB,MAAlB,CAAJ,EAA+B;AAC9B,SAAKrC,IAAL,GAAYgqB,KAAZ;AACA,SAAKC,cAAL,GAAsB,MAAK8W,QAAL,GAAgB,MAAK/gC,IAA3C;AACA,SAAKgqB,KAAL,GAAa,IAAIiX,MAAMC,UAAV,CAAqB,MAAKjX,cAA1B,CAAb;AACA,GAJD,MAIO;AACN,SAAKjqB,IAAL,GAAYgqB,MAAM6X,KAAlB;AACA,SAAK5X,cAAL,GAAsB,MAAKjqB,IAA3B;AACA,SAAKgqB,KAAL,GAAaA,KAAb;AACA;;AAED,QAAK4X,SAAL,GAAiBA,SAAjB;;AAEA,QAAKE,SAAL,GAf6B,CAiB7B;;;AACA,QAAKC,IAAL,CAAU,aAAV,EAAyB,UAACC,KAAD,CAAM,cAAN,EAAyB;AACjD,OAAIA,UAAU,QAAd,EAAwB;AACvB,QAAIL,cAAJ,EAAoB;AACnB,SAAMnzB,QAAQ;AACb6uB,kBAAY,MAAKpT;AADJ,MAAd;;AAIAqX,oBAAeC,6BAAf,GAA+CC,KAA/C,CAAqDC,YAArD,CAAkEC,YAAlE,CAA+ElzB,KAA/E,EAAsF,MAAKyzB,kBAAL,CAAwB7X,IAAxB,OAAtF;;AACAkX,oBAAeC,6BAAf,GAA+CC,KAA/C,CAAqDC,YAArD,CAAkES,mBAAlE,CAAsFC,OAAOC,gBAA7F;AACA;AACD;AACD,GAXD;;AAaA,QAAKjX,cAAL,CAAoB;AAAE,iBAAc;AAAhB,GAApB;;AA/B6B;AAgC7B;;wBAMDT,Y;0BAA0B;AAAA,OAAbhG,MAAa,uEAAJ,EAAI;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAI,UAAUlmB,IAAV,CAAeN,OAAOC,IAAP,CAAYumB,MAAZ,EAAoBzS,IAApB,CAAyB,GAAzB,CAAf,CAAJ,EAAmD;AAClDyS,WAAOjJ,IAAP,GAAciJ,OAAOjJ,IAAP,IAAe,EAA7B;AACAiJ,WAAOjJ,IAAP,CAAY8V,UAAZ,GAAyB,IAAIzzB,IAAJ,EAAzB;AACA,IAHD,MAGO;AACN4mB,WAAO6M,UAAP,GAAoB,IAAIzzB,IAAJ,EAApB;AACA;;AAED,UAAO4mB,MAAP;AACA;;;;;wBAEDod,S;uBAAY;AACX,QAAKO,SAAL,GAAiB;AAChB3gB,YAAQ,KAAKsI,KAAL,CAAWtI,MAAX,CAAkB0I,IAAlB,CAAuB,KAAKJ,KAA5B,CADQ;AAEhBxO,YAAQ,KAAKwO,KAAL,CAAWxO,MAAX,CAAkB4O,IAAlB,CAAuB,KAAKJ,KAA5B,CAFQ;AAGhB9oB,YAAQ,KAAK8oB,KAAL,CAAW9oB,MAAX,CAAkBkpB,IAAlB,CAAuB,KAAKJ,KAA5B;AAHQ,IAAjB;AAKA,OAAM7B,OAAO,IAAb;;AAEA,QAAK6B,KAAL,CAAWtI,MAAX,GAAoB,YAAW;AAC9B,WAAOyG,KAAKzG,MAAL,aAAe7X,SAAf,CAAP;AACA,IAFD;;AAIA,QAAKmgB,KAAL,CAAWxO,MAAX,GAAoB,YAAW;AAC9B,WAAO2M,KAAK3M,MAAL,aAAe3R,SAAf,CAAP;AACA,IAFD;;AAIA,QAAKmgB,KAAL,CAAW9oB,MAAX,GAAoB,YAAW;AAC9B,WAAOinB,KAAKjnB,MAAL,aAAe2I,SAAf,CAAP;AACA,IAFD;AAGA;;;;;wBAED7I,I;kBAAO;AAAA;;AACN,UAAO,eAAKgpB,KAAL,EAAWhpB,IAAX,eAAmB6I,SAAnB,CAAP;AACA;;;;;wBAEDmL,O;qBAAU;AAAA;;AACT,UAAO,gBAAKgV,KAAL,EAAWhV,OAAX,gBAAsBnL,SAAtB,CAAP;AACA;;;;;wBAED4J,W;uBAAY1V,G,EAAK8H,O,EAAS;AACzB,UAAO,KAAKmkB,KAAL,CAAWhV,OAAX,CAAmB;AAAEjX;AAAF,IAAnB,EAA4B8H,OAA5B,CAAP;AACA;;;;;wBAED+kB,Y;wBAAaC,G,EAAKhlB,O,EAAS;AAC1B,UAAO,KAAKmkB,KAAL,CAAWhV,OAAX,CAAmB;AAAEjX,SAAK;AAAE8X,UAAKgV;AAAP;AAAP,IAAnB,EAAyChlB,OAAzC,CAAP;AACA;;;;;wBAEDy8B,kB;8BAAmB9zB,K,EAAO+zB,Q,EAAU18B,O,EAAS;AAC5C,OAAI,KAAK+7B,SAAL,CAAe9X,QAAf,KAA4B,KAAhC,EAAuC;AACtC,WAAO,IAAP;AACA;;AAED,OAAIjkB,QAAQsb,MAAR,KAAmB,IAAvB,EAA6B;AAC5B,WAAO,IAAP;AACA,IAP2C,CAS5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,OAAMqhB,wBAAwB,CAC7B,MAD6B,EAE7B,QAF6B,EAG7B,MAH6B,EAI7B,MAJ6B,EAK7B,MAL6B,EAM7B,MAN6B,EAO7B,SAP6B,EAQ7B,UAR6B,EAS7B,MAT6B,EAU7B,WAV6B,CAA9B;AAaA,OAAMC,sBAAsBvkC,OAAOC,IAAP,CAAYokC,QAAZ,EAAsBv/B,MAAtB,CAA6B;AAAA,WAAK0K,EAAEyQ,UAAF,CAAa,GAAb,KAAqBqkB,sBAAsBjsB,QAAtB,CAA+B7I,CAA/B,MAAsC,KAAhE;AAAA,IAA7B,CAA5B;;AAEA,OAAI+0B,oBAAoBlhC,MAApB,GAA6B,CAAjC,EAAoC;AACnC,WAAO,IAAP;AACA;;AAED,OAAMmhC,oBAAoBxkC,OAAOC,IAAP,CAAYqQ,KAAZ,EAAmBxL,MAAnB,CAA0B;AAAA,WAAQtD,KAAKuD,OAAL,CAAa,GAAb,IAAoB,CAAC,CAA7B;AAAA,IAA1B,CAA1B;;AACA,OAAIy/B,kBAAkBnhC,MAAlB,GAA2B,CAA/B,EAAkC;AACjC,WAAO,IAAP;AACA;;AAED,UAAO,OAAP;AACA;;;;;wBAEDohC,2B;uCAA4BnnB,M,EAAQ;AACnC,QAAK,IAAMld,GAAX,2CAAkBkd,MAAlB,GAA0B;AACzB,QAAIld,IAAIiY,QAAJ,CAAa,IAAb,CAAJ,EAAwB;AACvB,YAAO,IAAP;AACA;;AAED,QAAMlY,QAAQmd,OAAOld,GAAP,CAAd;;AAEA,QAAIkjB,MAAMhjB,IAAN,CAAWH,KAAX,EAAkBH,MAAlB,CAAJ,EAA+B;AAC9B,SAAI,KAAKykC,2BAAL,CAAiCtkC,KAAjC,MAA4C,IAAhD,EAAsD;AACrD,aAAO,IAAP;AACA;AACD;AACD;;AAED,UAAO,KAAP;AACA;;;;;wBAED4jC,kB;8BAAmBx9B,M,EAAQ;AAC1B,OAAIk9B,mBAAmB,KAAvB,EAA8B;AAC7B;AACA;;AAED,OAAIl9B,OAAOm+B,EAAP,CAAUA,EAAV,KAAiB,GAArB,EAA0B;AACzB,SAAK1Z,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,aAAQ,QADW;AAEnB9D,SAAI8D,OAAOm+B,EAAP,CAAUC,CAAV,CAAY9kC,GAFG;AAGnBsF,WAAMoB,OAAOm+B,EAAP,CAAUC,CAHG;AAInBC,YAAO;AAJY,KAApB;AAMA;AACA;;AAED,OAAIr+B,OAAOm+B,EAAP,CAAUA,EAAV,KAAiB,GAArB,EAA0B;AACzB,QAAI,CAACn+B,OAAOm+B,EAAP,CAAUC,CAAV,CAAYpnB,IAAb,IAAqB,CAAChX,OAAOm+B,EAAP,CAAUC,CAAV,CAAYlf,MAAtC,EAA8C;AAC7C,UAAKuF,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,cAAQ,eADW;AAEnB9D,UAAI8D,OAAO9D,EAFQ;AAGnB0C,YAAMoB,OAAOm+B,EAAP,CAAUC,CAHG;AAInBC,aAAO;AAJY,MAApB;AAMA;AACA;;AAED,QAAMzzB,OAAO,EAAb;;AACA,QAAI5K,OAAOm+B,EAAP,CAAUC,CAAV,CAAYpnB,IAAhB,EAAsB;AACrB,UAAK,IAAMnd,GAAX,2CAAkBmG,OAAOm+B,EAAP,CAAUC,CAAV,CAAYpnB,IAA9B,GAAoC;AACnC,UAAIhX,OAAOm+B,EAAP,CAAUC,CAAV,CAAYpnB,IAAZ,CAAiBoQ,cAAjB,CAAgCvtB,GAAhC,CAAJ,EAA0C;AACzC+Q,YAAK/Q,GAAL,IAAYmG,OAAOm+B,EAAP,CAAUC,CAAV,CAAYpnB,IAAZ,CAAiBnd,GAAjB,CAAZ;AACA;AACD;AACD;;AAED,QAAImG,OAAOm+B,EAAP,CAAUC,CAAV,CAAYlf,MAAhB,EAAwB;AACvB,UAAK,IAAMrlB,IAAX,2CAAkBmG,OAAOm+B,EAAP,CAAUC,CAAV,CAAYlf,MAA9B,GAAsC;AACrC,UAAIlf,OAAOm+B,EAAP,CAAUC,CAAV,CAAYlf,MAAZ,CAAmBkI,cAAnB,CAAkCvtB,IAAlC,CAAJ,EAA4C;AAC3C+Q,YAAK/Q,IAAL,IAAY0Z,SAAZ;AACA;AACD;AACD;;AAED,SAAKkR,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,aAAQ,aADW;AAEnB9D,SAAI8D,OAAO9D,EAFQ;AAGnB0C,WAAMgM,IAHa;AAInByzB,YAAO;AAJY,KAApB;AAMA;AACA;;AAED,OAAIr+B,OAAOm+B,EAAP,CAAUA,EAAV,KAAiB,GAArB,EAA0B;AACzB,SAAK1Z,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,aAAQ,QADW;AAEnB9D,SAAI8D,OAAO9D,EAFQ;AAGnBmiC,YAAO;AAHY,KAApB;AAKA;AACA;AACD;;;;;wBAEDphB,M;kBAAOgD,M,EAAQ;AAAA;;AACd,QAAKgG,YAAL,CAAkBhG,MAAlB;;AAEA,OAAMjjB,SAAS,mBAAK4gC,SAAL,EAAe3gB,MAAf,mBAAyB7X,SAAzB,CAAf;;AACA,OAAI,CAAC83B,cAAD,IAAmB,KAAKoB,aAAL,CAAmB,QAAnB,IAA+B,CAAtD,EAAyD;AACxD,SAAK7Z,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,aAAQ,QADW;AAEnB9D,SAAIc,MAFe;AAGnB4B,WAAMxG,EAAEkgB,MAAF,CAAS,EAAT,EAAa2H,MAAb,CAHa;AAInBoe,YAAO;AAJY,KAApB;AAMA;;AAEDpe,UAAO3mB,GAAP,GAAa0D,MAAb;AAEA,UAAOA,MAAP;AACA;;;;;wBAED+Z,M;kBAAOhN,K,EAAOgN,O,EAAsB;AAAA,OAAd3V,OAAc,uEAAJ,EAAI;AACnC,QAAK6kB,YAAL,CAAkBlP,OAAlB,EAA0B,IAA1B,EAAgChN,KAAhC;AAEA,OAAMw0B,WAAW,KAAKV,kBAAL,CAAwB9zB,KAAxB,EAA+BgN,OAA/B,EAAuC3V,OAAvC,CAAjB;AACA,OAAIglB,MAAM,EAAV;;AACA,OAAI,CAAC8W,cAAD,IAAmB,KAAKoB,aAAL,CAAmB,QAAnB,IAA+B,CAAlD,IAAuDC,aAAa,IAAxE,EAA8E;AAC7E,QAAMC,cAAc;AAACvyB,aAAQ;AAAC3S,WAAK;AAAN;AAAT,KAApB;AACA,QAAIqgC,UAAUv4B,QAAQ+oB,KAAR,GAAgB,KAAK5tB,IAAL,CAAUwN,KAAV,EAAiBy0B,WAAjB,EAA8BtyB,KAA9B,EAAhB,GAAwD,KAAKqE,OAAL,CAAaxG,KAAb,EAAoBy0B,WAApB,KAAoC,EAA1G;;AACA,QAAI,CAACv5B,MAAMqvB,OAAN,CAAcqF,OAAd,CAAL,EAA6B;AAC5BA,eAAU,CAACA,OAAD,CAAV;AACA;;AAEDvT,UAAMuT,QAAQj/B,GAAR,CAAY;AAAA,YAAQO,KAAK3B,GAAb;AAAA,KAAZ,CAAN;;AACA,QAAI8H,QAAQsb,MAAR,KAAmB,IAAnB,IAA2B,KAAKwhB,2BAAL,CAAiCnnB,OAAjC,MAA6C,KAA5E,EAAmF;AAClFhN,aAAQ;AACPzQ,WAAK;AACJ8X,YAAKgV;AADD;AADE,MAAR;AAKA;AACD;;AAED,OAAMppB,SAAS,KAAK4gC,SAAL,CAAe7mB,MAAf,CAAsBhN,KAAtB,EAA6BgN,OAA7B,EAAqC3V,OAArC,CAAf;;AAEA,OAAI,CAAC87B,cAAD,IAAmB,KAAKoB,aAAL,CAAmB,QAAnB,IAA+B,CAAtD,EAAyD;AACxD,QAAIC,aAAa,IAAjB,EAAuB;AACtB,SAAIn9B,QAAQsb,MAAR,KAAmB,IAAvB,EAA6B;AAC5B,UAAI1f,OAAOyhC,UAAX,EAAuB;AACtB,YAAKha,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,gBAAQ,QADW;AAEnB9D,YAAIc,OAAOyhC,UAFQ;AAGnB7/B,cAAM,KAAK2R,OAAL,CAAa;AAACjX,cAAK0D,OAAOyhC;AAAb,SAAb,CAHa;AAInBJ,eAAO;AAJY,QAApB;AAMA;AACA;;AAEDt0B,cAAQ;AACPzQ,YAAK;AACJ8X,aAAKgV;AADD;AADE,OAAR;AAKA;;AAED,SAAIuT,WAAUv4B,QAAQ+oB,KAAR,GAAgB,KAAK5tB,IAAL,CAAUwN,KAAV,EAAiBmC,KAAjB,EAAhB,GAA2C,KAAKqE,OAAL,CAAaxG,KAAb,KAAuB,EAAhF;;AACA,SAAI,CAAC9E,MAAMqvB,OAAN,CAAcqF,QAAd,CAAL,EAA6B;AAC5BA,iBAAU,CAACA,QAAD,CAAV;AACA;;AACD,0BAAqBA,QAArB,kHAA8B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,UAAnB1Z,MAAmB;AAC7B,WAAKwE,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,eAAQ,eADW;AAEnB9D,WAAI+jB,OAAO3mB,GAFQ;AAGnBsF,aAAMqhB,MAHa;AAInBoe,cAAO;AAJY,OAApB;AAMA;AACD,KA/BD,MA+BO;AACN,UAAK5Z,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,cAAQ,cADW;AAEnB9D,UAAIqX,SAFe;AAGnB3U,YAAM;AACLmL,mBADK;AAELgN,sBAFK;AAGL3V;AAHK,OAHa;AAQnBi9B,aAAO;AARY,MAApB;AAUA;AACD;;AACD,UAAOrhC,MAAP;AACA;;;;;wBAED0f,M;kBAAO3S,K,EAAOgN,M,EAAsB;AAAA,OAAd3V,OAAc,uEAAJ,EAAI;AACnCA,WAAQsb,MAAR,GAAiB,IAAjB;AACAtb,WAAQs9B,aAAR,GAAwB,IAAxB;AACA,UAAO,KAAK3nB,MAAL,CAAYhN,KAAZ,EAAmBgN,MAAnB,EAA2B3V,OAA3B,CAAP;AACA;;;;;wBAED3E,M;kBAAOsN,K,EAAO;AACb,OAAM4vB,UAAU,KAAKpU,KAAL,CAAWhpB,IAAX,CAAgBwN,KAAhB,EAAuBmC,KAAvB,EAAhB;AAEA,OAAMka,MAAM,EAAZ;;AACA,yBAAqBuT,OAArB,yHAA8B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,QAAnB1Z,MAAmB;AAC7BmG,QAAIlsB,IAAJ,CAAS+lB,OAAO3mB,GAAhB;AAEA2mB,WAAO0c,UAAP,GAAoB,IAAItjC,IAAJ,EAApB;AACA4mB,WAAO0e,cAAP,GAAwB,KAAKpjC,IAA7B;AAEAghC,UAAM7f,MAAN,CAAa;AAACpjB,UAAK2mB,OAAO3mB;AAAb,KAAb,EAAgClB,EAAE2iC,IAAF,CAAO9a,MAAP,EAAe,KAAf,CAAhC;AACA;;AAEDlW,WAAQ;AAAEzQ,SAAK;AAAE8X,UAAKgV;AAAP;AAAP,IAAR;AAEA,OAAMppB,SAAS,KAAK4gC,SAAL,CAAenhC,MAAf,CAAsBsN,KAAtB,CAAf;;AAEA,OAAI,CAACmzB,cAAD,IAAmB,KAAKoB,aAAL,CAAmB,QAAnB,IAA+B,CAAtD,EAAyD;AACxD,0BAAqB3E,OAArB,yHAA8B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,SAAnB1Z,OAAmB;AAC7B,UAAKwE,IAAL,CAAU,QAAV,EAAoB;AACnBzkB,cAAQ,QADW;AAEnB9D,UAAI+jB,QAAO3mB,GAFQ;AAGnBsF,YAAMxG,EAAEkgB,MAAF,CAAS,EAAT,EAAa2H,OAAb,CAHa;AAInBoe,aAAO;AAJY,MAApB;AAMA;AACD;;AAED,UAAOrhC,MAAP;AACA;;;;;wBAEDqpB,c;4BAAwB;AAAA,qCAANrhB,IAAM;AAANA,QAAM;AAAA;;AACvB,OAAIA,KAAK,CAAL,KAAWA,KAAK,CAAL,EAAQ1L,GAAvB,EAA4B;AAC3B,QAAMA,MAAM0L,KAAK,CAAL,EAAQ1L,GAApB;AACA,WAAO0L,KAAK,CAAL,EAAQ1L,GAAf;AACA0L,SAAKwf,OAAL,CAAa;AACZlrB;AADY,KAAb;AAIA,SAAKojB,MAAL,aAAe1X,IAAf;AACA,WAAO1L,GAAP;AACA,IATD,MASO;AACN,WAAO,KAAK2jB,MAAL,aAAejY,IAAf,CAAP;AACA;AACD;;;;;wBAEDshB,K;mBAAQ;AAAA;;AACP,UAAO,gBAAKf,KAAL,EAAWe,KAAX,gBAAoBlhB,SAApB,CAAP;AACA;;;;;wBAEDmhB,I;kBAAO;AAAA;;AACN,UAAO,gBAAKhB,KAAL,EAAWgB,IAAX,gBAAmBnhB,SAAnB,CAAP;AACA;;;;;wBAEDohB,W;yBAAc;AAAA;;AACb,UAAO,gBAAKjB,KAAL,EAAWmX,YAAX,gBAA2Bt3B,SAA3B,CAAP;AACA;;;;;wBAEDqhB,S;uBAAY;AAAA;;AACX,UAAO,gBAAKlB,KAAL,EAAWqZ,UAAX,gBAAyBx5B,SAAzB,CAAP;AACA;;;;;wBAEDshB,c;4BAAiB;AAChB,OAAI;AACH,WAAO,KAAKF,WAAL,aAAoBphB,SAApB,CAAP;AACA,IAFD,CAEE,OAAO4N,CAAP,EAAU;AAAA;;AACX,yBAAQ1M,KAAR,kBAAc,uBAAd,EAAuC,KAAK/K,IAA5C,EAAkD,IAAlD,oCAA2D6J,SAA3D,IAAsE4N,CAAtE;AACA;AACD;;;;;wBAED2T,Y;0BAAe;AACd,OAAI;AACH,WAAO,KAAKF,SAAL,aAAkBrhB,SAAlB,CAAP;AACA,IAFD,CAEE,OAAO4N,CAAP,EAAU;AAAA;;AACX,0BAAQ1M,KAAR,mBAAc,uBAAd,EAAuC,KAAK/K,IAA5C,EAAkD,IAAlD,oCAA2D6J,SAA3D,IAAsE4N,CAAtE;AACA;AACD;;;;;wBAED4T,S;qBAAU7c,K,EAAO3I,O,EAAS;AACzB2I,SAAM40B,cAAN,GAAuB,KAAKpjC,IAA5B;AAEA,UAAOghC,MAAMhgC,IAAN,CAAWwN,KAAX,EAAkB3I,OAAlB,CAAP;AACA;;;;;wBAEDylB,qB;iCAAsBgY,S,EAAgC;AAAA,OAArB90B,KAAqB,uEAAb,EAAa;AAAA,OAAT3I,OAAS;AACrD2I,SAAM40B,cAAN,GAAuB,KAAKpjC,IAA5B;AACAwO,SAAM4yB,UAAN,GAAmB;AAClB5U,SAAK8W;AADa,IAAnB;AAIA,UAAOtC,MAAMhgC,IAAN,CAAWwN,KAAX,EAAkB3I,OAAlB,CAAP;AACA;;;;;;;mBArXc;AACd,UAAOk7B,QAAP;AACA;;;EArCyB5F,Y;;AAnB3B31B,OAAOC,aAAP,CA8ae+jB,YA9af,0F;;;;;;;;;;;ACAA,IAAM+Z,sBAAsB,EAA5B;;AAEAjnC,WAAWknC,0BAAX,GAAwC,UAAS3J,WAAT,EAAsB4J,wBAAtB,EAAgD;AACvFF,qBAAoB1J,WAApB,IAAmC;AAClCA,0BADkC;AAElC4J;AAFkC,EAAnC;AAIA,CALD,C,CAOA;AACA;;;AACAjkB,SAASkkB,oBAAT,CAA8B,UAAS79B,OAAT,EAAkB;AAC/C,KAAI,CAACA,QAAQ89B,WAAb,EAA0B;AACzB,SAAO3rB,SAAP,CADyB,CACP;AAClB;;AAED3L,OAAMxG,OAAN,EAAe2b,MAAMoiB,eAAN,CAAsB;AACpC/J,eAAax3B;AADuB,EAAtB,CAAf;AAIA,KAAM4iB,UAAUse,oBAAoB19B,QAAQg0B,WAA5B,CAAhB,CAT+C,CAW/C;;AACA,KAAI,CAAC5U,OAAL,EAAc;AACb,QAAM,IAAInkB,KAAJ,qCAA6C+E,QAAQg0B,WAArD,CAAN;AACA,EAd8C,CAgB/C;;;AACA,KAAI,CAACgK,qBAAqBC,cAArB,CAAoC9uB,OAApC,CAA4C;AAACiQ,WAASA,QAAQ4U;AAAlB,EAA5C,CAAL,EAAkF;AACjF,QAAM,IAAIgK,qBAAqBE,WAAzB,EAAN;AACA;;AAED,KAAI,CAAClnC,EAAEgG,QAAF,CAAW2c,SAASwkB,KAAT,CAAeC,YAAf,EAAX,EAA0Chf,QAAQ4U,WAAlD,CAAL,EAAqE;AACpE;AACA;AACA;AACA,SAAO;AACNl3B,SAAM,OADA;AAENoI,UAAO,IAAIvN,OAAOsD,KAAX,CACN0e,SAAS0kB,mBAAT,CAA6BC,YADvB,8CAEqClf,QAAQ4U,WAF7C;AAFD,GAAP;AAOA;;AAED,KAAMuK,cAAcnf,QAAQwe,wBAAR,CAAiC59B,OAAjC,CAApB;AAEA,QAAO2Z,SAAS6kB,qCAAT,CAA+Cpf,QAAQ4U,WAAvD,EAAoEuK,YAAYE,WAAhF,EAA6FF,YAAYv+B,OAAzG,CAAP;AACA,CArCD,2H;;;;;;;;;;;ACXA,oBAEA,SAAS0+B,WAAT,CAAqBZ,WAArB,EAAkC;AACjC,KAAI;AACH,SAAOve,KAAKnoB,GAAL,CACN,+CADM,EAEN;AAAC6I,WAAQ;AAAC0+B,kBAAcb;AAAf;AAAT,GAFM,EAEiCtgC,IAFxC;AAGA,EAJD,CAIE,OAAO/D,GAAP,EAAY;AACb,QAAMzC,EAAEkgB,MAAF,CAAS,IAAIjc,KAAJ,4CAAoDxB,IAAIyH,OAAxD,CAAT,EAA8E;AAACue,aAAUhmB,IAAIgmB;AAAf,GAA9E,CAAN;AACA;AACD;;AAED,SAASmf,SAAT,CAAmBd,WAAnB,EAAgC;AAC/B,KAAI;AACH,SAAOve,KAAKnoB,GAAL,CACN,gDADM,EAEN;AAAC6I,WAAQ;AAAC0+B,kBAAcb;AAAf;AAAT,GAFM,EAEiCtgC,IAFjC,CAEsCqO,KAFtC,CAE4CzP,KAF5C,CAEkD,GAFlD,CAAP;AAGA,EAJD,CAIE,OAAO3C,GAAP,EAAY;AACb,QAAMzC,EAAEkgB,MAAF,CAAS,IAAIjc,KAAJ,6CAAqDxB,IAAIyH,OAAzD,CAAT,EAA+E;AAACue,aAAUhmB,IAAIgmB;AAAf,GAA/E,CAAN;AACA;AACD;;AAGDhpB,WAAWknC,0BAAX,CAAsC,QAAtC,EAAgD,UAAS39B,OAAT,EAAkB;AACjEwG,OAAMxG,OAAN,EAAe2b,MAAMoiB,eAAN,CAAsB;AACpCD,eAAathC,MADuB;AAEpCqiC,WAASriC,MAF2B;AAGpCsiC,aAAWnjB,MAAMojB,OAHmB;AAIpClzB,SAAO8P,MAAMqjB,KAAN,CAAYxiC,MAAZ,CAJ6B;AAKpCyiC,YAAUtjB,MAAMqjB,KAAN,CAAY3mC,MAAZ;AAL0B,EAAtB,CAAf;AAQA,KAAM4mC,WAAWj/B,QAAQi/B,QAAR,IAAoBP,YAAY1+B,QAAQ89B,WAApB,CAArC;AAEA,KAAMW,cAAc;AACnBX,eAAa99B,QAAQ89B,WADF;AAEnBe,WAAS7+B,QAAQ6+B,OAFE;AAGnBK,aAAY,CAAC,IAAIjnC,IAAJ,EAAF,GAAe,OAAOoP,SAASrH,QAAQ8+B,SAAjB,EAA4B,EAA5B,CAHd;AAInBjzB,SAAO7L,QAAQm/B,MAAR,IAAkBP,UAAU5+B,QAAQ89B,WAAlB;AAJN,EAApB;;AAOA,KAAMjzB,SAAS7T,EAAE0kB,IAAF,CAAOujB,QAAP,EAAiBG,OAAOC,iBAAxB,CAAf;;AACAroC,GAAEkgB,MAAF,CAASunB,WAAT,EAAsB5zB,MAAtB,EAnBiE,CAqBjE;AACA;AACA;;;AACA,KAAI7K,QAAQs/B,YAAZ,EAA0B;AACzBb,cAAYa,YAAZ,GAA2Bt/B,QAAQs/B,YAAnC;AACA;;AAED,QAAO;AACNb,0BADM;AAENz+B,WAAS;AACR80B,YAAS;AACR36B,UAAM8kC,SAAS9kC;AADP;AADD;AAFH,EAAP;AAQA,CApCD,2H;;;;;;;;;;;ACvBA,mBAEAolC,MAAMC,YAAN,GAAqBxoC,EAAEwC,IAAF,CAAO+lC,MAAMC,YAAb,EAA2B,UAASj7B,IAAT,EAAeyvB,WAAf,EAAqC;AACpF,KAAMyL,QAAQhpC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,+BAAxB,EAAyDiG,OAAzD,CAAiE,KAAjE,EAAwE,EAAxE,EAA4EjB,KAA5E,CAAkF,GAAlF,CAAd;;AACA,KAAIqjC,MAAM/uB,QAAN,CAAesjB,WAAf,CAAJ,EAAiC;AAChC,SAAWv9B,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,CAAX;AACA,EAFD,MAEO;AAAA,oCAJuEwM,IAIvE;AAJuEA,OAIvE;AAAA;;AACN,SAAOW,uBAAKyvB,WAAL,SAAqBpwB,IAArB,EAAP;AACA;AAED,CARoB,CAArB,0H;;;;;;;;;;;;;;;;;ACFAnN,WAAWyF,YAAX,GAA0B;AACzB,yBAAc;AAAA;AACb,OAAKwjC,MAAL,GAAc3uB,IAAIrM,OAAJ,CAAY,gBAAZ,EAA8Bg7B,MAA5C;AACA,OAAKC,SAAL,GAAiB,IAAI,KAAKD,MAAT,EAAjB;AACA;;AAJwB,wBAMzBE,KANyB;AAAA,iBAMnB9iC,IANmB,EAMbk6B,KANa,EAMG;AAAA;;AAAA,qCAANpzB,IAAM;AAANA,QAAM;AAAA;;AAC3B,sBAAK+7B,SAAL,EAAe7iC,IAAf,qCAAoCk6B,KAApC,SAAiDpzB,IAAjD;AACA;;AARwB;AAAA;;AAAA,wBAUzB7H,GAVyB;AAAA,iBAUnB;AACL,OAAM8jC,SAAS78B,QAAQ68B,MAAR,EAAf;AACA,UAAQA,OAAO,CAAP,IAAY,OAAZ,GAAsBA,OAAO,CAAP,IAAY,IAA1C;AACA;;AAbwB;AAAA;;AAAA,wBAezB1jC,MAfyB;AAAA,kBAelB66B,KAfkB,EAeXl7B,IAfW,EAeL2yB,IAfK,EAeC;AACzB,QAAKmR,KAAL,CAAW,QAAX,EAAqB5I,KAArB,EAA4Bl7B,IAA5B,EAAkC2yB,IAAlC;AACA;;AAjBwB;AAAA;;AAAA,wBAmBzBnoB,SAnByB;AAAA,qBAmBf0wB,KAnBe,EAmBRl7B,IAnBQ,EAmBF2yB,IAnBE,EAmBI;AAC5B,QAAKmR,KAAL,CAAW,WAAX,EAAwB5I,KAAxB,EAA+Bl7B,IAA/B,EAAqC2yB,IAArC;AACA;;AArBwB;AAAA;;AAAA,wBAuBzBqR,SAvByB;AAAA,qBAuBf9I,KAvBe,EAuBRl7B,IAvBQ,EAuBF2yB,IAvBE,EAuBI;AAC5B,QAAKmR,KAAL,CAAW,WAAX,EAAwB5I,KAAxB,EAA+Bl7B,IAA/B,EAAqC2yB,IAArC;AACA;;AAzBwB;AAAA;;AAAA,wBA2BzBsR,SA3ByB;AAAA,qBA2Bf/I,KA3Be,EA2BRl7B,IA3BQ,EA2BF2yB,IA3BE,EA2BI;AAC5B,QAAKmR,KAAL,CAAW,WAAX,EAAwB5I,KAAxB,EAA+Bl7B,IAA/B,EAAqC2yB,IAArC;AACA;;AA7BwB;AAAA;;AAAA,wBA+BzBuR,KA/ByB;AAAA,iBA+BnBhJ,KA/BmB,EA+BZl7B,IA/BY,EA+BN2yB,IA/BM,EA+BA;AACxB,QAAKmR,KAAL,CAAW,OAAX,EAAoB5I,KAApB,EAA2Bl7B,IAA3B,EAAiC2yB,IAAjC;AACA;;AAjCwB;AAAA;;AAAA,wBAmCzBpjB,MAnCyB;AAAA,kBAmClB2rB,KAnCkB,EAmCXl7B,IAnCW,EAmCL2yB,IAnCK,EAmCC;AACzB,QAAKmR,KAAL,CAAW,QAAX,EAAqB5I,KAArB,EAA4Bl7B,IAA5B,EAAkC2yB,IAAlC;AACA;;AArCwB;AAAA;;AAAA,wBAuCzB11B,GAvCyB;AAAA,eAuCrBi+B,KAvCqB,EAuCdl7B,IAvCc,EAuCR2yB,IAvCQ,EAuCF;AACtB,QAAKmR,KAAL,CAAW,KAAX,EAAkB5I,KAAlB,EAAyBl7B,IAAzB,EAA+B2yB,IAA/B;AACA;;AAzCwB;AAAA;;AAAA;AAAA,MAA1B,qH;;;;;;;;;;;ACAAh4B,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwB6a,KAAxB,CAA8BqT,OAA9B,CAAsC,eAAtC,EAAuD;AACtDre,QAAO,WAD+C;AAEtDla,OAAM;AACL64B,SAAO,KADF;AAELJ,UAAQ,KAFH;AAGLS,WAHK,YAGKjvB,IAHL,EAGWkF,YAHX,EAGyB;AAC7B,UAAOA,aAAahN,CAAb,CAAeC,QAAtB;AACA,GALI;AAMLnG,QANK,YAME4kC,GANF,EAMO1xB,YANP,EAMqB;AACzB,OAAI0xB,IAAI7iC,OAAJ,CAAYmR,aAAahN,CAAb,CAAeC,QAA3B,IAAuC,CAAC,CAA5C,EAA+C;AAC9Cy+B,QAAIzH,MAAJ,CAAWyH,IAAI7iC,OAAJ,CAAYmR,aAAahN,CAAb,CAAeC,QAA3B,CAAX,EAAiD,CAAjD;AACA;AACD;AAVI;AAFgD,CAAvD;AAiBA/K,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCia,KAAhC,CAAsCoT,MAAtC,CAA6C,OAA7C,EAAsD;AACrDpe,QAAO,OAD8C;AAErDla,OAAM;AACL64B,SAAO,KADF;AAELJ,UAAQ;AAFH;AAF+C,CAAtD;AASAphC,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCia,KAAhC,CAAsCoT,MAAtC,CAA6C,OAA7C,EAAsD;AACrDpe,QAAO,OAD8C;AAErDla,OAAM;AACL64B,SAAO,OADF;AAELJ,UAAQ;AAFH;AAF+C,CAAtD;AAQAphC,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCia,KAAhC,CAAsCoT,MAAtC,CAA6C,OAA7C,EAAsD;AACrDpe,QAAO,OAD8C;AAErDla,OAAM;AACL64B,SAAO,MADF;AAELJ,UAAQ,UAFH;AAGLO,OAHK,YAGC7pB,YAHD,CAGa,UAHb,EAGyB;AAC7B,UAAOA,aAAa1M,CAAb,KAAmB,GAA1B;AACA,GALI;AAMLy2B,WANK,YAMK/pB,YANL,EAMmBhM,IANnB,EAMyB;AAC7B,OAAIA,QAAQ,IAAR,IAAgBgM,gBAAgB,IAApC,EAA0C;AACzC,WAAO4D,SAAP;AACA,IAH4B,CAI7B;AACA;AACA;;;AACA,OAAI5D,aAAamd,UAAb,GAA0BnpB,KAAKmpB,UAAnC,EAA+C;AAC9Cnd,iBAAamd,UAAb,GAA0BnpB,KAAKmpB,UAA/B;AACA;;AACD,UAAOnpB,KAAKpI,IAAZ;AACA;AAjBI;AAF+C,CAAtD;AAuBA1D,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwB4Z,KAAxB,CAA8B3qB,IAA9B;AACAlD,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwB6a,KAAxB,CAA8B3qB,IAA9B;AACAlD,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCia,KAAhC,CAAsC3qB,IAAtC;AACAlD,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BsG,KAA3B,CAAiC3qB,IAAjC;AAGAlD,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwB4Z,KAAxB,CAA8B6V,cAA9B,CAA6C,YAA7C,EAA2D+F,SAA3D,CAAqE;AACpE,oCAAmC;AAACC,SAAO;AAACxZ,QAAK;AAAN;AAAR;AADiC,CAArE;AAIAlwB,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCia,KAAhC,CAAsC6V,cAAtC,CAAqD,eAArD,EAAsE+F,SAAtE,CAAgF;AAC/ExnB,MAAK,CACJ;AAAClK,wBAAsB;AAACwB,QAAK,CAAC,KAAD,EAAQ,SAAR;AAAN;AAAvB,EADI,EAEJ;AAACvB,2BAAyB;AAACuB,QAAK,CAAC,KAAD,EAAQ,SAAR;AAAN;AAA1B,EAFI;AAD0E,CAAhF,2H;;;;;;;;;;;ACnEA,4BACA,SAASowB,mBAAT,CAA6Bt6B,EAA7B,EAAiC;AAChC,QAAO1C,eAAP,KAA2B,WAA3B,IAA0C0C,GAAG1C,eAAH,CAA1C;AACA;;AACD3M,WAAWU,QAAX,CAAoBiB,MAApB,CAA2B,YAA3B,EAAyC,UAASK,GAAT,EAAcD,KAAd,EAAqB;AAC7D,KAAIxB,EAAEqpC,QAAF,CAAW7nC,KAAX,KAAqBA,MAAMtB,IAAN,EAAzB,EAAuC;AACtC,SAAOkpC,oBAAoB;AAAA,UAAmBh9B,gBAAgBk9B,qBAAhB,CAAsC9nC,KAAtC,CAAnB;AAAA,GAApB,CAAP;AACA;AACD,CAJD;AAMAb,OAAOsK,OAAP,CAAe,YAAW;AACzB,KAAMzJ,QAAQ/B,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,YAAxB,CAAd;;AACA,KAAIJ,EAAEqpC,QAAF,CAAW7nC,KAAX,KAAqBA,MAAMtB,IAAN,EAAzB,EAAuC;AACtC,SAAOkpC,oBAAoB;AAAA,UAAmBh9B,gBAAgBk9B,qBAAhB,CAAsC9nC,KAAtC,CAAnB;AAAA,GAApB,CAAP;AACA;AACD,CALD,2H;;;;;;;;;;;ACVA,IAAM+nC,eAAevpC,EAAEwpC,QAAF,CAAW,YAAW;AAC1ClkC,SAAQC,GAAR,CAAY,+BAAZ;;AAEA,KAAI9F,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,WAAxB,CAAJ,EAA0C;AACzC4L,UAAQC,GAAR,CAAYw9B,QAAZ,GAA2BhqC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,eAAxB,CAA3B;;AAEA,MAAIX,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,eAAxB,KAA4CX,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,eAAxB,CAAhD,EAA0F;AACzF4L,WAAQC,GAAR,CAAYw9B,QAAZ,IAA4B7pB,mBAAmBngB,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,eAAxB,CAAnB,CAA5B,SAA8Fwf,mBAAmBngB,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,eAAxB,CAAnB,CAA9F;AACA;;AAED4L,UAAQC,GAAR,CAAYw9B,QAAZ,IAAwB7pB,mBAAmBngB,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,WAAxB,CAAnB,CAAxB;;AAEA,MAAIX,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,WAAxB,CAAJ,EAA0C;AACzC4L,WAAQC,GAAR,CAAYw9B,QAAZ,UAA6Bp5B,SAAS5Q,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,WAAxB,CAAT,CAA7B;AACA;;AAED4L,UAAQC,GAAR,CAAYw9B,QAAZ,eAAkChqC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,WAAxB,CAAlC;AAEA,SAAO4L,QAAQC,GAAR,CAAYw9B,QAAnB;AACA;AACD,CApBoB,EAoBlB,GApBkB,CAArB;;AAsBAhqC,WAAWU,QAAX,CAAoBiB,MAApB,CAA2B,WAA3B,EAAwC,UAASK,GAAT,EAAcD,KAAd,EAAqB;AAC5D,KAAIxB,EAAEqpC,QAAF,CAAW7nC,KAAX,CAAJ,EAAuB;AACtB,SAAO+nC,cAAP;AACA;AACD,CAJD;AAMA9pC,WAAWU,QAAX,CAAoBiB,MAApB,CAA2B,WAA3B,EAAwC,YAAW;AAClD,QAAOmoC,cAAP;AACA,CAFD;AAIA9pC,WAAWU,QAAX,CAAoBiB,MAApB,CAA2B,eAA3B,EAA4C,UAASK,GAAT,EAAcD,KAAd,EAAqB;AAChE,KAAIxB,EAAEqpC,QAAF,CAAW7nC,KAAX,CAAJ,EAAuB;AACtB,SAAO+nC,cAAP;AACA;AACD,CAJD;AAMA9pC,WAAWU,QAAX,CAAoBiB,MAApB,CAA2B,eAA3B,EAA4C,UAASK,GAAT,EAAcD,KAAd,EAAqB;AAChE,KAAIxB,EAAEqpC,QAAF,CAAW7nC,KAAX,CAAJ,EAAuB;AACtB,SAAO+nC,cAAP;AACA;AACD,CAJD;AAMA9pC,WAAWU,QAAX,CAAoBiB,MAApB,CAA2B,eAA3B,EAA4C,YAAW;AACtD,QAAOmoC,cAAP;AACA,CAFD;AAIA9pC,WAAWU,QAAX,CAAoBiB,MAApB,CAA2B,WAA3B,EAAwC,YAAW;AAClD,QAAOmoC,cAAP;AACA,CAFD;AAIA5oC,OAAOsK,OAAP,CAAe,YAAW;AACzB,QAAOs+B,cAAP;AACA,CAFD,2H;;;;;;;;;;;ACpDA,yBACA,IAAMj9B,SAAS,IAAIC,MAAJ,CAAW,gBAAX,EAA6B;AAC3CnD,UAAS;AACRsgC,iBAAe;AACd5jC,SAAM;AADQ;AADP;AADkC,CAA7B,CAAf;;AAQA,SAAS6jC,oBAAT,GAAgC;AAC/B,KAAMrpB,WAAW7gB,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uDAAxB,CAAjB;AACAkgB,UAAS/e,OAAT,CAAiB,UAAC6mB,OAAD,EAAa;AAC7B9b,SAAOo9B,aAAP,CAAqBthB,QAAQ3mB,GAA7B;AACA,MAAIu7B,cAAc5U,QAAQ3mB,GAAR,CAAY4E,OAAZ,CAAoB,iBAApB,EAAuC,EAAvC,CAAlB;;AACA,MAAI22B,gBAAgB,QAApB,EAA8B;AAC7BA,iBAAc,kBAAd;AACA;;AACD,MAAI,yBAAyBr7B,IAAzB,CAA8BymB,QAAQ3mB,GAAtC,CAAJ,EAAgD;AAC/Cu7B,iBAAc5U,QAAQ3mB,GAAR,CAAY4E,OAAZ,CAAoB,wBAApB,EAA8C,EAA9C,CAAd;AACA;;AACD,MAAI+hB,QAAQ5mB,KAAR,KAAkB,IAAtB,EAA4B;AAC3B,OAAMgF,OAAO;AACZojC,cAAUnqC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,SADE;AAEZooC,YAAQpqC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC;AAFI,IAAb;;AAIA,OAAI,yBAAyBE,IAAzB,CAA8BymB,QAAQ3mB,GAAtC,CAAJ,EAAgD;AAC/C+E,SAAKsjC,MAAL,GAAc,IAAd;AACAtjC,SAAKojC,QAAL,GAAgBnqC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,SAAhB;AACA+E,SAAKqjC,MAAL,GAAcpqC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,aAAd;AACA+E,SAAKujC,SAAL,GAAiBtqC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,UAAjB;AACA+E,SAAKwjC,SAAL,GAAiBvqC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,iBAAjB;AACA+E,SAAKyjC,YAAL,GAAoBxqC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,oBAApB;AACA+E,SAAK0jC,aAAL,GAAqBzqC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,qBAArB;AACA+E,SAAKqO,KAAL,GAAapV,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,YAAb;AACA+E,SAAK2jC,eAAL,GAAuB1qC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,wBAAvB;AACA+E,SAAK4jC,gBAAL,GAAwB3qC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,yBAAxB;AACA+E,SAAK6jC,UAAL,GAAkB5qC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,kBAAlB;AACA+E,SAAK8jC,WAAL,GAAmB7qC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,mBAAnB;AACA+E,SAAK+jC,YAAL,GAAoB9qC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,qBAApB;AACA+E,SAAKgkC,aAAL,GAAqB/qC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,qBAArB;AACA+E,SAAKikC,UAAL,GAAkBhrC,WAAWU,QAAX,CAAoBC,GAApB,CAA4BgoB,QAAQ3mB,GAApC,kBAAlB;AACA,QAAIipC,WAAJ,CAAgB1N,YAAY1W,WAAZ,EAAhB,EAA2C;AAC1CyjB,gBAAWvjC,KAAKujC,SAD0B;AAE1CC,gBAAWxjC,KAAKwjC,SAF0B;AAG1CC,mBAAczjC,KAAKyjC,YAHuB;AAI1CC,oBAAe1jC,KAAK0jC,aAJsB;AAK1Cr1B,YAAOrO,KAAKqO,KAL8B;AAM1Cw1B,iBAAY7jC,KAAK6jC,UANyB;AAO1CE,mBAAc/jC,KAAK+jC,YAPuB;AAQ1CC,oBAAehkC,KAAKgkC,aARsB;AAS1CC,iBAAYjkC,KAAKikC;AATyB,KAA3C;AAWA;;AACD,OAAIzN,gBAAgB,UAApB,EAAgC;AAC/Bx2B,SAAKmkC,KAAL,GAAankC,KAAKojC,QAAlB;AACA,WAAOpjC,KAAKojC,QAAZ;AACA;;AACD,OAAI5M,gBAAgB,SAApB,EAA+B;AAC9Bx2B,SAAKokC,WAAL,GAAmBpkC,KAAKojC,QAAxB;AACA,WAAOpjC,KAAKojC,QAAZ;AACA;;AACD5C,wBAAqBC,cAArB,CAAoC3iB,MAApC,CAA2C;AAC1C8D,aAAS4U,YAAY1W,WAAZ;AADiC,IAA3C,EAEG;AACF1H,UAAMpY;AADJ,IAFH;AAKA,GA9CD,MA8CO;AACNwgC,wBAAqBC,cAArB,CAAoC5iC,MAApC,CAA2C;AAC1C+jB,aAAS4U,YAAY1W,WAAZ;AADiC,IAA3C;AAGA;AACD,EA5DD;AA6DA;;AAED,IAAMukB,sBAAsB7qC,EAAEwpC,QAAF,CAAW7oC,OAAOyN,eAAP,CAAuBu7B,oBAAvB,CAAX,EAAyD,IAAzD,CAA5B;;AAEA,SAASmB,mBAAT,CAA6B5pC,GAA7B,EAAkC;AACjC,KAAM87B,cAAc97B,IAAImF,OAAJ,CAAY,wBAAZ,EAAsC,EAAtC,CAApB;;AACA,QAAO2gC,qBAAqBC,cAArB,CAAoC5iC,MAApC,CAA2C;AACjD+jB,WAAS4U,YAAY1W,WAAZ;AADwC,EAA3C,CAAP;AAGA;;AAED7mB,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,oBAAxB,EAA8C,YAAW;AACxD,QAAOyqC,qBAAP,CADwD,CAC1B;AAC9B,CAFD;AAIAprC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,mCAAxB,EAA6D,UAASqB,GAAT,EAAcD,KAAd,EAAqB;AACjF,KAAI,CAACA,KAAL,EAAY;AACX,SAAOspC,oBAAoBrpC,GAApB,CAAP,CADW,CACqB;AAChC;AACD,CAJD,2H;;;;;;;;;;;ACvFA;AACAhC,WAAWU,QAAX,CAAoByD,GAApB,CAAwB,UAAxB,EAAoCoI,QAAQC,GAAR,CAAY8+B,aAAZ,IAA6B/mC,OAAOF,EAAP,EAAjE,EAA8E;AAC7E,WAAU,IADmE;AAE7EkiB,SAAQ;AAFqE,CAA9E,E,CAKA;AACA;;AAEAvmB,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,UAA7B,EAAyC,YAAW;AACnD,MAAKtjB,GAAL,CAAS,6BAAT,EAAwC,KAAxC,EAA+C;AAC9CkC,QAAM,SADwC;AAE9C,YAAQ;AAFsC,EAA/C;AAIA,MAAKlC,GAAL,CAAS,8BAAT,EAAyC,KAAzC,EAAgD;AAC/CkC,QAAM,SADyC;AAE/C,YAAQ,IAFuC;AAG/CqgB,eAAa;AACZjlB,QAAK,6BADO;AAEZM,UAAO;AAFK;AAHkC,EAAhD;AAQA,MAAKoC,GAAL,CAAS,gCAAT,EAA2C,KAA3C,EAAkD;AACjDkC,QAAM,SAD2C;AAEjD,YAAU,IAFuC;AAGjDqgB,eAAa;AACZjlB,QAAK,iCADO;AAEZM,UAAO;AAFK;AAHoC,EAAlD;AAQA,MAAKoC,GAAL,CAAS,iCAAT,EAA4C,IAA5C,EAAkD;AACjDkC,QAAM,SAD2C;AAEjD,YAAU;AAFuC,EAAlD;AAIA,MAAKlC,GAAL,CAAS,gCAAT,EAA2C,IAA3C,EAAiD;AAChDkC,QAAM,SAD0C;AAEhD,YAAU;AAFsC,EAAjD;AAIA,MAAKlC,GAAL,CAAS,8BAAT,EAAyC,IAAzC,EAA+C;AAC9CkC,QAAM,SADwC;AAE9C,YAAU;AAFoC,EAA/C;AAIA,MAAKlC,GAAL,CAAS,2BAAT,EAAsC,IAAtC,EAA4C;AAC3CkC,QAAM,SADqC;AAE3C,YAAU;AAFiC,EAA5C;AAIA,MAAKlC,GAAL,CAAS,8BAAT,EAAyC,IAAzC,EAA+C;AAC9CkC,QAAM,SADwC;AAE9C,YAAU;AAFoC,EAA/C;AAIA,MAAKlC,GAAL,CAAS,0BAAT,EAAqC,EAArC,EAAyC;AACxCkC,QAAM,KADkC;AAExC,YAAU;AAF8B,EAAzC;AAIA,MAAKlC,GAAL,CAAS,wBAAT,EAAmC,IAAnC,EAAyC;AACxCkC,QAAM,SADkC;AAExC,YAAU;AAF8B,EAAzC;AAIA,MAAKlC,GAAL,CAAS,qCAAT,EAAgD,EAAhD,EAAoD;AACnDkC,QAAM,QAD6C;AAEnD,YAAU,IAFyC;AAGnD2gB,aAAW;AAHwC,EAApD;AAKA,MAAK7iB,GAAL,CAAS,8BAAT,EAAyC,EAAzC,EAA6C;AAC5CkC,QAAM,QADsC;AAE5C,YAAU,IAFkC;AAG5C2gB,aAAW;AAHiC,EAA7C;AAKA,MAAK7iB,GAAL,CAAS,yCAAT,EAAoD,KAApD,EAA2D;AAC1DkC,QAAM,SADoD;AAE1D,YAAU;AAFgD,EAA3D;AAKA,MAAK+gB,OAAL,CAAa,cAAb,EAA6B,YAAW;AACvC,OAAKjjB,GAAL,CAAS,0CAAT,EAAqD,MAArD,EAA6D;AAC5DkC,SAAM;AADsD,GAA7D;AAGA,OAAKlC,GAAL,CAAS,+BAAT,EAA0C,IAA1C,EAAgD;AAC/CkC,SAAM,SADyC;AAE/C,aAAU;AAFqC,GAAhD;AAIA,OAAKlC,GAAL,CAAS,sCAAT,EAAiD,IAAjD,EAAuD;AACtDkC,SAAM,SADgD;AAEtD,aAAU;AAF4C,GAAvD;AAIA,OAAKlC,GAAL,CAAS,4BAAT,EAAuC,KAAvC,EAA8C;AAC7CkC,SAAM,SADuC;AAE7C,aAAU,IAFmC;AAG7CqgB,gBAAa;AACZjlB,SAAK,WADO;AAEZM,WAAO;AACNulB,cAAS,CADH;AAENvN,UAAK;AAFC;AAFK;AAHgC,GAA9C;AAWA,OAAK5V,GAAL,CAAS,kCAAT,EAA6C,KAA7C,EAAoD;AACnDkC,SAAM;AAD6C,GAApD;AAGA,OAAKlC,GAAL,CAAS,6BAAT,EAAwC,EAAxC,EAA4C;AAC3CkC,SAAM,QADqC;AAE3C,aAAU;AAFiC,GAA5C;AAIA,OAAKlC,GAAL,CAAS,6BAAT,EAAwC,EAAxC,EAA4C;AAC3CkC,SAAM;AADqC,GAA5C;AAGA,OAAKlC,GAAL,CAAS,8BAAT,EAAyC,EAAzC,EAA6C;AAC5CkC,SAAM;AADsC,GAA7C;AAGA,OAAKlC,GAAL,CAAS,uCAAT,EAAkD,IAAlD,EAAwD;AACvDkC,SAAM;AADiD,GAAxD;AAGA,OAAKlC,GAAL,CAAS,4BAAT,EAAuC,KAAvC,EAA8C;AAC7CkC,SAAM;AADuC,GAA9C;AAGA,OAAKlC,GAAL,CAAS,2BAAT,EAAsC,QAAtC,EAAgD;AAC/CkC,SAAM,QADyC;AAE/C,aAAU,IAFqC;AAG/Cu3B,WAAQ,CACP;AACC57B,SAAK,QADN;AAECglB,eAAW;AAFZ,IADO,EAIJ;AACFhlB,SAAK,UADH;AAEFglB,eAAW;AAFT,IAJI,EAOJ;AACFhlB,SAAK,YADH;AAEFglB,eAAW;AAFT,IAPI;AAHuC,GAAhD;AAgBA,OAAK7iB,GAAL,CAAS,qCAAT,EAAgDI,OAAOF,EAAP,EAAhD,EAA6D;AAC5DgC,SAAM;AADsD,GAA7D;AAGA,OAAKlC,GAAL,CAAS,+CAAT,EAA0D,6CAA1D,EAAyG;AACxGkC,SAAM,QADkG;AAExG,aAAU;AAF8F,GAAzG;AAIA,OAAKlC,GAAL,CAAS,sDAAT,EAAiE,IAAjE,EAAuE;AACtEkC,SAAM,SADgE;AAEtE,aAAU;AAF4D,GAAvE;AAIA,OAAKlC,GAAL,CAAS,4DAAT,EAAuE,MAAvE,EAA+E;AAC9EkC,SAAM,QADwE;AAE9EqgB,gBAAa;AACZjlB,SAAK,sDADO;AAEZM,WAAO;AAFK;AAFiE,GAA/E;AAOA,OAAKoC,GAAL,CAAS,wBAAT,EAAmC,IAAnC,EAAyC;AACxCkC,SAAM,SADkC;AAExC,aAAU;AAF8B,GAAzC;AAIA,OAAKlC,GAAL,CAAS,uBAAT,EAAkC,EAAlC,EAAsC;AACrCkC,SAAM,MAD+B;AAErC,aAAU,IAF2B;AAGrC2gB,cAAW;AAH0B,GAAtC;AAKA,EArFD;AAuFA,MAAKI,OAAL,CAAa,QAAb,EAAuB,YAAW;AACjC,OAAKjjB,GAAL,CAAS,uBAAT,EAAkC,IAAlC,EAAwC;AACvCkC,SAAM;AADiC,GAAxC;AAGA,OAAKlC,GAAL,CAAS,qBAAT,EAAgC,GAAhC,EAAqC;AACpCkC,SAAM,KAD8B;AAEpCqgB,gBAAa;AACZjlB,SAAK,uBADO;AAEZM,WAAO;AAFK;AAFuB,GAArC;AAOA,OAAKoC,GAAL,CAAS,0BAAT,EAAqC,QAArC,EAA+C;AAC9CkC,SAAM,QADwC;AAE9Cu3B,WAAQ,CACP;AACC57B,SAAK,QADN;AAECglB,eAAW;AAFZ,IADO,EAIJ;AACFhlB,SAAK,YADH;AAEFglB,eAAW;AAFT,IAJI;AAFsC,GAA/C;AAYA,OAAK7iB,GAAL,CAAS,0BAAT,EAAqC,EAArC,EAAyC;AACxCkC,SAAM,QADkC;AAExCqgB,gBAAa;AACZjlB,SAAK,0BADO;AAEZM,WAAO;AAFK;AAF2B,GAAzC;AAOA,SAAO,KAAKoC,GAAL,CAAS,2BAAT,EAAsC,IAAtC,EAA4C;AAClDkC,SAAM;AAD4C,GAA5C,CAAP;AAGA,EAjCD;AAkCA,CAzLD;AA2LArG,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,OAA7B,EAAsC,YAAW;AAChD,MAAKL,OAAL,CAAa,UAAb,EAAyB,YAAW;AACnC,MAAMV,cAAc;AACnBjlB,QAAK,yBADc;AAEnBM,UAAO;AAFY,GAApB;AAIA,OAAKoC,GAAL,CAAS,yBAAT,EAAoC,KAApC,EAA2C;AAC1CkC,SAAM,SADoC;AAE1C,aAAU;AAFgC,GAA3C;AAIA,OAAKlC,GAAL,CAAS,4BAAT,EAAuC,EAAvC,EAA2C;AAC1CkC,SAAM,QADoC;AAE1CqgB;AAF0C,GAA3C;AAIA,OAAKviB,GAAL,CAAS,gCAAT,EAA2C,EAA3C,EAA+C;AAC9CkC,SAAM,QADwC;AAE9CqgB;AAF8C,GAA/C;AAIA,SAAO,KAAKviB,GAAL,CAAS,sCAAT,EAAiD,iBAAjD,EAAoE;AAC1EkC,SAAM,aADoE;AAE1EklC,aAAU,IAFgE;AAG1EpkB,UAAO,IAHmE;AAI1ET;AAJ0E,GAApE,CAAP;AAMA,EAvBD;AAwBA,MAAKU,OAAL,CAAa,QAAb,EAAuB,YAAW;AACjC,MAAMV,cAAc;AACnBjlB,QAAK,uBADc;AAEnBM,UAAO;AAFY,GAApB;AAIA,OAAKoC,GAAL,CAAS,uBAAT,EAAkC,KAAlC,EAAyC;AACxCkC,SAAM,SADkC;AAExC,aAAU;AAF8B,GAAzC;AAIA,OAAKlC,GAAL,CAAS,0BAAT,EAAqC,EAArC,EAAyC;AACxCkC,SAAM,QADkC;AAExCqgB;AAFwC,GAAzC;AAIA,OAAKviB,GAAL,CAAS,8BAAT,EAAyC,EAAzC,EAA6C;AAC5CkC,SAAM,QADsC;AAE5CqgB;AAF4C,GAA7C;AAIA,SAAO,KAAKviB,GAAL,CAAS,oCAAT,EAA+C,eAA/C,EAAgE;AACtEkC,SAAM,aADgE;AAEtEklC,aAAU,IAF4D;AAGtEpkB,UAAO,IAH+D;AAItET;AAJsE,GAAhE,CAAP;AAMA,EAvBD;AAwBA,MAAKU,OAAL,CAAa,QAAb,EAAuB,YAAW;AACjC,MAAMV,cAAc;AACnBjlB,QAAK,uBADc;AAEnBM,UAAO;AAFY,GAApB;AAIA,OAAKoC,GAAL,CAAS,uBAAT,EAAkC,KAAlC,EAAyC;AACxCkC,SAAM,SADkC;AAExC,aAAU;AAF8B,GAAzC;AAIA,OAAKlC,GAAL,CAAS,0BAAT,EAAqC,EAArC,EAAyC;AACxCkC,SAAM,QADkC;AAExCqgB;AAFwC,GAAzC;AAIA,OAAKviB,GAAL,CAAS,8BAAT,EAAyC,EAAzC,EAA6C;AAC5CkC,SAAM,QADsC;AAE5CqgB;AAF4C,GAA7C;AAIA,SAAO,KAAKviB,GAAL,CAAS,oCAAT,EAA+C,eAA/C,EAAgE;AACtEkC,SAAM,aADgE;AAEtEklC,aAAU,IAF4D;AAGtEpkB,UAAO,IAH+D;AAItET;AAJsE,GAAhE,CAAP;AAMA,EAvBD;AAwBA,MAAKU,OAAL,CAAa,UAAb,EAAyB,YAAW;AACnC,MAAMV,cAAc;AACnBjlB,QAAK,yBADc;AAEnBM,UAAO;AAFY,GAApB;AAIA,OAAKoC,GAAL,CAAS,yBAAT,EAAoC,KAApC,EAA2C;AAC1CkC,SAAM,SADoC;AAE1C,aAAU;AAFgC,GAA3C;AAIA,OAAKlC,GAAL,CAAS,4BAAT,EAAuC,EAAvC,EAA2C;AAC1CkC,SAAM,QADoC;AAE1CqgB;AAF0C,GAA3C;AAIA,OAAKviB,GAAL,CAAS,gCAAT,EAA2C,EAA3C,EAA+C;AAC9CkC,SAAM,QADwC;AAE9CqgB;AAF8C,GAA/C;AAIA,SAAO,KAAKviB,GAAL,CAAS,sCAAT,EAAiD,iBAAjD,EAAoE;AAC1EkC,SAAM,aADoE;AAE1EklC,aAAU,IAFgE;AAG1EpkB,UAAO,IAHmE;AAI1ET;AAJ0E,GAApE,CAAP;AAMA,EAvBD;AAwBA,MAAKU,OAAL,CAAa,QAAb,EAAuB,YAAW;AACjC,MAAMV,cAAc;AACnBjlB,QAAK,uBADc;AAEnBM,UAAO;AAFY,GAApB;AAIA,OAAKoC,GAAL,CAAS,uBAAT,EAAkC,KAAlC,EAAyC;AACxCkC,SAAM,SADkC;AAExC,aAAU;AAF8B,GAAzC;AAIA,OAAKlC,GAAL,CAAS,0BAAT,EAAqC,EAArC,EAAyC;AACxCkC,SAAM,QADkC;AAExCqgB;AAFwC,GAAzC;AAIA,OAAKviB,GAAL,CAAS,8BAAT,EAAyC,EAAzC,EAA6C;AAC5CkC,SAAM,QADsC;AAE5CqgB;AAF4C,GAA7C;AAIA,SAAO,KAAKviB,GAAL,CAAS,oCAAT,EAA+C,eAA/C,EAAgE;AACtEkC,SAAM,aADgE;AAEtEklC,aAAU,IAF4D;AAGtEpkB,UAAO,IAH+D;AAItET;AAJsE,GAAhE,CAAP;AAMA,EAvBD;AAwBA,MAAKU,OAAL,CAAa,SAAb,EAAwB,YAAW;AAClC,MAAMV,cAAc;AACnBjlB,QAAK,wBADc;AAEnBM,UAAO;AAFY,GAApB;AAIA,OAAKoC,GAAL,CAAS,wBAAT,EAAmC,KAAnC,EAA0C;AACzCkC,SAAM,SADmC;AAEzC,aAAU;AAF+B,GAA1C;AAIA,OAAKlC,GAAL,CAAS,2BAAT,EAAsC,EAAtC,EAA0C;AACzCkC,SAAM,QADmC;AAEzCqgB;AAFyC,GAA1C;AAIA,OAAKviB,GAAL,CAAS,+BAAT,EAA0C,EAA1C,EAA8C;AAC7CkC,SAAM,QADuC;AAE7CqgB;AAF6C,GAA9C;AAIA,SAAO,KAAKviB,GAAL,CAAS,qCAAT,EAAgD,gBAAhD,EAAkE;AACxEkC,SAAM,aADkE;AAExEklC,aAAU,IAF8D;AAGxEpkB,UAAO,IAHiE;AAIxET;AAJwE,GAAlE,CAAP;AAMA,EAvBD;AAwBA,QAAO,KAAKU,OAAL,CAAa,OAAb,EAAsB,YAAW;AACvC,OAAKjjB,GAAL,CAAS,2BAAT,EAAsC,iCAAtC,EAAyE;AACxEkC,SAAM,QADkE;AAExE,aAAU;AAF8D,GAAzE;AAIA,SAAO,KAAKlC,GAAL,CAAS,+BAAT,EAA0C,EAA1C,EAA8C;AACpDkC,SAAM,QAD8C;AAEpD,aAAU;AAF0C,GAA9C,CAAP;AAIA,EATM,CAAP;AAUA,CA3JD;AA6JArG,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,SAA7B,EAAwC,YAAW;AAClD,MAAKtjB,GAAL,CAAS,UAAT,EAAqB,OAAOtD,yBAAP,KAAqC,WAArC,IAAoDA,8BAA8B,IAAlF,GAAyFA,0BAA0BsL,QAAnH,GAA8H,IAAnJ,EAAyJ;AACxJ9F,QAAM,QADkJ;AAExJ4gB,mBAAiB,sBAFuI;AAGxJ,YAAU;AAH8I,EAAzJ;AAKA,MAAK9iB,GAAL,CAAS,WAAT,EAAsB,aAAtB,EAAqC;AACpCkC,QAAM,QAD8B;AAEpC,YAAU;AAF0B,EAArC;AAIA,MAAKlC,GAAL,CAAS,UAAT,EAAqB,EAArB,EAAyB;AACxBkC,QAAM,UADkB;AAExB,YAAU;AAFc,EAAzB;AAIA,MAAKlC,GAAL,CAAS,gCAAT,EAA2C,KAA3C,EAAkD;AACjDkC,QAAM;AAD2C,EAAlD;AAGA,MAAKlC,GAAL,CAAS,gBAAT,EAA2B,IAA3B,EAAiC;AAChCkC,QAAM,SAD0B;AAEhC,YAAU;AAFsB,EAAjC;AAIA,MAAKlC,GAAL,CAAS,YAAT,EAAuB,EAAvB,EAA2B;AAC1BkC,QAAM,QADoB;AAE1B,YAAU;AAFgB,EAA3B;AAIA,MAAKlC,GAAL,CAAS,WAAT,EAAsB,KAAtB,EAA6B;AAC5BkC,QAAM,SADsB;AAE5B,YAAU;AAFkB,EAA7B;AAIA,MAAKlC,GAAL,CAAS,qBAAT,EAAgC,EAAhC,EAAoC;AACnCkC,QAAM,QAD6B;AAEnC,YAAU;AAFyB,EAApC;AAIA,MAAKlC,GAAL,CAAS,iBAAT,EAA4B,EAA5B,EAAgC;AAC/BkC,QAAM,QADyB;AAE/B,YAAU;AAFqB,EAAhC;AAIA,MAAKlC,GAAL,CAAS,+BAAT,EAA0C,KAA1C,EAAiD;AAChDkC,QAAM,SAD0C;AAEhD,YAAU;AAFsC,EAAjD;AAIA,MAAKlC,GAAL,CAAS,SAAT,EAAoB,gBAApB,EAAsC;AACrCkC,QAAM,QAD+B;AAErCmlC,cAAY;AAFyB,EAAtC;AAIA,MAAKpkB,OAAL,CAAa,MAAb,EAAqB,YAAW;AAC/B,OAAKjjB,GAAL,CAAS,uBAAT,EAAkC,iBAAlC,EAAqD;AACpDkC,SAAM,QAD8C;AAEpD,aAAU,IAF0C;AAGpD4gB,oBAAiB;AAHmC,GAArD;AAKA,SAAO,KAAK9iB,GAAL,CAAS,oBAAT,EAA+B,IAA/B,EAAqC;AAC3CkC,SAAM,SADqC;AAE3C,aAAU;AAFiC,GAArC,CAAP;AAIA,EAVD;AAWA,MAAK+gB,OAAL,CAAa,WAAb,EAA0B,YAAW;AACpC,SAAO,KAAKjjB,GAAL,CAAS,sBAAT,EAAiC,IAAjC,EAAuC;AAC7CkC,SAAM;AADuC,GAAvC,CAAP;AAGA,EAJD;AAKA,MAAK+gB,OAAL,CAAa,eAAb,EAA8B,YAAW;AACxC,SAAO,KAAKjjB,GAAL,CAAS,gCAAT,EAA2C,CAA3C,EAA8C;AACpDkC,SAAM,KAD8C;AAEpD,aAAU,IAF0C;AAGpD4gB,oBAAiB;AAHmC,GAA9C,CAAP;AAKA,EAND;AAOA,MAAKG,OAAL,CAAa,UAAb,EAAyB,YAAW;AACnC,SAAO,KAAKjjB,GAAL,CAAS,gBAAT,EAA2B,GAA3B,EAAgC;AACtCkC,SAAM,KADgC;AAEtC,aAAU,IAF4B;AAGtC4gB,oBAAiB;AAHqB,GAAhC,CAAP;AAKA,EAND;AAOA,MAAKG,OAAL,CAAa,oBAAb,EAAmC,YAAW;AAC7C,OAAKjjB,GAAL,CAAS,gCAAT,EAA2C,KAA3C,EAAkD;AACjDkC,SAAM,SAD2C;AAEjD,aAAU;AAFuC,GAAlD;AAIA,OAAKlC,GAAL,CAAS,uCAAT,EAAkD,GAAlD,EAAuD;AACtDkC,SAAM,QADgD;AAEtD,aAAU,IAF4C;AAGtDqgB,gBAAa;AACZjlB,SAAK,gCADO;AAEZM,WAAO;AAFK;AAHyC,GAAvD;AAQA,OAAKoC,GAAL,CAAS,mCAAT,EAA8C,KAA9C,EAAqD;AACpDkC,SAAM,SAD8C;AAEpD,aAAU;AAF0C,GAArD;AAIA,SAAO,KAAKlC,GAAL,CAAS,mCAAT,EAA8C,GAA9C,EAAmD;AACzDkC,SAAM,QADmD;AAEzD,aAAU,IAF+C;AAGzDqgB,gBAAa;AACZjlB,SAAK,mCADO;AAEZM,WAAO;AAFK;AAH4C,GAAnD,CAAP;AAQA,EAzBD;AA0BA,MAAKqlB,OAAL,CAAa,cAAb,EAA6B,YAAW;AACvC,SAAO,KAAKjjB,GAAL,CAAS,qBAAT,EAAgC,EAAhC,EAAoC;AAC1CkC,SAAM,MADoC;AAE1C,aAAU;AAFgC,GAApC,CAAP;AAIA,EALD;AAMA,QAAO,KAAK+gB,OAAL,CAAa,aAAb,EAA4B,YAAW;AAC7C,SAAO,KAAKjjB,GAAL,CAAS,qBAAT,EAAgC,EAAhC,EAAoC;AAC1CkC,SAAM;AADoC,GAApC,CAAP;AAGA,EAJM,CAAP;AAKA,CAhHD;AAkHArG,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,OAA7B,EAAsC,YAAW;AAChD,MAAKL,OAAL,CAAa,mBAAb,EAAkC,YAAW;AAC5C,OAAKjjB,GAAL,CAAS,cAAT,EAAyB,81BAAzB,EAAy3B;AACx3BkC,SAAM,MADk3B;AAEx3BolC,SAAM,WAFk3B;AAGx3BC,cAAW,IAH62B;AAIx3B1kB,cAAW;AAJ62B,GAAz3B;AAMA,SAAO,KAAK7iB,GAAL,CAAS,cAAT,EAAyB,8VAAzB,EAAyX;AAC/XkC,SAAM,MADyX;AAE/XolC,SAAM,WAFyX;AAG/XC,cAAW,IAHoX;AAI/X1kB,cAAW;AAJoX,GAAzX,CAAP;AAMA,EAbD;AAcA,MAAKI,OAAL,CAAa,MAAb,EAAqB,YAAW;AAC/B,OAAKjjB,GAAL,CAAS,eAAT,EAA0B,MAA1B,EAAkC;AACjCkC,SAAM,QAD2B;AAEjCu3B,WAAQ,CACP;AACC57B,SAAK,MADN;AAECglB,eAAW;AAFZ,IADO,EAIJ;AACFhlB,SAAK,OADH;AAEFglB,eAAW;AAFT,IAJI,CAFyB;AAWjCxa,QAAK,IAX4B;AAYjCwa,cAAW;AAZsB,GAAlC;AAcA,OAAK7iB,GAAL,CAAS,WAAT,EAAsB,EAAtB,EAA0B;AACzBkC,SAAM,QADmB;AAEzBmG,QAAK,IAFoB;AAGzBwa,cAAW;AAHc,GAA1B;AAKA,OAAK7iB,GAAL,CAAS,WAAT,EAAsB,EAAtB,EAA0B;AACzBkC,SAAM,QADmB;AAEzBmG,QAAK,IAFoB;AAGzBwa,cAAW;AAHc,GAA1B;AAKA,OAAK7iB,GAAL,CAAS,WAAT,EAAsB,IAAtB,EAA4B;AAC3BkC,SAAM,SADqB;AAE3BmG,QAAK,IAFsB;AAG3Bwa,cAAW;AAHgB,GAA5B;AAKA,OAAK7iB,GAAL,CAAS,eAAT,EAA0B,EAA1B,EAA8B;AAC7BkC,SAAM,QADuB;AAE7BmG,QAAK,IAFwB;AAG7Bwa,cAAW;AAHkB,GAA9B;AAKA,OAAK7iB,GAAL,CAAS,eAAT,EAA0B,EAA1B,EAA8B;AAC7BkC,SAAM,UADuB;AAE7BmG,QAAK,IAFwB;AAG7Bwa,cAAW;AAHkB,GAA9B;AAKA,OAAK7iB,GAAL,CAAS,YAAT,EAAuB,EAAvB,EAA2B;AAC1BkC,SAAM,QADoB;AAE1BslC,gBAAa;AAFa,GAA3B;AAIA,SAAO,KAAKxnC,GAAL,CAAS,kBAAT,EAA6B,mBAA7B,EAAkD;AACxDkC,SAAM,QADkD;AAExDmlC,eAAY;AAF4C,GAAlD,CAAP;AAIA,EAhDD;AAiDA,MAAKpkB,OAAL,CAAa,YAAb,EAA2B,YAAW;AACrC,OAAKjjB,GAAL,CAAS,uBAAT,EAAkC,KAAlC,EAAyC;AACxCkC,SAAM,SADkC;AAExC2gB,cAAW;AAF6B,GAAzC;AAIA,OAAK7iB,GAAL,CAAS,oBAAT,EAA+B,EAA/B,EAAmC;AAClCkC,SAAM,QAD4B;AAElC2gB,cAAW,SAFuB;AAGlCN,gBAAa;AACZjlB,SAAK,uBADO;AAEZM,WAAO;AAFK,IAHqB;AAOlC6kB,qBAAkB;AACjBnlB,SAAK,uBADY;AAEjBM,WAAO;AAFU;AAPgB,GAAnC;AAYA,SAAO,KAAKoC,GAAL,CAAS,iBAAT,EAA4B,EAA5B,EAAgC;AACtCkC,SAAM,MADgC;AAEtColC,SAAM,WAFgC;AAGtCC,cAAW,IAH2B;AAItC1kB,cAAW,MAJ2B;AAKtCC,oBAAiB,6BALqB;AAMtCP,gBAAa;AACZjlB,SAAK,uBADO;AAEZM,WAAO;AAFK,IANyB;AAUtC6kB,qBAAkB;AACjBnlB,SAAK,uBADY;AAEjBM,WAAO;AAFU;AAVoB,GAAhC,CAAP;AAeA,EAhCD;AAiCA,MAAKqlB,OAAL,CAAa,cAAb,EAA6B,YAAW;AACvC,OAAKjjB,GAAL,CAAS,gCAAT,EAA2C,KAA3C,EAAkD;AACjDkC,SAAM,SAD2C;AAEjD2gB,cAAW;AAFsC,GAAlD;AAIA,OAAK7iB,GAAL,CAAS,mCAAT,EAA8C,EAA9C,EAAkD;AACjDkC,SAAM,QAD2C;AAEjD2gB,cAAW,SAFsC;AAGjDN,gBAAa;AACZjlB,SAAK,gCADO;AAEZM,WAAO;AAFK,IAHoC;AAOjD6kB,qBAAkB;AACjBnlB,SAAK,gCADY;AAEjBM,WAAO;AAFU;AAP+B,GAAlD;AAYA,SAAO,KAAKoC,GAAL,CAAS,2BAAT,EAAsC,EAAtC,EAA0C;AAChDkC,SAAM,MAD0C;AAEhDolC,SAAM,WAF0C;AAGhDC,cAAW,IAHqC;AAIhD1kB,cAAW,MAJqC;AAKhDN,gBAAa;AACZjlB,SAAK,gCADO;AAEZM,WAAO;AAFK,IALmC;AAShD6kB,qBAAkB;AACjBnlB,SAAK,gCADY;AAEjBM,WAAO;AAFU;AAT8B,GAA1C,CAAP;AAcA,EA/BD;AAgCA,MAAKqlB,OAAL,CAAa,wBAAb,EAAuC,YAAW;AACjD,OAAKjjB,GAAL,CAAS,oCAAT,EAA+C,KAA/C,EAAsD;AACrDkC,SAAM,SAD+C;AAErD2gB,cAAW;AAF0C,GAAtD;AAIA,OAAK7iB,GAAL,CAAS,gCAAT,EAA2C,EAA3C,EAA+C;AAC9CkC,SAAM,QADwC;AAE9C2gB,cAAW,SAFmC;AAG9CN,gBAAa;AACZjlB,SAAK,oCADO;AAEZM,WAAO;AAFK,IAHiC;AAO9C6kB,qBAAkB;AACjBnlB,SAAK,oCADY;AAEjBM,WAAO;AAFU;AAP4B,GAA/C;AAYA,SAAO,KAAKoC,GAAL,CAAS,yBAAT,EAAoC,EAApC,EAAwC;AAC9CkC,SAAM,MADwC;AAE9ColC,SAAM,WAFwC;AAG9CC,cAAW,IAHmC;AAI9C1kB,cAAW,MAJmC;AAK9CC,oBAAiB,qCAL6B;AAM9CP,gBAAa;AACZjlB,SAAK,oCADO;AAEZM,WAAO;AAFK,IANiC;AAU9C6kB,qBAAkB;AACjBnlB,SAAK,oCADY;AAEjBM,WAAO;AAFU;AAV4B,GAAxC,CAAP;AAeA,EAhCD;AAiCA,MAAKqlB,OAAL,CAAa,yBAAb,EAAwC,YAAW;AAClD,OAAKjjB,GAAL,CAAS,4BAAT,EAAuC,KAAvC,EAA8C;AAC7CkC,SAAM,SADuC;AAE7C2gB,cAAW;AAFkC,GAA9C;AAIA,OAAK7iB,GAAL,CAAS,+BAAT,EAA0C,EAA1C,EAA8C;AAC7CkC,SAAM,QADuC;AAE7C2gB,cAAW,SAFkC;AAG7CN,gBAAa;AACZjlB,SAAK,4BADO;AAEZM,WAAO;AAFK,IAHgC;AAO7C6kB,qBAAkB;AACjBnlB,SAAK,4BADY;AAEjBM,WAAO;AAFU;AAP2B,GAA9C;AAYA,SAAO,KAAKoC,GAAL,CAAS,uBAAT,EAAkC,EAAlC,EAAsC;AAC5CkC,SAAM,MADsC;AAE5ColC,SAAM,WAFsC;AAG5CC,cAAW,IAHiC;AAI5C1kB,cAAW,MAJiC;AAK5CC,oBAAiB,6BAL2B;AAM5CP,gBAAa;AACZjlB,SAAK,4BADO;AAEZM,WAAO;AAFK,IAN+B;AAU5C6kB,qBAAkB;AACjBnlB,SAAK,4BADY;AAEjBM,WAAO;AAFU;AAV0B,GAAtC,CAAP;AAeA,EAhCD;AAiCA,QAAO,KAAKqlB,OAAL,CAAa,cAAb,EAA6B,YAAW;AAC9C,OAAKjjB,GAAL,CAAS,yBAAT,EAAoC,KAApC,EAA2C;AAC1CkC,SAAM,SADoC;AAE1C2gB,cAAW;AAF+B,GAA3C;AAIA,OAAK7iB,GAAL,CAAS,4BAAT,EAAuC,EAAvC,EAA2C;AAC1CkC,SAAM,QADoC;AAE1C2gB,cAAW,SAF+B;AAG1CN,gBAAa;AACZjlB,SAAK,yBADO;AAEZM,WAAO;AAFK,IAH6B;AAO1C6kB,qBAAkB;AACjBnlB,SAAK,yBADY;AAEjBM,WAAO;AAFU;AAPwB,GAA3C;AAYA,SAAO,KAAKoC,GAAL,CAAS,oBAAT,EAA+B,EAA/B,EAAmC;AACzCkC,SAAM,MADmC;AAEzColC,SAAM,WAFmC;AAGzCC,cAAW,IAH8B;AAIzC1kB,cAAW,MAJ8B;AAKzCC,oBAAiB,0BALwB;AAMzCP,gBAAa;AACZjlB,SAAK,yBADO;AAEZM,WAAO;AAFK,IAN4B;AAUzC6kB,qBAAkB;AACjBnlB,SAAK,yBADY;AAEjBM,WAAO;AAFU;AAVuB,GAAnC,CAAP;AAeA,EAhCM,CAAP;AAiCA,CApOD;AAsOA/B,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,SAA7B,EAAwC,YAAW;AAClD,MAAKL,OAAL,CAAa,qBAAb,EAAoC,YAAW;AAC9C,OAAKjjB,GAAL,CAAS,iCAAT,EAA4C,KAA5C,EAAmD;AAClDkC,SAAM,SAD4C;AAElD,aAAU,IAFwC;AAGlD4gB,oBAAiB;AAHiC,GAAnD;AAKA,OAAK9iB,GAAL,CAAS,8BAAT,EAAyC,IAAzC,EAA+C;AAC9CkC,SAAM,SADwC;AAE9C,aAAU,IAFoC;AAG9C4gB,oBAAiB;AAH6B,GAA/C;AAKA,EAXD;AAYA,MAAK9iB,GAAL,CAAS,sBAAT,EAAiC,IAAjC,EAAuC;AACtCkC,QAAM,SADgC;AAEtC,YAAU;AAF4B,EAAvC;AAIA,MAAKlC,GAAL,CAAS,yCAAT,EAAoD,CAApD,EAAuD;AACtDkC,QAAM,KADgD;AAEtD,YAAU,IAF4C;AAGtD4gB,mBAAiB;AAHqC,EAAvD;AAKA,MAAK9iB,GAAL,CAAS,uBAAT,EAAkC,IAAlC,EAAwC;AACvCkC,QAAM,SADiC;AAEvC,YAAU;AAF6B,EAAxC;AAIA,MAAKlC,GAAL,CAAS,4CAAT,EAAuD,CAAvD,EAA0D;AACzDkC,QAAM,KADmD;AAEzD,YAAU,IAF+C;AAGzD4gB,mBAAiB;AAHwC,EAA1D;AAKA,MAAK9iB,GAAL,CAAS,uCAAT,EAAkD,KAAlD,EAAyD;AACxDkC,QAAM,SADkD;AAExD,YAAU;AAF8C,EAAzD;AAIA,MAAKlC,GAAL,CAAS,4BAAT,EAAuC,KAAvC,EAA8C;AAC7CkC,QAAM;AADuC,EAA9C;AAGA,MAAKlC,GAAL,CAAS,0BAAT,EAAqC,IAArC,EAA2C;AAC1CkC,QAAM,SADoC;AAE1C,YAAU;AAFgC,EAA3C;AAIA,MAAKlC,GAAL,CAAS,2BAAT,EAAsC,KAAtC,EAA6C;AAC5CkC,QAAM,SADsC;AAE5C,YAAU;AAFkC,EAA7C;AAIA,MAAKlC,GAAL,CAAS,6BAAT,EAAwC,KAAxC,EAA+C;AAC9CkC,QAAM,SADwC;AAE9C,YAAU;AAFoC,EAA/C;AAIA,MAAKlC,GAAL,CAAS,4BAAT,EAAuC,EAAvC,EAA2C;AAC1CkC,QAAM,QADoC;AAE1C,YAAU;AAFgC,EAA3C;AAIA,MAAKlC,GAAL,CAAS,qBAAT,EAAgC,KAAhC,EAAuC;AACtCkC,QAAM,SADgC;AAEtC,YAAU;AAF4B,EAAvC;AAIA,MAAKlC,GAAL,CAAS,gBAAT,EAA2B,CAA3B,EAA8B;AAC7BkC,QAAM,KADuB;AAE7B,YAAU;AAFmB,EAA9B;AAIA,MAAKlC,GAAL,CAAS,wBAAT,EAAmC,IAAnC,EAAyC;AACxCkC,QAAM,KADkC;AAExC,YAAU;AAF8B,EAAzC;AAIA,MAAKlC,GAAL,CAAS,4BAAT,EAAuC,IAAvC,EAA6C;AAC5CkC,QAAM,SADsC;AAE5C,YAAU;AAFkC,EAA7C;AAIA,MAAKlC,GAAL,CAAS,+BAAT,EAA0C,KAA1C,EAAiD;AAChDkC,QAAM,SAD0C;AAEhD,YAAU,KAFsC;AAGhD4gB,mBAAiB;AAH+B,EAAjD;AAKA,MAAK9iB,GAAL,CAAS,wBAAT,EAAmC,GAAnC,EAAwC;AACvCkC,QAAM,KADiC;AAEvC,YAAU,IAF6B;AAGvC4gB,mBAAiB;AAHsB,EAAxC;AAKA,MAAK9iB,GAAL,CAAS,WAAT,EAAsB,IAAtB,EAA4B;AAC3BkC,QAAM,SADqB;AAE3B,YAAU;AAFiB,EAA5B;AAIA,MAAKlC,GAAL,CAAS,8BAAT,EAAyC,EAAzC,EAA6C;AAC5CkC,QAAM,KADsC;AAE5C,YAAU;AAFkC,EAA7C;AAIA,MAAKlC,GAAL,CAAS,2BAAT,EAAsC,oBAAtC,EAA4D;AAC3DkC,QAAM,QADqD;AAE3DmlC,cAAY,OAF+C;AAG3DxkB,aAAW;AAHgD,EAA5D;AAKA,MAAK7iB,GAAL,CAAS,sBAAT,EAAiC,EAAjC,EAAqC;AACpCkC,QAAM,QAD8B;AAEpC,YAAU,IAF0B;AAGpC4gB,mBAAiB;AAHmB,EAArC;AAKA,MAAK9iB,GAAL,CAAS,uBAAT,EAAkC,iEAAlC,EAAqG;AACpGkC,QAAM,QAD8F;AAEpG4gB,mBAAiB;AAFmF,EAArG;AAIA,MAAK9iB,GAAL,CAAS,oBAAT,EAA+B,SAA/B,EAA0C;AACzCkC,QAAM;AADmC,EAA1C;AAGA,MAAKlC,GAAL,CAAS,oBAAT,EAA+B,IAA/B,EAAqC;AACpCkC,QAAM,QAD8B;AAEpC,YAAU,IAF0B;AAGpC4gB,mBAAiB;AAHmB,EAArC;AAKA,MAAK9iB,GAAL,CAAS,oBAAT,EAA+B,IAA/B,EAAqC;AACpCkC,QAAM,QAD8B;AAEpC,YAAU,IAF0B;AAGpC4gB,mBAAiB;AAHmB,EAArC;AAKA,MAAK9iB,GAAL,CAAS,2BAAT,EAAsC,KAAtC,EAA6C;AAC5CkC,QAAM,QADsC;AAE5C,YAAU,IAFkC;AAG5C4gB,mBAAiB;AAH2B,EAA7C;AAKA,MAAK9iB,GAAL,CAAS,qBAAT,EAAgC,KAAhC,EAAuC;AACtCkC,QAAM,SADgC;AAEtC,YAAU;AAF4B,EAAvC;AAIA,MAAKlC,GAAL,CAAS,qBAAT,EAAgC,KAAhC,EAAuC;AACtCkC,QAAM,SADgC;AAEtC,YAAU;AAF4B,EAAvC;AAIA,MAAKlC,GAAL,CAAS,qBAAT,EAAgC,KAAhC,EAAuC;AACtCkC,QAAM,SADgC;AAEtC,YAAU;AAF4B,EAAvC;AAIA,MAAKlC,GAAL,CAAS,qBAAT,EAAgC,KAAhC,EAAuC;AACtCkC,QAAM,SADgC;AAEtC,YAAU;AAF4B,EAAvC;AAIA,QAAO,KAAKlC,GAAL,CAAS,8BAAT,EAAyC,KAAzC,EAAgD;AACtDkC,QAAM,SADgD;AAEtD,YAAU;AAF4C,EAAhD,CAAP;AAIA,CA5ID;AA8IArG,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,MAA7B,EAAqC,YAAW;AAC/C,MAAKtjB,GAAL,CAAS,eAAT,EAA0B,EAA1B,EAA8B;AAC7BkC,QAAM;AADuB,EAA9B;AAGA,MAAKlC,GAAL,CAAS,gBAAT,EAA2B,EAA3B,EAA+B;AAC9BkC,QAAM;AADwB,EAA/B;AAGA,MAAKlC,GAAL,CAAS,aAAT,EAAwB,cAAxB,EAAwC;AACvCkC,QAAM;AADiC,EAAxC;AAGA,MAAKlC,GAAL,CAAS,+BAAT,EAA0C,EAA1C,EAA8C;AAC7CkC,QAAM;AADuC,EAA9C;AAGA,MAAKlC,GAAL,CAAS,mBAAT,EAA8B,EAA9B,EAAkC;AACjCkC,QAAM;AAD2B,EAAlC;AAGA,QAAO,KAAKlC,GAAL,CAAS,aAAT,EAAwB,EAAxB,EAA4B;AAClCkC,QAAM,MAD4B;AAElColC,QAAM,WAF4B;AAGlCC,aAAW;AAHuB,EAA5B,CAAP;AAKA,CArBD;AAuBA1rC,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,MAA7B,EAAqC,YAAW;AAC/C,MAAKtjB,GAAL,CAAS,aAAT,EAAwB,IAAxB,EAA8B;AAC7BkC,QAAM,SADuB;AAE7B,YAAU;AAFmB,EAA9B;AAIA,MAAKlC,GAAL,CAAS,YAAT,EAAuB,KAAvB,EAA8B;AAC7BkC,QAAM,SADuB;AAE7B,YAAU,IAFmB;AAG7BqgB,eAAa;AACZjlB,QAAK,aADO;AAEZM,UAAO;AAFK;AAHgB,EAA9B;AAQA,MAAKoC,GAAL,CAAS,qBAAT,EAAgC,IAAhC,EAAsC;AACrCkC,QAAM,SAD+B;AAErCqgB,eAAa;AACZjlB,QAAK,aADO;AAEZM,UAAO;AAFK;AAFwB,EAAtC;AAOA,MAAKoC,GAAL,CAAS,cAAT,EAAyB,6BAAzB,EAAwD;AACvDkC,QAAM,QADiD;AAEvDqgB,eAAa,CACZ;AACCjlB,QAAK,aADN;AAECM,UAAO;AAFR,GADY,EAIT;AACFN,QAAK,qBADH;AAEFM,UAAO;AAFL,GAJS;AAF0C,EAAxD;AAYA,MAAKoC,GAAL,CAAS,iBAAT,EAA4B,IAA5B,EAAkC;AACjCkC,QAAM,SAD2B;AAEjC,YAAU,IAFuB;AAGjCqgB,eAAa,CACZ;AACCjlB,QAAK,aADN;AAECM,UAAO;AAFR,GADY,EAIT;AACFN,QAAK,qBADH;AAEFM,UAAO;AAFL,GAJS;AAHoB,EAAlC;AAaA,MAAKoC,GAAL,CAAS,gBAAT,EAA2B,WAA3B,EAAwC;AACvCkC,QAAM,QADiC;AAEvCmlC,cAAY,6BAF2B;AAGvC9kB,eAAa;AACZjlB,QAAK,aADO;AAEZM,UAAO;AAFK;AAH0B,EAAxC;AAQA,MAAKqlB,OAAL,CAAa,uBAAb,EAAsC,YAAW;AAChD,OAAKjjB,GAAL,CAAS,qBAAT,EAAgC,EAAhC,EAAoC;AACnCkC,SAAM;AAD6B,GAApC;AAGA,OAAKlC,GAAL,CAAS,cAAT,EAAyB,EAAzB,EAA6B;AAC5BkC,SAAM,QADsB;AAE5BqlC,cAAW;AAFiB,GAA7B;AAIA,OAAKvnC,GAAL,CAAS,eAAT,EAA0B,EAA1B,EAA8B;AAC7BkC,SAAM,QADuB;AAE7BqlC,cAAW;AAFkB,GAA9B;AAIA,OAAKvnC,GAAL,CAAS,yBAAT,EAAoC,EAApC,EAAwC;AACvCkC,SAAM;AADiC,GAAxC;AAGA,OAAKlC,GAAL,CAAS,kBAAT,EAA6B,EAA7B,EAAiC;AAChCkC,SAAM,QAD0B;AAEhCqlC,cAAW;AAFqB,GAAjC;AAIA,OAAKvnC,GAAL,CAAS,mBAAT,EAA8B,EAA9B,EAAkC;AACjCkC,SAAM,QAD2B;AAEjCqlC,cAAW;AAFsB,GAAlC;AAIA,OAAKvnC,GAAL,CAAS,kBAAT,EAA6B,EAA7B,EAAiC;AAChCkC,SAAM;AAD0B,GAAjC;AAGA,SAAO,KAAKlC,GAAL,CAAS,yBAAT,EAAoC,EAApC,EAAwC;AAC9CkC,SAAM,QADwC;AAE9C,aAAU;AAFoC,GAAxC,CAAP;AAIA,EA9BD;AA+BA,QAAO,KAAK+gB,OAAL,CAAa,SAAb,EAAwB,YAAW;AACzC,OAAKjjB,GAAL,CAAS,yBAAT,EAAoC,IAApC,EAA0C;AACzCkC,SAAM,SADmC;AAEzC,aAAU;AAF+B,GAA1C;AAIA,SAAO,KAAKlC,GAAL,CAAS,mBAAT,EAA8B,IAA9B,EAAoC;AAC1CkC,SAAM,SADoC;AAE1C,aAAU;AAFgC,GAApC,CAAP;AAIA,EATM,CAAP;AAUA,CA9FD;AAgGArG,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,QAA7B,EAAuC,YAAW;AACjD,MAAKL,OAAL,CAAa,SAAb,EAAwB,YAAW;AAClC,OAAKjjB,GAAL,CAAS,mBAAT,EAA8B,MAA9B,EAAsC;AACrCkC,SAAM,QAD+B;AAErC,aAAU;AAF2B,GAAtC;AAIA,OAAKlC,GAAL,CAAS,kBAAT,EAA6B,mFAA7B,EAAkH;AACjHkC,SAAM,MAD2G;AAEjHolC,SAAM,WAF2G;AAGjHC,cAAW,IAHsG;AAIjH,aAAU;AAJuG,GAAlH;AAMA,OAAKvnC,GAAL,CAAS,yBAAT,EAAoC,4EAApC,EAAkH;AACjHkC,SAAM,MAD2G;AAEjHolC,SAAM,WAF2G;AAGjHC,cAAW,IAHsG;AAIjH,aAAU;AAJuG,GAAlH;AAMA,OAAKvnC,GAAL,CAAS,oBAAT,EAA+B,0IAA/B,EAA2K;AAC1KkC,SAAM,QADoK;AAE1KqlC,cAAW,IAF+J;AAG1K,aAAU;AAHgK,GAA3K;AAKA,OAAKvnC,GAAL,CAAS,uBAAT,EAAkC,0EAAlC,EAA8G;AAC7GkC,SAAM,MADuG;AAE7GolC,SAAM,WAFuG;AAG7GC,cAAW,IAHkG;AAI7G,aAAU;AAJmG,GAA9G;AAMA,SAAO,KAAKvnC,GAAL,CAAS,uBAAT,EAAkC,2BAAlC,EAA+D;AACrEkC,SAAM,MAD+D;AAErEolC,SAAM,WAF+D;AAGrE,aAAU,IAH2D;AAIrExkB,oBAAiB;AAJoD,GAA/D,CAAP;AAMA,EAlCD;AAmCA,MAAKG,OAAL,CAAa,gBAAb,EAA+B,YAAW;AACzC,OAAKjjB,GAAL,CAAS,0BAAT,EAAqC,mBAArC,EAA0D;AACzDkC,SAAM,MADmD;AAEzDqlC,cAAW,IAF8C;AAGzD,aAAU;AAH+C,GAA1D;AAKA,SAAO,KAAKvnC,GAAL,CAAS,yBAAT,EAAoC,mBAApC,EAAyD;AAC/DkC,SAAM,MADyD;AAE/DqlC,cAAW,IAFoD;AAG/D,aAAU;AAHqD,GAAzD,CAAP;AAKA,EAXD;AAYA,QAAO,KAAKtkB,OAAL,CAAa,gBAAb,EAA+B,YAAW;AAChD,OAAKjjB,GAAL,CAAS,iBAAT,EAA4B,IAA5B,EAAkC;AACjCkC,SAAM,SAD2B;AAEjC,aAAU;AAFuB,GAAlC;AAIA,OAAKlC,GAAL,CAAS,0BAAT,EAAqC,IAArC,EAA2C;AAC1CkC,SAAM,SADoC;AAE1C,aAAU;AAFgC,GAA3C;AAIA,OAAKlC,GAAL,CAAS,oBAAT,EAA+B,KAA/B,EAAsC;AACrCkC,SAAM,SAD+B;AAErC,aAAU;AAF2B,GAAtC;AAIA,OAAKlC,GAAL,CAAS,kBAAT,EAA6B,KAA7B,EAAoC;AACnCkC,SAAM,SAD6B;AAEnC,aAAU;AAFyB,GAApC;AAIA,EAjBM,CAAP;AAkBA,CAlED;AAoEArG,WAAWU,QAAX,CAAoB+mB,QAApB,CAA6B,MAA7B,EAAqC,YAAW;AAC/C,MAAKtjB,GAAL,CAAS,WAAT,EAAsB,GAAtB,EAA2B;AAC1BkC,QAAM,QADoB;AAE1Bu3B,UAAQ,CACP;AACC57B,QAAK,GADN;AAECglB,cAAW;AAFZ,GADO,EAIJ;AACFhlB,QAAK,GADH;AAEFglB,cAAW;AAFT,GAJI,EAOJ;AACFhlB,QAAK,GADH;AAEFglB,cAAW;AAFT,GAPI,CAFkB;AAc1B,YAAU;AAdgB,EAA3B;AAgBA,MAAK7iB,GAAL,CAAS,aAAT,EAAwB,KAAxB,EAA+B;AAC9BkC,QAAM,SADwB;AAE9B,YAAU;AAFoB,EAA/B;AAIA,MAAKlC,GAAL,CAAS,UAAT,EAAqB,KAArB,EAA4B;AAC3BkC,QAAM,SADqB;AAE3B,YAAU;AAFiB,EAA5B;AAIA,QAAO,KAAKlC,GAAL,CAAS,gBAAT,EAA2B,IAA3B,EAAiC;AACvCkC,QAAM;AADiC,EAAjC,CAAP;AAGA,CA5BD;AA8BArG,WAAWU,QAAX,CAAoBsnB,IAApB,sG;;;;;;;;;;;AChiCA9mB,OAAOyI,OAAP,CAAe;AACd,sBADc,YACQivB,SADR,EACmB;AAChC,OAAKgT,OAAL;AACA,MAAM9J,UAAU9hC,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2B7iB,IAA3B,GAAkC2P,KAAlC,GAA0C3N,MAA1C,CAAiD,UAAS0hB,MAAT,EAAiB;AACjF,UAAOA,OAAO7B,MAAP,KAAkB,IAAlB,IAA0B6B,OAAO,QAAP,MAAqB,IAAtD;AACA,GAFe,CAAhB;;AAGA,MAAIwQ,qBAAqBp3B,IAAzB,EAA+B;AAC9B,UAAO;AACN0d,YAAQ4iB,QAAQp7B,MAAR,CAAe,UAAS0hB,MAAT,EAAiB;AACvC,YAAOA,OAAO6M,UAAP,GAAoB2D,SAA3B;AACA,KAFO,CADF;AAINh0B,YAAQ5E,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2ByH,qBAA3B,CAAiD4J,SAAjD,EAA4D;AACnErS,aAAQ;AACPxM,WAAK;AADE,MAD2D;AAInE,eAAU;AAJyD,KAA5D,EAKL;AACF3F,aAAQ;AACP3S,WAAK,CADE;AAEPqjC,kBAAY;AAFL;AADN,KALK,EAULzwB,KAVK;AAJF,IAAP;AAgBA;;AACD,SAAOytB,OAAP;AACA,EAzBa;AA0Bd,uBA1Bc,YA0BSlJ,SA1BT,EA0BoB;AACjC,MAAI,CAAC13B,OAAO2I,MAAP,EAAL,EAAsB;AACrB,UAAO,EAAP;AACA;;AACD,OAAK+hC,OAAL;;AACA,MAAI,CAAC5rC,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,yBAAhD,CAAL,EAAiF;AAChF,UAAO,EAAP;AACA;;AACD,MAAMi4B,UAAU9hC,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2B7iB,IAA3B,GAAkC2P,KAAlC,GAA0C3N,MAA1C,CAAiD,UAAS0hB,MAAT,EAAiB;AACjF,UAAOA,OAAO7B,MAAP,KAAkB,IAAzB;AACA,GAFe,CAAhB;;AAGA,MAAIqS,qBAAqBp3B,IAAzB,EAA+B;AAC9B,UAAO;AACN0d,YAAQ4iB,QAAQp7B,MAAR,CAAe,UAAS0hB,MAAT,EAAiB;AACvC,YAAOA,OAAO6M,UAAP,GAAoB2D,SAA3B;AACA,KAFO,CADF;AAINh0B,YAAQ5E,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2ByH,qBAA3B,CAAiD4J,SAAjD,EAA4D;AACnErS,aAAQ;AACPxM,WAAK;AADE;AAD2D,KAA5D,EAIL;AACF3F,aAAQ;AACP3S,WAAK,CADE;AAEPqjC,kBAAY;AAFL;AADN,KAJK,EASLzwB,KATK;AAJF,IAAP;AAeA;;AACD,SAAOytB,OAAP;AACA;AAvDa,CAAf;AA0DA9hC,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BsG,KAA3B,CAAiCnf,EAAjC,CAAoC,SAApC,EAA+C,UAASrI,IAAT,EAAe3D,OAAf,EAAwB;AACtE,KAAIA,QAAQ,QAAR,MAAsB,IAA1B,EAAgC;AAC/B1C,aAAW6Y,aAAX,CAAyBgU,uBAAzB,CAAiD,yBAAjD,EAA4ExmB,IAA5E,EAAkF9F,EAAE0kB,IAAF,CAAOviB,OAAP,EAAgB,KAAhB,EAAuB,OAAvB,CAAlF;AACA;;AACD,QAAO1C,WAAW6Y,aAAX,CAAyBkU,0BAAzB,CAAoD,0BAApD,EAAgF1mB,IAAhF,EAAsF3D,OAAtF,CAAP;AACA,CALD;AAOA1C,WAAW6Y,aAAX,CAAyBkT,SAAzB,CAAmCU,SAAnC,CAA6C,0BAA7C,EAAyE,YAAW;AACnF,KAAI,KAAK5iB,MAAL,IAAe,IAAnB,EAAyB;AACxB,SAAO,KAAP;AACA;;AACD,QAAO7J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+B,KAAKrS,MAApC,EAA4C,yBAA5C,CAAP;AACA,CALD,2H;;;;;;;;;;;ACjEA,+B,CACA,6BAEA3I,OAAOyI,OAAP,CAAe;AACdkiC,gBADc,YACEnoC,IADF,EACQ;AAErBqM,QAAMrM,IAAN,EAAYqC,MAAZ;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,mBAAhD,MAAyE,IAA7E,EAAmF;AAClF,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,sCAA7C,EAAqF;AAAEsF,YAAQ,iBAAV;AAA6B3B,YAAQ;AAArC,IAArF,CAAN;AACA;;AAEDzE,SAAOA,KAAKmjB,WAAL,GAAmBjgB,OAAnB,CAA2B,aAA3B,EAA0C,EAA1C,CAAP;AACAlD,SAAOgQ,EAAEo4B,UAAF,CAAapoC,IAAb,CAAP;AACA1D,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,EAA8E,KAA9E,EAAkG;AAAE2C,SAAM,SAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,8BAAlF;AAAkH+kB,eAAY;AAA9H,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,WAA8E,EAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,KAAlF;AAAyF+kB,eAAY;AAArG,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,kBAA8E,cAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,kCAAlF;AAAsH+kB,eAAY;AAAlI,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,qBAA8E,KAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,qCAAlF;AAAyH+kB,eAAY;AAArI,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,sBAA8E,kBAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,sCAAlF;AAA0H+kB,eAAY;AAAtI,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,aAA8E,QAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,6BAAlF;AAAiH+kB,eAAY;AAA7H,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,sBAA8E,SAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,sCAAlF;AAA0H+kB,eAAY,IAAtI;AAA4InO,WAAQ,CAAE;AAAE57B,SAAK,QAAP;AAAiBglB,eAAW;AAA5B,IAAF,EAA0C;AAAEhlB,SAAK,SAAP;AAAkBglB,eAAW;AAA7B,IAA1C;AAApJ,GAAlG;AACAhnB,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,UAA8E,EAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,0BAAlF;AAA8G+kB,eAAY;AAA1H,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,cAA8E,EAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,8BAAlF;AAAkH+kB,eAAY;AAA9H,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,mBAA8E,OAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,mCAAlF;AAAuH+kB,eAAY,IAAnI;AAAyInO,WAAQ,CAAE;AAAE57B,SAAK,UAAP;AAAmBglB,eAAW;AAA9B,IAAF,EAA8C;AAAEhlB,SAAK,OAAP;AAAgBglB,eAAW;AAA3B,IAA9C,EAAoF;AAAEhlB,SAAK,EAAP;AAAWglB,eAAW;AAAtB,IAApF;AAAjJ,GAAlG;AACAhnB,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,yBAA8E,EAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,yCAAlF;AAA6H+kB,eAAY;AAAzI,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,0BAA8E,SAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,0CAAlF;AAA8H+kB,eAAY;AAA1I,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,oBAA8E,SAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,oCAAlF;AAAwH+kB,eAAY;AAApI,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,sBAA8E,EAA9E,EAAkG;AAAE2C,SAAM,QAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,sCAAlF;AAA0H+kB,eAAY;AAAtI,GAAlG;AACA/rC,aAAWU,QAAX,CAAoByD,GAApB,4BAAkDT,IAAlD,mBAA8E,KAA9E,EAAkG;AAAE2C,SAAM,SAAR;AAAmB+f,UAAO,OAA1B;AAAmCgB,+BAA2B1jB,IAA9D;AAAuEsjB,cAAW,mCAAlF;AAAuH+kB,eAAY;AAAnI,GAAlG;AACA;AA9Ba,CAAf,0H;;;;;;;;;;;ACHA7qC,OAAOyI,OAAP,CAAe;AACdqiC,oBADc,cACQ;AACrB,MAAI,CAAC9qC,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,mBAAhD,MAAyE,IAA7E,EAAmF;AAClF,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,uCAA7C,EAAsF;AAAEsF,YAAQ,qBAAV;AAAiC3B,YAAQ;AAAzC,IAAtF,CAAN;AACA;;AAEDo/B,uBAAqBC,cAArB,CAAoC5iC,MAApC,CAA2C,EAA3C;AAEA5E,aAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BrI,MAA3B,CAAkC;AAACzd,QAAK;AAAN,GAAlC,EAA+D;AAAC0d,SAAM;AAAC8V,gBAAY,IAAIzzB,IAAJ;AAAb;AAAP,GAA/D,EAA+F;AAAC8wB,UAAO;AAAR,GAA/F;AACA;AAba,CAAf,0H;;;;;;;;;;;ACAApxB,OAAOyI,OAAP,CAAe;AACdgT,cADc,YACA5V,IADA,EACM;AACnB,SAAO7F,OAAOqB,IAAP,CAAY,gBAAZ,EAA8B;AACpC2Q,QAAKnM,KAAKmM,GAD0B;AAEpCoK,UAAO,CAAEvW,KAAKgE,QAAP;AAF6B,GAA9B,CAAP;AAIA;AANa,CAAf,0H;;;;;;;;;;;ACAA7J,OAAOyI,OAAP,CAAe;AACdsiC,eADc,cACY;AAAA,MAAXllC,IAAW,uEAAJ,EAAI;;AACzB;AACA,MAAI,CAAC7F,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAC5DsF,YAAQ;AADoD,IAAvD,CAAN;AAGA;;AAED,MAAI,CAACob,MAAMhjB,IAAN,CAAW6E,KAAKmM,GAAhB,EAAqBnN,MAArB,CAAL,EAAmC;AAClC,SAAM,IAAI7E,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAC5DsF,YAAQ;AADoD,IAAvD,CAAN;AAGA,GAZwB,CAczB;;;AACA,MAAM8I,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCpQ,KAAKmM,GAAzC,CAAb;AACA,MAAMrJ,SAAS3I,OAAO2I,MAAP,EAAf;AACA,MAAMiC,OAAO5K,OAAO4K,IAAP,EAAb;AACA,MAAMogC,aAAa9+B,MAAMqvB,OAAN,CAAc7pB,KAAKuB,SAAnB,KAAiCvB,KAAKuB,SAAL,CAAe8F,QAAf,CAAwBnO,KAAKf,QAA7B,CAApD,CAlByB,CAoBzB;;AACA,MAAI6H,KAAKxH,CAAL,KAAW,GAAf,EAAoB;AACnB,SAAM,IAAIlK,OAAOsD,KAAX,CAAiB,mCAAjB,EAAsD,oCAAtD,EAA4F;AACjGsF,YAAQ;AADyF,IAA5F,CAAN;AAGA,GAzBwB,CA2BzB;;;AACA,MAAIqiC,aAAa,KAAjB;;AACA,MAAID,cAAclsC,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BrS,MAA/B,EAAuC,yBAAvC,EAAkE+I,KAAKnR,GAAvE,CAAlB,EAA+F;AAC9F0qC,gBAAa,IAAb;AACA,GAFD,MAEO,IAAIv5B,KAAKxH,CAAL,KAAW,GAAX,IAAkBpL,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BrS,MAA/B,EAAuC,wBAAvC,CAAtB,EAAwF;AAC9FsiC,gBAAa,IAAb;AACA,GAFM,MAEA,IAAIv5B,KAAKxH,CAAL,KAAW,GAAX,IAAkBpL,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BrS,MAA/B,EAAuC,wBAAvC,CAAtB,EAAwF;AAC9FsiC,gBAAa,IAAb;AACA,GAnCwB,CAqCzB;;;AACA,MAAI,CAACA,UAAL,EAAiB;AAChB,SAAM,IAAIjrC,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAC1DsF,YAAQ;AADkD,IAArD,CAAN;AAGA,GA1CwB,CA4CzB;;;AACA,MAAI,CAACsD,MAAMqvB,OAAN,CAAc11B,KAAKuW,KAAnB,CAAL,EAAgC;AAC/B,SAAM,IAAIpc,OAAOsD,KAAX,CAAiB,yBAAjB,EAA4C,mBAA5C,EAAiE;AACtEsF,YAAQ;AAD8D,IAAjE,CAAN;AAGA,GAjDwB,CAmDzB;;;AACA/C,OAAKuW,KAAL,CAAWxb,OAAX,CAAmB,UAACiJ,QAAD,EAAc;AAChC,OAAMqhC,UAAUpsC,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwB6J,iBAAxB,CAA0C/S,QAA1C,CAAhB;;AACA,OAAI,CAACqhC,OAAL,EAAc;AACb,UAAM,IAAIlrC,OAAOsD,KAAX,CAAiB,wBAAjB,EAA2C,kBAA3C,EAA+D;AACpEsF,aAAQ;AAD4D,KAA/D,CAAN;AAGA;;AAED9J,cAAW2c,aAAX,CAAyB5V,KAAKmM,GAA9B,EAAmCk5B,OAAnC,EAA4CtgC,IAA5C;AACA,GATD;AAWA,SAAO,IAAP;AACA;AAjEa,CAAf,0H;;;;;;;;;;;ACAA5K,OAAOyI,OAAP,CAAe;AACdmT,YADc,YACF5J,GADE,EACG;AAEhBnD,QAAMmD,GAAN,EAAWnN,MAAX;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAM8I,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAAb;;AAEA,MAAI,CAACN,IAAL,EAAW;AACV,SAAM,IAAI1R,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI,CAAC9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,cAAhD,EAAgE+I,KAAKnR,GAArE,CAAL,EAAgF;AAC/E,SAAM,IAAIP,OAAOsD,KAAX,CAAiB,sBAAjB,EAAyC,gBAAzC,EAA2D;AAAEsF,YAAQ;AAAV,IAA3D,CAAN;AACA;;AAED,MAAI8I,KAAKxH,CAAL,KAAW,GAAf,EAAoB;AACnB,SAAM,IAAIlK,OAAOsD,KAAX,CAAiB,2BAAjB,EAA8C,qCAA9C,EAAqF;AAAEsF,YAAQ;AAAV,IAArF,CAAN;AACA;;AAED,SAAO9J,WAAW8c,WAAX,CAAuB5J,GAAvB,CAAP;AACA;AAxBa,CAAf,0H;;;;;;;;;;;ACAAhS,OAAOyI,OAAP,CAAe;AACd0iC,UADc,kBACY;AAAA,MAAfn5B,GAAe,QAAfA,GAAe;AAAA,MAAVsT,OAAU,QAAVA,OAAU;AAEzBzW,QAAMmD,GAAN,EAAWnN,MAAX;AACAgK,QAAMyW,OAAN,EAAezgB,MAAf;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAMgO,eAAe9X,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCwI,wBAAhC,CAAyDlJ,GAAzD,EAA8DhS,OAAO2I,MAAP,EAA9D,CAArB;AACA,MAAMyiC,gBAAgBtsC,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCwI,wBAAhC,CAAyDlJ,GAAzD,EAA8DsT,OAA9D,CAAtB;;AAEA,MAAI,CAAC1O,YAAD,IAAiB,CAACw0B,aAAtB,EAAqC;AACpC,SAAM,IAAIprC,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED9J,aAAWC,MAAX,CAAkB2T,aAAlB,CAAgC2mB,kBAAhC,CAAmDrnB,GAAnD,EAAwDsT,OAAxD,EAAiEtlB,OAAO2I,MAAP,EAAjE;AAEA,SAAO,IAAP;AACA;AApBa,CAAf,0H;;;;;;;;;;;ACAA3I,OAAOyI,OAAP,CAAe;AACd4iC,2BADc,YACap7B,IADb,EACmB;AAEhCpB,QAAMoB,IAAN,EAAYpL,MAAZ;AAEA,SAAOoL,SAASnR,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,qCAAxB,CAAhB;AACA;AANa,CAAf,0H;;;;;;;;;;;ACAAO,OAAOyI,OAAP,CAAe;AACd6iC,oBADc,kBAC2C;AAAA,MAApCv7B,MAAoC,QAApCA,MAAoC;AAAA,MAA5Bw7B,MAA4B,QAA5BA,MAA4B;AAAA,MAApBC,MAAoB,QAApBA,MAAoB;AAAA,MAAZC,SAAY,QAAZA,SAAY;AACxD58B,QAAMkB,MAAN,EAAclL,MAAd;AACAgK,QAAM08B,MAAN,EAAcjrC,IAAd;AACAuO,QAAM28B,MAAN,EAAclrC,IAAd;AACAuO,QAAM48B,SAAN,EAAiBC,OAAjB;;AAEA,MAAI,CAAC1rC,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI,CAAC9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,uBAAhD,CAAL,EAA+E;AAC9E,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED,MAAI6iC,SAAJ,EAAe;AACd3sC,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2B7X,MAA3B,CAAkC;AACjCsO,SAAKjC,MAD4B;AAEjC1P,QAAI;AACHovB,WAAM+b,MADH;AAEHpc,WAAMmc;AAFH;AAF6B,IAAlC;AAOA,GARD,MAQO;AACNzsC,cAAWC,MAAX,CAAkBwc,QAAlB,CAA2B7X,MAA3B,CAAkC;AACjCsO,SAAKjC,MAD4B;AAEjC1P,QAAI;AACH2uB,UAAKwc,MADF;AAEHtc,UAAKqc;AAFF;AAF6B,IAAlC;AAOA;AACD;AAhCa,CAAf,0H;;;;;;;;;;;ACAAvrC,OAAOyI,OAAP,CAAe;AACdkjC,cADc,YACAnpC,IADA,EACMia,OADN,EACoD;AAAA,MAArCC,QAAqC,uEAA1B,KAA0B;AAAA,MAAnBqD,YAAmB,uEAAJ,EAAI;AACjElR,QAAMrM,IAAN,EAAYqC,MAAZ;AACAgK,QAAM4N,OAAN,EAAeuH,MAAM4nB,QAAN,CAAe,CAAC/mC,MAAD,CAAf,CAAf;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI,CAAC9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,UAAhD,CAAL,EAAkE;AACjE,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED,SAAO9J,WAAWyd,UAAX,CAAsB,GAAtB,EAA2B/Z,IAA3B,EAAiCxC,OAAO4K,IAAP,MAAiB5K,OAAO4K,IAAP,GAAcf,QAAhE,EAA0E4S,OAA1E,EAAmFC,QAAnF,EAA6F;AAACqD;AAAD,GAA7F,CAAP;AACA;AAda,CAAf,0H;;;;;;;;;;;ACAA/f,OAAOyI,OAAP,CAAe;AACdojC,YADc,YACFljC,MADE,EACM;AACnB,MAAI3I,OAAO2I,MAAP,OAAoBA,MAApB,IAA8B,CAAC7J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,4BAAhD,CAAnC,EAAkH;AACjH,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,sBAAjB,EAAyC,gBAAzC,EAA2D;AAAEsF,YAAQ;AAAV,IAA3D,CAAN;AACA;;AACD,MAAMiM,QAAQmN,SAAS8pB,0BAAT,EAAd;;AACA9pB,WAAS+pB,iBAAT,CAA2BpjC,MAA3B,EAAmCkM,KAAnC;;AACA,SAAO;AACNlM,iBADM;AAENqjC,cAAWn3B,MAAMA;AAFX,GAAP;AAIA;AAXa,CAAf,0H;;;;;;;;;;;ACAA7U,OAAOyI,OAAP,CAAe;AACdwjC,mBADc,YACKzpC,IADL,EACWia,OADX,EACyD;AAAA,MAArCC,QAAqC,uEAA1B,KAA0B;AAAA,MAAnBqD,YAAmB,uEAAJ,EAAI;AACtElR,QAAMrM,IAAN,EAAYqC,MAAZ;AACAgK,QAAM4N,OAAN,EAAeuH,MAAM4nB,QAAN,CAAe,CAAC/mC,MAAD,CAAf,CAAf;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI,CAAC9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,UAAhD,CAAL,EAAkE;AACjE,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED,SAAO9J,WAAWyd,UAAX,CAAsB,GAAtB,EAA2B/Z,IAA3B,EAAiCxC,OAAO4K,IAAP,MAAiB5K,OAAO4K,IAAP,GAAcf,QAAhE,EAA0E4S,OAA1E,EAAmFC,QAAnF,EAA6F;AAACqD;AAAD,GAA7F,CAAP;AACA;AAda,CAAf,0H;;;;;;;;;;;ACAA,IAAItO,eAAJ;AAAWzJ,OAAO8E,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACyE,WAAOzE,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAEXhN,OAAOyI,OAAP,CAAe;AACd+U,cADc,YACAjU,OADA,EACS;AACtBsF,QAAMtF,OAAN,EAAeya,MAAMoiB,eAAN,CAAsB;AACpC7lC,QAAKsE;AAD+B,GAAtB,CAAf;;AAGA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAC5DsF,YAAQ;AADoD,IAAvD,CAAN;AAGA;;AACD,MAAMsjC,kBAAkBptC,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2BtF,WAA3B,CAAuC1M,QAAQhJ,GAA/C,EAAoD;AAC3E2S,WAAQ;AACPtJ,OAAG,CADI;AAEPoI,SAAK,CAFE;AAGP8L,UAAM;AAHC;AADmE,GAApD,CAAxB;;AAOA,MAAIouB,mBAAmB,IAAvB,EAA6B;AAC5B,SAAM,IAAIlsC,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,aAA7C,EAA4D;AACjEsF,YAAQ,eADyD;AAEjE3B,YAAQ;AAFyD,IAA5D,CAAN;AAIA;;AACD,MAAM+T,gBAAgBlc,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,gBAAhD,EAAkEujC,gBAAgBl6B,GAAlF,CAAtB;AACA,MAAMm6B,gBAAgBrtC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uBAAxB,CAAtB;AACA,MAAM2sC,YAAYF,mBAAmBA,gBAAgBtiC,CAAnC,IAAwCsiC,gBAAgBtiC,CAAhB,CAAkBrJ,GAAlB,KAA0BP,OAAO2I,MAAP,EAApF;;AACA,MAAI,EAAEqS,iBAAkBmxB,iBAAiBC,SAArC,CAAJ,EAAsD;AACrD,SAAM,IAAIpsC,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,aAA7C,EAA4D;AACjEsF,YAAQ,eADyD;AAEjE3B,YAAQ;AAFyD,IAA5D,CAAN;AAIA;;AACD,MAAMolC,uBAAuBvtC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,4CAAxB,CAA7B;;AACA,MAAI4sC,wBAAwB,IAAxB,IAAgCA,yBAAyB,CAA7D,EAAgE;AAC/D,OAAIH,gBAAgB7rC,EAAhB,IAAsB,IAA1B,EAAgC;AAC/B;AACA;;AACD,OAAMisC,QAAQ76B,OAAOy6B,gBAAgB7rC,EAAvB,CAAd;;AACA,OAAIisC,SAAS,IAAb,EAAmB;AAClB;AACA;;AACD,OAAMC,gBAAgB96B,SAASI,IAAT,CAAcy6B,KAAd,EAAqB,SAArB,CAAtB;;AACA,OAAIC,gBAAgBF,oBAApB,EAA0C;AACzC,UAAM,IAAIrsC,OAAOsD,KAAX,CAAiB,gCAAjB,EAAmD,6BAAnD,EAAkF;AACvFsF,aAAQ;AAD+E,KAAlF,CAAN;AAGA;AACD;;AACD,SAAO9J,WAAW0e,aAAX,CAAyB0uB,eAAzB,EAA0ClsC,OAAO4K,IAAP,EAA1C,CAAP;AACA;AAjDa,CAAf,0H;;;;;;;;;;;ACFA5K,OAAOyI,OAAP,CAAe;AACd+jC,qBADc,YACOvmC,QADP,EACiB;AAE9B4I,QAAM5I,QAAN,EAAgBpB,MAAhB;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI,CAAC9J,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,gCAAxB,CAAL,EAAgE;AAC/D,SAAM,IAAIO,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED,MAAMD,SAAS3I,OAAO2I,MAAP,EAAf;AACA,MAAMiC,OAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCtN,MAApC,CAAb;;AAEA,MAAI,CAACiC,IAAL,EAAW;AACV,SAAM,IAAI5K,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAIgC,KAAK+U,QAAL,IAAiB/U,KAAK+U,QAAL,CAAc1Z,QAA/B,IAA2CuM,EAAEjT,IAAF,CAAOqL,KAAK+U,QAAL,CAAc1Z,QAAd,CAAuBwmC,MAA9B,CAA/C,EAAsF;AACrF,OAAMxoC,SAAS+d,SAAS0qB,cAAT,CAAwB9hC,IAAxB,EAA8B;AAAE+hC,YAAQ1mC,QAAV;AAAoB2mC,eAAW;AAA/B,IAA9B,CAAf;;AACA,OAAI3oC,OAAOsJ,KAAX,EAAkB;AACjB,UAAM,IAAIvN,OAAOsD,KAAX,CAAiB,wBAAjB,EAA2C,kBAA3C,EAA+D;AAAEsF,aAAQ;AAAV,KAA/D,CAAN;AACA;AACD,GALD,MAKO,IAAIgC,KAAKf,QAAL,KAAkB2I,EAAEjT,IAAF,CAAO0G,QAAP,CAAtB,EAAwC;AAC9C,SAAM,IAAIjG,OAAOsD,KAAX,CAAiB,wBAAjB,EAA2C,kBAA3C,EAA+D;AAAEsF,YAAQ;AAAV,IAA/D,CAAN;AACA;;AAED5I,SAAO+E,KAAP,CAAa,YAAW;AACvBjG,cAAW0f,UAAX,CAAsB7V,MAAtB;AACA,GAFD;AAIA,SAAO,IAAP;AACA;AAlCa,CAAf,0H;;;;;;;;;;;ACAA,IAAMkkC,SAASzzB,IAAIrM,OAAJ,CAAY,WAAZ,CAAf;;AAEAjO,WAAWqB,SAAX,CAAqB8C,GAArB,CAAyB,mBAAzB,EAA8C,UAASsG,OAAT,EAAkB;AAE/D,KAAIzK,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,6BAAxB,CAAJ,EAA4D;AAC3D,MAAMqtC,eAAehuC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,4BAAxB,CAArB;AACA,MAAI4I,gBAAJ,CAF2D,CAI3D;;AACA,MAAI,CAAC,CAACykC,YAAF,IAAkBA,aAAa/oC,MAAnC,EAA2C;AAC1CsE,aAAU;AACTjD,UAAM0nC,aAAaroC,KAAb,CAAmB,GAAnB;AADG,IAAV;AAGA;;AACD,MAAMe,SAAS,IAAIqnC,MAAJ,CAAWxkC,OAAX,CAAf;AACAkB,UAAQT,GAAR,GAActD,OAAOunC,KAAP,CAAaxjC,QAAQT,GAArB,CAAd;AACA;;AAED,QAAOS,OAAP;AAEA,CAlBD,EAkBG,CAlBH,EAkBM,gBAlBN,sG;;;;;;;;;;;ACFAzK,WAAWqB,SAAX,CAAqB8C,GAArB,CAAyB,mBAAzB,EAA8C,UAASsG,OAAT,EAAkB;AAC/D;AACA,KAAIA,QAAQ6J,QAAR,IAAoB,IAApB,IACH/T,EAAEqZ,KAAF,CAAQnP,QAAQ6J,QAAhB,EAA0B,KAA1B,EAAiChB,IAAjC,CAAsC,UAAClQ,IAAD;AAAA,SAAUA,SAAS,KAAnB;AAAA,EAAtC,CADD,EACkE;AAEjE;AACA,MAAI,CAACpD,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BzR,QAAQK,CAAR,CAAUrJ,GAAzC,EAA8C,aAA9C,CAAL,EAAmE;AAElE;AACA,OAAM0I,WAAWnK,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoC1M,QAAQK,CAAR,CAAUrJ,GAA9C,EAAmD0I,QAApE;;AACA,OAAMhC,SAASyC,QAAQC,EAAR,CAAW,yBAAX,EAAsC,EAAtC,EAA0CV,QAA1C,CAAf,CAJkE,CAMlE;AACA;;;AACAnK,cAAW6Y,aAAX,CAAyBC,UAAzB,CAAoCrO,QAAQK,CAAR,CAAUrJ,GAA9C,EAAmD,SAAnD,EAA8D;AAC7DA,SAAK8C,OAAOF,EAAP,EADwD;AAE7D6O,SAAKzI,QAAQyI,GAFgD;AAG7D3R,QAAI,IAAIC,IAAJ,EAHyD;AAI7DwI,SAAKY,QAAQC,EAAR,CAAW,0BAAX,EAAuC;AAAE1C;AAAF,KAAvC,EAAmDgC,QAAnD;AAJwD,IAA9D,EARkE,CAelE;;AACA,SAAM,IAAIjJ,OAAOsD,KAAX,CACL,0BADK,EAEL,qCAFK,EAGL;AACCsF,YAAQ,gBADT;AAEC3B,YAAQ;AAFT,IAHK,CAAN;AAQA;AACD;;AAED,QAAOsC,OAAP;AAEA,CAnCD,EAmCG,CAnCH,EAmCM,gBAnCN,sG;;;;;;;;;;;ACAAvJ,OAAOyI,OAAP,CAAe;AACdukC,kBADc,kBAC2D;AAAA,MAAtDh7B,GAAsD,QAAtDA,GAAsD;AAAA,MAAjDu5B,MAAiD,QAAjDA,MAAiD;AAAA,MAAzCC,MAAyC,QAAzCA,MAAyC;AAAA,MAAjCC,SAAiC,QAAjCA,SAAiC;AAAA,wBAAtBxe,KAAsB;AAAA,MAAtBA,KAAsB,8BAAd,EAAc;AAAA,MAAVggB,OAAU,QAAVA,OAAU;AACxEp+B,QAAMmD,GAAN,EAAWnN,MAAX;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAMskC,aAAaltC,OAAO2I,MAAP,EAAnB;AACA,MAAM+I,OAAO1R,OAAOqB,IAAP,CAAY,eAAZ,EAA6B2Q,GAA7B,EAAkCk7B,UAAlC,CAAb;;AACA,MAAI,CAACx7B,IAAL,EAAW;AACV,UAAO,KAAP;AACA,GAXuE,CAaxE;;;AACA,MAAIA,KAAKxH,CAAL,KAAW,GAAX,IAAkB,CAACpL,WAAWic,KAAX,CAAiBC,aAAjB,CAA+BkyB,UAA/B,EAA2C,gBAA3C,CAAnB,IAAmFx7B,KAAKuB,SAAL,CAAexN,OAAf,CAAuBiM,KAAK7H,QAA5B,MAA0C,CAAC,CAAlI,EAAqI;AACpI,UAAO,KAAP;AACA,GAhBuE,CAkBxE;;;AACA,MAAIxK,EAAE8tC,WAAF,CAAc5B,MAAd,CAAJ,EAA2B;AAC1BA,YAAS,IAAIjrC,IAAJ,EAAT;AACA,GArBuE,CAuBxE;;;AACA,MAAI,CAACjB,EAAE8tC,WAAF,CAAc3B,MAAd,CAAD,IAA0B,CAACnsC,EAAE+tC,MAAF,CAAS5B,MAAT,CAA/B,EAAiD;AAChD,SAAM,IAAIxrC,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAMP,UAAU;AACf2X,SAAM;AACL3f,QAAI,CAAC;AADA,IADS;AAIfgf,UAAO4N;AAJQ,GAAhB;;AAOA,MAAI,CAACnuB,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,0BAAxB,CAAL,EAA0D;AACzD4I,WAAQ6K,MAAR,GAAiB;AAAE,gBAAY;AAAd,IAAjB;AACA;;AAED,MAAI0tB,UAAU,EAAd;;AACA,MAAIvhC,EAAE8tC,WAAF,CAAc3B,MAAd,KAAyBC,SAA7B,EAAwC;AACvC7K,aAAU9hC,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2B4T,2CAA3B,CAAuEnd,GAAvE,EAA4Eu5B,MAA5E,EAAoFljC,OAApF,EAA6F8K,KAA7F,EAAV;AACA,GAFD,MAEO,IAAI9T,EAAE8tC,WAAF,CAAc3B,MAAd,KAAyB,CAACC,SAA9B,EAAyC;AAC/C7K,aAAU9hC,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2B0T,kCAA3B,CAA8Djd,GAA9D,EAAmEu5B,MAAnE,EAA2EljC,OAA3E,EAAoF8K,KAApF,EAAV;AACA,GAFM,MAEA,IAAI,CAAC9T,EAAE8tC,WAAF,CAAc3B,MAAd,CAAD,IAA0BC,SAA9B,EAAyC;AAC/C7K,aAAU9hC,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2BiU,6CAA3B,CAAyExd,GAAzE,EAA8Ew5B,MAA9E,EAAsFD,MAAtF,EAA8FljC,OAA9F,EAAuG8K,KAAvG,EAAV;AACA,GAFM,MAEA;AACNytB,aAAU9hC,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2B8T,oCAA3B,CAAgErd,GAAhE,EAAqEw5B,MAArE,EAA6ED,MAA7E,EAAqFljC,OAArF,EAA8F8K,KAA9F,EAAV;AACA;;AAED,MAAMk6B,mBAAmBvuC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,kBAAxB,MAAgD,IAAzE;;AAEA,MAAM6tC,WAAWjuC,EAAEsC,GAAF,CAAMi/B,OAAN,EAAe,UAACr3B,OAAD,EAAa;AAC5CA,WAAQkoB,OAAR,GAAkBpyB,EAAEk/B,SAAF,CAAYh1B,QAAQkoB,OAApB,EAA6B;AAAElxB,SAAK2sC;AAAP,IAA7B,CAAlB;;AACA,OAAI3jC,QAAQK,CAAR,IAAaL,QAAQK,CAAR,CAAUrJ,GAAvB,IAA8B8sC,gBAAlC,EAAoD;AACnD,QAAMziC,OAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoC1M,QAAQK,CAAR,CAAUrJ,GAA9C,CAAb;AACAgJ,YAAQK,CAAR,CAAUpH,IAAV,GAAiBoI,QAAQA,KAAKpI,IAA9B;AACA;;AACD,UAAO+G,OAAP;AACA,GAPgB,CAAjB;;AASA,MAAI0jC,OAAJ,EAAa;AACZ,OAAIM,kBAAkB,CAAtB;AACA,OAAIC,cAAchzB,SAAlB;;AAEA,OAAI,CAACnb,EAAE8tC,WAAF,CAAc3B,MAAd,CAAL,EAA4B;AAC3B,QAAMiC,WAAWH,SAASA,SAASvpC,MAAT,GAAkB,CAA3B,CAAjB;;AACA,QAAI,CAAC1E,EAAE8tC,WAAF,CAAcM,QAAd,CAAD,IAA4BA,SAASptC,EAAT,GAAcmrC,MAA9C,EAAsD;AACrD,SAAMkC,iBAAiB5uC,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2B8T,oCAA3B,CAAgErd,GAAhE,EAAqEw5B,MAArE,EAA6EiC,SAASptC,EAAtF,EAA0F;AAAEgf,aAAO,CAAT;AAAYW,YAAM;AAAE3f,WAAI;AAAN;AAAlB,MAA1F,CAAvB;AACAmtC,mBAAcE,eAAev6B,KAAf,GAAuB,CAAvB,CAAd;AACAo6B,uBAAkBG,eAAezgB,KAAf,EAAlB;AACA;AACD;;AAED,UAAO;AACNqgB,sBADM;AAENE,4BAFM;AAGND;AAHM,IAAP;AAKA;;AAED,SAAO;AACND;AADM,GAAP;AAGA;AArFa,CAAf,0H;;;;;;;;;;;ACAAttC,OAAOyI,OAAP,CAAe;AACd2W,gBADc,kBAC0B;AAAA,yBAAtB5Z,MAAsB;AAAA,MAAtBA,MAAsB,+BAAb,EAAa;AAAA,MAAT6Z,KAAS,QAATA,KAAS;AACvC,MAAMpb,SAASnF,WAAWsgB,eAAX,CAA2B;AAAEzW,WAAQ3I,OAAO2I,MAAP,EAAV;AAA2BnD,iBAA3B;AAAmC6Z;AAAnC,GAA3B,CAAf;;AAEA,MAAI,CAACpb,MAAL,EAAa;AACZ,UAAOA,MAAP;AACA;;AAED,SAAOA,OAAOkP,KAAP,EAAP;AACA;AATa,CAAf,0H;;;;;;;;;;;ACAAnT,OAAOyI,OAAP,CAAe;AACdklC,aADc,YACD37B,GADC,EACI;AAEjBnD,QAAMmD,GAAN,EAAWnN,MAAX;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAD,IAAoB7J,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,6BAAxB,MAA2D,KAAnF,EAA0F;AACzF,SAAM,IAAIO,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAEDiG,QAAMmD,GAAN,EAAWnN,MAAX;AAEA,MAAMwD,UAAU;AACf2X,SAAM;AACL,kBAAc;AADT,IADS;AAIf9M,WAAQ;AACPlB,SAAK,CADE;AAEPpI,OAAG,CAFI;AAGPkW,WAAO;AAHA;AAJO,GAAhB;AAWA,MAAMA,QAAQhhB,WAAWC,MAAX,CAAkB6uC,KAAlB,CAAwBpqC,IAAxB,CAA6B;AAAE0Q,UAAO,eAAT;AAA0B3L,gBAAa;AAAE6d,aAAS,CAAX;AAAcvN,SAAK;AAAnB;AAAvC,GAA7B,EAA+F1F,KAA/F,EAAd;AACA,SAAOrU,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgC0lB,oBAAhC,CAAqDpmB,GAArD,EAA0D3S,EAAEqZ,KAAF,CAAQoH,KAAR,EAAe,KAAf,CAA1D,EAAiFzX,OAAjF,EAA0F8K,KAA1F,EAAP;AACA;AAxBa,CAAf,0H;;;;;;;;;;;ACAAnT,OAAOyI,OAAP,CAAe;AACdolC,cADc,cACE;AACf,SAAO/uC,WAAWqO,IAAlB;AACA;AAHa,CAAf,0H;;;;;;;;;;;ACAAnN,OAAOyI,OAAP,CAAe;AACdqlC,aADc,cACC;AAEd,MAAI,CAAC9tC,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAMP,UAAU;AACf2X,SAAM;AACL,gBAAY;AADP,IADS;AAIf9M,WAAQ;AACPrJ,cAAU,CADH;AAEPiW,WAAO;AAFA;AAJO,GAAhB;AAUA,MAAMA,QAAQhhB,WAAWC,MAAX,CAAkB6uC,KAAlB,CAAwBpqC,IAAxB,CAA6B;AAAE0Q,UAAO,OAAT;AAAkB3L,gBAAa;AAAE6d,aAAS,CAAX;AAAcvN,SAAK;AAAnB;AAA/B,GAA7B,EAAuF1F,KAAvF,EAAd;;AACA,MAAM46B,UAAU1uC,EAAEqZ,KAAF,CAAQoH,KAAR,EAAe,KAAf,CAAhB,CAjBc,CAmBd;AACA;;;AACA,MAAM1D,QAAQtd,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBi7B,gBAAxB,CAAyCD,OAAzC,EAAkD,IAAlD,EAAwD1lC,OAAxD,EAAiE8K,KAAjE,EAAd;;AACA,uBAAmBiJ,KAAnB,kHAA0B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,OAAfxR,IAAe;AACzBA,QAAKkV,KAAL,GAAazgB,EAAE4uC,YAAF,CAAerjC,KAAKkV,KAApB,EAA2BiuB,OAA3B,CAAb;AACA;;AACD,SAAO3xB,KAAP;AACA;AA3Ba,CAAf,0H;;;;;;;;;;;ACAApc,OAAOyI,OAAP,CAAe;AACdylC,mBADc,YACK1sB,QADL,EACe;AAE5B3S,QAAM2S,QAAN,EAAgB9gB,MAAhB;;AAEA,MAAI,CAACV,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,SAAO9J,WAAWyiB,QAAX,CAAoBvhB,OAAO2I,MAAP,EAApB,EAAqC6Y,QAArC,CAAP;AACA;AAVa,CAAf,0H;;;;;;;;;;;ACAAxhB,OAAOyI,OAAP,CAAe;AACdsZ,oBADc,YACMrH,QADN,EACgB;AAC7B7L,QAAM6L,QAAN,EAAgBsJ,MAAM4nB,QAAN,CAAeF,OAAf,CAAhB;;AAEA,MAAI,CAAC1rC,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,OAAK8hC,OAAL;AACA,SAAO5rC,WAAW2b,wBAAX,CAAoCza,OAAO4K,IAAP,EAApC,EAAmD8P,QAAnD,CAAP;AACA;AAVa,CAAf,0H;;;;;;;;;;;ACAA1a,OAAOyI,OAAP,CAAe;AACd0lC,SADc,YACLn8B,GADK,EACAu4B,IADA,EACM;AAEnB17B,QAAMmD,GAAN,EAAWnN,MAAX;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAM8I,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAAb;;AAEA,MAAI,CAACN,IAAL,EAAW;AACV,SAAM,IAAI1R,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAK8I,KAAKxH,CAAL,KAAW,GAAZ,IAAqBpL,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,aAAhD,MAAmE,IAA5F,EAAmG;AAClG,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED,MAAK8I,KAAK0kB,gBAAL,KAA0B,IAA3B,IAAqCmU,SAAS74B,KAAKykB,QAAnD,IAAgE,CAACr3B,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,wBAAhD,CAArE,EAAgJ;AAC/I,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,SAAO9J,WAAW2c,aAAX,CAAyBzJ,GAAzB,EAA8BhS,OAAO4K,IAAP,EAA9B,CAAP;AACA;AAxBa,CAAf,0H;;;;;;;;;;;ACAA5K,OAAOyI,OAAP,CAAe;AACd2lC,UADc,YACJp8B,GADI,EACC;AAEdnD,QAAMmD,GAAN,EAAWnN,MAAX;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,OAAK8hC,OAAL;AAEA,MAAMh5B,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAAb;AACA,MAAMpH,OAAO5K,OAAO4K,IAAP,EAAb;;AAEA,MAAI8G,KAAKxH,CAAL,KAAW,GAAf,EAAoB;AACnB,SAAM,IAAIlK,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED,MAAI,CAACsD,MAAM0E,IAAN,CAAWc,KAAKuB,SAAL,IAAkB,EAA7B,EAAiC8F,QAAjC,CAA0CnO,KAAKf,QAA/C,CAAL,EAA+D;AAC9D,SAAM,IAAI7J,OAAOsD,KAAX,CAAiB,wBAAjB,EAA2C,0BAA3C,EAAuE;AAAEsF,YAAQ;AAAV,IAAvE,CAAN;AACA,GAnBa,CAqBd;;;AACA,MAAI9J,WAAWic,KAAX,CAAiBszB,OAAjB,CAAyBzjC,KAAKrK,GAA9B,EAAmC,OAAnC,EAA4CmR,KAAKnR,GAAjD,CAAJ,EAA2D;AAC1D,OAAM+tC,YAAYxvC,WAAWic,KAAX,CAAiBwzB,cAAjB,CAAgC,OAAhC,EAAyC78B,KAAKnR,GAA9C,EAAmD4S,KAAnD,GAA2DpP,MAA7E;;AACA,OAAIuqC,cAAc,CAAlB,EAAqB;AACpB,UAAM,IAAItuC,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,uEAA7C,EAAsH;AAAEsF,aAAQ;AAAV,KAAtH,CAAN;AACA;AACD;;AAED,SAAO9J,WAAWmiB,kBAAX,CAA8BjP,GAA9B,EAAmChS,OAAO4K,IAAP,EAAnC,CAAP;AACA;AA/Ba,CAAf,0H;;;;;;;;;;;ACAA5K,OAAOyI,OAAP,CAAe;AACd+lC,mBADc,YACKhsC,IADL,EACW;AAExBqM,QAAMrM,IAAN,EAAYqC,MAAZ;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,mBAAhD,MAAyE,IAA7E,EAAmF;AAClF,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAEDpG,SAAOA,KAAKmjB,WAAL,GAAmBjgB,OAAnB,CAA2B,aAA3B,EAA0C,EAA1C,CAAP;AACAlD,SAAOgQ,EAAEo4B,UAAF,CAAapoC,IAAb,CAAP;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA1D,aAAWU,QAAX,CAAoB2e,UAApB,4BAAyD3b,IAAzD;AACA;AA9Ba,CAAf,0H;;;;;;;;;;;ACAAxC,OAAOyI,OAAP,CAAe;AACdgmC,eADc,cACG;AAChB,MAAI,CAACzuC,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI9J,WAAWic,KAAX,CAAiBszB,OAAjB,CAAyBruC,OAAO2I,MAAP,EAAzB,EAA0C,OAA1C,MAAuD,IAA3D,EAAiE;AAChE,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED5I,SAAO2P,UAAP,CAAkB,YAAM;AACvB3P,UAAO2P,UAAP,CAAkB,YAAM;AACvBhL,YAAQk9B,IAAR,CAAa,6CAAb;AACAx2B,YAAQqjC,KAAR;AACA,IAHD,EAIE,IAJF;AAKArjC,WAAQsjC,IAAR,CAAa,CAAb;AACA,GAPD,EAQE,IARF;AAUA,SAAO;AACNplC,YAAS,sCADH;AAENjB,WAAQ,CAAC,CAAD;AAFF,GAAP;AAIA;AAxBa,CAAf,0H;;;;;;;;;;;ACAAtI,OAAOyI,OAAP,CAAe;AACd,kBADc,YACI+jB,KADJ,EACW5jB,MADX,EACmBqD,IADnB,EACyB;AACtC4C,QAAM2d,KAAN,EAAa3nB,MAAb;AACAgK,QAAMjG,MAAN,EAAc/D,MAAd;;AACA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAC5DsF,YAAQ;AADoD,IAAvD,CAAN;AAGA;;AACD,MAAI,CAAC9J,WAAWic,KAAX,CAAiBszB,OAAjB,CAAyBruC,OAAO2I,MAAP,EAAzB,EAA0C,OAA1C,CAAL,EAAyD;AACxD,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAC1DsF,YAAQ;AADkD,IAArD,CAAN;AAGA;;AACD,MAAMgmC,IAAI9vC,WAAWC,MAAX,CAAkBytB,KAAlB,CAAV;;AAEA,MAAI,CAACoiB,CAAD,IAAM,CAACvvC,EAAEmnB,UAAF,CAAaooB,EAAEhmC,MAAF,CAAb,CAAX,EAAoC;AACnC,SAAM,IAAI5I,OAAOsD,KAAX,CAAiB,sBAAjB,EAAyC,gBAAzC,EAA2D;AAChEsF,YAAQ;AADwD,IAA3D,CAAN;AAGA;;AACD,MAAM25B,SAASzjC,WAAWC,MAAX,CAAkBytB,KAAlB,EAAyB5jB,MAAzB,EAAiC0D,KAAjC,CAAuCxN,WAAWC,MAAX,CAAkBytB,KAAlB,CAAvC,EAAiEvgB,IAAjE,CAAf;AACA,SAAOs2B,UAAUA,OAAOpvB,KAAjB,GAAyBovB,OAAOpvB,KAAP,EAAzB,GAA0CovB,MAAjD;AACA;AAvBa,CAAf,0H;;;;;;;;;;;ACAAviC,OAAOyI,OAAP,CAAe;AACdomC,YADc,YACFtuC,GADE,EACGM,KADH,EACUY,MADV,EACkB;AAC/B,MAAIzB,OAAO2I,MAAP,OAAoB,IAAxB,EAA8B;AAC7B,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,iCAA7C,EAAgF;AACrFsF,YAAQ;AAD6E,IAAhF,CAAN;AAGA;;AAED,MAAI,CAAC9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,yBAAhD,CAAL,EAAiF;AAChF,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,iCAA7C,EAAgF;AACrFsF,YAAQ;AAD6E,IAAhF,CAAN;AAGA,GAX8B,CAa/B;;;AACAiG,QAAMtO,GAAN,EAAWsE,MAAX;AAEA,MAAMrD,UAAU1C,WAAWC,MAAX,CAAkBsnB,QAAlB,CAA2BC,EAA3B,CAA8BrQ,WAA9B,CAA0C1V,GAA1C,CAAhB,CAhB+B,CAkB/B;;AACA,UAAQiB,QAAQ2D,IAAhB;AACC,QAAK,UAAL;AACC0J,UAAMhO,KAAN,EAAa,CAACH,MAAD,CAAb;AACA;;AACD,QAAK,SAAL;AACCmO,UAAMhO,KAAN,EAAa6qC,OAAb;AACA;;AACD,QAAK,KAAL;AACC78B,UAAMhO,KAAN,EAAa8jC,MAAb;AACA;;AACD;AACC91B,UAAMhO,KAAN,EAAagE,MAAb;AACA;AAZF;;AAeA/F,aAAWU,QAAX,CAAoBinB,UAApB,CAA+BlmB,GAA/B,EAAoCM,KAApC,EAA2CY,MAA3C;AACA,SAAO,IAAP;AACA;AArCa,CAAf,0H;;;;;;;;;;;ACCAzB,OAAOyI,OAAP,CAAe;AACdqmC,oBADc,YACMn5B,MADN,EACc;AAAA;;AAC3B9G,QAAM8G,MAAN,EAAc,CAAC9Q,MAAD,CAAd;;AACA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAC5DsF,YAAQ;AADoD,IAAvD,CAAN;AAGA;;AACD,MAAI,CAAC9J,WAAWic,KAAX,CAAiBszB,OAAjB,CAAyBruC,OAAO2I,MAAP,EAAzB,EAA0C,OAA1C,CAAL,EAAyD;AACxD,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAC1DsF,YAAQ;AADkD,IAArD,CAAN;AAGA;;AACD,MAAMmmC,iBAAiB,uIAAvB;;AACA,MAAMC,cAAc3vC,EAAEoU,OAAF,CAAUpU,EAAEsC,GAAF,CAAMgU,MAAN,EAAc,UAAS3P,KAAT,EAAgB;AAC3D,OAAI+oC,eAAe/tC,IAAf,CAAoBgF,KAApB,CAAJ,EAAgC;AAC/B,WAAOA,KAAP;AACA;AACD,GAJ6B,CAAV,CAApB;;AAKA,MAAM8O,SAAShW,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgC5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,KAA2C,EAA3E,CAAf;AACA,MAAMsV,SAASjW,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgC5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,KAA2C,EAA3E,CAAf;AACA,MAAIqK,aAAJ;AACA,MAAIiM,gBAAJ;AACA,MAAMnL,OAAO5K,OAAO4K,IAAP,EAAb;AACA,MAAMuX,MAAMvX,KAAK3B,QAAL,IAAiBnK,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,UAAxB,CAAjB,IAAwD,IAApE;;AACA,MAAIX,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uBAAxB,CAAJ,EAAsD;AACrDsW,aAAUjX,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,oBAAxB,CAAV;AACAqK,UAAOhL,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,iBAAxB,CAAP;AACA,GAHD,MAGO;AACNsW,aAAUrM,QAAQC,EAAR,CAAW,4BAAX,EAAyC;AAClDwY;AADkD,IAAzC,CAAV;AAGArY,UAAOJ,QAAQC,EAAR,CAAW,yBAAX,EAAsC;AAC5CwY;AAD4C,IAAtC,CAAP;AAGA;;AACDpM,YAAUjX,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgCqQ,OAAhC,CAAV;AACAi5B,cAAYpuC,OAAZ,CAAoB,iBAAS;AAC5B,SAAK8pC,OAAL;;AACA5gC,UAAOhL,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgCoE,IAAhC,EAAsC;AAC5C9D;AAD4C,IAAtC,CAAP;;AAGA,OAAI;AACHgQ,UAAM5F,IAAN,CAAW;AACVyF,SAAI7P,KADM;AAEV4K,WAAM9R,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,YAAxB,CAFI;AAGVsW,qBAHU;AAIVjM,WAAMgL,SAAShL,IAAT,GAAgBiL;AAJZ,KAAX;AAMA,IAPD,CAOE,aAAkB;AAAA,QAAVxL,OAAU,QAAVA,OAAU;AACnB,UAAM,IAAIvJ,OAAOsD,KAAX,CAAiB,yBAAjB,mCAA4EiG,OAA5E,EAAwF;AAC7FX,aAAQ,qBADqF;AAE7FW;AAF6F,KAAxF,CAAN;AAIA;AACD,GAlBD;AAmBA,SAAOylC,WAAP;AACA;AAzDa,CAAf,0H;;;;;;;;;;;;ACDA,IAAAv9B,eAAA;AAAAzJ,OAAAinC,MAAA;AAAA,uBAAAjiC,CAAA;AAAAyE,aAAAzE,CAAA;AAAA;AAAA;;AAAA,IAAAvH,UAAA,GAAAA,OAAA,cAAAvD,IAAA;AAAA,WAAAgO,IAAA,GAAAg/B,IAAA,KAAAnrC,MAAA,EAAAmM,IAAAg/B,CAAA,EAAAh/B,GAAA;AAAA,QAAAA,KAAA,aAAAA,CAAA,MAAAhO,IAAA,SAAAgO,CAAA;AAAA;;AAAA;AAAA;;AAEAlQ,OAAOyI,OAAP,CACC;AAAAib,eAAa,UAACna,OAAD;AAEZ,QAAA8a,GAAA,EAAAC,IAAA,EAAA5S,IAAA,EAAAkF,YAAA,EAAAu4B,MAAA,EAAAvkC,IAAA;AAAAiE,UAAMtF,OAAN,EAAe7I,MAAf;;AAEA,QAAG,CAAIV,OAAO2I,MAAP,EAAP;AACC,YAAU,IAAA3I,OAAOsD,KAAP,CAAa,oBAAb,EAAmC,cAAnC,EAAmD;AAAEsF,gBAAQ;AAAV,OAAnD,CAAV;ACIE;;ADFH,QAAGW,QAAQlJ,EAAX;AACC8uC,eAASpgC,KAAK6C,GAAL,CAASH,OAAOlI,QAAQlJ,EAAf,EAAmBwR,IAAnB,EAAT,CAAT;;AACA,UAAGs9B,SAAS,KAAZ;AACC,cAAU,IAAAnvC,OAAOsD,KAAP,CAAa,8BAAb,EAA6C,kCAA7C,EAAiF;AAAEsF,kBAAQ,aAAV;AAAyBwmC,sBAAY7lC,QAAQlJ,EAA7C;AAAiDgvC,qBAAe,IAAA/uC,IAAA,GAAOgvC,OAAP;AAAhE,SAAjF,CAAV;AADD,aAEK,IAAGH,SAAS,KAAZ;AACJ5lC,gBAAQlJ,EAAR,GAAiB,IAAAC,IAAA,EAAjB;AALF;AAAA;AAOCiJ,cAAQlJ,EAAR,GAAiB,IAAAC,IAAA,EAAjB;ACSE;;ADPH,UAAA+jB,MAAA9a,QAAAT,GAAA,YAAAub,IAAgBtgB,MAAhB,GAAgB,MAAhB,IAAyBjF,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,wBAAxB,CAAzB;AACC,YAAU,IAAAO,OAAOsD,KAAP,CAAa,6BAAb,EAA4C,6CAA5C,EAA2F;AAAEsF,gBAAQ;AAAV,OAA3F,CAAV;ACWE;;ADTHgC,WAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCjW,OAAO2I,MAAP,EAApC,EAAqD;AAAAuK,cAAQ;AAAArJ,kBAAU,CAAV;AAAarH,cAAM;AAAnB;AAAR,KAArD,CAAP;AAEAkP,WAAO1R,OAAOqB,IAAP,CAAY,eAAZ,EAA6BkI,QAAQyI,GAArC,EAA0CpH,KAAKrK,GAA/C,CAAP;;AAEA,QAAG,CAAImR,IAAP;AACC,aAAO,KAAP;ACcE;;ADZHkF,mBAAe9X,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCwI,wBAAhC,CAAyD3R,QAAQyI,GAAjE,EAAsEhS,OAAO2I,MAAP,EAAtE,CAAf;;AACA,QAAGiO,iBAAkBA,aAAa0O,OAAb,IAAwB1O,aAAa0iB,OAAvD,CAAH;AACCx6B,iBAAW6Y,aAAX,CAAyBC,UAAzB,CAAoC5X,OAAO2I,MAAP,EAApC,EAAqD,SAArD,EAAgE;AAC/DpI,aAAK8C,OAAOF,EAAP,EAD0D;AAE/D6O,aAAKN,KAAKnR,GAFqD;AAG/DF,YAAI,IAAIC,IAAJ,EAH2D;AAI/DwI,aAAKY,QAAQC,EAAR,CAAW,iBAAX,EAA8B,EAA9B,EAAkCiB,KAAK3B,QAAvC;AAJ0D,OAAhE;AAMA,aAAO,KAAP;ACcE;;ADZH,QAAAqb,OAAG1Z,KAAKf,QAAR,EAAGpE,QAAApE,IAAA,CAAkBqQ,KAAKmJ,KAAL,IAAc,EAAhC,EAAAyJ,IAAA,MAAH;AACCxlB,iBAAW6Y,aAAX,CAAyBC,UAAzB,CAAoC5X,OAAO2I,MAAP,EAApC,EAAqD,SAArD,EAAgE;AAC/DpI,aAAK8C,OAAOF,EAAP,EAD0D;AAE/D6O,aAAKN,KAAKnR,GAFqD;AAG/DF,YAAI,IAAIC,IAAJ,EAH2D;AAI/DwI,aAAKY,QAAQC,EAAR,CAAW,qBAAX,EAAkC,EAAlC,EAAsCiB,KAAK3B,QAA3C;AAJ0D,OAAhE;AAMA,aAAO,KAAP;ACcE;;ADZH,QAAiCM,QAAAgmC,KAAA,YAAmBzwC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,+BAAxB,CAApD;AAAA8J,cAAQgmC,KAAR,GAAgB3kC,KAAKpI,IAArB;ACeG;;ADdH,QAAGxC,OAAOR,QAAP,CAAe,QAAf,EAAuBgwC,SAA1B;AACCjmC,cAAQqa,kBAAR,GAA6B,KAAK6rB,UAAL,CAAgB7rB,kBAAhB,EAA7B;ACgBE;;ADdH9kB,eAAWgP,OAAX,CAAmBC,YAAnB,CAAgC8nB,GAAhC;ACgBE,WDfF/2B,WAAW4kB,WAAX,CAAuB9Y,IAAvB,EAA6BrB,OAA7B,EAAsCmI,IAAtC,CCeE;ADjEH;AAAA,CADD;AAsDArC,eAAeZ,OAAf,CACC;AAAAtJ,QAAM,QAAN;AACA3C,QAAM,aADN;AAEAmG,UAAQ,UAACA,MAAD;AACP,QAAAiC,IAAA;AAAAA,WAAO9L,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCtN,MAApC,CAAP;;AACA,QAAe,EAAAiC,QAAA,OAAIA,KAAMkV,KAAV,GAAU,MAAV,CAAf;AAAA,aAAO,IAAP;ACmBG;;ADlBH,WAAOra,QAAApE,IAAA,CAAauJ,KAAKkV,KAAlB,YAAP;AALD;AAAA,CADD,EAOE,CAPF,EAOK,IAPL,kH;;;;;;;;;;;AExDA9f,OAAOyI,OAAP,CAAe;AACdinC,kBADc,cACM;AACnB,MAAI,CAAC1vC,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAC5DsF,YAAQ;AADoD,IAAvD,CAAN;AAGA;;AACD,MAAMgC,OAAO5K,OAAO4K,IAAP,EAAb;;AACA,MAAI,CAACA,KAAK+K,MAAN,IAAgB,CAAC/K,KAAK+K,MAAL,CAAY,CAAZ,CAAjB,IAAmC/K,KAAK+K,MAAL,CAAY,CAAZ,EAAeG,OAAtD,EAA+D;AAC9D,SAAM,IAAI9V,OAAOsD,KAAX,CAAiB,qBAAjB,EAAwC,eAAxC,EAAyD;AAC9DsF,YAAQ;AADsD,IAAzD,CAAN;AAGA;;AACD,OAAK8hC,OAAL;AACA,MAAM51B,SAAShW,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgC5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,KAA2C,EAA3E,CAAf;AACA,MAAMsV,SAASjW,WAAW6G,YAAX,CAAwBD,OAAxB,CAAgC5G,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,cAAxB,KAA2C,EAA3E,CAAf;AACAkF,UAAQC,GAAR,4BAAsCgG,KAAK+K,MAAL,CAAY,CAAZ,EAAeG,OAArD;;AACA,MAAI;AACHE,SAAM5F,IAAN,CAAW;AACVyF,QAAIjL,KAAK+K,MAAL,CAAY,CAAZ,EAAeG,OADT;AAEVlF,UAAM9R,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,YAAxB,CAFI;AAGVsW,aAAS,iBAHC;AAIVjM,UAAUgL,MAAV,kDAA+DC;AAJrD,IAAX;AAMA,GAPD,CAOE,aAAkB;AAAA,OAAVxL,OAAU,QAAVA,OAAU;AACnB,SAAM,IAAIvJ,OAAOsD,KAAX,CAAiB,yBAAjB,mCAA4EiG,OAA5E,EAAwF;AAC7FX,YAAQ,mBADqF;AAE7FW;AAF6F,IAAxF,CAAN;AAIA;;AACD,SAAO;AACNA,YAAS,yBADH;AAENjB,WAAQ,CAACsC,KAAK+K,MAAL,CAAY,CAAZ,EAAeG,OAAhB;AAFF,GAAP;AAIA;AAlCa,CAAf;AAqCAzG,eAAeZ,OAAf,CAAuB;AACtBtJ,OAAM,QADgB;AAEtB3C,OAAM,mBAFgB;AAGtBmG,OAHsB,cAGb;AACR,SAAO,IAAP;AACA;AALqB,CAAvB,EAMG,CANH,EAMM,IANN,kH;;;;;;;;;;;ACrCA3I,OAAOyI,OAAP,CAAe;AACdknC,eADc,YACChnC,MADD,EACSoyB,KADT,EACgB;AAE7BlsB,QAAMlG,MAAN,EAAc9D,MAAd;AACAgK,QAAMksB,KAAN,EAAa/W,MAAM4nB,QAAN,CAAeF,OAAf,CAAb;;AAEA,MAAI,CAAC1rC,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,mBAAhD,MAAyE,IAA7E,EAAmF;AAClF,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED,MAAMgC,OAAO5K,OAAOoc,KAAP,CAAa5E,OAAb,CAAqB;AAAEjX,QAAKoI;AAAP,GAArB,EAAsC;AAAEuK,WAAQ;AAAErJ,cAAU;AAAZ;AAAV,GAAtC,CAAb;;AAEA,MAAIkxB,KAAJ,EAAW;AACV,UAAO/6B,OAAOqB,IAAP,CAAY,6BAAZ,EAA2C,OAA3C,EAAoDuJ,KAAKf,QAAzD,CAAP;AACA,GAFD,MAEO;AACN,UAAO7J,OAAOqB,IAAP,CAAY,kCAAZ,EAAgD,OAAhD,EAAyDuJ,KAAKf,QAA9D,CAAP;AACA;AACD;AArBa,CAAf,0H;;;;;;;;;;;ACAA7J,OAAOyI,OAAP,CAAe;AACdka,YADc,YACFngB,IADE,EACI;AAEjBqM,QAAMrM,IAAN,EAAYqC,MAAZ;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI,CAAC9J,WAAW6jB,WAAX,CAAuB3iB,OAAO2I,MAAP,EAAvB,EAAwCnG,IAAxC,CAAL,EAAoD;AACnD,SAAM,IAAIxC,OAAOsD,KAAX,CAAiB,6BAAjB,EAAgD,uBAAhD,EAAyE;AAAEsF,YAAQ;AAAV,IAAzE,CAAN;AACA;;AAED,SAAOpG,IAAP;AACA;AAda,CAAf;AAiBA1D,WAAWmP,WAAX,CAAuBkB,WAAvB,CAAmC,aAAnC,EAAkD,CAAlD,EAAqD,IAArD,EAA2D;AAC1DxG,SAAQ;AAAA,SAAM,IAAN;AAAA;AADkD,CAA3D,2H;;;;;;;;;;;ACjBA3I,OAAOyI,OAAP,CAAe;AACdia,YADc,YACF7Y,QADE,EACoB;AAAA,MAAZ+lC,KAAY,uEAAJ,EAAI;AAAA,MACzBC,2BADyB,GACOD,KADP,CACzBC,2BADyB;AAEjChhC,QAAMhF,QAAN,EAAgBhF,MAAhB;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAMgC,OAAO5K,OAAO4K,IAAP,EAAb;;AAEA,MAAIA,KAAKf,QAAL,IAAiB,CAAC/K,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,8BAAxB,CAAtB,EAA+E;AAC9E,SAAM,IAAIO,OAAOsD,KAAX,CAAiB,mBAAjB,EAAsC,aAAtC,EAAqD;AAAEsF,YAAQ;AAAV,IAArD,CAAN;AACA;;AAED,MAAIgC,KAAKf,QAAL,KAAkBA,QAAtB,EAAgC;AAC/B,UAAOA,QAAP;AACA;;AAED,MAAIgT,uBAAJ;;AACA,MAAI;AACHA,oBAAiB,IAAItK,MAAJ,OAAgBzT,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,uBAAxB,CAAhB,OAAjB;AACA,GAFD,CAEE,OAAO8N,KAAP,EAAc;AACfsP,oBAAiB,IAAItK,MAAJ,CAAW,mBAAX,CAAjB;AACA;;AAED,MAAI,CAACsK,eAAe7b,IAAf,CAAoB6I,QAApB,CAAL,EAAoC;AACnC,SAAM,IAAI7J,OAAOsD,KAAX,CAAiB,kBAAjB,EAAyCjE,EAAEuiB,MAAF,CAAS/X,QAAT,CAAzC,wFAAN;AACA;;AAED,MAAIe,KAAKf,QAAL,KAAkB2Q,SAAtB,EAAiC;AAChC,OAAI,CAAC3Q,SAAS8b,WAAT,EAAD,KAA4B/a,KAAKf,QAAL,CAAc8b,WAAd,EAAhC,EAA6D;AAC5D,QAAI,CAAC7mB,WAAWid,yBAAX,CAAqClS,QAArC,CAAL,EAAqD;AACpD,WAAM,IAAI7J,OAAOsD,KAAX,CAAiB,yBAAjB,eAAwDjE,EAAEuiB,MAAF,CAAS/X,QAAT,CAAxD,qCAA6G;AAAEjB,cAAQ,aAAV;AAAyB+Y,aAAO9X;AAAhC,MAA7G,CAAN;AACA;AACD;AACD,GAND,MAMO,IAAI,CAAC/K,WAAWid,yBAAX,CAAqClS,QAArC,CAAL,EAAqD;AAC3D,SAAM,IAAI7J,OAAOsD,KAAX,CAAiB,yBAAjB,eAAwDjE,EAAEuiB,MAAF,CAAS/X,QAAT,CAAxD,qCAA6G;AAAEjB,YAAQ,aAAV;AAAyB+Y,WAAO9X;AAAhC,IAA7G,CAAN;AACA;;AAED,MAAI,CAAC/K,WAAW4jB,WAAX,CAAuB9X,KAAKrK,GAA5B,EAAiCsJ,QAAjC,CAAL,EAAiD;AAChD,SAAM,IAAI7J,OAAOsD,KAAX,CAAiB,iCAAjB,EAAoD,2BAApD,EAAiF;AAAEsF,YAAQ;AAAV,IAAjF,CAAN;AACA;;AAED,MAAI,CAACgC,KAAKf,QAAV,EAAoB;AACnB7J,UAAOyY,SAAP,CAAiB7N,KAAKrK,GAAtB,EAA2B;AAAA,WAAMP,OAAOqB,IAAP,CAAY,qBAAZ,EAAmCwuC,2BAAnC,CAAN;AAAA,IAA3B;AACA7vC,UAAO+E,KAAP,CAAa,YAAW;AACvB,WAAOjG,WAAWqB,SAAX,CAAqB0D,GAArB,CAAyB,iBAAzB,EAA4C/E,WAAWC,MAAX,CAAkBgU,KAAlB,CAAwBkD,WAAxB,CAAoCrL,KAAKrK,GAAzC,CAA5C,CAAP;AACA,IAFD;AAGA;;AAED,SAAOsJ,QAAP;AACA;AApDa,CAAf;AAuDA/K,WAAWmP,WAAX,CAAuBkB,WAAvB,CAAmC,aAAnC,EAAkD,CAAlD,EAAqD,IAArD,EAA2D;AAC1DxG,OAD0D,cACjD;AAAE,SAAO,IAAP;AAAc;AADiC,CAA3D,2H;;;;;;;;;;;ACvDA3I,OAAOyI,OAAP,CAAe;AACdma,SADc,YACL5c,KADK,EACE;AAEf6I,QAAO7I,KAAP,EAAcnB,MAAd;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAMgC,OAAO5K,OAAO4K,IAAP,EAAb;;AAEA,MAAI,CAAC9L,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,2BAAxB,CAAL,EAA2D;AAC1D,SAAM,IAAIO,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,+BAA7C,EAA8E;AAAEsF,YAAQ,UAAV;AAAsB3B,YAAQ;AAA9B,IAA9E,CAAN;AACA;;AAED,MAAI2D,KAAK+K,MAAL,IAAe/K,KAAK+K,MAAL,CAAY,CAAZ,CAAf,IAAiC/K,KAAK+K,MAAL,CAAY,CAAZ,EAAeG,OAAf,KAA2B9P,KAAhE,EAAuE;AACtE,UAAOA,KAAP;AACA;;AAED,MAAI,CAAClH,WAAW8jB,QAAX,CAAoBhY,KAAKrK,GAAzB,EAA8ByF,KAA9B,CAAL,EAA2C;AAC1C,SAAM,IAAIhG,OAAOsD,KAAX,CAAiB,8BAAjB,EAAiD,wBAAjD,EAA2E;AAAEsF,YAAQ;AAAV,IAA3E,CAAN;AACA;;AAED,SAAO5C,KAAP;AACA;AAxBa,CAAf;AA2BAlH,WAAWmP,WAAX,CAAuBkB,WAAvB,CAAmC,UAAnC,EAA+C,CAA/C,EAAkD,IAAlD,EAAwD;AACvDxG,OADuD,cAChD,UAAY;AAAE,SAAO,IAAP;AAAc;AADoB,CAAxD,2H;;;;;;;;;;;AC3BA3I,OAAOyI,OAAP,CAAe;AACd2hB,cADc,YACApY,GADA,EACK;AAElBnD,QAAMmD,GAAN,EAAWnN,MAAX;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAM8I,OAAO5S,WAAWC,MAAX,CAAkB+S,KAAlB,CAAwBmE,WAAxB,CAAoCjE,GAApC,CAAb;;AAEA,MAAI,CAACN,IAAL,EAAW;AACV,SAAM,IAAI1R,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAI,CAAC9J,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,gBAAhD,EAAkE+I,KAAKnR,GAAvE,CAAL,EAAkF;AACjF,SAAM,IAAIP,OAAOsD,KAAX,CAAiB,sBAAjB,EAAyC,gBAAzC,EAA2D;AAAEsF,YAAQ;AAAV,IAA3D,CAAN;AACA;;AAED,SAAO9J,WAAWsrB,aAAX,CAAyBpY,GAAzB,CAAP;AACA;AApBa,CAAf,0H;;;;;;;;;;;ACAAhS,OAAOyI,OAAP,CAAe;AACdqnC,YADc,kBACc;AAAA,MAAf99B,GAAe,QAAfA,GAAe;AAAA,MAAVsT,OAAU,QAAVA,OAAU;AAE3BzW,QAAMmD,GAAN,EAAWnN,MAAX;AACAgK,QAAMyW,OAAN,EAAezgB,MAAf;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAMgO,eAAe9X,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCwI,wBAAhC,CAAyDlJ,GAAzD,EAA8DhS,OAAO2I,MAAP,EAA9D,CAArB;AACA,MAAMyiC,gBAAgBtsC,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgCwI,wBAAhC,CAAyDlJ,GAAzD,EAA8DsT,OAA9D,CAAtB;;AAEA,MAAI,CAAC1O,YAAD,IAAiB,CAACw0B,aAAtB,EAAqC;AACpC,SAAM,IAAIprC,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED9J,aAAWC,MAAX,CAAkB2T,aAAlB,CAAgC+mB,oBAAhC,CAAqDznB,GAArD,EAA0DsT,OAA1D,EAAmEtlB,OAAO2I,MAAP,EAAnE;AAEA,SAAO,IAAP;AACA;AApBa,CAAf,0H;;;;;;;;;;;ACAA,IAAI8I,eAAJ;AAAWzJ,OAAO8E,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACyE,WAAOzE,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAEXhN,OAAOyI,OAAP,CAAe;AACd8hB,cADc,YACAhhB,OADA,EACS;AAEtBsF,QAAMtF,OAAN,EAAeya,MAAMoiB,eAAN,CAAsB;AAAC7lC,QAAIsE;AAAL,GAAtB,CAAf;;AAEA,MAAI,CAAC7E,OAAO2I,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAI3I,OAAOsD,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEsF,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAED,MAAMsjC,kBAAkBptC,WAAWC,MAAX,CAAkBwc,QAAlB,CAA2BtF,WAA3B,CAAuC1M,QAAQhJ,GAA/C,CAAxB;;AAEA,MAAI,CAAC2rC,eAAD,IAAoB,CAACA,gBAAgB3rC,GAAzC,EAA8C;AAC7C;AACA;;AAED,MAAMya,gBAAgBlc,WAAWic,KAAX,CAAiBC,aAAjB,CAA+Bhb,OAAO2I,MAAP,EAA/B,EAAgD,cAAhD,EAAgEY,QAAQyI,GAAxE,CAAtB;AACA,MAAM+9B,cAAcjxC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,sBAAxB,CAApB;AACA,MAAMuwC,UAAU9D,gBAAgBtiC,CAAhB,IAAqBsiC,gBAAgBtiC,CAAhB,CAAkBrJ,GAAlB,KAA0BP,OAAO2I,MAAP,EAA/D;;AAEA,MAAI,CAACqS,aAAD,KAAmB,CAAC+0B,WAAD,IAAgB,CAACC,OAApC,CAAJ,EAAkD;AACjD,SAAM,IAAIhwC,OAAOsD,KAAX,CAAiB,0BAAjB,EAA6C,6BAA7C,EAA4E;AAAEsF,YAAQ,eAAV;AAA2B3B,YAAQ;AAAnC,IAA5E,CAAN;AACA;;AAED,MAAMgpC,qBAAqBnxC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,yCAAxB,CAA3B;;AACA,MAAIukB,MAAMhjB,IAAN,CAAWivC,kBAAX,EAA+BtL,MAA/B,KAA0CsL,uBAAuB,CAArE,EAAwE;AACvE,OAAI1D,sBAAJ;AACA,OAAID,cAAJ;;AAEA,OAAItoB,MAAMhjB,IAAN,CAAWkrC,gBAAgB7rC,EAA3B,EAA+BskC,MAA/B,CAAJ,EAA4C;AAC3C2H,YAAQ76B,OAAOy6B,gBAAgB7rC,EAAvB,CAAR;AACA;;AACD,OAAIisC,KAAJ,EAAW;AACVC,oBAAgB96B,SAASI,IAAT,CAAcy6B,KAAd,EAAqB,SAArB,CAAhB;AACA;;AACD,OAAIC,gBAAgB0D,kBAApB,EAAwC;AACvC,UAAM,IAAIjwC,OAAOsD,KAAX,CAAiB,+BAAjB,EAAkD,4BAAlD,EAAgF;AAAEsF,aAAQ;AAAV,KAAhF,CAAN;AACA;AACD;;AAED,MAAIsjC,gBAAgBxb,WAApB,EAAiC;AAChC,OAAIwb,gBAAgBxb,WAAhB,CAA4B,CAA5B,EAA+BnoB,WAA/B,KAA+CiS,SAAnD,EAA8D;AAC7DjR,YAAQmnB,WAAR,GAAsBwb,gBAAgBxb,WAAtC;AACAnnB,YAAQmnB,WAAR,CAAoB,CAApB,EAAuBnoB,WAAvB,GAAqCgB,QAAQT,GAA7C;AACAS,YAAQT,GAAR,GAAcojC,gBAAgBpjC,GAA9B;AACA;AACD;;AAEDS,UAAQK,CAAR,GAAYsiC,gBAAgBtiC,CAA5B;AAEA,SAAO9K,WAAWyrB,aAAX,CAAyBhhB,OAAzB,EAAkCvJ,OAAO4K,IAAP,EAAlC,CAAP;AACA;AAlDa,CAAf,0H;;;;;;;;;;;ACFA,sBACA9L,WAAW4H,SAAX,CAAqBzD,GAArB,CAAyB,IAAzB,EAA+B,CAA/B,EAAkC;AACjCqG,WAAU,cADuB;AAEjCmH,OAAM;AAF2B,CAAlC;AAKA3R,WAAW4H,SAAX,CAAqBzD,GAArB,CAAyB,GAAzB,EAA8B,EAA9B,EAAkC;AACjCqG,WAAU,UADuB;AAEjCmH,OAAM,WAF2B;AAGjCzJ,QAAO;AACNxE,QAAM,SADA;AAENvD,QAAM,gBAFA;AAGNgI,QAHM,YAGCqB,MAHD,EAGS;AACd,UAAO4nC,SAAS,GAAT,EAAc5nC,OAAO9F,IAArB,CAAP;AACA;AALK,EAH0B;AAWjC2tC,SAXiC,YAWxBtpC,UAXwB,EAWZ;AACpB,MAAMmK,QAAQ;AACb9G,MAAG,GADU;AAEb1H,SAAMqE;AAFO,GAAd;AAIA,SAAOupC,SAAS54B,OAAT,CAAiBxG,KAAjB,CAAP;AACA,EAjBgC;AAmBjCX,SAnBiC,YAmBxBggC,QAnBwB,EAmBd;AAClB,SAAOA,SAAS7tC,IAAhB;AACA,EArBgC;AAuBjC8tC,UAvBiC,cAuBrB;AACX,SAAOxxC,WAAWic,KAAX,CAAiBw1B,uBAAjB,CAAyC,CAAC,aAAD,EAAgB,kBAAhB,CAAzC,KAAiFzxC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,6BAAxB,MAA2D,IAAnJ;AACA,EAzBgC;AA2BjC+wC,aA3BiC,YA2BpBzgC,MA3BoB,EA2BZ;AACpB,SAAO,CAAC,CAACqgC,SAAS54B,OAAT,CAAiB;AAAEjX,QAAKwP,MAAP;AAAe7F,MAAG;AAAlB,GAAjB,CAAT;AACA;AA7BgC,CAAlC;AAgCApL,WAAW4H,SAAX,CAAqBzD,GAArB,CAAyB,GAAzB,EAA8B,EAA9B,EAAkC;AACjCqG,WAAU,gBADuB;AAEjCmH,OAAM,SAF2B;AAGjCzJ,QAAO;AACNxE,QAAM,QADA;AAENvD,QAAM,mBAFA;AAGNgI,QAHM,YAGCqB,MAHD,EAGS;AACd,UAAO4nC,SAAS,GAAT,EAAc5nC,OAAOuB,QAArB,CAAP;AACA,GALK;AAMNpC,MANM,YAMD8M,GANC,EAMI;AACT,UAAO;AAAE1K,cAAU0K,IAAI/R;AAAhB,IAAP;AACA;AARK,EAH0B;AAcjC2tC,SAdiC,YAcxBtpC,UAdwB,EAcZ;AACpB,MAAMmK,QAAQ;AACb9G,MAAG,GADU;AAEb1H,SAAMqE;AAFO,GAAd;AAKA,MAAM+P,eAAe65B,iBAAiBj5B,OAAjB,CAAyBxG,KAAzB,CAArB;;AACA,MAAI4F,gBAAgBA,aAAa5E,GAAjC,EAAsC;AACrC,UAAOo+B,SAAS54B,OAAT,CAAiBZ,aAAa5E,GAA9B,CAAP;AACA;AACD,EAxBgC;AA0BjC3B,SA1BiC,YA0BxBggC,QA1BwB,EA0Bd;AAClB,MAAMz5B,eAAe65B,iBAAiBj5B,OAAjB,CAAyB;AAAExF,QAAKq+B,SAAS9vC;AAAhB,GAAzB,EAAgD;AAAE2S,WAAQ;AAAE1Q,UAAM,CAAR;AAAWkuC,WAAO;AAAlB;AAAV,GAAhD,CAArB;;AACA,MAAI,CAAC95B,YAAL,EAAmB;AAClB,UAAO,EAAP;AACA;;AACD,MAAI9X,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,kBAAxB,KAA+CmX,aAAa85B,KAAhE,EAAuE;AACtE,UAAO95B,aAAa85B,KAApB;AACA;;AAED,SAAO95B,aAAapU,IAApB;AACA,EApCgC;AAsCjCmuC,kBAtCiC,YAsCfN,QAtCe,EAsCL;AAC3B,MAAIvxC,WAAWU,QAAX,CAAoBC,GAApB,CAAwB,kBAAxB,CAAJ,EAAiD;AAChD,OAAMmX,eAAe65B,iBAAiBj5B,OAAjB,CAAyB;AAAExF,SAAKq+B,SAAS9vC;AAAhB,IAAzB,EAAgD;AAAE2S,YAAQ;AAAE1Q,WAAM;AAAR;AAAV,IAAhD,CAArB;AACA,UAAOoU,gBAAgBA,aAAapU,IAApC;AACA;AACD,EA3CgC;AA6CjC8tC,UA7CiC,cA6CrB;AACX,SAAOxxC,WAAWic,KAAX,CAAiBw1B,uBAAjB,CAAyC,CAAC,aAAD,EAAgB,kBAAhB,CAAzC,CAAP;AACA,EA/CgC;AAiDjCK,cAjDiC,YAiDnB7gC,MAjDmB,EAiDX;AACrB,MAAM6G,eAAe9X,WAAWC,MAAX,CAAkB2T,aAAlB,CAAgC8E,OAAhC,CAAwC;AAACxF,QAAKjC;AAAN,GAAxC,CAArB;;AACA,MAAI6G,gBAAgB,IAApB,EAA0B;AAAE;AAAS;;AAErC,SAAOi6B,QAAQpxC,GAAR,WAAqBmX,aAAapU,IAAlC,aAAP;AACA;AAtDgC,CAAlC;AAyDA1D,WAAW4H,SAAX,CAAqBzD,GAArB,CAAyB,GAAzB,EAA8B,EAA9B,EAAkC;AACjCqG,WAAU,eADuB;AAEjCmH,OAAM,WAF2B;AAGjCzJ,QAAO;AACNxE,QAAM,OADA;AAENvD,QAAM,cAFA;AAGNgI,QAHM,YAGCqB,MAHD,EAGS;AACd,UAAO4nC,SAAS,GAAT,EAAc5nC,OAAO9F,IAArB,CAAP;AACA;AALK,EAH0B;AAWjC2tC,SAXiC,YAWxBtpC,UAXwB,EAWZ;AACpB,MAAMmK,QAAQ;AACb9G,MAAG,GADU;AAEb1H,SAAMqE;AAFO,GAAd;AAIA,SAAOupC,SAAS54B,OAAT,CAAiBxG,KAAjB,CAAP;AACA,EAjBgC;AAmBjCX,SAnBiC,YAmBxBggC,QAnBwB,EAmBd;AAClB,SAAOA,SAAS7tC,IAAhB;AACA,EArBgC;AAuBjC8tC,UAvBiC,cAuBrB;AACX,SAAOxxC,WAAWic,KAAX,CAAiB+1B,gBAAjB,CAAkC,aAAlC,CAAP;AACA;AAzBgC,CAAlC,2H","file":"/packages/rocketchat_lib.js","sourcesContent":["\n/*\n* Kick off the global namespace for RocketChat.\n* @namespace RocketChat\n*/\nRocketChat = {\n\tmodels: {}\n};\n","RocketChat.getURL = (path, { cdn = true, full = false } = {}) => {\n\tconst cdnPrefix = _.rtrim(_.trim(RocketChat.settings.get('CDN_PREFIX') || ''), '/');\n\tconst pathPrefix = _.rtrim(_.trim(__meteor_runtime_config__.ROOT_URL_PATH_PREFIX || ''), '/');\n\n\tlet basePath;\n\n\tconst finalPath = _.ltrim(_.trim(path), '/');\n\n\tif (cdn && cdnPrefix !== '') {\n\t\tbasePath = cdnPrefix + pathPrefix;\n\t} else if (full || Meteor.isCordova) {\n\t\treturn Meteor.absoluteUrl(finalPath);\n\t} else {\n\t\tbasePath = pathPrefix;\n\t}\n\n\treturn `${ basePath }/${ finalPath }`;\n};\n","\n/*\n* RocketChat.settings holds all packages settings\n* @namespace RocketChat.settings\n*/\nRocketChat.settings = {\n\tcallbacks: {},\n\tregexCallbacks: {},\n\tts: new Date,\n\tget(_id, callback) {\n\t\tif (callback != null) {\n\t\t\tRocketChat.settings.onload(_id, callback);\n\t\t\tif (!Meteor.settings) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (_id === '*') {\n\t\t\t\treturn Object.keys(Meteor.settings).forEach(key => {\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tcallback(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (_.isRegExp(_id) && Meteor.settings) {\n\t\t\t\treturn Object.keys(Meteor.settings).forEach(key => {\n\t\t\t\t\tif (!_id.test(key)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tcallback(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn Meteor.settings[_id] != null && callback(_id, Meteor.settings[_id]);\n\t\t} else {\n\t\t\tif (!Meteor.settings) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (_.isRegExp(_id)) {\n\t\t\t\treturn Object.keys(Meteor.settings).reduce((items, key) => {\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tif (_id.test(key)) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn items;\n\t\t\t\t}, []);\n\t\t\t}\n\t\t\treturn Meteor.settings && Meteor.settings[_id];\n\t\t}\n\t},\n\tset(_id, value, callback) {\n\t\treturn Meteor.call('saveSetting', _id, value, callback);\n\t},\n\tbatchSet(settings, callback) {\n\t\t// async -> sync\n\t\t// http://daemon.co.za/2012/04/simple-async-with-only-underscore/\n\t\tconst save = function(setting) {\n\t\t\treturn function(callback) {\n\t\t\t\treturn Meteor.call('saveSetting', setting._id, setting.value, setting.editor, callback);\n\t\t\t};\n\t\t};\n\t\tconst actions = _.map(settings, (setting) => save(setting));\n\t\treturn _(actions).reduceRight(_.wrap, (err, success) => callback(err, success))();\n\t},\n\tload(key, value, initialLoad) {\n\t\t['*', key].forEach(item => {\n\t\t\tif (RocketChat.settings.callbacks[item]) {\n\t\t\t\tRocketChat.settings.callbacks[item].forEach(callback => callback(key, value, initialLoad));\n\t\t\t}\n\t\t});\n\t\tObject.keys(RocketChat.settings.regexCallbacks).forEach(cbKey => {\n\t\t\tconst cbValue = RocketChat.settings.regexCallbacks[cbKey];\n\t\t\tif (!cbValue.regex.test(key)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcbValue.callbacks.forEach(callback => callback(key, value, initialLoad));\n\t\t});\n\t},\n\tonload(key, callback) {\n\t\t// if key is '*'\n\t\t// \tfor key, value in Meteor.settings\n\t\t// \t\tcallback key, value, false\n\t\t// else if Meteor.settings?[_id]?\n\t\t// \tcallback key, Meteor.settings[_id], false\n\t\tconst keys = [].concat(key);\n\t\tkeys.forEach(k => {\n\t\t\tif (_.isRegExp(k)) {\n\t\t\t\tRocketChat.settings.regexCallbacks[name = k.source] = RocketChat.settings.regexCallbacks[name = k.source] || {\n\t\t\t\t\tregex: k,\n\t\t\t\t\tcallbacks: []\n\t\t\t\t};\n\t\t\t\tRocketChat.settings.regexCallbacks[k.source].callbacks.push(callback);\n\t\t\t} else {\n\t\t\t\tRocketChat.settings.callbacks[k] = RocketChat.settings.callbacks[k] || [];\n\t\t\t\tRocketChat.settings.callbacks[k].push(callback);\n\t\t\t}\n\t\t});\n\t}\n};\n","/*\n* Callback hooks provide an easy way to add extra steps to common operations.\n* @namespace RocketChat.callbacks\n*/\n\nRocketChat.callbacks = {};\n\nif (Meteor.isServer) {\n\tRocketChat.callbacks.showTime = true;\n\tRocketChat.callbacks.showTotalTime = true;\n} else {\n\tRocketChat.callbacks.showTime = false;\n\tRocketChat.callbacks.showTotalTime = false;\n}\n\n\n/*\n* Callback priorities\n*/\n\nRocketChat.callbacks.priority = {\n\tHIGH: -1000,\n\tMEDIUM: 0,\n\tLOW: 1000\n};\n\n\n/*\n* Add a callback function to a hook\n* @param {String} hook - The name of the hook\n* @param {Function} callback - The callback function\n*/\n\nRocketChat.callbacks.add = function(hook, callback, priority, id) {\n\tif (priority == null) {\n\t\tpriority = RocketChat.callbacks.priority.MEDIUM;\n\t}\n\tif (!_.isNumber(priority)) {\n\t\tpriority = RocketChat.callbacks.priority.MEDIUM;\n\t}\n\tcallback.priority = priority;\n\tcallback.id = id || Random.id();\n\tRocketChat.callbacks[hook] = RocketChat.callbacks[hook] || [];\n\tif (RocketChat.callbacks.showTime === true) {\n\t\tconst err = new Error;\n\t\tcallback.stack = err.stack;\n\t}\n\tif (RocketChat.callbacks[hook].find((cb) => cb.id === callback.id)) {\n\t\treturn;\n\t}\n\tRocketChat.callbacks[hook].push(callback);\n};\n\n\n/*\n* Remove a callback from a hook\n* @param {string} hook - The name of the hook\n* @param {string} id - The callback's id\n*/\n\nRocketChat.callbacks.remove = function(hookName, id) {\n\tRocketChat.callbacks[hookName] = _.reject(RocketChat.callbacks[hookName], (callback) => callback.id === id);\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n* @returns {Object} Returns the item after it's been through all the callbacks for this hook\n*/\n\nRocketChat.callbacks.run = function(hook, item, constant) {\n\tconst callbacks = RocketChat.callbacks[hook];\n\tif (callbacks && callbacks.length) {\n\t\tlet totalTime = 0;\n\t\tconst result = _.sortBy(callbacks, function(callback) {\n\t\t\treturn callback.priority || RocketChat.callbacks.priority.MEDIUM;\n\t\t}).reduce(function(result, callback) {\n\t\t\tlet time = 0;\n\t\t\tif (RocketChat.callbacks.showTime === true || RocketChat.callbacks.showTotalTime === true) {\n\t\t\t\ttime = Date.now();\n\t\t\t}\n\t\t\tconst callbackResult = callback(result, constant);\n\t\t\tif (RocketChat.callbacks.showTime === true || RocketChat.callbacks.showTotalTime === true) {\n\t\t\t\tconst currentTime = Date.now() - time;\n\t\t\t\ttotalTime += currentTime;\n\t\t\t\tif (RocketChat.callbacks.showTime === true) {\n\t\t\t\t\tif (Meteor.isServer) {\n\t\t\t\t\t\tRocketChat.statsTracker.timing('callbacks.time', currentTime, [`hook:${ hook }`, `callback:${ callback.id }`]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet stack = callback.stack && typeof callback.stack.split === 'function' && callback.stack.split('\\n');\n\t\t\t\t\t\tstack = stack && stack[2] && (stack[2].match(/\\(.+\\)/)||[])[0];\n\t\t\t\t\t\tconsole.log(String(currentTime), hook, callback.id, stack);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn (typeof callbackResult === 'undefined') ? result : callbackResult;\n\t\t}, item);\n\t\tif (RocketChat.callbacks.showTotalTime === true) {\n\t\t\tif (Meteor.isServer) {\n\t\t\t\tRocketChat.statsTracker.timing('callbacks.totalTime', totalTime, [`hook:${ hook }`]);\n\t\t\t} else {\n\t\t\t\tconsole.log(`${ hook }:`, totalTime);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t} else {\n\t\treturn item;\n\t}\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item, in async mode (only works on server)\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n*/\n\nRocketChat.callbacks.runAsync = function(hook, item, constant) {\n\tconst callbacks = RocketChat.callbacks[hook];\n\tif (Meteor.isServer && callbacks && callbacks.length) {\n\t\tMeteor.defer(function() {\n\t\t\t_.sortBy(callbacks, (callback) => callback.priority || RocketChat.callbacks.priority.MEDIUM).forEach((callback) => callback(item, constant));\n\t\t});\n\t} else {\n\t\treturn item;\n\t}\n};\n","RocketChat.fileUploadMediaWhiteList = function() {\n\tconst mediaTypeWhiteList = RocketChat.settings.get('FileUpload_MediaTypeWhiteList');\n\n\tif (!mediaTypeWhiteList || mediaTypeWhiteList === '*') {\n\t\treturn;\n\t}\n\treturn _.map(mediaTypeWhiteList.split(','), function(item) {\n\t\treturn item.trim();\n\t});\n};\n\nRocketChat.fileUploadIsValidContentType = function(type) {\n\tconst list = RocketChat.fileUploadMediaWhiteList();\n\tif (!list || _.contains(list, type)) {\n\t\treturn true;\n\t} else {\n\t\tconst wildCardGlob = '/*';\n\t\tconst wildcards = _.filter(list, function(item) {\n\t\t\treturn item.indexOf(wildCardGlob) > 0;\n\t\t});\n\t\tif (_.contains(wildcards, type.replace(/(\\/.*)$/, wildCardGlob))) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n","RocketChat.placeholders = {};\n\nRocketChat.placeholders.replace = function(str, data) {\n\tif (!str) {\n\t\treturn '';\n\t}\n\n\tstr = str.replace(/\\[Site_Name\\]/g, RocketChat.settings.get('Site_Name') || '');\n\tstr = str.replace(/\\[Site_URL\\]/g, RocketChat.settings.get('Site_Url') || '');\n\n\tif (data) {\n\t\tstr = str.replace(/\\[name\\]/g, data.name || '');\n\t\tstr = str.replace(/\\[fname\\]/g, _.strLeft(data.name, ' ') || '');\n\t\tstr = str.replace(/\\[lname\\]/g, _.strRightBack(data.name, ' ') || '');\n\t\tstr = str.replace(/\\[email\\]/g, data.email || '');\n\t\tstr = str.replace(/\\[password\\]/g, data.password || '');\n\n\t\tif (data.unsubscribe) {\n\t\t\tstr = str.replace(/\\[unsubscribe\\]/g, data.unsubscribe);\n\t\t}\n\t}\n\n\tstr = str.replace(/([^>\\r\\n]?)(\\r\\n|\\n\\r|\\r|\\n)/g, '$1' + '<br>' + '$2');\n\n\n\treturn str;\n};\n","\n/*\n* Callback hooks provide an easy way to add extra steps to common operations.\n* @namespace RocketChat.promises\n*/\n\nRocketChat.promises = {};\n\n\n/*\n* Callback priorities\n*/\n\nRocketChat.promises.priority = {\n\tHIGH: -1000,\n\tMEDIUM: 0,\n\tLOW: 1000\n};\n\n\n/*\n* Add a callback function to a hook\n* @param {String} hook - The name of the hook\n* @param {Function} callback - The callback function\n*/\n\nRocketChat.promises.add = function(hook, callback, p = RocketChat.promises.priority.MEDIUM, id) {\n\tconst priority = !_.isNumber(p) ? RocketChat.promises.priority.MEDIUM : p;\n\tcallback.priority = priority;\n\tcallback.id = id || Random.id();\n\tRocketChat.promises[hook] = RocketChat.promises[hook] || [];\n\tif (RocketChat.promises[hook].find(cb => cb.id === callback.id)) {\n\t\treturn;\n\t}\n\tRocketChat.promises[hook].push(callback);\n};\n\n\n/*\n* Remove a callback from a hook\n* @param {string} hook - The name of the hook\n* @param {string} id - The callback's id\n*/\n\nRocketChat.promises.remove = function(hookName, id) {\n\tRocketChat.promises[hookName] = _.reject(RocketChat.promises[hookName], (callback) => callback.id === id);\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n* @returns {Object} Returns the item after it's been through all the callbacks for this hook\n*/\n\nRocketChat.promises.run = function(hook, item, constant) {\n\tlet callbacks = RocketChat.promises[hook];\n\tif (callbacks == null || callbacks.length === 0) {\n\t\treturn Promise.resolve(item);\n\t}\n\tcallbacks = _.sortBy(callbacks, (callback) => callback.priority || RocketChat.promises.priority.MEDIUM);\n\treturn callbacks.reduce(function(previousPromise, callback) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\treturn previousPromise.then((result) => callback(result, constant).then(resolve, reject));\n\t\t});\n\t}, Promise.resolve(item));\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item, in async mode (only works on server)\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n*/\n\nRocketChat.promises.runAsync = function(hook, item, constant) {\n\tconst callbacks = RocketChat.promises[hook];\n\tif (!Meteor.isServer || callbacks == null || callbacks.length === 0) {\n\t\treturn item;\n\t}\n\tMeteor.defer(() => {\n\t\t_.sortBy(callbacks, (callback) => callback.priority || RocketChat.promises.priority.MEDIUM).forEach(function(callback) {\n\t\t\tcallback(item, constant);\n\t\t});\n\t});\n};\n","/* globals roomExit*/\nthis.roomTypesCommon = class {\n\tconstructor() {\n\t\tthis.roomTypes = {};\n\t\tthis.roomTypesOrder = [];\n\t\tthis.mainOrder = 1;\n\t}\n\n\t/* Adds a room type to app\n\t@param identifier An identifier to the room type. If a real room, MUST BE the same of `db.rocketchat_room.t` field, if not, can be null\n\t@param order Order number of the type\n\t@param config\n\ttemplate: template name to render on sideNav\n\ticon: icon class\n\troute:\n\tname: route name\n\taction: route action function\n\t*/\n\n\tadd(identifier = Random.id(), order, config) {\n\t\tif (this.roomTypes[identifier] != null) {\n\t\t\treturn false;\n\t\t}\n\t\tif (order == null) {\n\t\t\torder = this.mainOrder + 10;\n\t\t\tthis.mainOrder += 10;\n\t\t}\n\t\tthis.roomTypesOrder.push({\n\t\t\tidentifier,\n\t\t\torder\n\t\t});\n\t\tthis.roomTypes[identifier] = config;\n\t\tif (config.route && config.route.path && config.route.name && config.route.action) {\n\t\t\tconst routeConfig = {\n\t\t\t\tname: config.route.name,\n\t\t\t\taction: config.route.action\n\t\t\t};\n\t\t\tif (Meteor.isClient) {\n\t\t\t\trouteConfig.triggersExit = [roomExit];\n\t\t\t}\n\t\t\treturn FlowRouter.route(config.route.path, routeConfig);\n\t\t}\n\t}\n\n\thasCustomLink(roomType) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link != null;\n\t}\n\n\t/*\n\t@param roomType: room type (e.g.: c (for channels), d (for direct channels))\n\t@param subData: the user's subscription data\n\t*/\n\n\tgetRouteLink(roomType, subData) {\n\t\tif (this.roomTypes[roomType] == null) {\n\t\t\treturn false;\n\t\t}\n\t\tlet routeData = {};\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {\n\t\t\trouteData = this.roomTypes[roomType].route.link(subData);\n\t\t} else if (subData && subData.name) {\n\t\t\trouteData = {\n\t\t\t\tname: subData.name\n\t\t\t};\n\t\t}\n\t\treturn FlowRouter.path(this.roomTypes[roomType].route.name, routeData);\n\t}\n\n\topenRouteLink(roomType, subData, queryParams) {\n\t\tif (this.roomTypes[roomType] == null) {\n\t\t\treturn false;\n\t\t}\n\t\tlet routeData = {};\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {\n\t\t\trouteData = this.roomTypes[roomType].route.link(subData);\n\t\t} else if (subData && subData.name) {\n\t\t\trouteData = {\n\t\t\t\tname: subData.name\n\t\t\t};\n\t\t}\n\t\treturn FlowRouter.go(this.roomTypes[roomType].route.name, routeData, queryParams);\n\t}\n};\nexport default this.roomTypesCommon;\n","RocketChat.slashCommands = {\n\tcommands: {}\n};\n\nRocketChat.slashCommands.add = function(command, callback, options = {}, result) {\n\tRocketChat.slashCommands.commands[command] = {\n\t\tcommand,\n\t\tcallback,\n\t\tparams: options.params,\n\t\tdescription: options.description,\n\t\tclientOnly: options.clientOnly || false,\n\t\tresult\n\t};\n};\n\nRocketChat.slashCommands.run = function(command, params, item) {\n\tif (RocketChat.slashCommands.commands[command] && RocketChat.slashCommands.commands[command].callback) {\n\t\treturn RocketChat.slashCommands.commands[command].callback(command, params, item);\n\t}\n};\n\nMeteor.methods({\n\tslashCommand(command) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'slashCommand'\n\t\t\t});\n\t\t}\n\t\treturn RocketChat.slashCommands.run(command.cmd, command.params, command.msg);\n\t}\n});\n","RocketChat.Message = {\n\tparse(msg, language) {\n\t\tconst messageType = RocketChat.MessageTypes.getType(msg);\n\t\tif (messageType) {\n\t\t\tif (messageType.render) {\n\t\t\t\treturn messageType.render(msg);\n\t\t\t} else if (messageType.template) {\n\t\t\t\t// Render message\n\t\t\t\treturn;\n\t\t\t} else if (messageType.message) {\n\t\t\t\tif (!language && typeof localStorage !== 'undefined') {\n\t\t\t\t\tlanguage = localStorage.getItem('userLanguage');\n\t\t\t\t}\n\t\t\t\tconst data = (typeof messageType.data === 'function' && messageType.data(msg)) || {};\n\t\t\t\treturn TAPi18n.__(messageType.message, data, language);\n\t\t\t}\n\t\t}\n\t\tif (msg.u && msg.u.username === RocketChat.settings.get('Chatops_Username')) {\n\t\t\tmsg.html = msg.msg;\n\t\t\treturn msg.html;\n\t\t}\n\t\tmsg.html = msg.msg;\n\t\tif (_.trim(msg.html) !== '') {\n\t\t\tmsg.html = _.escapeHTML(msg.html);\n\t\t}\n\t\tmsg.html = msg.html.replace(/\\n/gm, '<br/>');\n\t\treturn msg.html;\n\t}\n};\n","RocketChat.MessageTypes = new class {\n\tconstructor() {\n\t\tthis.types = {};\n\t}\n\n\tregisterType(options) {\n\t\treturn this.types[options.id] = options;\n\t}\n\n\tgetType(message) {\n\t\treturn this.types[message && message.t];\n\t}\n\n\tisSystemMessage(message) {\n\t\tconst type = this.types[message && message.t];\n\t\treturn type && type.system;\n\t}\n\n\tisChartMessage(message) {\n\t\tconst type = this.types[message && message.t];\n        return type && type == 'chart';\n\t}\n\n};\n\nMeteor.startup(function() {\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'r',\n\t\tsystem: true,\n\t\tmessage: 'Room_name_changed',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\troom_name: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'au',\n\t\tsystem: true,\n\t\tmessage: 'User_added_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_added: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'ru',\n\t\tsystem: true,\n\t\tmessage: 'User_removed_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_removed: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'ul',\n\t\tsystem: true,\n\t\tmessage: 'User_left',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_left: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'uj',\n\t\tsystem: true,\n\t\tmessage: 'User_joined_channel',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'wm',\n\t\tsystem: true,\n\t\tmessage: 'Welcome',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'rm',\n\t\tsystem: true,\n\t\tmessage: 'Message_removed',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'rtc',\n\t\trender(message) {\n\t\t\treturn RocketChat.callbacks.run('renderRtcMessage', message);\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'user-muted',\n\t\tsystem: true,\n\t\tmessage: 'User_muted_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_muted: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'user-unmuted',\n\t\tsystem: true,\n\t\tmessage: 'User_unmuted_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_unmuted: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'subscription-role-added',\n\t\tsystem: true,\n\t\tmessage: '__username__was_set__role__by__user_by_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.msg,\n\t\t\t\trole: message.role,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'subscription-role-removed',\n\t\tsystem: true,\n\t\tmessage: '__username__is_no_longer__role__defined_by__user_by_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.msg,\n\t\t\t\trole: message.role,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room-archived',\n\t\tsystem: true,\n\t\tmessage: 'This_room_has_been_archived_by__username_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room-unarchived',\n\t\tsystem: true,\n\t\tmessage: 'This_room_has_been_unarchived_by__username_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\n\t//TODO : ì°¨íŠ¸íŒŒìž…, ê³µì§€, ì•„ì´í…œ íƒ€ìž…(ì—¬ëŸ¬ ì•„ì´í…œì„ ë³„ë¡œë„ ì •ì˜)ë“¤ì„ ì •ì˜\n\t//ë©”ë¦¬ì§€ ì»¬ëŸ¼ 't'ì— íƒ€ìž…ì„ ë„£ìœ¼ë©´ ë°˜ì˜ë¨.\n    RocketChat.MessageTypes.registerType({\n        id: 'chart',\n        system: false\n    });\n});\n","/* globals WebAppInternals */\nRocketChat.settings.get('Site_Url', function(key, value) {\n\tif (value == null || value.trim() === '') {\n\t\treturn;\n\t}\n\tlet host = value.replace(/\\/$/, '');\n\t// let prefix = '';\n\tconst match = value.match(/([^\\/]+\\/{2}[^\\/]+)(\\/.+)/);\n\tif (match != null) {\n\t\thost = match[1];\n\t\t// prefix = match[2].replace(/\\/$/, '');\n\t}\n\t__meteor_runtime_config__.ROOT_URL = host;\n\n\tif (Meteor.absoluteUrl.defaultOptions && Meteor.absoluteUrl.defaultOptions.rootUrl) {\n\t\tMeteor.absoluteUrl.defaultOptions.rootUrl = host;\n\t}\n\tif (Meteor.isServer) {\n\t\tRocketChat.hostname = host.replace(/^https?:\\/\\//, '');\n\t\tprocess.env.MOBILE_ROOT_URL = host;\n\t\tprocess.env.MOBILE_DDP_URL = host;\n\t\tif (typeof WebAppInternals !== 'undefined' && WebAppInternals.generateBoilerplate) {\n\t\t\treturn WebAppInternals.generateBoilerplate();\n\t\t}\n\t}\n});\n","const logger = new Logger('Meteor', {\n\tmethods: {\n\t\tmethod: {\n\t\t\ttype: 'debug'\n\t\t},\n\t\tpublish: {\n\t\t\ttype: 'debug'\n\t\t}\n\t}\n});\n\nconst wrapMethods = function(name, originalHandler, methodsMap) {\n\tmethodsMap[name] = function() {\n\t\tconst args = name === 'ufsWrite' ? Array.prototype.slice.call(arguments, 1) : arguments;\n\t\tlogger.method(name, '-> userId:', Meteor.userId(), ', arguments: ', args);\n\n\t\treturn originalHandler.apply(this, arguments);\n\t};\n};\n\nconst originalMeteorMethods = Meteor.methods;\n\nMeteor.methods = function(methodMap) {\n\t_.each(methodMap, function(handler, name) {\n\t\twrapMethods(name, handler, methodMap);\n\t});\n\toriginalMeteorMethods(methodMap);\n};\n\nconst originalMeteorPublish = Meteor.publish;\n\nMeteor.publish = function(name, func) {\n\treturn originalMeteorPublish(name, function() {\n\t\tlogger.publish(name, '-> userId:', this.userId, ', arguments: ', arguments);\n\n\t\treturn func.apply(this, arguments);\n\t});\n};\n","import bugsnag from 'bugsnag';\n\nRocketChat.bugsnag = bugsnag;\n\nRocketChat.settings.get('Bugsnag_api_key', (key, value) => {\n\tif (value) {\n\t\tbugsnag.register(value);\n\t}\n});\n\nconst notify = function(message, stack) {\n\tif (typeof stack === 'string') {\n\t\tmessage += ` ${ stack }`;\n\t}\n\tlet options = {};\n\tif (RocketChat.Info) {\n\t\toptions = { app: { version: RocketChat.Info.version, info: RocketChat.Info } };\n\t}\n\tconst error = new Error(message);\n\terror.stack = stack;\n\tRocketChat.bugsnag.notify(error, options);\n};\n\nprocess.on('uncaughtException', Meteor.bindEnvironment((error) => {\n\tnotify(error.message, error.stack);\n\tthrow error;\n}));\n\nconst originalMeteorDebug = Meteor._debug;\nMeteor._debug = function() {\n\tnotify(...arguments);\n\treturn originalMeteorDebug(...arguments);\n};\n","const client = require('prom-client');\n\nRocketChat.promclient = client;\n\nRocketChat.metrics = {};\n\n// one sample metrics only - a counter\n\nRocketChat.metrics.messagesSent = new client.Counter('messages_sent', 'cumulated number of messages sent');\n","/* globals RateLimiter */\nRocketChat.RateLimiter = new class {\n\tlimitFunction(fn, numRequests, timeInterval, matchers) {\n\t\tif (process.env.TEST_MODE === 'true') {\n\t\t\treturn fn;\n\t\t}\n\t\tconst rateLimiter = new RateLimiter();\n\t\trateLimiter.addRule(matchers, numRequests, timeInterval);\n\t\treturn function(...args) {\n\t\t\tconst match = {};\n\t\t\t_.each(matchers, function(matcher, key) {\n\t\t\t\treturn match[key] = args[key];\n\t\t\t});\n\t\t\trateLimiter.increment(match);\n\t\t\tconst rateLimitResult = rateLimiter.check(match);\n\t\t\tif (rateLimitResult.allowed) {\n\t\t\t\treturn fn.apply(null, arguments);\n\t\t\t} else {\n\t\t\t\tthrow new Meteor.Error('error-too-many-requests', `Error, too many requests. Please slow down. You must wait ${ Math.ceil(rateLimitResult.timeToReset / 1000) } seconds before trying again.`, {\n\t\t\t\t\ttimeToReset: rateLimitResult.timeToReset,\n\t\t\t\t\tseconds: Math.ceil(rateLimitResult.timeToReset / 1000)\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tlimitMethod(methodName, numRequests, timeInterval, matchers) {\n\t\tif (process.env.TEST_MODE === 'true') {\n\t\t\treturn;\n\t\t}\n\t\tconst match = {\n\t\t\ttype: 'method',\n\t\t\tname: methodName\n\t\t};\n\t\t_.each(matchers, function(matcher, key) {\n\t\t\treturn match[key] = matchers[key];\n\t\t});\n\t\treturn DDPRateLimiter.addRule(match, numRequests, timeInterval);\n\t}\n\n};\n","/* globals LoggerManager */\nRocketChat.settings.get('Log_Package', function(key, value) {\n\treturn LoggerManager.showPackage = value;\n});\n\nRocketChat.settings.get('Log_File', function(key, value) {\n\treturn LoggerManager.showFileAndLine = value;\n});\n\nRocketChat.settings.get('Log_Level', function(key, value) {\n\tif (value != null) {\n\t\tLoggerManager.logLevel = parseInt(value);\n\t\tMeteor.setTimeout(() => {\n\t\t\treturn LoggerManager.enable(true);\n\t\t}, 200);\n\t}\n});\n","/* globals Push */\nclass PushNotification {\n\tgetNotificationId(roomId) {\n\t\tconst serverId = RocketChat.settings.get('uniqueID');\n\t\treturn this.hash(`${ serverId }|${ roomId }`); // hash\n\t}\n\n\thash(str) {\n\t\tlet hash = 0;\n\t\tlet i = str.length;\n\n\t\twhile (i) {\n\t\t\thash = ((hash << 5) - hash) + str.charCodeAt(--i);\n\t\t\thash = hash & hash; // Convert to 32bit integer\n\t\t}\n\t\treturn hash;\n\t}\n\n\tsend({ roomName, roomId, username, message, usersTo, payload }) {\n\t\tlet title;\n\t\tif (roomName && roomName !== '') {\n\t\t\ttitle = `${ roomName }`;\n\t\t\tmessage = `${ username }: ${ message }`;\n\t\t} else {\n\t\t\ttitle = `${ username }`;\n\t\t}\n\t\tconst icon = RocketChat.settings.get('Assets_favicon_192').url || RocketChat.settings.get('Assets_favicon_192').defaultUrl;\n\t\tconst config = {\n\t\t\tfrom: 'push',\n\t\t\tbadge: 1,\n\t\t\tsound: 'default',\n\t\t\ttitle,\n\t\t\ttext: message,\n\t\t\tpayload,\n\t\t\tquery: usersTo,\n\t\t\tnotId: this.getNotificationId(roomId),\n\t\t\tgcm: {\n\t\t\t\tstyle: 'inbox',\n\t\t\t\tsummaryText: '%n% new messages',\n\t\t\t\timage: RocketChat.getURL(icon, { full: true })\n\t\t\t},\n\t\t\tapn: {\n\t\t\t\ttext: title + ((title !== '' && message !== '') ? '\\n' : '') + message\n\t\t\t}\n\t\t};\n\n\t\treturn Push.send(config);\n\t}\n}\n\nRocketChat.PushNotification = new PushNotification();\n","RocketChat.emailDomainDefaultBlackList = [\n\t'0-mail.com',\n\t'0815.ru',\n\t'0815.su',\n\t'0clickemail.com',\n\t'0wnd.net',\n\t'0wnd.org',\n\t'10mail.org',\n\t'10minut.com.pl',\n\t'10minutemail.co.za',\n\t'10minutemail.com',\n\t'10minutemail.de',\n\t'123-m.com',\n\t'1chuan.com',\n\t'1fsdfdsfsdf.tk',\n\t'1pad.de',\n\t'1zhuan.com',\n\t'20email.eu',\n\t'20mail.eu',\n\t'20mail.it',\n\t'20minutemail.com',\n\t'21cn.com',\n\t'2fdgdfgdfgdf.tk',\n\t'2prong.com',\n\t'30minutemail.com',\n\t'33mail.com',\n\t'3d-painting.com',\n\t'3trtretgfrfe.tk',\n\t'4gfdsgfdgfd.tk',\n\t'4warding.com',\n\t'4warding.net',\n\t'4warding.org',\n\t'5ghgfhfghfgh.tk',\n\t'60minutemail.com',\n\t'675hosting.com',\n\t'675hosting.net',\n\t'675hosting.org',\n\t'6hjgjhgkilkj.tk',\n\t'6ip.us',\n\t'6paq.com',\n\t'6url.com',\n\t'75hosting.com',\n\t'75hosting.net',\n\t'75hosting.org',\n\t'7days-printing.com',\n\t'7tags.com',\n\t'99experts.com',\n\t'9ox.net',\n\t'a-bc.net',\n\t'a45.in',\n\t'abcmail.email',\n\t'abyssmail.com',\n\t'acentri.com',\n\t'advantimo.com',\n\t'afrobacon.com',\n\t'ag.us.to',\n\t'agedmail.com',\n\t'ahk.jp',\n\t'ajaxapp.net',\n\t'alivance.com',\n\t'ama-trade.de',\n\t'amail.com',\n\t'amilegit.com',\n\t'amiri.net',\n\t'amiriindustries.com',\n\t'anappthat.com',\n\t'ano-mail.net',\n\t'anonbox.net',\n\t'anonmails.de',\n\t'anonymail.dk',\n\t'anonymbox.com',\n\t'antichef.com',\n\t'antichef.net',\n\t'antireg.ru',\n\t'antispam.de',\n\t'antispammail.de',\n\t'appixie.com',\n\t'armyspy.com',\n\t'artman-conception.com',\n\t'aver.com',\n\t'azmeil.tk',\n\t'baxomale.ht.cx',\n\t'beddly.com',\n\t'beefmilk.com',\n\t'bigprofessor.so',\n\t'bigstring.com',\n\t'binkmail.com',\n\t'bio-muesli.net',\n\t'blogmyway.org',\n\t'bobmail.info',\n\t'bofthew.com',\n\t'bootybay.de',\n\t'boun.cr',\n\t'bouncr.com',\n\t'boxformail.in',\n\t'breakthru.com',\n\t'brefmail.com',\n\t'brennendesreich.de',\n\t'broadbandninja.com',\n\t'bsnow.net',\n\t'bspamfree.org',\n\t'bu.mintemail.com',\n\t'buffemail.com',\n\t'bugmenot.com',\n\t'bumpymail.com',\n\t'bund.us',\n\t'bundes-li.ga',\n\t'burnthespam.info',\n\t'burstmail.info',\n\t'buymoreplays.com',\n\t'buyusedlibrarybooks.org',\n\t'byom.de',\n\t'c2.hu',\n\t'cachedot.net',\n\t'card.zp.ua',\n\t'casualdx.com',\n\t'cbair.com',\n\t'cek.pm',\n\t'cellurl.com',\n\t'centermail.com',\n\t'centermail.net',\n\t'chammy.info',\n\t'cheatmail.de',\n\t'childsavetrust.org',\n\t'chogmail.com',\n\t'choicemail1.com',\n\t'chong-mail.com',\n\t'chong-mail.net',\n\t'chong-mail.org',\n\t'clixser.com',\n\t'cmail.com',\n\t'cmail.net',\n\t'cmail.org',\n\t'coldemail.info',\n\t'consumerriot.com',\n\t'cool.fr.nf',\n\t'correo.blogos.net',\n\t'cosmorph.com',\n\t'courriel.fr.nf',\n\t'courrieltemporaire.com',\n\t'crapmail.org',\n\t'crazymailing.com',\n\t'cubiclink.com',\n\t'curryworld.de',\n\t'cust.in',\n\t'cuvox.de',\n\t'd3p.dk',\n\t'dacoolest.com',\n\t'daintly.com',\n\t'dandikmail.com',\n\t'dayrep.com',\n\t'dbunker.com',\n\t'dcemail.com',\n\t'deadaddress.com',\n\t'deadspam.com',\n\t'deagot.com',\n\t'dealja.com',\n\t'delikkt.de',\n\t'despam.it',\n\t'despammed.com',\n\t'devnullmail.com',\n\t'dfgh.net',\n\t'digitalsanctuary.com',\n\t'dingbone.com',\n\t'discard.email',\n\t'discardmail.com',\n\t'discardmail.de',\n\t'disposableaddress.com',\n\t'disposableemailaddresses.com',\n\t'disposableemailaddresses.emailmiser.com',\n\t'disposableinbox.com',\n\t'dispose.it',\n\t'disposeamail.com',\n\t'disposemail.com',\n\t'dispostable.com',\n\t'dlemail.ru',\n\t'dm.w3internet.co.uk',\n\t'dm.w3internet.co.ukexample.com',\n\t'dodgeit.com',\n\t'dodgit.com',\n\t'dodgit.org',\n\t'doiea.com',\n\t'domozmail.com',\n\t'donemail.ru',\n\t'dontreg.com',\n\t'dontsendmespam.de',\n\t'dotmsg.com',\n\t'drdrb.com',\n\t'drdrb.net',\n\t'droplar.com',\n\t'dropmail.me',\n\t'dt.com',\n\t'duam.net',\n\t'dudmail.com',\n\t'dump-email.info',\n\t'dumpandjunk.com',\n\t'dumpmail.de',\n\t'dumpyemail.com',\n\t'duskmail.com',\n\t'e-mail.com',\n\t'e-mail.org',\n\t'e4ward.com',\n\t'easytrashmail.com',\n\t'einmalmail.de',\n\t'einrot.com',\n\t'einrot.de',\n\t'eintagsmail.de',\n\t'email60.com',\n\t'emaildienst.de',\n\t'emailgo.de',\n\t'emailias.com',\n\t'emailigo.de',\n\t'emailinfive.com',\n\t'emaillime.com',\n\t'emailmiser.com',\n\t'emailproxsy.com',\n\t'emailsensei.com',\n\t'emailtemporanea.com',\n\t'emailtemporanea.net',\n\t'emailtemporar.ro',\n\t'emailtemporario.com.br',\n\t'emailthe.net',\n\t'emailtmp.com',\n\t'emailto.de',\n\t'emailwarden.com',\n\t'emailx.at.hm',\n\t'emailxfer.com',\n\t'emeil.in',\n\t'emeil.ir',\n\t'emil.com',\n\t'emz.net',\n\t'enterto.com',\n\t'ephemail.net',\n\t'ero-tube.org',\n\t'etranquil.com',\n\t'etranquil.net',\n\t'etranquil.org',\n\t'evopo.com',\n\t'explodemail.com',\n\t'express.net.ua',\n\t'eyepaste.com',\n\t'fakeinbox.com',\n\t'fakeinformation.com',\n\t'fakemail.fr',\n\t'fakemailz.com',\n\t'fammix.com',\n\t'fansworldwide.de',\n\t'fantasymail.de',\n\t'fastacura.com',\n\t'fastchevy.com',\n\t'fastchrysler.com',\n\t'fastkawasaki.com',\n\t'fastmazda.com',\n\t'fastmitsubishi.com',\n\t'fastnissan.com',\n\t'fastsubaru.com',\n\t'fastsuzuki.com',\n\t'fasttoyota.com',\n\t'fastyamaha.com',\n\t'fatflap.com',\n\t'fdfdsfds.com',\n\t'fightallspam.com',\n\t'figjs.com',\n\t'fiifke.de',\n\t'filzmail.com',\n\t'fivemail.de',\n\t'fixmail.tk',\n\t'fizmail.com',\n\t'fleckens.hu',\n\t'flemail.ru',\n\t'flyspam.com',\n\t'footard.com',\n\t'forgetmail.com',\n\t'fr33mail.info',\n\t'frapmail.com',\n\t'freundin.ru',\n\t'friendlymail.co.uk',\n\t'front14.org',\n\t'fuckingduh.com',\n\t'fudgerub.com',\n\t'fux0ringduh.com',\n\t'fyii.de',\n\t'garliclife.com',\n\t'gehensiemirnichtaufdensack.de',\n\t'gelitik.in',\n\t'get1mail.com',\n\t'get2mail.fr',\n\t'getairmail.com',\n\t'getmails.eu',\n\t'getonemail.com',\n\t'getonemail.net',\n\t'ghosttexter.de',\n\t'giantmail.de',\n\t'girlsundertheinfluence.com',\n\t'gishpuppy.com',\n\t'gmial.com',\n\t'goemailgo.com',\n\t'gorillaswithdirtyarmpits.com',\n\t'gotmail.com',\n\t'gotmail.net',\n\t'gotmail.org',\n\t'gotti.otherinbox.com',\n\t'gowikibooks.com',\n\t'gowikicampus.com',\n\t'gowikicars.com',\n\t'gowikifilms.com',\n\t'gowikigames.com',\n\t'gowikimusic.com',\n\t'gowikimusic.great-host.in',\n\t'gowikinetwork.com',\n\t'gowikitravel.com',\n\t'gowikitv.com',\n\t'grandmamail.com',\n\t'grandmasmail.com',\n\t'great-host.in',\n\t'greensloth.com',\n\t'grr.la',\n\t'gsrv.co.uk',\n\t'guerillamail.biz',\n\t'guerillamail.com',\n\t'guerillamail.net',\n\t'guerillamail.org',\n\t'guerrillamail.biz',\n\t'guerrillamail.com',\n\t'guerrillamail.de',\n\t'guerrillamail.info',\n\t'guerrillamail.net',\n\t'guerrillamail.org',\n\t'guerrillamailblock.com',\n\t'gustr.com',\n\t'h.mintemail.com',\n\t'h8s.org',\n\t'hacccc.com',\n\t'haltospam.com',\n\t'harakirimail.com',\n\t'hartbot.de',\n\t'hat-geld.de',\n\t'hatespam.org',\n\t'hellodream.mobi',\n\t'herp.in',\n\t'hidemail.de',\n\t'hidzz.com',\n\t'hmamail.com',\n\t'hochsitze.com',\n\t'hopemail.biz',\n\t'hotpop.com',\n\t'hulapla.de',\n\t'iaoss.com',\n\t'ieatspam.eu',\n\t'ieatspam.info',\n\t'ieh-mail.de',\n\t'ihateyoualot.info',\n\t'iheartspam.org',\n\t'ikbenspamvrij.nl',\n\t'imails.info',\n\t'imgof.com',\n\t'imstations.com',\n\t'inbax.tk',\n\t'inbox.si',\n\t'inboxalias.com',\n\t'inboxclean.com',\n\t'inboxclean.org',\n\t'inboxproxy.com',\n\t'incognitomail.com',\n\t'incognitomail.net',\n\t'incognitomail.org',\n\t'infocom.zp.ua',\n\t'inoutmail.de',\n\t'inoutmail.eu',\n\t'inoutmail.info',\n\t'inoutmail.net',\n\t'insorg-mail.info',\n\t'instant-mail.de',\n\t'ip6.li',\n\t'ipoo.org',\n\t'irish2me.com',\n\t'iwi.net',\n\t'jamit.com.au',\n\t'jetable.com',\n\t'jetable.fr.nf',\n\t'jetable.net',\n\t'jetable.org',\n\t'jnxjn.com',\n\t'jourrapide.com',\n\t'jsrsolutions.com',\n\t'junk1e.com',\n\t'kasmail.com',\n\t'kaspop.com',\n\t'keepmymail.com',\n\t'killmail.com',\n\t'killmail.net',\n\t'kimsdisk.com',\n\t'kingsq.ga',\n\t'kir.ch.tc',\n\t'klassmaster.com',\n\t'klassmaster.net',\n\t'klzlk.com',\n\t'kook.ml',\n\t'koszmail.pl',\n\t'kulturbetrieb.info',\n\t'kurzepost.de',\n\t'l33r.eu',\n\t'lackmail.net',\n\t'lags.us',\n\t'lawlita.com',\n\t'lazyinbox.com',\n\t'letthemeatspam.com',\n\t'lhsdv.com',\n\t'lifebyfood.com',\n\t'link2mail.net',\n\t'litedrop.com',\n\t'loadby.us',\n\t'login-email.ml',\n\t'lol.ovpn.to',\n\t'lolfreak.net',\n\t'lookugly.com',\n\t'lopl.co.cc',\n\t'lortemail.dk',\n\t'lovemeleaveme.com',\n\t'lr78.com',\n\t'lroid.com',\n\t'lukop.dk',\n\t'm21.cc',\n\t'm4ilweb.info',\n\t'maboard.com',\n\t'mail-filter.com',\n\t'mail-temporaire.fr',\n\t'mail.by',\n\t'mail.mezimages.net',\n\t'mail.zp.ua',\n\t'mail114.net',\n\t'mail1a.de',\n\t'mail21.cc',\n\t'mail2rss.org',\n\t'mail333.com',\n\t'mail4trash.com',\n\t'mailbidon.com',\n\t'mailbiz.biz',\n\t'mailblocks.com',\n\t'mailbucket.org',\n\t'mailcat.biz',\n\t'mailcatch.com',\n\t'mailde.de',\n\t'mailde.info',\n\t'maildrop.cc',\n\t'maildx.com',\n\t'maileater.com',\n\t'mailed.ro',\n\t'maileimer.de',\n\t'mailexpire.com',\n\t'mailfa.tk',\n\t'mailforspam.com',\n\t'mailfreeonline.com',\n\t'mailfs.com',\n\t'mailguard.me',\n\t'mailimate.com',\n\t'mailin8r.com',\n\t'mailinater.com',\n\t'mailinator.com',\n\t'mailinator.net',\n\t'mailinator.org',\n\t'mailinator.us',\n\t'mailinator2.com',\n\t'mailincubator.com',\n\t'mailismagic.com',\n\t'mailmate.com',\n\t'mailme.ir',\n\t'mailme.lv',\n\t'mailme24.com',\n\t'mailmetrash.com',\n\t'mailmetrash.comilzilla.org',\n\t'mailmoat.com',\n\t'mailms.com',\n\t'mailnator.com',\n\t'mailnesia.com',\n\t'mailnull.com',\n\t'mailorg.org',\n\t'mailpick.biz',\n\t'mailproxsy.com',\n\t'mailquack.com',\n\t'mailrock.biz',\n\t'mailscrap.com',\n\t'mailshell.com',\n\t'mailsiphon.com',\n\t'mailslapping.com',\n\t'mailslite.com',\n\t'mailtemp.info',\n\t'mailtome.de',\n\t'mailtothis.com',\n\t'mailtrash.net',\n\t'mailtv.net',\n\t'mailtv.tv',\n\t'mailzilla.com',\n\t'mailzilla.org',\n\t'mailzilla.orgmbx.cc',\n\t'makemetheking.com',\n\t'manifestgenerator.com',\n\t'manybrain.com',\n\t'mbx.cc',\n\t'mega.zik.dj',\n\t'meinspamschutz.de',\n\t'meltmail.com',\n\t'messagebeamer.de',\n\t'mezimages.net',\n\t'mierdamail.com',\n\t'migumail.com',\n\t'ministry-of-silly-walks.de',\n\t'mintemail.com',\n\t'misterpinball.de',\n\t'mjukglass.nu',\n\t'mmailinater.com',\n\t'moakt.com',\n\t'mobi.web.id',\n\t'mobileninja.co.uk',\n\t'moburl.com',\n\t'mohmal.com',\n\t'moncourrier.fr.nf',\n\t'monemail.fr.nf',\n\t'monmail.fr.nf',\n\t'monumentmail.com',\n\t'msa.minsmail.com',\n\t'mt2009.com',\n\t'mt2014.com',\n\t'mx0.wwwnew.eu',\n\t'my10minutemail.com',\n\t'mycard.net.ua',\n\t'mycleaninbox.net',\n\t'myemailboxy.com',\n\t'mymail-in.net',\n\t'mymailoasis.com',\n\t'mynetstore.de',\n\t'mypacks.net',\n\t'mypartyclip.de',\n\t'myphantomemail.com',\n\t'mysamp.de',\n\t'myspaceinc.com',\n\t'myspaceinc.net',\n\t'myspaceinc.org',\n\t'myspacepimpedup.com',\n\t'myspamless.com',\n\t'mytemp.email',\n\t'mytempemail.com',\n\t'mytempmail.com',\n\t'mytrashmail.com',\n\t'nabuma.com',\n\t'neomailbox.com',\n\t'nepwk.com',\n\t'nervmich.net',\n\t'nervtmich.net',\n\t'netmails.com',\n\t'netmails.net',\n\t'netzidiot.de',\n\t'neverbox.com',\n\t'nice-4u.com',\n\t'nincsmail.com',\n\t'nincsmail.hu',\n\t'nnh.com',\n\t'no-spam.ws',\n\t'noblepioneer.com',\n\t'nobulk.com',\n\t'noclickemail.com',\n\t'nogmailspam.info',\n\t'nomail.pw',\n\t'nomail.xl.cx',\n\t'nomail2me.com',\n\t'nomorespamemails.com',\n\t'nonspam.eu',\n\t'nonspammer.de',\n\t'noref.in',\n\t'nospam.ze.tc',\n\t'nospam4.us',\n\t'nospamfor.us',\n\t'nospammail.net',\n\t'nospamthanks.info',\n\t'notmailinator.com',\n\t'notsharingmy.info',\n\t'nowhere.org',\n\t'nowmymail.com',\n\t'nurfuerspam.de',\n\t'nus.edu.sg',\n\t'nwldx.com',\n\t'objectmail.com',\n\t'obobbo.com',\n\t'odaymail.com',\n\t'odnorazovoe.ru',\n\t'one-time.email',\n\t'oneoffemail.com',\n\t'oneoffmail.com',\n\t'onewaymail.com',\n\t'onlatedotcom.info',\n\t'online.ms',\n\t'oopi.org',\n\t'opayq.com',\n\t'ordinaryamerican.net',\n\t'otherinbox.codupmyspace.com',\n\t'otherinbox.com',\n\t'ourklips.com',\n\t'outlawspam.com',\n\t'ovpn.to',\n\t'owlpic.com',\n\t'pancakemail.com',\n\t'paplease.com',\n\t'pcusers.otherinbox.com',\n\t'pepbot.com',\n\t'pfui.ru',\n\t'pimpedupmyspace.com',\n\t'pjjkp.com',\n\t'plexolan.de',\n\t'poczta.onet.pl',\n\t'politikerclub.de',\n\t'pooae.com',\n\t'poofy.org',\n\t'pookmail.com',\n\t'privacy.net',\n\t'privatdemail.net',\n\t'privy-mail.com',\n\t'privymail.de',\n\t'proxymail.eu',\n\t'prtnx.com',\n\t'prtz.eu',\n\t'punkass.com',\n\t'putthisinyourspamdatabase.com',\n\t'pwrby.com',\n\t'quickinbox.com',\n\t'quickmail.nl',\n\t'rcpt.at',\n\t'reallymymail.com',\n\t'realtyalerts.ca',\n\t'recode.me',\n\t'recursor.net',\n\t'recyclemail.dk',\n\t'regbypass.com',\n\t'regbypass.comsafe-mail.net',\n\t'rejectmail.com',\n\t'reliable-mail.com',\n\t'rhyta.com',\n\t'rklips.com',\n\t'rmqkr.net',\n\t'royal.net',\n\t'rppkn.com',\n\t'rtrtr.com',\n\t's0ny.net',\n\t'safe-mail.net',\n\t'safersignup.de',\n\t'safetymail.info',\n\t'safetypost.de',\n\t'sandelf.de',\n\t'saynotospams.com',\n\t'schafmail.de',\n\t'schrott-email.de',\n\t'secretemail.de',\n\t'secure-mail.biz',\n\t'selfdestructingmail.com',\n\t'selfdestructingmail.org',\n\t'sendspamhere.com',\n\t'sendspamhere.com',\n\t'senseless-entertainment.com',\n\t'services391.com',\n\t'sharedmailbox.org',\n\t'sharklasers.com',\n\t'shieldedmail.com',\n\t'shieldemail.com',\n\t'shiftmail.com',\n\t'shitmail.me',\n\t'shitmail.org',\n\t'shitware.nl',\n\t'shmeriously.com',\n\t'shortmail.net',\n\t'shotmail.ru',\n\t'showslow.de',\n\t'sibmail.com',\n\t'sinnlos-mail.de',\n\t'siteposter.net',\n\t'skeefmail.com',\n\t'slapsfromlastnight.com',\n\t'slaskpost.se',\n\t'slipry.net',\n\t'slopsbox.com',\n\t'slushmail.com',\n\t'smashmail.de',\n\t'smellfear.com',\n\t'smellrear.com',\n\t'snakemail.com',\n\t'sneakemail.com',\n\t'sneakmail.de',\n\t'snkmail.com',\n\t'sofimail.com',\n\t'sofort-mail.de',\n\t'softpls.asia',\n\t'sogetthis.com',\n\t'sohu.com',\n\t'solvemail.info',\n\t'soodonims.com',\n\t'spa.com',\n\t'spaereplease.com',\n\t'spam.la',\n\t'spam.su',\n\t'spam4.me',\n\t'spamail.de',\n\t'spamarrest.com',\n\t'spamavert.com',\n\t'spambob.com',\n\t'spambob.net',\n\t'spambob.org',\n\t'spambog.com',\n\t'spambog.de',\n\t'spambog.net',\n\t'spambog.ru',\n\t'spambox.info',\n\t'spambox.irishspringrealty.com',\n\t'spambox.us',\n\t'spamcannon.com',\n\t'spamcannon.net',\n\t'spamcero.com',\n\t'spamcon.org',\n\t'spamcorptastic.com',\n\t'spamcowboy.com',\n\t'spamcowboy.net',\n\t'spamcowboy.org',\n\t'spamday.com',\n\t'spamex.com',\n\t'spamfree.eu',\n\t'spamfree24.com',\n\t'spamfree24.de',\n\t'spamfree24.eu',\n\t'spamfree24.info',\n\t'spamfree24.net',\n\t'spamfree24.org',\n\t'spamgoes.in',\n\t'spamgourmet.com',\n\t'spamgourmet.net',\n\t'spamgourmet.org',\n\t'spamherelots.com',\n\t'spamhereplease.com',\n\t'spamhole.com',\n\t'spamify.com',\n\t'spaminator.de',\n\t'spamkill.info',\n\t'spaml.com',\n\t'spaml.de',\n\t'spammotel.com',\n\t'spamobox.com',\n\t'spamoff.de',\n\t'spamsalad.in',\n\t'spamslicer.com',\n\t'spamspot.com',\n\t'spamstack.net',\n\t'spamthis.co.uk',\n\t'spamthisplease.com',\n\t'spamtrail.com',\n\t'spamtroll.net',\n\t'speed.1s.fr',\n\t'spikio.com',\n\t'spoofmail.de',\n\t'squizzy.de',\n\t'ssoia.com',\n\t'startkeys.com',\n\t'stinkefinger.net',\n\t'stop-my-spam.com',\n\t'stuffmail.de',\n\t'super-auswahl.de',\n\t'supergreatmail.com',\n\t'supermailer.jp',\n\t'superrito.com',\n\t'superstachel.de',\n\t'suremail.info',\n\t'svk.jp',\n\t'sweetxxx.de',\n\t'tagyourself.com',\n\t'talkinator.com',\n\t'tapchicuoihoi.com',\n\t'teewars.org',\n\t'teleosaurs.xyz',\n\t'teleworm.com',\n\t'teleworm.us',\n\t'temp-mail.org',\n\t'temp-mail.ru',\n\t'temp.emeraldwebmail.com',\n\t'temp.headstrong.de',\n\t'tempalias.com',\n\t'tempe-mail.com',\n\t'tempemail.biz',\n\t'tempemail.co.za',\n\t'tempemail.com',\n\t'tempemail.net',\n\t'tempemail.net',\n\t'tempinbox.co.uk',\n\t'tempinbox.com',\n\t'tempmail.eu',\n\t'tempmail.it',\n\t'tempmail2.com',\n\t'tempmaildemo.com',\n\t'tempmailer.com',\n\t'tempmailer.de',\n\t'tempomail.fr',\n\t'temporarily.de',\n\t'temporarioemail.com.br',\n\t'temporaryemail.net',\n\t'temporaryemail.us',\n\t'temporaryforwarding.com',\n\t'temporaryinbox.com',\n\t'temporarymailaddress.com',\n\t'tempsky.com',\n\t'tempthe.net',\n\t'tempymail.com',\n\t'thanksnospam.info',\n\t'thankyou2010.com',\n\t'thc.st',\n\t'thecloudindex.com',\n\t'thelimestones.com',\n\t'thisisnotmyrealemail.com',\n\t'thismail.net',\n\t'thrma.com',\n\t'throwawayemailaddress.com',\n\t'tilien.com',\n\t'tittbit.in',\n\t'tizi.com',\n\t'tmail.ws',\n\t'tmailinator.com',\n\t'toiea.com',\n\t'toomail.biz',\n\t'topranklist.de',\n\t'tradermail.info',\n\t'trash-amil.com',\n\t'trash-mail.at',\n\t'trash-mail.com',\n\t'trash-mail.de',\n\t'trash2009.com',\n\t'trash2010.com',\n\t'trash2011.com',\n\t'trashdevil.com',\n\t'trashdevil.de',\n\t'trashemail.de',\n\t'trashmail.at',\n\t'trashmail.com',\n\t'trashmail.de',\n\t'trashmail.me',\n\t'trashmail.net',\n\t'trashmail.org',\n\t'trashmail.ws',\n\t'trashmailer.com',\n\t'trashymail.com',\n\t'trashymail.net',\n\t'trbvm.com',\n\t'trbvn.com',\n\t'trialmail.de',\n\t'trillianpro.com',\n\t'tryalert.com',\n\t'turual.com',\n\t'twinmail.de',\n\t'twoweirdtricks.com',\n\t'tyldd.com',\n\t'uggsrock.com',\n\t'umail.net',\n\t'upliftnow.com',\n\t'uplipht.com',\n\t'uroid.com',\n\t'us.af',\n\t'username.e4ward.com',\n\t'venompen.com',\n\t'veryrealemail.com',\n\t'vidchart.com',\n\t'viditag.com',\n\t'viewcastmedia.com',\n\t'viewcastmedia.net',\n\t'viewcastmedia.org',\n\t'viewcastmediae',\n\t'viralplays.com',\n\t'vkcode.ru',\n\t'vomoto.com',\n\t'vpn.st',\n\t'vsimcard.com',\n\t'vubby.com',\n\t'walala.org',\n\t'walkmail.net',\n\t'walkmail.ru',\n\t'wasteland.rfc822.org',\n\t'webemail.me',\n\t'webm4il.info',\n\t'webuser.in',\n\t'wee.my',\n\t'weg-werf-email.de',\n\t'wegwerf-email-addressen.de',\n\t'wegwerf-emails.de',\n\t'wegwerfadresse.de',\n\t'wegwerfemail.com',\n\t'wegwerfemail.de',\n\t'wegwerfmail.de',\n\t'wegwerfmail.info',\n\t'wegwerfmail.net',\n\t'wegwerfmail.org',\n\t'wetrainbayarea.com',\n\t'wetrainbayarea.org',\n\t'wh4f.org',\n\t'whatiaas.com',\n\t'whatpaas.com',\n\t'whatsaas.com',\n\t'whopy.com',\n\t'whtjddn.33mail.com',\n\t'whyspam.me',\n\t'wilemail.com',\n\t'willhackforfood.biz',\n\t'willselfdestruct.com',\n\t'winemaven.info',\n\t'wronghead.com',\n\t'wuzup.net',\n\t'wuzupmail.net',\n\t'www.e4ward.com',\n\t'www.gishpuppy.com',\n\t'www.mailinator.com',\n\t'wwwnew.eu',\n\t'x.ip6.li',\n\t'xagloo.com',\n\t'xemaps.com',\n\t'xents.com',\n\t'xmaily.com',\n\t'xoxy.net',\n\t'xyzfree.net',\n\t'yapped.net',\n\t'yeah.net',\n\t'yep.it',\n\t'yogamaven.com',\n\t'yomail.info',\n\t'yopmail.com',\n\t'yopmail.fr',\n\t'yopmail.net',\n\t'yourdomain.com',\n\t'ypmail.webarnak.fr.eu.org',\n\t'yuurok.com',\n\t'z1p.biz',\n\t'za.com',\n\t'zehnminuten.de',\n\t'zehnminutenmail.de',\n\t'zetmail.com',\n\t'zippymail.info',\n\t'zoaxe.com',\n\t'zoemail.com',\n\t'zoemail.net',\n\t'zoemail.org',\n\t'zomg.info',\n\t'zxcv.com',\n\t'zxcvbnm.com',\n\t'zzz.com'\n];\n\n","import moment from 'moment';\n\nRocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited and increments it if the edit was way in the past (aka imported)\n\tif (message.editedAt && Math.abs(moment(message.editedAt).diff()) > 60000) {\n\t\t//TODO: Review as I am not sure how else to get around this as the incrementing of the msgs count shouldn't be in this callback\n\t\tRocketChat.models.Rooms.incMsgCountById(message.rid, 1);\n\t\treturn message;\n\t} else if (message.editedAt) {\n\t\t// skips this callback if the message was edited\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\tRocketChat.models.Rooms.incMsgCountById(message.rid, 1);\n\t\treturn message;\n\t}\n\n\t/**\n\t * Chechs if a messages contains a user highlight\n\t *\n\t * @param {string} message\n\t * @param {array|undefined} highlights\n\t *\n\t * @returns {boolean}\n     */\n\tfunction messageContainsHighlight(message, highlights) {\n\t\tif (! highlights || highlights.length === 0) { return false; }\n\n\t\tlet has = false;\n\t\thighlights.some(function(highlight) {\n\t\t\tconst regexp = new RegExp(s.escapeRegExp(highlight), 'i');\n\t\t\tif (regexp.test(message.msg)) {\n\t\t\t\thas = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\treturn has;\n\t}\n\n\tif (room.t != null && room.t === 'd') {\n\t\t// Update the other subscriptions\n\t\tRocketChat.models.Subscriptions.incUnreadOfDirectForRoomIdExcludingUserId(message.rid, message.u._id, 1);\n\t} else {\n\t\tlet toAll = false;\n\t\tconst mentionIds = [];\n\t\tconst highlightsIds = [];\n\t\tconst highlights = RocketChat.models.Users.findUsersByUsernamesWithHighlights(room.usernames, { fields: { '_id': 1, 'settings.preferences.highlights': 1 }}).fetch();\n\n\t\tif (message.mentions != null) {\n\t\t\tmessage.mentions.forEach(function(mention) {\n\t\t\t\tif (!toAll && mention._id === 'all') {\n\t\t\t\t\ttoAll = true;\n\t\t\t\t}\n\t\t\t\tif (mention._id !== message.u._id) {\n\t\t\t\t\tmentionIds.push(mention._id);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\thighlights.forEach(function(user) {\n\t\t\tif (user && user.settings && user.settings.preferences && messageContainsHighlight(message, user.settings.preferences.highlights)) {\n\t\t\t\tif (user._id !== message.u._id) {\n\t\t\t\t\thighlightsIds.push(user._id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (toAll) {\n\t\t\tRocketChat.models.Subscriptions.incUnreadForRoomIdExcludingUserId(room._id, message.u._id);\n\t\t} else if ((mentionIds && mentionIds.length > 0) || (highlightsIds && highlightsIds.length > 0)) {\n\t\t\tRocketChat.models.Subscriptions.incUnreadForRoomIdAndUserIds(room._id, _.compact(_.unique(mentionIds.concat(highlightsIds))));\n\t\t}\n\t}\n\n\t// Update all the room activity tracker fields\n\tRocketChat.models.Rooms.incMsgCountAndSetLastMessageTimestampById(message.rid, 1, message.ts);\n\n\t// Update all other subscriptions to alert their owners but witout incrementing\n\t// the unread counter, as it is only for mentions and direct messages\n\tRocketChat.models.Subscriptions.setAlertForRoomIdExcludingUserId(message.rid, message.u._id);\n\n\treturn message;\n\n}, RocketChat.callbacks.priority.LOW, 'notifyUsersOnMessage');\n","/* globals roomTypesCommon*/\nRocketChat.roomTypes = new class roomTypesServer extends roomTypesCommon {\n\t/* add a publish for a room type\n\t@param roomType: room type (e.g.: c (for channels), d (for direct channels))\n\t@param callback: function that will return the publish's data\n\t*/\n\n\tsetPublish(roomType, callback) {\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].publish != null) {\n\t\t\tthrow new Meteor.Error('route-publish-exists', 'Publish for the given type already exists');\n\t\t}\n\t\tif (this.roomTypes[roomType] == null) {\n\t\t\tthis.roomTypes[roomType] = {};\n\t\t}\n\t\treturn this.roomTypes[roomType].publish = callback;\n\t}\n\n\tsetRoomFind(roomType, callback) {\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].roomFind != null) {\n\t\t\tthrow new Meteor.Error('room-find-exists', 'Room find for the given type already exists');\n\t\t}\n\t\tif (this.roomTypes[roomType] == null) {\n\t\t\tthis.roomTypes[roomType] = {};\n\t\t}\n\t\treturn this.roomTypes[roomType].roomFind = callback;\n\t}\n\tgetRoomFind(roomType) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].roomFind;\n\t}\n\n\n\t/* run the publish for a room type\n\t@param scope: Meteor publish scope\n\t@param roomType: room type (e.g.: c (for channels), d (for direct channels))\n\t@param identifier: identifier of the room\n\t*/\n\n\trunPublish(scope, roomType, identifier) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].publish && this.roomTypes[roomType].publish.call(scope, identifier);\n\t}\n\n};\n","import moment from 'moment';\n\nRocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\treturn message;\n\t}\n\n\tlet emailSubject;\n\tconst usersToSendEmail = {};\n\tconst directMessage = room.t === 'd';\n\n\tif (directMessage) {\n\t\tusersToSendEmail[message.rid.replace(message.u._id, '')] = 1;\n\n\t\temailSubject = TAPi18n.__('Offline_DM_Email', {\n\t\t\tuser: message.u.username\n\t\t});\n\n\t} else {\n\t\tif (message.mentions) {\n\t\t\tmessage.mentions.forEach(function(mention) {\n\t\t\t\tusersToSendEmail[mention._id] = 1;\n\t\t\t});\n\t\t}\n\n\t\temailSubject = TAPi18n.__('Offline_Mention_Email', {\n\t\t\tuser: message.u.username,\n\t\t\troom: room.name\n\t\t});\n\t}\n\n\tconst getMessageLink = (room, sub) => {\n\t\tconst roomPath = RocketChat.roomTypes.getRouteLink(room.t, sub);\n\t\tconst path = Meteor.absoluteUrl(roomPath ? roomPath.replace(/^\\//, '') : '');\n\t\tconst style = [\n\t\t\t'color: #fff;',\n\t\t\t'padding: 9px 12px;',\n\t\t\t'border-radius: 4px;',\n\t\t\t'background-color: #04436a;',\n\t\t\t'text-decoration: none;'\n\t\t].join(' ');\n\t\tconst message = TAPi18n.__('Offline_Link_Message');\n\t\treturn `<p style=\"text-align:center;margin-bottom:8px;\"><a style=\"${ style }\" href=\"${ path }\">${ message }</a>`;\n\t};\n\n\tconst divisorMessage = '<hr style=\"margin: 20px auto; border: none; border-bottom: 1px solid #dddddd;\">';\n\tlet messageHTML = s.escapeHTML(message.msg);\n\n\tmessage = RocketChat.callbacks.run('renderMessage', message);\n\tif (message.tokens && message.tokens.length > 0) {\n\t\tmessage.tokens.forEach((token) => {\n\t\t\ttoken.text = token.text.replace(/([^\\$])(\\$[^\\$])/gm, '$1$$$2');\n\t\t\tmessageHTML = messageHTML.replace(token.token, token.text);\n\t\t});\n\t}\n\n\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\tmessageHTML = messageHTML.replace(/\\n/gm, '<br/>');\n\n\tRocketChat.models.Subscriptions.findWithSendEmailByRoomId(room._id).forEach((sub) => {\n\t\tif (sub.disableNotifications) {\n\t\t\tdelete usersToSendEmail[sub.u._id];\n\t\t} else {\n\t\t\tswitch (sub.emailNotifications) {\n\t\t\t\tcase 'all':\n\t\t\t\t\tusersToSendEmail[sub.u._id] = 'force';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'mentions':\n\t\t\t\t\tif (usersToSendEmail[sub.u._id]) {\n\t\t\t\t\t\tusersToSendEmail[sub.u._id] = 'force';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'nothing':\n\t\t\t\t\tdelete usersToSendEmail[sub.u._id];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'default':\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n\n\tconst userIdsToSendEmail = Object.keys(usersToSendEmail);\n\n\tlet defaultLink;\n\n\tconst linkByUser = {};\n\tif (RocketChat.roomTypes.hasCustomLink(room.t)) {\n\t\tRocketChat.models.Subscriptions.findByRoomIdAndUserIds(room._id, userIdsToSendEmail).forEach((sub) => {\n\t\t\tlinkByUser[sub.u._id] = getMessageLink(room, sub);\n\t\t});\n\t} else {\n\t\tdefaultLink = getMessageLink(room, { name: room.name });\n\t}\n\n\tif (userIdsToSendEmail.length > 0) {\n\t\tconst usersOfMention = RocketChat.models.Users.getUsersToSendOfflineEmail(userIdsToSendEmail).fetch();\n\n\t\tif (usersOfMention && usersOfMention.length > 0) {\n\t\t\tconst siteName = RocketChat.settings.get('Site_Name');\n\n\t\t\tusersOfMention.forEach((user) => {\n\t\t\t\tif (user.settings && user.settings.preferences && user.settings.preferences.emailNotificationMode && user.settings.preferences.emailNotificationMode === 'disabled' && usersToSendEmail[user._id] !== 'force') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Checks if user is in the room he/she is mentioned (unless it's public channel)\n\t\t\t\tif (room.t !== 'c' && room.usernames.indexOf(user.username) === -1) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tuser.emails.some((email) => {\n\t\t\t\t\tif (email.verified) {\n\t\t\t\t\t\temail = {\n\t\t\t\t\t\t\tto: email.address,\n\t\t\t\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\t\t\t\tsubject: `[${ siteName }] ${ emailSubject }`,\n\t\t\t\t\t\t\thtml: header + messageHTML + divisorMessage + (linkByUser[user._id] || defaultLink) + footer\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tMeteor.defer(() => {\n\t\t\t\t\t\t\tEmail.send(email);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\treturn message;\n\n}, RocketChat.callbacks.priority.LOW, 'sendEmailOnMessage');\n","/* globals Push */\nimport moment from 'moment';\n\nRocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\treturn message;\n\t}\n\n\tconst user = RocketChat.models.Users.findOneById(message.u._id);\n\n\t/*\n\tIncrement unread couter if direct messages\n\t */\n\tconst settings = {};\n\n\t/**\n\t * Checks if a given user can be notified\n\t *\n\t * @param {string} id\n\t * @param {string} type - mobile|desktop\n\t *\n\t * @returns {boolean}\n     */\n\tfunction canBeNotified(id, type) {\n\t\tconst types = {\n\t\t\tmobile: [ 'dontNotifyDesktopUsers', 'alwaysNotifyDesktopUsers' ],\n\t\t\tdesktop: [ 'dontNotifyMobileUsers', 'alwaysNotifyMobileUsers' ]\n\t\t};\n\n\t\treturn (settings[types[type][0]].indexOf(id) === -1 || settings[types[type][1]].indexOf(id) !== -1);\n\t}\n\n\t/**\n\t * Checks if a message contains a user highlight\n\t *\n\t * @param {string} message\n\t * @param {array|undefined} highlights\n\t *\n\t * @returns {boolean}\n\t */\n\tfunction messageContainsHighlight(message, highlights) {\n\t\tif (! highlights || highlights.length === 0) { return false; }\n\n\t\tlet has = false;\n\t\thighlights.some(function(highlight) {\n\t\t\tconst regexp = new RegExp(s.escapeRegExp(highlight), 'i');\n\t\t\tif (regexp.test(message.msg)) {\n\t\t\t\thas = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\treturn has;\n\t}\n\n\tsettings.alwaysNotifyDesktopUsers = [];\n\tsettings.dontNotifyDesktopUsers = [];\n\tsettings.alwaysNotifyMobileUsers = [];\n\tsettings.dontNotifyMobileUsers = [];\n\tsettings.desktopNotificationDurations = {};\n\n\tconst notificationPreferencesByRoom = RocketChat.models.Subscriptions.findNotificationPreferencesByRoom(room._id);\n\tnotificationPreferencesByRoom.forEach(function(subscription) {\n\t\tif (subscription.disableNotifications) {\n\t\t\tsettings.dontNotifyDesktopUsers.push(subscription.u._id);\n\t\t\tsettings.dontNotifyMobileUsers.push(subscription.u._id);\n\t\t} else {\n\t\t\tif (subscription.desktopNotifications === 'all') {\n\t\t\t\tsettings.alwaysNotifyDesktopUsers.push(subscription.u._id);\n\t\t\t} else if (subscription.desktopNotifications === 'nothing') {\n\t\t\t\tsettings.dontNotifyDesktopUsers.push(subscription.u._id);\n\t\t\t}\n\t\t\tif (subscription.mobilePushNotifications === 'all') {\n\t\t\t\tsettings.alwaysNotifyMobileUsers.push(subscription.u._id);\n\t\t\t} else if (subscription.mobilePushNotifications === 'nothing') {\n\t\t\t\tsettings.dontNotifyMobileUsers.push(subscription.u._id);\n\t\t\t}\n\t\t}\n\t\tsettings.desktopNotificationDurations[subscription.u._id] = subscription.desktopNotificationDuration;\n\t});\n\n\tlet userIdsToNotify = [];\n\tlet userIdsToPushNotify = [];\n\tconst usersWithHighlights = [];\n\n\tconst highlights = RocketChat.models.Users.findUsersByUsernamesWithHighlights(room.usernames, { fields: { '_id': 1, 'settings.preferences.highlights': 1 }}).fetch();\n\n\thighlights.forEach(function(user) {\n\t\tif (messageContainsHighlight(message, user.settings.preferences.highlights)) {\n\t\t\tusersWithHighlights.push(user);\n\t\t}\n\t});\n\n\tlet push_message;\n\t//Set variables depending on Push Notification settings\n\tif (RocketChat.settings.get('Push_show_message')) {\n\t\tpush_message = message.msg;\n\t} else {\n\t\tpush_message = ' ';\n\t}\n\n\tlet push_username;\n\tlet push_room;\n\tif (RocketChat.settings.get('Push_show_username_room')) {\n\t\tpush_username = user.username;\n\t\tpush_room = `#${ room.name }`;\n\t} else {\n\t\tpush_username = '';\n\t\tpush_room = '';\n\t}\n\n\tif (room.t == null || room.t === 'd') {\n\t\tconst userOfMentionId = message.rid.replace(message.u._id, '');\n\t\tconst userOfMention = RocketChat.models.Users.findOne({\n\t\t\t_id: userOfMentionId\n\t\t}, {\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\tstatusConnection: 1\n\t\t\t}\n\t\t});\n\n\t\t// Always notify Sandstorm\n\t\tif (userOfMention != null) {\n\t\t\tRocketChat.Sandstorm.notify(message, [userOfMention._id],\n\t\t\t\t`@${ user.username }: ${ message.msg }`, 'privateMessage');\n\n\t\t}\n\t\tif ((userOfMention != null) && canBeNotified(userOfMentionId, 'mobile')) {\n\t\t\tRocketChat.Notifications.notifyUser(userOfMention._id, 'notification', {\n\t\t\t\ttitle: RocketChat.settings.get('UI_Use_Real_Name') ? user.name : `@${ user.username }`,\n\t\t\t\ttext: message.msg,\n\t\t\t\tduration: settings.desktopNotificationDurations[userOfMention._id],\n\t\t\t\tpayload: {\n\t\t\t\t\t_id: message._id,\n\t\t\t\t\trid: message.rid,\n\t\t\t\t\tsender: message.u,\n\t\t\t\t\ttype: room.t,\n\t\t\t\t\tname: room.name\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif ((userOfMention != null) && canBeNotified(userOfMentionId, 'desktop')) {\n\t\t\tif (Push.enabled === true && userOfMention.statusConnection !== 'online') {\n\t\t\t\tRocketChat.PushNotification.send({\n\t\t\t\t\troomId: message.rid,\n\t\t\t\t\tusername: push_username,\n\t\t\t\t\tmessage: push_message,\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\thost: Meteor.absoluteUrl(),\n\t\t\t\t\t\trid: message.rid,\n\t\t\t\t\t\tsender: message.u,\n\t\t\t\t\t\ttype: room.t,\n\t\t\t\t\t\tname: room.name\n\t\t\t\t\t},\n\t\t\t\t\tusersTo: {\n\t\t\t\t\t\tuserId: userOfMention._id\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn message;\n\t\t\t}\n\t\t}\n\n\t} else {\n\t\tconst mentionIds = [];\n\t\tif (message.mentions != null) {\n\t\t\tmessage.mentions.forEach(function(mention) {\n\t\t\t\treturn mentionIds.push(mention._id);\n\t\t\t});\n\t\t}\n\t\tconst toAll = mentionIds.indexOf('all') > -1;\n\t\tconst toHere = mentionIds.indexOf('here') > -1;\n\t\tif (mentionIds.length > 0 || settings.alwaysNotifyDesktopUsers.length > 0) {\n\t\t\tlet desktopMentionIds = _.union(mentionIds, settings.alwaysNotifyDesktopUsers);\n\t\t\tdesktopMentionIds = _.difference(desktopMentionIds, settings.dontNotifyDesktopUsers);\n\n\t\t\tlet usersOfDesktopMentions = RocketChat.models.Users.find({\n\t\t\t\t_id: {\n\t\t\t\t\t$in: desktopMentionIds\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tfields: {\n\t\t\t\t\t_id: 1,\n\t\t\t\t\tusername: 1,\n\t\t\t\t\tactive: 1\n\t\t\t\t}\n\t\t\t}).fetch();\n\t\t\tif (room.t === 'c' && !toAll) {\n\t\t\t\tconst callJoin = function(usersOfMentionItem) {\n\t\t\t\t\tif (usersOfMentionItem.active) {\n\t\t\t\t\t\tMeteor.runAsUser(usersOfMentionItem._id, function() {\n\t\t\t\t\t\t\treturn Meteor.call('joinRoom', room._id);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tfor (const usersOfMentionItem of usersOfDesktopMentions) {\n\t\t\t\t\tif (room.usernames.indexOf(usersOfMentionItem.username) === -1) {\n\t\t\t\t\t\tcallJoin(usersOfMentionItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (room.t !== 'c') {\n\t\t\t\tusersOfDesktopMentions = _.reject(usersOfDesktopMentions, (usersOfMentionItem) => {\n\t\t\t\t\treturn room.usernames.indexOf(usersOfMentionItem.username) === -1;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tuserIdsToNotify = _.pluck(usersOfDesktopMentions, '_id');\n\t\t}\n\n\t\tif (mentionIds.length > 0 || settings.alwaysNotifyMobileUsers.length > 0) {\n\t\t\tlet mobileMentionIds = _.union(mentionIds, settings.alwaysNotifyMobileUsers);\n\t\t\tmobileMentionIds = _.difference(mobileMentionIds, settings.dontNotifyMobileUsers);\n\n\t\t\tlet usersOfMobileMentions = RocketChat.models.Users.find({\n\t\t\t\t_id: {\n\t\t\t\t\t$in: mobileMentionIds\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tfields: {\n\t\t\t\t\t_id: 1,\n\t\t\t\t\tusername: 1,\n\t\t\t\t\tstatusConnection: 1\n\t\t\t\t}\n\t\t\t}).fetch();\n\n\t\t\tif (room.t !== 'c') {\n\t\t\t\tusersOfMobileMentions = _.reject(usersOfMobileMentions, (usersOfMentionItem) => {\n\t\t\t\t\treturn room.usernames.indexOf(usersOfMentionItem.username) === -1;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tuserIdsToPushNotify = _.pluck(_.filter(usersOfMobileMentions, function(user) {\n\t\t\t\treturn user.statusConnection !== 'online';\n\t\t\t}), '_id');\n\t\t}\n\n\t\tif ((toAll || toHere) && room.usernames && room.usernames.length > 0) {\n\t\t\tRocketChat.models.Users.find({\n\t\t\t\tusername: {\n\t\t\t\t\t$in: room.usernames\n\t\t\t\t},\n\t\t\t\t_id: {\n\t\t\t\t\t$ne: user._id\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tfields: {\n\t\t\t\t\t_id: 1,\n\t\t\t\t\tusername: 1,\n\t\t\t\t\tstatus: 1,\n\t\t\t\t\tstatusConnection: 1\n\t\t\t\t}\n\t\t\t}).forEach(function(user) {\n\t\t\t\tif (['online', 'away', 'busy'].includes(user.status) && (settings.dontNotifyDesktopUsers || []).includes(user._id) === false) {\n\t\t\t\t\tuserIdsToNotify.push(user._id);\n\t\t\t\t}\n\t\t\t\tif (toAll && user.statusConnection !== 'online' && (settings.dontNotifyMobileUsers || []).includes(user._id) === false) {\n\t\t\t\t\treturn userIdsToPushNotify.push(user._id);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (usersWithHighlights.length > 0) {\n\t\t\tconst highlightsIds = _.pluck(usersWithHighlights, '_id');\n\t\t\tuserIdsToNotify = userIdsToNotify.concat(highlightsIds);\n\t\t\tuserIdsToPushNotify = userIdsToPushNotify.concat(highlightsIds);\n\t\t}\n\n\t\tuserIdsToNotify = _.without(_.compact(_.unique(userIdsToNotify)), message.u._id);\n\t\tuserIdsToPushNotify = _.without(_.compact(_.unique(userIdsToPushNotify)), message.u._id);\n\n\t\tif (userIdsToNotify.length > 0) {\n\t\t\tfor (const usersOfMentionId of userIdsToNotify) {\n\t\t\t\tlet title = `@${ user.username }`;\n\t\t\t\tif (room.name) {\n\t\t\t\t\ttitle += ` @ #${ room.name }`;\n\t\t\t\t}\n\t\t\t\tRocketChat.Notifications.notifyUser(usersOfMentionId, 'notification', {\n\t\t\t\t\ttitle,\n\t\t\t\t\ttext: message.msg,\n\t\t\t\t\tduration: settings.desktopNotificationDurations[usersOfMentionId],\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\t_id: message._id,\n\t\t\t\t\t\trid: message.rid,\n\t\t\t\t\t\tsender: message.u,\n\t\t\t\t\t\ttype: room.t,\n\t\t\t\t\t\tname: room.name\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (userIdsToPushNotify.length > 0) {\n\t\t\tif (Push.enabled === true) {\n\t\t\t\tRocketChat.PushNotification.send({\n\t\t\t\t\troomId: message.rid,\n\t\t\t\t\troomName: push_room,\n\t\t\t\t\tusername: push_username,\n\t\t\t\t\tmessage: push_message,\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\thost: Meteor.absoluteUrl(),\n\t\t\t\t\t\trid: message.rid,\n\t\t\t\t\t\tsender: message.u,\n\t\t\t\t\t\ttype: room.t,\n\t\t\t\t\t\tname: room.name\n\t\t\t\t\t},\n\t\t\t\t\tusersTo: {\n\t\t\t\t\t\tuserId: {\n\t\t\t\t\t\t\t$in: userIdsToPushNotify\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst allUserIdsToNotify = _.unique(userIdsToNotify.concat(userIdsToPushNotify));\n\t\tif (room.t === 'p') {\n\t\t\tRocketChat.Sandstorm.notify(message, allUserIdsToNotify,\n\t\t\t\t`@${ user.username }: ${ message.msg }`, 'privateMessage');\n\t\t} else {\n\t\t\tRocketChat.Sandstorm.notify(message, allUserIdsToNotify,\n\t\t\t\t`@${ user.username }: ${ message.msg }`, 'message');\n\t\t}\n\t}\n\n\treturn message;\n\n}, RocketChat.callbacks.priority.LOW, 'sendNotificationOnMessage');\n","const dns = Npm.require('dns');\n\nlet emailDomainBlackList = [];\nlet emailDomainWhiteList = [];\nlet useDefaultBlackList = false;\nlet useDNSDomainCheck = false;\n\nRocketChat.settings.get('Accounts_BlockedDomainsList', function(key, value) {\n\temailDomainBlackList = _.map(value.split(','), (domain) => domain.trim());\n});\nRocketChat.settings.get('Accounts_AllowedDomainsList', function(key, value) {\n\temailDomainWhiteList = _.map(value.split(','), (domain) => domain.trim());\n});\nRocketChat.settings.get('Accounts_UseDefaultBlockedDomainsList', function(key, value) {\n\tuseDefaultBlackList = value;\n});\nRocketChat.settings.get('Accounts_UseDNSDomainCheck', function(key, value) {\n\tuseDNSDomainCheck = value;\n});\n\nRocketChat.validateEmailDomain = function(email) {\n\tconst emailValidation = /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n\tif (!emailValidation.test(email)) {\n\t\tthrow new Meteor.Error('error-invalid-email', `Invalid email ${ email }`, { function: 'RocketChat.validateEmailDomain', email });\n\t}\n\n\tconst emailDomain = email.substr(email.lastIndexOf('@') + 1);\n\n\t// if not in whitelist\n\tif (emailDomainWhiteList.indexOf(emailDomain) === -1) {\n\t\tif (emailDomainBlackList.indexOf(emailDomain) !== -1 || (useDefaultBlackList && RocketChat.emailDomainDefaultBlackList.indexOf(emailDomain) !== -1)) {\n\t\t\tthrow new Meteor.Error('error-email-domain-blacklisted', 'The email domain is blacklisted', { function: 'RocketChat.validateEmailDomain' });\n\t\t}\n\t}\n\n\tif (useDNSDomainCheck) {\n\t\ttry {\n\t\t\tMeteor.wrapAsync(dns.resolveMx)(emailDomain);\n\t\t} catch (e) {\n\t\t\tthrow new Meteor.Error('error-invalid-domain', 'Invalid domain', { function: 'RocketChat.validateEmailDomain' });\n\t\t}\n\t}\n};\n","import fs from 'fs';\n\nfunction hasDockerEnv() {\n\ttry {\n\t\tfs.statSync('/.dockerenv');\n\t\treturn true;\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction hasDockerCGroup() {\n\ttry {\n\t\treturn fs.readFileSync('/proc/self/cgroup', 'utf8').indexOf('docker') !== -1;\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction check() {\n\treturn hasDockerEnv() || hasDockerCGroup();\n}\n\nlet isDocker;\nRocketChat.isDocker = function() {\n\tif (isDocker === undefined) {\n\t\tisDocker = check();\n\t}\n\n\treturn isDocker;\n};\n","RocketChat.addUserToDefaultChannels = function(user, silenced) {\n\tRocketChat.callbacks.run('beforeJoinDefaultChannels', user);\n\tconst defaultRooms = RocketChat.models.Rooms.findByDefaultAndTypes(true, ['c', 'p'], {fields: {usernames: 0}}).fetch();\n\tdefaultRooms.forEach((room) => {\n\n\t\t// put user in default rooms\n\t\tconst muted = room.ro && !RocketChat.authz.hasPermission(user._id, 'post-readonly');\n\t\tRocketChat.models.Rooms.addUsernameById(room._id, user.username, muted);\n\n\t\tif (!RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, user._id)) {\n\n\t\t\t// Add a subscription to this user\n\t\t\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, user, {\n\t\t\t\tts: new Date(),\n\t\t\t\topen: true,\n\t\t\t\talert: true,\n\t\t\t\tunread: 1\n\t\t\t});\n\n\t\t\t// Insert user joined message\n\t\t\tif (!silenced) {\n\t\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(room._id, user);\n\t\t\t}\n\t\t}\n\t});\n};\n","RocketChat.addUserToRoom = function(rid, user, inviter, silenced) {\n\tconst now = new Date();\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t// Check if user is already in room\n\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, user._id);\n\tif (subscription) {\n\t\treturn;\n\t}\n\n\tif (room.t === 'c' || room.t === 'p') {\n\t\tRocketChat.callbacks.run('beforeJoinRoom', user, room);\n\t}\n\n\tconst muted = room.ro && !RocketChat.authz.hasPermission(user._id, 'post-readonly');\n\tRocketChat.models.Rooms.addUsernameById(rid, user.username, muted);\n\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, user, {\n\t\tts: now,\n\t\topen: true,\n\t\talert: true,\n\t\tunread: 1\n\t});\n\n\tif (!silenced) {\n\t\tif (inviter) {\n\t\t\tRocketChat.models.Messages.createUserAddedWithRoomIdAndUser(rid, user, {\n\t\t\t\tts: now,\n\t\t\t\tu: {\n\t\t\t\t\t_id: inviter._id,\n\t\t\t\t\tusername: inviter.username\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(rid, user, { ts: now });\n\t\t}\n\t}\n\n\tif (room.t === 'c' || room.t === 'p') {\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterJoinRoom', user, room);\n\t\t});\n\t}\n\n\treturn true;\n};\n","RocketChat.archiveRoom = function(rid) {\n\tRocketChat.models.Rooms.archiveById(rid);\n\tRocketChat.models.Subscriptions.archiveByRoomId(rid);\n\n\tRocketChat.callbacks.run('afterRoomArchived', RocketChat.models.Rooms.findOneById(rid), Meteor.user());\n};\n","RocketChat.checkUsernameAvailability = (username) ->\n\tusernameBlackList = []\n\tRocketChat.settings.get('Accounts_BlockedUsernameList', (key, value) =>\n\t\tusernameBlackList = _.map(value.split(','), (username) => username.trim())\n\t\tif usernameBlackList.length isnt 0\n\t\t\tfor restrictedUsername in usernameBlackList\n\t\t\t\tregex = new RegExp('^' + s.escapeRegExp(restrictedUsername) + '$', 'i')\n\t\t\t\treturn false if regex.test(s.trim(s.escapeRegExp(username)))\n\t\treturn not Meteor.users.findOne({ username: { $regex : new RegExp(\"^\" + s.trim(s.escapeRegExp(username)) + \"$\", \"i\") } });\n\t)\n","RocketChat.checkUsernameAvailability = function(username) {\n  var usernameBlackList;\n  usernameBlackList = [];\n  return RocketChat.settings.get('Accounts_BlockedUsernameList', (function(_this) {\n    return function(key, value) {\n      var i, len, regex, restrictedUsername;\n      usernameBlackList = _.map(value.split(','), function(username) {\n        return username.trim();\n      });\n      if (usernameBlackList.length !== 0) {\n        for (i = 0, len = usernameBlackList.length; i < len; i++) {\n          restrictedUsername = usernameBlackList[i];\n          regex = new RegExp('^' + s.escapeRegExp(restrictedUsername) + '$', 'i');\n          if (regex.test(s.trim(s.escapeRegExp(username)))) {\n            return false;\n          }\n        }\n      }\n      return !Meteor.users.findOne({\n        username: {\n          $regex: new RegExp(\"^\" + s.trim(s.escapeRegExp(username)) + \"$\", \"i\")\n        }\n      });\n    };\n  })(this));\n};\n","RocketChat.checkEmailAvailability = function(email) {\n\treturn !Meteor.users.findOne({ 'emails.address': { $regex : new RegExp(`^${ s.trim(s.escapeRegExp(email)) }$`, 'i') } });\n};\n","/* globals RocketChat */\nRocketChat.createRoom = function(type, name, owner, members, readOnly, extraData={}) {\n\tname = s.trim(name);\n\towner = s.trim(owner);\n\tmembers = [].concat(members);\n\n\tif (!name) {\n\t\tthrow new Meteor.Error('error-invalid-name', 'Invalid name', { function: 'RocketChat.createRoom' });\n\t}\n\n\towner = RocketChat.models.Users.findOneByUsername(owner, { fields: { username: 1 }});\n\tif (!owner) {\n\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { function: 'RocketChat.createRoom' });\n\t}\n\n\tlet nameValidation;\n\ttry {\n\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t} catch (error) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\n\tif (!nameValidation.test(name)) {\n\t\tthrow new Meteor.Error('error-invalid-name', 'Invalid name', { function: 'RocketChat.createRoom' });\n\t}\n\n\tconst now = new Date();\n\tif (!_.contains(members, owner.username)) {\n\t\tmembers.push(owner.username);\n\t}\n\n\t// avoid duplicate names\n\tlet room = RocketChat.models.Rooms.findOneByName(name);\n\tif (room) {\n\t\tif (room.archived) {\n\t\t\tthrow new Meteor.Error('error-archived-duplicate-name', `There's an archived channel with name ${ name }`, { function: 'RocketChat.createRoom', room_name: name });\n\t\t} else {\n\t\t\tthrow new Meteor.Error('error-duplicate-channel-name', `A channel with name '${ name }' exists`, { function: 'RocketChat.createRoom', room_name: name });\n\t\t}\n\t}\n\n\tif (type === 'c') {\n\t\tRocketChat.callbacks.run('beforeCreateChannel', owner, {\n\t\t\tt: 'c',\n\t\t\tname,\n\t\t\tts: now,\n\t\t\tro: readOnly === true,\n\t\t\tsysMes: readOnly !== true,\n\t\t\tusernames: members,\n\t\t\tu: {\n\t\t\t\t_id: owner._id,\n\t\t\t\tusername: owner.username\n\t\t\t}\n\t\t});\n\t}\n\n\textraData = Object.assign({}, extraData, {\n\t\tts: now,\n\t\tro: readOnly === true,\n\t\tsysMes: readOnly !== true\n\t});\n\n\troom = RocketChat.models.Rooms.createWithTypeNameUserAndUsernames(type, name, owner, members, extraData);\n\n\tfor (const username of members) {\n\t\tconst member = RocketChat.models.Users.findOneByUsername(username, { fields: { username: 1 }});\n\t\tif (!member) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// make all room members muted by default, unless they have the post-readonly permission\n\t\tif (readOnly === true && !RocketChat.authz.hasPermission(member._id, 'post-readonly')) {\n\t\t\tRocketChat.models.Rooms.muteUsernameByRoomId(room._id, username);\n\t\t}\n\n\t\tconst extra = { open: true };\n\n\t\tif (username === owner.username) {\n\t\t\textra.ls = now;\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, member, extra);\n\t}\n\n\tRocketChat.authz.addUserRoles(owner._id, ['owner'], room._id);\n\n\tif (type === 'c') {\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('afterCreateChannel', owner, room);\n\t\t});\n\t} else if (type === 'p') {\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('afterCreatePrivateGroup', owner, room);\n\t\t});\n\t}\n\n\treturn {\n\t\trid: room._id\n\t};\n};\n","/* globals FileUpload */\nRocketChat.deleteMessage = function(message, user) {\n\tconst keepHistory = RocketChat.settings.get('Message_KeepHistory');\n\tconst showDeletedStatus = RocketChat.settings.get('Message_ShowDeletedStatus');\n\tlet deletedMsg;\n\n\tif (keepHistory) {\n\t\tif (showDeletedStatus) {\n\t\t\tRocketChat.models.Messages.cloneAndSaveAsHistoryById(message._id);\n\t\t} else {\n\t\t\tRocketChat.models.Messages.setHiddenById(message._id, true);\n\t\t}\n\n\t\tif (message.file && message.file._id) {\n\t\t\tRocketChat.models.Uploads.update(message.file._id, { $set: { _hidden: true } });\n\t\t}\n\t} else {\n\t\tif (!showDeletedStatus) {\n\t\t\tdeletedMsg = RocketChat.models.Messages.findOneById(message._id);\n\t\t\tRocketChat.models.Messages.removeById(message._id);\n\t\t}\n\n\t\tif (message.file && message.file._id) {\n\t\t\tFileUpload.delete(message.file._id);\n\t\t}\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterDeleteMessage', deletedMsg);\n\t\t});\n\t}\n\n\tif (showDeletedStatus) {\n\t\tRocketChat.models.Messages.setAsDeletedByIdAndUser(message._id, user);\n\t} else {\n\t\tRocketChat.Notifications.notifyRoom(message.rid, 'deleteMessage', { _id: message._id });\n\t}\n};\n","/* globals RocketChat */\nRocketChat.deleteUser = function(userId) {\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\tRocketChat.models.Messages.removeByUserId(userId); // Remove user messages\n\tRocketChat.models.Subscriptions.findByUserId(userId).forEach((subscription) => {\n\t\tconst room = RocketChat.models.Rooms.findOneById(subscription.rid);\n\t\tif (room) {\n\t\t\tif (room.t !== 'c' && room.usernames.length === 1) {\n\t\t\t\tRocketChat.models.Rooms.removeById(subscription.rid); // Remove non-channel rooms with only 1 user (the one being deleted)\n\t\t\t}\n\t\t\tif (room.t === 'd') {\n\t\t\t\tRocketChat.models.Subscriptions.removeByRoomId(subscription.rid);\n\t\t\t\tRocketChat.models.Messages.removeByRoomId(subscription.rid);\n\t\t\t}\n\t\t}\n\t});\n\n\tRocketChat.models.Subscriptions.removeByUserId(userId); // Remove user subscriptions\n\tRocketChat.models.Rooms.removeByTypeContainingUsername('d', user.username); // Remove direct rooms with the user\n\tRocketChat.models.Rooms.removeUsernameFromAll(user.username); // Remove user from all other rooms\n\n\t// removes user's avatar\n\tif (user.avatarOrigin === 'upload' || user.avatarOrigin === 'url') {\n\t\tRocketChatFileAvatarInstance.deleteFile(encodeURIComponent(`${ user.username }.jpg`));\n\t}\n\n\tRocketChat.models.Integrations.disableByUserId(userId); // Disables all the integrations which rely on the user being deleted.\n\n\tRocketChat.models.Users.removeById(userId); // Remove user from users database\n};\n","/* globals RocketChat */\nRocketChat.getFullUserData = function({userId, filter, limit}) {\n\tlet fields = {\n\t\tname: 1,\n\t\tusername: 1,\n\t\tstatus: 1,\n\t\tutcOffset: 1,\n\t\ttype: 1,\n\t\tactive: 1\n\t};\n\n\tif (RocketChat.authz.hasPermission(userId, 'view-full-other-user-info')) {\n\t\tfields = _.extend(fields, {\n\t\t\temails: 1,\n\t\t\tphone: 1,\n\t\t\tstatusConnection: 1,\n\t\t\tcreatedAt: 1,\n\t\t\tlastLogin: 1,\n\t\t\tservices: 1,\n\t\t\trequirePasswordChange: 1,\n\t\t\trequirePasswordChangeReason: 1,\n\t\t\troles: 1,\n\t\t\tcustomFields: 1\n\t\t});\n\t} else if (limit !== 0) {\n\t\tlimit = 1;\n\t}\n\n\tfilter = s.trim(filter);\n\n\tif (!filter && limit === 1) {\n\t\treturn undefined;\n\t}\n\n\tconst options = {\n\t\tfields,\n\t\tlimit,\n\t\tsort: { username: 1 }\n\t};\n\n\tif (filter) {\n\t\tif (limit === 1) {\n\t\t\treturn RocketChat.models.Users.findByUsername(filter, options);\n\t\t} else {\n\t\t\tconst filterReg = new RegExp(s.escapeRegExp(filter), 'i');\n\t\t\treturn RocketChat.models.Users.findByUsernameNameOrEmailAddress(filterReg, options);\n\t\t}\n\t}\n\n\treturn RocketChat.models.Users.find({}, options);\n};\n","/* globals RocketChat */\nRocketChat.getRoomByNameOrIdWithOptionToJoin = function _getRoomByNameOrIdWithOptionToJoin({ currentUserId, nameOrId, type='', tryDirectByUserIdOnly=false, joinChannel=true, errorOnEmpty=true }) {\n\tlet room;\n\n\t//If the nameOrId starts with #, then let's try to find a channel or group\n\tif (nameOrId.startsWith('#')) {\n\t\tnameOrId = nameOrId.substring(1);\n\t\troom = RocketChat.models.Rooms.findOneByIdOrName(nameOrId);\n\t} else if (nameOrId.startsWith('@') || type === 'd') {\n\t\t//If the nameOrId starts with @ OR type is 'd', then let's try just a direct message\n\t\tnameOrId = nameOrId.replace('@', '');\n\n\t\tlet roomUser;\n\t\tif (tryDirectByUserIdOnly) {\n\t\t\troomUser = RocketChat.models.Users.findOneById(nameOrId);\n\t\t} else {\n\t\t\troomUser = RocketChat.models.Users.findOne({\n\t\t\t\t$or: [{ _id: nameOrId }, { username: nameOrId }]\n\t\t\t});\n\t\t}\n\n\t\tconst rid = _.isObject(roomUser) ? [currentUserId, roomUser._id].sort().join('') : nameOrId;\n\t\troom = RocketChat.models.Rooms.findOneById(rid);\n\n\t\t//If the room hasn't been found yet, let's try some more\n\t\tif (!_.isObject(room)) {\n\t\t\t//If the roomUser wasn't found, then there's no destination to point towards\n\t\t\t//so return out based upon errorOnEmpty\n\t\t\tif (!_.isObject(roomUser)) {\n\t\t\t\tif (errorOnEmpty) {\n\t\t\t\t\tthrow new Meteor.Error('invalid-channel');\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\troom = Meteor.runAsUser(currentUserId, function() {\n\t\t\t\tconst {rid} = Meteor.call('createDirectMessage', roomUser.username);\n\t\t\t\treturn RocketChat.models.Rooms.findOneById(rid);\n\t\t\t});\n\t\t}\n\t} else {\n\t\t//Otherwise, we'll treat this as a channel or group.\n\t\troom = RocketChat.models.Rooms.findOneByIdOrName(nameOrId);\n\t}\n\n\t//If no room was found, handle the room return based upon errorOnEmpty\n\tif (!room && errorOnEmpty) {\n\t\tthrow new Meteor.Error('invalid-channel');\n\t} else if (!room) {\n\t\treturn;\n\t}\n\n\t//If a room was found and they provided a type to search, then check\n\t//and if the type found isn't what we're looking for then handle\n\t//the return based upon errorOnEmpty\n\tif (type && room.t !== type) {\n\t\tif (errorOnEmpty) {\n\t\t\tthrow new Meteor.Error('invalid-channel');\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t//If the room type is channel and joinChannel has been passed, try to join them\n\t//if they can't join the room, this will error out!\n\tif (room.t === 'c' && joinChannel) {\n\t\tconst sub = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, currentUserId);\n\n\t\tif (!sub) {\n\t\t\tMeteor.runAsUser(currentUserId, function() {\n\t\t\t\treturn Meteor.call('joinRoom', room._id);\n\t\t\t});\n\t\t}\n\t}\n\n\treturn room;\n};\n","RocketChat.removeUserFromRoom = function(rid, user) {\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\tif (room) {\n\t\tRocketChat.callbacks.run('beforeLeaveRoom', user, room);\n\t\tRocketChat.models.Rooms.removeUsernameById(rid, user.username);\n\n\t\tif (room.usernames.indexOf(user.username) !== -1) {\n\t\t\tconst removedUser = user;\n\t\t\tRocketChat.models.Messages.createUserLeaveWithRoomIdAndUser(rid, removedUser);\n\t\t}\n\n\t\tif (room.t === 'l') {\n\t\t\tRocketChat.models.Messages.createCommandWithRoomIdAndUser('survey', rid, user);\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.removeByRoomIdAndUserId(rid, user._id);\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterLeaveRoom', user, room);\n\t\t});\n\t}\n};\n","/* globals Gravatar */\nRocketChat.saveUser = function(userId, userData) {\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\tconst existingRoles = _.pluck(RocketChat.authz.getRoles(), '_id');\n\n\tif (userData._id && userId !== userData._id && !RocketChat.authz.hasPermission(userId, 'edit-other-user-info')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing user is not allowed', { method: 'insertOrUpdateUser', action: 'Editing_user' });\n\t}\n\n\tif (!userData._id && !RocketChat.authz.hasPermission(userId, 'create-user')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Adding user is not allowed', { method: 'insertOrUpdateUser', action: 'Adding_user' });\n\t}\n\n\tif (userData.roles && _.difference(userData.roles, existingRoles).length > 0) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'The field Roles consist invalid role name', { method: 'insertOrUpdateUser', action: 'Assign_role' });\n\t}\n\n\tif (userData.roles && _.indexOf(userData.roles, 'admin') >= 0 && !RocketChat.authz.hasPermission(userId, 'assign-admin-role')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Assigning admin is not allowed', { method: 'insertOrUpdateUser', action: 'Assign_admin' });\n\t}\n\n\tif (!userData._id && !s.trim(userData.name)) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Name is required', { method: 'insertOrUpdateUser', field: 'Name' });\n\t}\n\n\tif (!userData._id && !s.trim(userData.username)) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Username is required', { method: 'insertOrUpdateUser', field: 'Username' });\n\t}\n\n\tlet nameValidation;\n\n\ttry {\n\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t} catch (e) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\n\tif (userData.username && !nameValidation.test(userData.username)) {\n\t\tthrow new Meteor.Error('error-input-is-not-a-valid-field', `${ _.escape(userData.username) } is not a valid username`, { method: 'insertOrUpdateUser', input: userData.username, field: 'Username' });\n\t}\n\n\tif (!userData._id && !userData.password) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Password is required', { method: 'insertOrUpdateUser', field: 'Password' });\n\t}\n\n\tif (!userData._id) {\n\t\tif (!RocketChat.checkUsernameAvailability(userData.username)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `${ _.escape(userData.username) } is already in use :(`, { method: 'insertOrUpdateUser', field: userData.username });\n\t\t}\n\n\t\tif (userData.email && !RocketChat.checkEmailAvailability(userData.email)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `${ _.escape(userData.email) } is already in use :(`, { method: 'insertOrUpdateUser', field: userData.email });\n\t\t}\n\n\t\tRocketChat.validateEmailDomain(userData.email);\n\n\t\t// insert user\n\t\tconst createUser = {\n\t\t\tusername: userData.username,\n\t\t\tpassword: userData.password,\n\t\t\tjoinDefaultChannels: userData.joinDefaultChannels\n\t\t};\n\t\tif (userData.email) {\n\t\t\tcreateUser.email = userData.email;\n\t\t}\n\n\t\tconst _id = Accounts.createUser(createUser);\n\n\t\tconst updateUser = {\n\t\t\t$set: {\n\t\t\t\tname: userData.name,\n\t\t\t\troles: userData.roles || ['user']\n\t\t\t}\n\t\t};\n\n\t\tif (userData.requirePasswordChange) {\n\t\t\tupdateUser.$set.requirePasswordChange = userData.requirePasswordChange;\n\t\t}\n\n\t\tif (userData.verified) {\n\t\t\tupdateUser.$set['emails.0.verified'] = true;\n\t\t}\n\n\t\tMeteor.users.update({ _id }, updateUser);\n\n\t\tif (userData.sendWelcomeEmail) {\n\t\t\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\t\t\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\n\t\t\tlet subject;\n\t\t\tlet html;\n\n\t\t\tif (RocketChat.settings.get('Accounts_UserAddedEmail_Customized')) {\n\t\t\t\tsubject = RocketChat.settings.get('Accounts_UserAddedEmailSubject');\n\t\t\t\thtml = RocketChat.settings.get('Accounts_UserAddedEmail');\n\t\t\t} else {\n\t\t\t\tsubject = TAPi18n.__('Accounts_UserAddedEmailSubject_Default', { lng: user.language || RocketChat.settings.get('language') || 'en' });\n\t\t\t\thtml = TAPi18n.__('Accounts_UserAddedEmail_Default', { lng: user.language || RocketChat.settings.get('language') || 'en' });\n\t\t\t}\n\n\t\t\tsubject = RocketChat.placeholders.replace(subject);\n\t\t\thtml = RocketChat.placeholders.replace(html, {\n\t\t\t\tname: userData.name,\n\t\t\t\temail: userData.email,\n\t\t\t\tpassword: userData.password\n\t\t\t});\n\n\t\t\tconst email = {\n\t\t\t\tto: userData.email,\n\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\tsubject,\n\t\t\t\thtml: header + html + footer\n\t\t\t};\n\n\t\t\tMeteor.defer(function() {\n\t\t\t\ttry {\n\t\t\t\t\tEmail.send(email);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ error.message }`, { function: 'RocketChat.saveUser', message: error.message });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tuserData._id = _id;\n\n\t\tif (RocketChat.settings.get('Accounts_SetDefaultAvatar') === true && userData.email) {\n\t\t\tconst gravatarUrl = Gravatar.imageUrl(userData.email, {default: '404', size: 200, secure: true});\n\n\t\t\ttry {\n\t\t\t\tRocketChat.setUserAvatar(userData, gravatarUrl, '', 'url');\n\t\t\t} catch (e) {\n\t\t\t\t//Ignore this error for now, as it not being successful isn't bad\n\t\t\t}\n\t\t}\n\n\t\treturn _id;\n\t} else {\n\t\t// update user\n\t\tif (userData.username) {\n\t\t\tRocketChat.setUsername(userData._id, userData.username);\n\t\t}\n\n\t\tif (userData.name) {\n\t\t\tRocketChat.setRealName(userData._id, userData.name);\n\t\t}\n\n\t\tif (userData.email) {\n\t\t\tRocketChat.setEmail(userData._id, userData.email);\n\t\t}\n\n\t\tif (userData.password && userData.password.trim() && RocketChat.authz.hasPermission(userId, 'edit-other-user-password')) {\n\t\t\tAccounts.setPassword(userData._id, userData.password.trim());\n\t\t}\n\n\t\tconst updateUser = {\n\t\t\t$set: {}\n\t\t};\n\n\t\tif (userData.roles) {\n\t\t\tupdateUser.$set.roles = userData.roles;\n\t\t}\n\n\t\tif (userData.requirePasswordChange) {\n\t\t\tupdateUser.$set.requirePasswordChange = userData.requirePasswordChange;\n\t\t}\n\n\t\tif (userData.verified) {\n\t\t\tupdateUser.$set['emails.0.verified'] = userData.verified;\n\t\t}\n\n\t\tMeteor.users.update({ _id: userData._id }, updateUser);\n\n\t\treturn true;\n\t}\n};\n","RocketChat.saveCustomFields = function(userId, formData) {\n\tif (s.trim(RocketChat.settings.get('Accounts_CustomFields')) !== '') {\n\t\tlet customFieldsMeta;\n\t\ttry {\n\t\t\tcustomFieldsMeta = JSON.parse(RocketChat.settings.get('Accounts_CustomFields'));\n\t\t} catch (e) {\n\t\t\tthrow new Meteor.Error('error-invalid-customfield-json', 'Invalid JSON for Custom Fields');\n\t\t}\n\n\t\tconst customFields = {};\n\n\t\tObject.keys(customFieldsMeta).forEach((fieldName) => {\n\t\t\tconst field = customFieldsMeta[fieldName];\n\n\t\t\tcustomFields[fieldName] = formData[fieldName];\n\t\t\tif (field.required && !formData[fieldName]) {\n\t\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Field ${ fieldName } is required`, { method: 'registerUser' });\n\t\t\t}\n\n\t\t\tif (field.type === 'select' && field.options.indexOf(formData[fieldName]) === -1) {\n\t\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Value for field ${ fieldName } is invalid`, { method: 'registerUser' });\n\t\t\t}\n\n\t\t\tif (field.maxLength && formData[fieldName].length > field.maxLength) {\n\t\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Max length of field ${ fieldName } ${ field.maxLength }`, { method: 'registerUser' });\n\t\t\t}\n\n\t\t\tif (field.minLength && formData[fieldName].length < field.minLength) {\n\t\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Min length of field ${ fieldName } ${ field.minLength }`, { method: 'registerUser' });\n\t\t\t}\n\t\t});\n\n\t\t// for fieldName, field of customFieldsMeta\n\t\tRocketChat.models.Users.setCustomFields(userId, customFields);\n\n\t\tObject.keys(customFields).forEach((fieldName) => {\n\t\t\tif (!customFieldsMeta[fieldName].modifyRecordField) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst modifyRecordField = customFieldsMeta[fieldName].modifyRecordField;\n\t\t\tconst update = {};\n\t\t\tif (modifyRecordField.array) {\n\t\t\t\tupdate.$addToSet = {};\n\t\t\t\tupdate.$addToSet[modifyRecordField.field] = customFields[fieldName];\n\t\t\t} else {\n\t\t\t\tupdate.$set = {};\n\t\t\t\tupdate.$set[modifyRecordField.field] = customFields[fieldName];\n\t\t\t}\n\n\t\t\tRocketChat.models.Users.update(userId, update);\n\t\t});\n\n\t\treturn true;\n\t}\n};\n","RocketChat.sendMessage = (user, message, room, upsert = false) ->\n\tif not user or not message or not room._id\n\t\treturn false\n\n\tunless message.ts?\n\t\tmessage.ts = new Date()\n\n\tmessage.u = _.pick user, ['_id','username']\n\n\tif not Match.test(message.msg, String)\n\t\tmessage.msg = ''\n\n\tmessage.rid = room._id\n\n\tif not room.usernames? || room.usernames.length is 0\n\t\tupdated_room = RocketChat.models.Rooms.findOneById(room._id)\n\t\tif updated_room?\n\t\t\troom = updated_room\n\t\telse\n\t\t\troom.usernames = []\n\n\tif message.parseUrls isnt false\n\t\tif urls = message.msg.match /([A-Za-z]{3,9}):\\/\\/([-;:&=\\+\\$,\\w]+@{1})?([-A-Za-z0-9\\.]+)+:?(\\d+)?((\\/[-\\+=!:~%\\/\\.@\\,\\w]*)?\\??([-\\+=&!:;%@\\/\\.\\,\\w]+)?(?:#([^\\s\\)]+))?)?/g\n\t\t\tmessage.urls = urls.map (url) -> url: url\n\n\tmessage = RocketChat.callbacks.run 'beforeSaveMessage', message\n\n\t# Avoid saving sandstormSessionId to the database\n\tsandstormSessionId = null\n\tif message.sandstormSessionId\n\t\tsandstormSessionId = message.sandstormSessionId\n\t\tdelete message.sandstormSessionId\n\n\tif message._id? and upsert\n\t\t_id = message._id\n\t\tdelete message._id\n\t\tRocketChat.models.Messages.upsert {_id: _id, 'u._id': message.u._id}, message\n\t\tmessage._id = _id\n\telse\n\t\tmessage._id = RocketChat.models.Messages.insert message\n\n\t###\n\tDefer other updates as their return is not interesting to the user\n\t###\n\tMeteor.defer ->\n\t\t# Execute all callbacks\n\t\tmessage.sandstormSessionId = sandstormSessionId\n\t\tRocketChat.callbacks.run 'afterSaveMessage', message, room\n\n\treturn message\n","RocketChat.sendMessage = function(user, message, room, upsert) {\n  var _id, sandstormSessionId, updated_room, urls;\n  if (upsert == null) {\n    upsert = false;\n  }\n  if (!user || !message || !room._id) {\n    return false;\n  }\n  if (message.ts == null) {\n    message.ts = new Date();\n  }\n  message.u = _.pick(user, ['_id', 'username']);\n  if (!Match.test(message.msg, String)) {\n    message.msg = '';\n  }\n  message.rid = room._id;\n  if ((room.usernames == null) || room.usernames.length === 0) {\n    updated_room = RocketChat.models.Rooms.findOneById(room._id);\n    if (updated_room != null) {\n      room = updated_room;\n    } else {\n      room.usernames = [];\n    }\n  }\n  if (message.parseUrls !== false) {\n    if (urls = message.msg.match(/([A-Za-z]{3,9}):\\/\\/([-;:&=\\+\\$,\\w]+@{1})?([-A-Za-z0-9\\.]+)+:?(\\d+)?((\\/[-\\+=!:~%\\/\\.@\\,\\w]*)?\\??([-\\+=&!:;%@\\/\\.\\,\\w]+)?(?:#([^\\s\\)]+))?)?/g)) {\n      message.urls = urls.map(function(url) {\n        return {\n          url: url\n        };\n      });\n    }\n  }\n  message = RocketChat.callbacks.run('beforeSaveMessage', message);\n  sandstormSessionId = null;\n  if (message.sandstormSessionId) {\n    sandstormSessionId = message.sandstormSessionId;\n    delete message.sandstormSessionId;\n  }\n  if ((message._id != null) && upsert) {\n    _id = message._id;\n    delete message._id;\n    RocketChat.models.Messages.upsert({\n      _id: _id,\n      'u._id': message.u._id\n    }, message);\n    message._id = _id;\n  } else {\n    message._id = RocketChat.models.Messages.insert(message);\n  }\n\n  /*\n  \tDefer other updates as their return is not interesting to the user\n   */\n  Meteor.defer(function() {\n    message.sandstormSessionId = sandstormSessionId;\n    return RocketChat.callbacks.run('afterSaveMessage', message, room);\n  });\n  return message;\n};\n","blockedSettings = {}\nprocess.env.SETTINGS_BLOCKED?.split(',').forEach (settingId) ->\n\tblockedSettings[settingId] = 1\n\nhiddenSettings = {}\nprocess.env.SETTINGS_HIDDEN?.split(',').forEach (settingId) ->\n\thiddenSettings[settingId] = 1\n\nRocketChat.settings._sorter = {}\n\n###\n# Add a setting\n# @param {String} _id\n# @param {Mixed} value\n# @param {Object} setting\n###\nRocketChat.settings.add = (_id, value, options = {}) ->\n\t# console.log '[functions] RocketChat.settings.add -> '.green, 'arguments:', arguments\n\n\tif not _id or\n\t\tnot value? and not process?.env?['OVERWRITE_SETTING_' + _id]?\n\t\t\treturn false\n\n\tRocketChat.settings._sorter[options.group] ?= 0\n\n\toptions.packageValue = value\n\toptions.valueSource = 'packageValue'\n\toptions.hidden = false\n\toptions.blocked = options.blocked || false\n\toptions.sorter ?= RocketChat.settings._sorter[options.group]++\n\n\tif options.enableQuery?\n\t\toptions.enableQuery = JSON.stringify options.enableQuery\n\n\tif options.i18nDefaultQuery?\n\t\toptions.i18nDefaultQuery = JSON.stringify options.i18nDefaultQuery\n\n\tif process?.env?[_id]?\n\t\tvalue = process.env[_id]\n\t\tif value.toLowerCase() is \"true\"\n\t\t\tvalue = true\n\t\telse if value.toLowerCase() is \"false\"\n\t\t\tvalue = false\n\t\toptions.processEnvValue = value\n\t\toptions.valueSource = 'processEnvValue'\n\n\telse if Meteor.settings?[_id]?\n\t\tvalue = Meteor.settings[_id]\n\t\toptions.meteorSettingsValue = value\n\t\toptions.valueSource = 'meteorSettingsValue'\n\n\tif not options.i18nLabel?\n\t\toptions.i18nLabel = _id\n\n\t# Default description i18n key will be the setting name + \"_Description\" (eg: LDAP_Enable -> LDAP_Enable_Description)\n\tif not options.i18nDescription?\n\t\toptions.i18nDescription = \"#{_id}_Description\"\n\n\tif blockedSettings[_id]?\n\t\toptions.blocked = true\n\n\tif hiddenSettings[_id]?\n\t\toptions.hidden = true\n\n\tif process?.env?['OVERWRITE_SETTING_' + _id]?\n\t\tvalue = process.env['OVERWRITE_SETTING_' + _id]\n\t\tif value.toLowerCase() is \"true\"\n\t\t\tvalue = true\n\t\telse if value.toLowerCase() is \"false\"\n\t\t\tvalue = false\n\t\toptions.value = value\n\t\toptions.processEnvValue = value\n\t\toptions.valueSource = 'processEnvValue'\n\n\tupdateOperations =\n\t\t$set: options\n\t\t$setOnInsert:\n\t\t\tcreatedAt: new Date\n\n\tif options.editor?\n\t\tupdateOperations.$setOnInsert.editor = options.editor\n\t\tdelete options.editor\n\n\tif not options.value?\n\t\tif options.force is true\n\t\t\tupdateOperations.$set.value = options.packageValue\n\t\telse\n\t\t\tupdateOperations.$setOnInsert.value = value\n\n\tquery = _.extend { _id: _id }, updateOperations.$set\n\n\tif not options.section?\n\t\tupdateOperations.$unset = { section: 1 }\n\t\tquery.section = { $exists: false }\n\n\texistantSetting = RocketChat.models.Settings.db.findOne(query)\n\n\tif existantSetting?\n\t\tif not existantSetting.editor? and updateOperations.$setOnInsert.editor?\n\t\t\tupdateOperations.$set.editor = updateOperations.$setOnInsert.editor\n\t\t\tdelete updateOperations.$setOnInsert.editor\n\telse\n\t\tupdateOperations.$set.ts = new Date\n\n\treturn RocketChat.models.Settings.upsert { _id: _id }, updateOperations\n\n\n\n###\n# Add a setting group\n# @param {String} _id\n###\nRocketChat.settings.addGroup = (_id, options = {}, cb) ->\n\t# console.log '[functions] RocketChat.settings.addGroup -> '.green, 'arguments:', arguments\n\n\tif not _id\n\t\treturn false\n\n\tif _.isFunction(options)\n\t\tcb = options\n\t\toptions = {}\n\n\tif not options.i18nLabel?\n\t\toptions.i18nLabel = _id\n\n\tif not options.i18nDescription?\n\t\toptions.i18nDescription = \"#{_id}_Description\"\n\n\toptions.ts = new Date\n\toptions.blocked = false\n\toptions.hidden = false\n\n\tif blockedSettings[_id]?\n\t\toptions.blocked = true\n\n\tif hiddenSettings[_id]?\n\t\toptions.hidden = true\n\n\tRocketChat.models.Settings.upsert { _id: _id },\n\t\t$set: options\n\t\t$setOnInsert:\n\t\t\ttype: 'group'\n\t\t\tcreatedAt: new Date\n\n\tif cb?\n\t\tcb.call\n\t\t\tadd: (id, value, options = {}) ->\n\t\t\t\toptions.group = _id\n\t\t\t\tRocketChat.settings.add id, value, options\n\n\t\t\tsection: (section, cb) ->\n\t\t\t\tcb.call\n\t\t\t\t\tadd: (id, value, options = {}) ->\n\t\t\t\t\t\toptions.group = _id\n\t\t\t\t\t\toptions.section = section\n\t\t\t\t\t\tRocketChat.settings.add id, value, options\n\n\treturn\n\n\n###\n# Remove a setting by id\n# @param {String} _id\n###\nRocketChat.settings.removeById = (_id) ->\n\t# console.log '[functions] RocketChat.settings.add -> '.green, 'arguments:', arguments\n\n\tif not _id\n\t\treturn false\n\n\treturn RocketChat.models.Settings.removeById _id\n\n\n###\n# Update a setting by id\n# @param {String} _id\n###\nRocketChat.settings.updateById = (_id, value, editor) ->\n\t# console.log '[functions] RocketChat.settings.updateById -> '.green, 'arguments:', arguments\n\n\tif not _id or not value?\n\t\treturn false\n\n\tif editor?\n\t\treturn RocketChat.models.Settings.updateValueAndEditorById _id, value, editor\n\n\treturn RocketChat.models.Settings.updateValueById _id, value\n\n\n###\n# Update options of a setting by id\n# @param {String} _id\n###\nRocketChat.settings.updateOptionsById = (_id, options) ->\n\t# console.log '[functions] RocketChat.settings.updateOptionsById -> '.green, 'arguments:', arguments\n\n\tif not _id or not options?\n\t\treturn false\n\n\treturn RocketChat.models.Settings.updateOptionsById _id, options\n\n\n###\n# Update a setting by id\n# @param {String} _id\n###\nRocketChat.settings.clearById = (_id) ->\n\t# console.log '[functions] RocketChat.settings.clearById -> '.green, 'arguments:', arguments\n\n\tif not _id?\n\t\treturn false\n\n\treturn RocketChat.models.Settings.updateValueById _id, undefined\n\n\n###\n# Update a setting by id\n###\nRocketChat.settings.init = ->\n\tRocketChat.settings.initialLoad = true\n\tRocketChat.models.Settings.find().observe\n\t\tadded: (record) ->\n\t\t\tMeteor.settings[record._id] = record.value\n\t\t\tif record.env is true\n\t\t\t\tprocess.env[record._id] = record.value\n\t\t\tRocketChat.settings.load record._id, record.value, RocketChat.settings.initialLoad\n\t\tchanged: (record) ->\n\t\t\tMeteor.settings[record._id] = record.value\n\t\t\tif record.env is true\n\t\t\t\tprocess.env[record._id] = record.value\n\t\t\tRocketChat.settings.load record._id, record.value, RocketChat.settings.initialLoad\n\t\tremoved: (record) ->\n\t\t\tdelete Meteor.settings[record._id]\n\t\t\tif record.env is true\n\t\t\t\tdelete process.env[record._id]\n\t\t\tRocketChat.settings.load record._id, undefined, RocketChat.settings.initialLoad\n\tRocketChat.settings.initialLoad = false\n\n\tfor fn in RocketChat.settings.afterInitialLoad\n\t\tfn(Meteor.settings)\n\n\nRocketChat.settings.afterInitialLoad = []\n\nRocketChat.settings.onAfterInitialLoad = (fn) ->\n\tRocketChat.settings.afterInitialLoad.push(fn)\n\tif RocketChat.settings.initialLoad is false\n\t\tfn(Meteor.settings)\n","var blockedSettings, hiddenSettings, ref, ref1;\n\nblockedSettings = {};\n\nif ((ref = process.env.SETTINGS_BLOCKED) != null) {\n  ref.split(',').forEach(function(settingId) {\n    return blockedSettings[settingId] = 1;\n  });\n}\n\nhiddenSettings = {};\n\nif ((ref1 = process.env.SETTINGS_HIDDEN) != null) {\n  ref1.split(',').forEach(function(settingId) {\n    return hiddenSettings[settingId] = 1;\n  });\n}\n\nRocketChat.settings._sorter = {};\n\n\n/*\n * Add a setting\n * @param {String} _id\n * @param {Mixed} value\n * @param {Object} setting\n */\n\nRocketChat.settings.add = function(_id, value, options) {\n  var base, existantSetting, name, query, ref2, ref3, ref4, ref5, updateOperations;\n  if (options == null) {\n    options = {};\n  }\n  if (!_id || (value == null) && ((typeof process !== \"undefined\" && process !== null ? (ref2 = process.env) != null ? ref2['OVERWRITE_SETTING_' + _id] : void 0 : void 0) == null)) {\n    return false;\n  }\n  if ((base = RocketChat.settings._sorter)[name = options.group] == null) {\n    base[name] = 0;\n  }\n  options.packageValue = value;\n  options.valueSource = 'packageValue';\n  options.hidden = false;\n  options.blocked = options.blocked || false;\n  if (options.sorter == null) {\n    options.sorter = RocketChat.settings._sorter[options.group]++;\n  }\n  if (options.enableQuery != null) {\n    options.enableQuery = JSON.stringify(options.enableQuery);\n  }\n  if (options.i18nDefaultQuery != null) {\n    options.i18nDefaultQuery = JSON.stringify(options.i18nDefaultQuery);\n  }\n  if ((typeof process !== \"undefined\" && process !== null ? (ref3 = process.env) != null ? ref3[_id] : void 0 : void 0) != null) {\n    value = process.env[_id];\n    if (value.toLowerCase() === \"true\") {\n      value = true;\n    } else if (value.toLowerCase() === \"false\") {\n      value = false;\n    }\n    options.processEnvValue = value;\n    options.valueSource = 'processEnvValue';\n  } else if (((ref4 = Meteor.settings) != null ? ref4[_id] : void 0) != null) {\n    value = Meteor.settings[_id];\n    options.meteorSettingsValue = value;\n    options.valueSource = 'meteorSettingsValue';\n  }\n  if (options.i18nLabel == null) {\n    options.i18nLabel = _id;\n  }\n  if (options.i18nDescription == null) {\n    options.i18nDescription = _id + \"_Description\";\n  }\n  if (blockedSettings[_id] != null) {\n    options.blocked = true;\n  }\n  if (hiddenSettings[_id] != null) {\n    options.hidden = true;\n  }\n  if ((typeof process !== \"undefined\" && process !== null ? (ref5 = process.env) != null ? ref5['OVERWRITE_SETTING_' + _id] : void 0 : void 0) != null) {\n    value = process.env['OVERWRITE_SETTING_' + _id];\n    if (value.toLowerCase() === \"true\") {\n      value = true;\n    } else if (value.toLowerCase() === \"false\") {\n      value = false;\n    }\n    options.value = value;\n    options.processEnvValue = value;\n    options.valueSource = 'processEnvValue';\n  }\n  updateOperations = {\n    $set: options,\n    $setOnInsert: {\n      createdAt: new Date\n    }\n  };\n  if (options.editor != null) {\n    updateOperations.$setOnInsert.editor = options.editor;\n    delete options.editor;\n  }\n  if (options.value == null) {\n    if (options.force === true) {\n      updateOperations.$set.value = options.packageValue;\n    } else {\n      updateOperations.$setOnInsert.value = value;\n    }\n  }\n  query = _.extend({\n    _id: _id\n  }, updateOperations.$set);\n  if (options.section == null) {\n    updateOperations.$unset = {\n      section: 1\n    };\n    query.section = {\n      $exists: false\n    };\n  }\n  existantSetting = RocketChat.models.Settings.db.findOne(query);\n  if (existantSetting != null) {\n    if ((existantSetting.editor == null) && (updateOperations.$setOnInsert.editor != null)) {\n      updateOperations.$set.editor = updateOperations.$setOnInsert.editor;\n      delete updateOperations.$setOnInsert.editor;\n    }\n  } else {\n    updateOperations.$set.ts = new Date;\n  }\n  return RocketChat.models.Settings.upsert({\n    _id: _id\n  }, updateOperations);\n};\n\n\n/*\n * Add a setting group\n * @param {String} _id\n */\n\nRocketChat.settings.addGroup = function(_id, options, cb) {\n  if (options == null) {\n    options = {};\n  }\n  if (!_id) {\n    return false;\n  }\n  if (_.isFunction(options)) {\n    cb = options;\n    options = {};\n  }\n  if (options.i18nLabel == null) {\n    options.i18nLabel = _id;\n  }\n  if (options.i18nDescription == null) {\n    options.i18nDescription = _id + \"_Description\";\n  }\n  options.ts = new Date;\n  options.blocked = false;\n  options.hidden = false;\n  if (blockedSettings[_id] != null) {\n    options.blocked = true;\n  }\n  if (hiddenSettings[_id] != null) {\n    options.hidden = true;\n  }\n  RocketChat.models.Settings.upsert({\n    _id: _id\n  }, {\n    $set: options,\n    $setOnInsert: {\n      type: 'group',\n      createdAt: new Date\n    }\n  });\n  if (cb != null) {\n    cb.call({\n      add: function(id, value, options) {\n        if (options == null) {\n          options = {};\n        }\n        options.group = _id;\n        return RocketChat.settings.add(id, value, options);\n      },\n      section: function(section, cb) {\n        return cb.call({\n          add: function(id, value, options) {\n            if (options == null) {\n              options = {};\n            }\n            options.group = _id;\n            options.section = section;\n            return RocketChat.settings.add(id, value, options);\n          }\n        });\n      }\n    });\n  }\n};\n\n\n/*\n * Remove a setting by id\n * @param {String} _id\n */\n\nRocketChat.settings.removeById = function(_id) {\n  if (!_id) {\n    return false;\n  }\n  return RocketChat.models.Settings.removeById(_id);\n};\n\n\n/*\n * Update a setting by id\n * @param {String} _id\n */\n\nRocketChat.settings.updateById = function(_id, value, editor) {\n  if (!_id || (value == null)) {\n    return false;\n  }\n  if (editor != null) {\n    return RocketChat.models.Settings.updateValueAndEditorById(_id, value, editor);\n  }\n  return RocketChat.models.Settings.updateValueById(_id, value);\n};\n\n\n/*\n * Update options of a setting by id\n * @param {String} _id\n */\n\nRocketChat.settings.updateOptionsById = function(_id, options) {\n  if (!_id || (options == null)) {\n    return false;\n  }\n  return RocketChat.models.Settings.updateOptionsById(_id, options);\n};\n\n\n/*\n * Update a setting by id\n * @param {String} _id\n */\n\nRocketChat.settings.clearById = function(_id) {\n  if (_id == null) {\n    return false;\n  }\n  return RocketChat.models.Settings.updateValueById(_id, void 0);\n};\n\n\n/*\n * Update a setting by id\n */\n\nRocketChat.settings.init = function() {\n  var fn, i, len, ref2, results;\n  RocketChat.settings.initialLoad = true;\n  RocketChat.models.Settings.find().observe({\n    added: function(record) {\n      Meteor.settings[record._id] = record.value;\n      if (record.env === true) {\n        process.env[record._id] = record.value;\n      }\n      return RocketChat.settings.load(record._id, record.value, RocketChat.settings.initialLoad);\n    },\n    changed: function(record) {\n      Meteor.settings[record._id] = record.value;\n      if (record.env === true) {\n        process.env[record._id] = record.value;\n      }\n      return RocketChat.settings.load(record._id, record.value, RocketChat.settings.initialLoad);\n    },\n    removed: function(record) {\n      delete Meteor.settings[record._id];\n      if (record.env === true) {\n        delete process.env[record._id];\n      }\n      return RocketChat.settings.load(record._id, void 0, RocketChat.settings.initialLoad);\n    }\n  });\n  RocketChat.settings.initialLoad = false;\n  ref2 = RocketChat.settings.afterInitialLoad;\n  results = [];\n  for (i = 0, len = ref2.length; i < len; i++) {\n    fn = ref2[i];\n    results.push(fn(Meteor.settings));\n  }\n  return results;\n};\n\nRocketChat.settings.afterInitialLoad = [];\n\nRocketChat.settings.onAfterInitialLoad = function(fn) {\n  RocketChat.settings.afterInitialLoad.push(fn);\n  if (RocketChat.settings.initialLoad === false) {\n    return fn(Meteor.settings);\n  }\n};\n","RocketChat.setUserAvatar = function(user, dataURI, contentType, service) {\n\tlet encoding;\n\tlet image;\n\n\tif (service === 'initials') {\n\t\treturn RocketChat.models.Users.setAvatarOrigin(user._id, service);\n\t} else if (service === 'url') {\n\t\tlet result = null;\n\n\t\ttry {\n\t\t\tresult = HTTP.get(dataURI, { npmRequestOptions: {encoding: 'binary'} });\n\t\t} catch (error) {\n\t\t\tif (error.response.statusCode !== 404) {\n\t\t\t\tconsole.log(`Error while handling the setting of the avatar from a url (${ dataURI }) for ${ user.username }:`, error);\n\t\t\t\tthrow new Meteor.Error('error-avatar-url-handling', `Error while handling avatar setting from a URL (${ dataURI }) for ${ user.username }`, { function: 'RocketChat.setUserAvatar', url: dataURI, username: user.username });\n\t\t\t}\n\t\t}\n\n\t\tif (result.statusCode !== 200) {\n\t\t\tconsole.log(`Not a valid response, ${ result.statusCode }, from the avatar url: ${ dataURI }`);\n\t\t\tthrow new Meteor.Error('error-avatar-invalid-url', `Invalid avatar URL: ${ dataURI }`, { function: 'RocketChat.setUserAvatar', url: dataURI });\n\t\t}\n\n\t\tif (!/image\\/.+/.test(result.headers['content-type'])) {\n\t\t\tconsole.log(`Not a valid content-type from the provided url, ${ result.headers['content-type'] }, from the avatar url: ${ dataURI }`);\n\t\t\tthrow new Meteor.Error('error-avatar-invalid-url', `Invalid avatar URL: ${ dataURI }`, { function: 'RocketChat.setUserAvatar', url: dataURI });\n\t\t}\n\n\t\tencoding = 'binary';\n\t\timage = result.content;\n\t\tcontentType = result.headers['content-type'];\n\t} else if (service === 'rest') {\n\t\tencoding = 'binary';\n\t\timage = dataURI;\n\t} else {\n\t\tconst fileData = RocketChatFile.dataURIParse(dataURI);\n\t\tencoding = 'base64';\n\t\timage = fileData.image;\n\t\tcontentType = fileData.contentType;\n\t}\n\n\tconst rs = RocketChatFile.bufferToStream(new Buffer(image, encoding));\n\tRocketChatFileAvatarInstance.deleteFile(encodeURIComponent(`${ user.username }.jpg`));\n\tconst ws = RocketChatFileAvatarInstance.createWriteStream(encodeURIComponent(`${ user.username }.jpg`), contentType);\n\tws.on('end', Meteor.bindEnvironment(function() {\n\t\tMeteor.setTimeout(function() {\n\t\t\tRocketChat.models.Users.setAvatarOrigin(user._id, service);\n\t\t\tRocketChat.Notifications.notifyLogged('updateAvatar', {username: user.username});\n\t\t}, 500);\n\t}));\n\trs.pipe(ws);\n};\n","RocketChat._setUsername = (userId, username) ->\n\tusername = s.trim username\n\tif not userId or not username\n\t\treturn false\n\n\ttry\n\t\tnameValidation = new RegExp '^' + RocketChat.settings.get('UTF8_Names_Validation') + '$'\n\tcatch\n\t\tnameValidation = new RegExp '^[0-9a-zA-Z-_.]+$'\n\n\tif not nameValidation.test username\n\t\treturn false\n\n\tuser = RocketChat.models.Users.findOneById userId\n\n\t# User already has desired username, return\n\tif user.username is username\n\t\treturn user\n\n\tpreviousUsername = user.username\n\n\t# Check username availability or if the user already owns a different casing of the name\n\tif ( !previousUsername or !(username.toLowerCase() == previousUsername.toLowerCase()))\n\t\tunless RocketChat.checkUsernameAvailability username\n\t\t\treturn false\n\n\t# If first time setting username, send Enrollment Email\n\ttry\n\t\tif not previousUsername and user.emails?.length > 0 and RocketChat.settings.get 'Accounts_Enrollment_Email'\n\t\t\tAccounts.sendEnrollmentEmail(user._id)\n\tcatch error\n\n\tuser.username = username\n\n\t# If first time setting username, check if should set default avatar\n\tif not previousUsername and RocketChat.settings.get('Accounts_SetDefaultAvatar') is true\n\t\tavatarSuggestions = getAvatarSuggestionForUser user\n\t\tfor service, avatarData of avatarSuggestions\n\t\t\tif service isnt 'gravatar'\n\t\t\t\tRocketChat.setUserAvatar(user, avatarData.blob, avatarData.contentType, service)\n\t\t\t\tgravatar = null\n\t\t\t\tbreak\n\t\t\telse\n\t\t\t\tgravatar = avatarData\n\t\tif gravatar?\n\t\t\tRocketChat.setUserAvatar(user, gravatar.blob, gravatar.contentType, 'gravatar')\n\n\t# Username is available; if coming from old username, update all references\n\tif previousUsername\n\t\tRocketChat.models.Messages.updateAllUsernamesByUserId user._id, username\n\t\tRocketChat.models.Messages.updateUsernameOfEditByUserId user._id, username\n\n\t\tRocketChat.models.Messages.findByMention(previousUsername).forEach (msg) ->\n\t\t\tupdatedMsg = msg.msg.replace(new RegExp(\"@#{previousUsername}\", \"ig\"), \"@#{username}\")\n\t\t\tRocketChat.models.Messages.updateUsernameAndMessageOfMentionByIdAndOldUsername msg._id, previousUsername, username, updatedMsg\n\n\t\tRocketChat.models.Rooms.replaceUsername previousUsername, username\n\t\tRocketChat.models.Rooms.replaceMutedUsername previousUsername, username\n\t\tRocketChat.models.Rooms.replaceUsernameOfUserByUserId user._id, username\n\n\t\tRocketChat.models.Subscriptions.setUserUsernameByUserId user._id, username\n\t\tRocketChat.models.Subscriptions.setNameForDirectRoomsWithOldName previousUsername, username\n\n\t\trs = RocketChatFileAvatarInstance.getFileWithReadStream(encodeURIComponent(\"#{previousUsername}.jpg\"))\n\t\tif rs?\n\t\t\tRocketChatFileAvatarInstance.deleteFile encodeURIComponent(\"#{username}.jpg\")\n\t\t\tws = RocketChatFileAvatarInstance.createWriteStream encodeURIComponent(\"#{username}.jpg\"), rs.contentType\n\t\t\tws.on 'end', Meteor.bindEnvironment ->\n\t\t\t\tRocketChatFileAvatarInstance.deleteFile encodeURIComponent(\"#{previousUsername}.jpg\")\n\t\t\trs.readStream.pipe(ws)\n\n\t# Set new username\n\tRocketChat.models.Users.setUsername user._id, username\n\treturn user\n\nRocketChat.setUsername = RocketChat.RateLimiter.limitFunction RocketChat._setUsername, 1, 60000,\n\t0: () -> return not Meteor.userId() or not RocketChat.authz.hasPermission(Meteor.userId(), 'edit-other-user-info') # Administrators have permission to change others usernames, so don't limit those\n","RocketChat._setUsername = function(userId, username) {\n  var avatarData, avatarSuggestions, error, gravatar, nameValidation, previousUsername, ref, rs, service, user, ws;\n  username = s.trim(username);\n  if (!userId || !username) {\n    return false;\n  }\n  try {\n    nameValidation = new RegExp('^' + RocketChat.settings.get('UTF8_Names_Validation') + '$');\n  } catch (error1) {\n    nameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n  }\n  if (!nameValidation.test(username)) {\n    return false;\n  }\n  user = RocketChat.models.Users.findOneById(userId);\n  if (user.username === username) {\n    return user;\n  }\n  previousUsername = user.username;\n  if (!previousUsername || !(username.toLowerCase() === previousUsername.toLowerCase())) {\n    if (!RocketChat.checkUsernameAvailability(username)) {\n      return false;\n    }\n  }\n  try {\n    if (!previousUsername && ((ref = user.emails) != null ? ref.length : void 0) > 0 && RocketChat.settings.get('Accounts_Enrollment_Email')) {\n      Accounts.sendEnrollmentEmail(user._id);\n    }\n  } catch (error1) {\n    error = error1;\n  }\n  user.username = username;\n  if (!previousUsername && RocketChat.settings.get('Accounts_SetDefaultAvatar') === true) {\n    avatarSuggestions = getAvatarSuggestionForUser(user);\n    for (service in avatarSuggestions) {\n      avatarData = avatarSuggestions[service];\n      if (service !== 'gravatar') {\n        RocketChat.setUserAvatar(user, avatarData.blob, avatarData.contentType, service);\n        gravatar = null;\n        break;\n      } else {\n        gravatar = avatarData;\n      }\n    }\n    if (gravatar != null) {\n      RocketChat.setUserAvatar(user, gravatar.blob, gravatar.contentType, 'gravatar');\n    }\n  }\n  if (previousUsername) {\n    RocketChat.models.Messages.updateAllUsernamesByUserId(user._id, username);\n    RocketChat.models.Messages.updateUsernameOfEditByUserId(user._id, username);\n    RocketChat.models.Messages.findByMention(previousUsername).forEach(function(msg) {\n      var updatedMsg;\n      updatedMsg = msg.msg.replace(new RegExp(\"@\" + previousUsername, \"ig\"), \"@\" + username);\n      return RocketChat.models.Messages.updateUsernameAndMessageOfMentionByIdAndOldUsername(msg._id, previousUsername, username, updatedMsg);\n    });\n    RocketChat.models.Rooms.replaceUsername(previousUsername, username);\n    RocketChat.models.Rooms.replaceMutedUsername(previousUsername, username);\n    RocketChat.models.Rooms.replaceUsernameOfUserByUserId(user._id, username);\n    RocketChat.models.Subscriptions.setUserUsernameByUserId(user._id, username);\n    RocketChat.models.Subscriptions.setNameForDirectRoomsWithOldName(previousUsername, username);\n    rs = RocketChatFileAvatarInstance.getFileWithReadStream(encodeURIComponent(previousUsername + \".jpg\"));\n    if (rs != null) {\n      RocketChatFileAvatarInstance.deleteFile(encodeURIComponent(username + \".jpg\"));\n      ws = RocketChatFileAvatarInstance.createWriteStream(encodeURIComponent(username + \".jpg\"), rs.contentType);\n      ws.on('end', Meteor.bindEnvironment(function() {\n        return RocketChatFileAvatarInstance.deleteFile(encodeURIComponent(previousUsername + \".jpg\"));\n      }));\n      rs.readStream.pipe(ws);\n    }\n  }\n  RocketChat.models.Users.setUsername(user._id, username);\n  return user;\n};\n\nRocketChat.setUsername = RocketChat.RateLimiter.limitFunction(RocketChat._setUsername, 1, 60000, {\n  0: function() {\n    return !Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'edit-other-user-info');\n  }\n});\n","RocketChat._setRealName = function(userId, name) {\n\tname = s.trim(name);\n\tif (!userId || !name) {\n\t\treturn false;\n\t}\n\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t// User already has desired name, return\n\tif (user.name === name) {\n\t\treturn user;\n\t}\n\n\t// Set new name\n\tRocketChat.models.Users.setName(user._id, name);\n\tuser.name = name;\n\n\tif (RocketChat.settings.get('UI_Use_Real_Name') === true) {\n\t\tRocketChat.Notifications.notifyLogged('Users:NameChanged', {\n\t\t\t_id: user._id,\n\t\t\tname: user.name,\n\t\t\tusername: user.username\n\t\t});\n\t}\n\n\treturn user;\n};\n\nRocketChat.setRealName = RocketChat.RateLimiter.limitFunction(RocketChat._setRealName, 1, 60000, {\n\t0() { return !Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'edit-other-user-info'); } // Administrators have permission to change others names, so don't limit those\n});\n","RocketChat._setEmail = function(userId, email) {\n\temail = s.trim(email);\n\tif (!userId) {\n\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { function: '_setEmail' });\n\t}\n\n\tif (!email) {\n\t\tthrow new Meteor.Error('error-invalid-email', 'Invalid email', { function: '_setEmail' });\n\t}\n\n\tRocketChat.validateEmailDomain(email);\n\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t// User already has desired username, return\n\tif (user.emails && user.emails[0] && user.emails[0].address === email) {\n\t\treturn user;\n\t}\n\n\t// Check email availability\n\tif (!RocketChat.checkEmailAvailability(email)) {\n\t\tthrow new Meteor.Error('error-field-unavailable', `${ email } is already in use :(`, { function: '_setEmail', field: email });\n\t}\n\n\t// Set new email\n\tRocketChat.models.Users.setEmail(user._id, email);\n\tuser.email = email;\n\treturn user;\n};\n\nRocketChat.setEmail = RocketChat.RateLimiter.limitFunction(RocketChat._setEmail, 1, 60000, {\n\t0() { return !Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'edit-other-user-info'); } // Administrators have permission to change others emails, so don't limit those\n});\n","RocketChat.unarchiveRoom = function(rid) {\n\tRocketChat.models.Rooms.unarchiveById(rid);\n\tRocketChat.models.Subscriptions.unarchiveByRoomId(rid);\n};\n","RocketChat.updateMessage = function(message, user) {\n\t// If we keep history of edits, insert a new message to store history information\n\tif (RocketChat.settings.get('Message_KeepHistory')) {\n\t\tRocketChat.models.Messages.cloneAndSaveAsHistoryById(message._id);\n\t}\n\n\tmessage.editedAt = new Date();\n\tmessage.editedBy = {\n\t\t_id: user._id,\n\t\tusername: user.username\n\t};\n\n\tconst urls = message.msg.match(/([A-Za-z]{3,9}):\\/\\/([-;:&=\\+\\$,\\w]+@{1})?([-A-Za-z0-9\\.]+)+:?(\\d+)?((\\/[-\\+=!:~%\\/\\.@\\,\\w]*)?\\??([-\\+=&!:;%@\\/\\.\\,\\w]+)?(?:#([^\\s\\)]+))?)?/g);\n\tif (urls) {\n\t\tmessage.urls = urls.map((url) => { return { url }; });\n\t}\n\n\tmessage = RocketChat.callbacks.run('beforeSaveMessage', message);\n\n\tconst tempid = message._id;\n\tdelete message._id;\n\n\tRocketChat.models.Messages.update({ _id: tempid }, { $set: message });\n\n\tconst room = RocketChat.models.Rooms.findOneById(message.rid);\n\n\tMeteor.defer(function() {\n\t\tRocketChat.callbacks.run('afterSaveMessage', RocketChat.models.Messages.findOneById(tempid), room);\n\t});\n};\n","RocketChat.Notifications = new class\n\tconstructor: ->\n\t\tself = @\n\n\t\t@debug = false\n\n\t\t@streamAll = new Meteor.Streamer 'notify-all'\n\t\t@streamLogged = new Meteor.Streamer 'notify-logged'\n\t\t@streamRoom = new Meteor.Streamer 'notify-room'\n\t\t@streamRoomUsers = new Meteor.Streamer 'notify-room-users'\n\t\t@streamUser = new Meteor.Streamer 'notify-user'\n\n\n\t\t@streamAll.allowWrite('none')\n\t\t@streamLogged.allowWrite('none')\n\t\t@streamRoom.allowWrite('none')\n\t\t@streamRoomUsers.allowWrite (eventName, args...) ->\n\t\t\t[roomId, e] = eventName.split('/')\n\n\t\t\tuser = Meteor.users.findOne @userId, {fields: {username: 1}}\n\t\t\tif RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(roomId, @userId)?\n\t\t\t\tsubscriptions = RocketChat.models.Subscriptions.findByRoomIdAndNotUserId(roomId, @userId).fetch()\n\t\t\t\tfor subscription in subscriptions\n\t\t\t\t\tRocketChat.Notifications.notifyUser(subscription.u._id, e, args...)\n\n\t\t\treturn false\n\n\t\t@streamUser.allowWrite('logged')\n\n\t\t@streamAll.allowRead('all')\n\n\t\t@streamLogged.allowRead('logged')\n\n\t\t@streamRoom.allowRead (eventName) ->\n\t\t\tif not @userId? then return false\n\n\t\t\troomId = eventName.split('/')[0]\n\n\t\t\tuser = Meteor.users.findOne @userId, {fields: {username: 1}}\n\t\t\troom = RocketChat.models.Rooms.findOneById(roomId)\n\t\t\tif room.t is 'l' and room.v._id is user._id\n\t\t\t\treturn true\n\n\t\t\treturn room.usernames.indexOf(user.username) > -1\n\n\t\t@streamRoomUsers.allowRead('none');\n\n\t\t@streamUser.allowRead (eventName) ->\n\t\t\tuserId = eventName.split('/')[0]\n\t\t\treturn @userId? and @userId is userId\n\n\n\tnotifyAll: (eventName, args...) ->\n\t\tconsole.log 'notifyAll', arguments if @debug is true\n\n\t\targs.unshift eventName\n\t\t@streamAll.emit.apply @streamAll, args\n\n\tnotifyLogged: (eventName, args...) ->\n\t\tconsole.log 'notifyLogged', arguments if @debug is true\n\n\t\targs.unshift eventName\n\t\t@streamLogged.emit.apply @streamLogged, args\n\n\tnotifyRoom: (room, eventName, args...) ->\n\t\tconsole.log 'notifyRoom', arguments if @debug is true\n\n\t\targs.unshift \"#{room}/#{eventName}\"\n\t\t@streamRoom.emit.apply @streamRoom, args\n\n\tnotifyUser: (userId, eventName, args...) ->\n\t\tconsole.log 'notifyUser', arguments if @debug is true\n\n\t\targs.unshift \"#{userId}/#{eventName}\"\n\t\t@streamUser.emit.apply @streamUser, args\n\n\n\tnotifyAllInThisInstance: (eventName, args...) ->\n\t\tconsole.log 'notifyAll', arguments if @debug is true\n\n\t\targs.unshift eventName\n\t\t@streamAll.emitWithoutBroadcast.apply @streamAll, args\n\n\tnotifyLoggedInThisInstance: (eventName, args...) ->\n\t\tconsole.log 'notifyLogged', arguments if @debug is true\n\n\t\targs.unshift eventName\n\t\t@streamLogged.emitWithoutBroadcast.apply @streamLogged, args\n\n\tnotifyRoomInThisInstance: (room, eventName, args...) ->\n\t\tconsole.log 'notifyRoomAndBroadcast', arguments if @debug is true\n\n\t\targs.unshift \"#{room}/#{eventName}\"\n\t\t@streamRoom.emitWithoutBroadcast.apply @streamRoom, args\n\n\tnotifyUserInThisInstance: (userId, eventName, args...) ->\n\t\tconsole.log 'notifyUserAndBroadcast', arguments if @debug is true\n\n\t\targs.unshift \"#{userId}/#{eventName}\"\n\t\t@streamUser.emitWithoutBroadcast.apply @streamUser, args\n\n\n## Permissions for client\n\n# Enable emit for event typing for rooms and add username to event data\nfunc = (eventName, username) ->\n\t[room, e] = eventName.split('/')\n\n\tif e is 'webrtc'\n\t\treturn true\n\n\tif e is 'typing'\n\t\tuser = Meteor.users.findOne(@userId, {fields: {username: 1}})\n\t\tif user?.username is username\n\t\t\treturn true\n\n\treturn false\n\nRocketChat.Notifications.streamRoom.allowWrite func\n","var func,\n  slice = [].slice;\n\nRocketChat.Notifications = new ((function() {\n  function _Class() {\n    var self;\n    self = this;\n    this.debug = false;\n    this.streamAll = new Meteor.Streamer('notify-all');\n    this.streamLogged = new Meteor.Streamer('notify-logged');\n    this.streamRoom = new Meteor.Streamer('notify-room');\n    this.streamRoomUsers = new Meteor.Streamer('notify-room-users');\n    this.streamUser = new Meteor.Streamer('notify-user');\n    this.streamAll.allowWrite('none');\n    this.streamLogged.allowWrite('none');\n    this.streamRoom.allowWrite('none');\n    this.streamRoomUsers.allowWrite(function() {\n      var args, e, eventName, i, len, ref, ref1, roomId, subscription, subscriptions, user;\n      eventName = arguments[0], args = 2 <= arguments.length ? slice.call(arguments, 1) : [];\n      ref = eventName.split('/'), roomId = ref[0], e = ref[1];\n      user = Meteor.users.findOne(this.userId, {\n        fields: {\n          username: 1\n        }\n      });\n      if (RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(roomId, this.userId) != null) {\n        subscriptions = RocketChat.models.Subscriptions.findByRoomIdAndNotUserId(roomId, this.userId).fetch();\n        for (i = 0, len = subscriptions.length; i < len; i++) {\n          subscription = subscriptions[i];\n          (ref1 = RocketChat.Notifications).notifyUser.apply(ref1, [subscription.u._id, e].concat(slice.call(args)));\n        }\n      }\n      return false;\n    });\n    this.streamUser.allowWrite('logged');\n    this.streamAll.allowRead('all');\n    this.streamLogged.allowRead('logged');\n    this.streamRoom.allowRead(function(eventName) {\n      var room, roomId, user;\n      if (this.userId == null) {\n        return false;\n      }\n      roomId = eventName.split('/')[0];\n      user = Meteor.users.findOne(this.userId, {\n        fields: {\n          username: 1\n        }\n      });\n      room = RocketChat.models.Rooms.findOneById(roomId);\n      if (room.t === 'l' && room.v._id === user._id) {\n        return true;\n      }\n      return room.usernames.indexOf(user.username) > -1;\n    });\n    this.streamRoomUsers.allowRead('none');\n    this.streamUser.allowRead(function(eventName) {\n      var userId;\n      userId = eventName.split('/')[0];\n      return (this.userId != null) && this.userId === userId;\n    });\n  }\n\n  _Class.prototype.notifyAll = function() {\n    var args, eventName;\n    eventName = arguments[0], args = 2 <= arguments.length ? slice.call(arguments, 1) : [];\n    if (this.debug === true) {\n      console.log('notifyAll', arguments);\n    }\n    args.unshift(eventName);\n    return this.streamAll.emit.apply(this.streamAll, args);\n  };\n\n  _Class.prototype.notifyLogged = function() {\n    var args, eventName;\n    eventName = arguments[0], args = 2 <= arguments.length ? slice.call(arguments, 1) : [];\n    if (this.debug === true) {\n      console.log('notifyLogged', arguments);\n    }\n    args.unshift(eventName);\n    return this.streamLogged.emit.apply(this.streamLogged, args);\n  };\n\n  _Class.prototype.notifyRoom = function() {\n    var args, eventName, room;\n    room = arguments[0], eventName = arguments[1], args = 3 <= arguments.length ? slice.call(arguments, 2) : [];\n    if (this.debug === true) {\n      console.log('notifyRoom', arguments);\n    }\n    args.unshift(room + \"/\" + eventName);\n    return this.streamRoom.emit.apply(this.streamRoom, args);\n  };\n\n  _Class.prototype.notifyUser = function() {\n    var args, eventName, userId;\n    userId = arguments[0], eventName = arguments[1], args = 3 <= arguments.length ? slice.call(arguments, 2) : [];\n    if (this.debug === true) {\n      console.log('notifyUser', arguments);\n    }\n    args.unshift(userId + \"/\" + eventName);\n    return this.streamUser.emit.apply(this.streamUser, args);\n  };\n\n  _Class.prototype.notifyAllInThisInstance = function() {\n    var args, eventName;\n    eventName = arguments[0], args = 2 <= arguments.length ? slice.call(arguments, 1) : [];\n    if (this.debug === true) {\n      console.log('notifyAll', arguments);\n    }\n    args.unshift(eventName);\n    return this.streamAll.emitWithoutBroadcast.apply(this.streamAll, args);\n  };\n\n  _Class.prototype.notifyLoggedInThisInstance = function() {\n    var args, eventName;\n    eventName = arguments[0], args = 2 <= arguments.length ? slice.call(arguments, 1) : [];\n    if (this.debug === true) {\n      console.log('notifyLogged', arguments);\n    }\n    args.unshift(eventName);\n    return this.streamLogged.emitWithoutBroadcast.apply(this.streamLogged, args);\n  };\n\n  _Class.prototype.notifyRoomInThisInstance = function() {\n    var args, eventName, room;\n    room = arguments[0], eventName = arguments[1], args = 3 <= arguments.length ? slice.call(arguments, 2) : [];\n    if (this.debug === true) {\n      console.log('notifyRoomAndBroadcast', arguments);\n    }\n    args.unshift(room + \"/\" + eventName);\n    return this.streamRoom.emitWithoutBroadcast.apply(this.streamRoom, args);\n  };\n\n  _Class.prototype.notifyUserInThisInstance = function() {\n    var args, eventName, userId;\n    userId = arguments[0], eventName = arguments[1], args = 3 <= arguments.length ? slice.call(arguments, 2) : [];\n    if (this.debug === true) {\n      console.log('notifyUserAndBroadcast', arguments);\n    }\n    args.unshift(userId + \"/\" + eventName);\n    return this.streamUser.emitWithoutBroadcast.apply(this.streamUser, args);\n  };\n\n  return _Class;\n\n})());\n\nfunc = function(eventName, username) {\n  var e, ref, room, user;\n  ref = eventName.split('/'), room = ref[0], e = ref[1];\n  if (e === 'webrtc') {\n    return true;\n  }\n  if (e === 'typing') {\n    user = Meteor.users.findOne(this.userId, {\n      fields: {\n        username: 1\n      }\n    });\n    if ((user != null ? user.username : void 0) === username) {\n      return true;\n    }\n  }\n  return false;\n};\n\nRocketChat.Notifications.streamRoom.allowWrite(func);\n","import ModelsBaseDb from './_BaseDb';\nimport ModelsBaseCache from './_BaseCache';\n\nRocketChat.models._CacheControl = new Meteor.EnvironmentVariable();\n\nclass ModelsBase {\n\tconstructor(nameOrModel, useCache) {\n\t\tthis._db = new ModelsBaseDb(nameOrModel, this);\n\t\tthis.model = this._db.model;\n\t\tthis.collectionName = this._db.collectionName;\n\t\tthis.name = this._db.name;\n\n\t\tthis._useCache = useCache === true;\n\n\t\tthis.cache = new ModelsBaseCache(this);\n\t\t// TODO_CACHE: remove\n\t\tthis.on = this.cache.on.bind(this.cache);\n\t\tthis.emit = this.cache.emit.bind(this.cache);\n\t\tthis.getDynamicView = this.cache.getDynamicView.bind(this.cache);\n\t\tthis.processQueryOptionsOnResult = this.cache.processQueryOptionsOnResult.bind(this.cache);\n\t\t// END_TODO_CACHE\n\n\t\tthis.db = this;\n\n\t\tif (this._useCache) {\n\t\t\tthis.db = new this.constructor(this.model, false);\n\t\t}\n\t}\n\n\tget useCache() {\n\t\tif (RocketChat.models._CacheControl.get() === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this._useCache;\n\t}\n\n\tget origin() {\n\t\treturn this.useCache === true ? 'cache' : '_db';\n\t}\n\n\tarrayToCursor(data) {\n\t\treturn {\n\t\t\tfetch() {\n\t\t\t\treturn data;\n\t\t\t},\n\t\t\tcount() {\n\t\t\t\treturn data.length;\n\t\t\t},\n\t\t\tforEach(fn) {\n\t\t\t\treturn data.forEach(fn);\n\t\t\t}\n\t\t};\n\t}\n\n\tsetUpdatedAt(/*record, checkQuery, query*/) {\n\t\treturn this._db.setUpdatedAt(...arguments);\n\t}\n\n\tfind() {\n\t\ttry {\n\t\t\treturn this[this.origin].find(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOne() {\n\t\ttry {\n\t\t\treturn this[this.origin].findOne(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOneById() {\n\t\ttry {\n\t\t\treturn this[this.origin].findOneById(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\tcheck(ids, [String]);\n\n\t\ttry {\n\t\t\treturn this[this.origin].findOneByIds(ids, options);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tinsert(/*record*/) {\n\t\treturn this._db.insert(...arguments);\n\t}\n\n\tupdate(/*query, update, options*/) {\n\t\treturn this._db.update(...arguments);\n\t}\n\n\tupsert(/*query, update*/) {\n\t\treturn this._db.upsert(...arguments);\n\t}\n\n\tremove(/*query*/) {\n\t\treturn this._db.remove(...arguments);\n\t}\n\n\tinsertOrUpsert() {\n\t\treturn this._db.insertOrUpsert(...arguments);\n\t}\n\n\tallow() {\n\t\treturn this._db.allow(...arguments);\n\t}\n\n\tdeny() {\n\t\treturn this._db.deny(...arguments);\n\t}\n\n\tensureIndex() {\n\t\treturn this._db.ensureIndex(...arguments);\n\t}\n\n\tdropIndex() {\n\t\treturn this._db.dropIndex(...arguments);\n\t}\n\n\ttryEnsureIndex() {\n\t\treturn this._db.tryEnsureIndex(...arguments);\n\t}\n\n\ttryDropIndex() {\n\t\treturn this._db.tryDropIndex(...arguments);\n\t}\n\n\ttrashFind(/*query, options*/) {\n\t\treturn this._db.trashFind(...arguments);\n\t}\n\n\ttrashFindDeletedAfter(/*deletedAt, query, options*/) {\n\t\treturn this._db.trashFindDeletedAfter(...arguments);\n\t}\n\n\t// dinamicTrashFindAfter(method, deletedAt, ...args) {\n\t// \tconst scope = {\n\t// \t\tfind: (query={}) => {\n\t// \t\t\treturn this.trashFindDeletedAfter(deletedAt, query, { fields: {_id: 1, _deletedAt: 1} });\n\t// \t\t}\n\t// \t};\n\n\t// \tscope.model = {\n\t// \t\tfind: scope.find\n\t// \t};\n\n\t// \treturn this[method].apply(scope, args);\n\t// }\n\n\t// dinamicFindAfter(method, updatedAt, ...args) {\n\t// \tconst scope = {\n\t// \t\tfind: (query={}, options) => {\n\t// \t\t\tquery._updatedAt = {\n\t// \t\t\t\t$gt: updatedAt\n\t// \t\t\t};\n\n\t// \t\t\treturn this.find(query, options);\n\t// \t\t}\n\t// \t};\n\n\t// \tscope.model = {\n\t// \t\tfind: scope.find\n\t// \t};\n\n\t// \treturn this[method].apply(scope, args);\n\t// }\n\n\t// dinamicFindChangesAfter(method, updatedAt, ...args) {\n\t// \treturn {\n\t// \t\tupdate: this.dinamicFindAfter(method, updatedAt, ...args).fetch(),\n\t// \t\tremove: this.dinamicTrashFindAfter(method, updatedAt, ...args).fetch()\n\t// \t};\n\t// }\n\n}\n\nRocketChat.models._Base = ModelsBase;\n","RocketChat.models.Messages = new class extends RocketChat.models._Base\n\tconstructor: ->\n\t\tsuper('message')\n\n\t\t@tryEnsureIndex { 'rid': 1, 'ts': 1 }\n\t\t@tryEnsureIndex { 'ts': 1 }\n\t\t@tryEnsureIndex { 'u._id': 1 }\n\t\t@tryEnsureIndex { 'editedAt': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'editedBy._id': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'rid': 1, 't': 1, 'u._id': 1 }\n\t\t@tryEnsureIndex { 'expireAt': 1 }, { expireAfterSeconds: 0 }\n\t\t@tryEnsureIndex { 'msg': 'text' }\n\t\t@tryEnsureIndex { 'file._id': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'mentions.username': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'pinned': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'snippeted': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'location': '2dsphere' }\n\t\t@tryEnsureIndex { 'slackBotId': 1, 'slackTs': 1 }, { sparse: 1 }\n\n\t# FIND\n\tfindByMention: (username, options) ->\n\t\tquery =\n\t\t\t\"mentions.username\": username\n\n\t\treturn @find query, options\n\n\tfindVisibleByMentionAndRoomId: (username, rid, options) ->\n\t\tquery =\n\t\t\t_hidden: { $ne: true }\n\t\t\t\"mentions.username\": username\n\t\t\t\"rid\": rid\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomId: (roomId, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\n\t\t\trid: roomId\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomIdNotContainingTypes: (roomId, types, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\n\t\t\trid: roomId\n\n\t\tif Match.test(types, [String]) and types.length > 0\n\t\t\tquery.t =\n\t\t\t\t$nin: types\n\n\t\treturn @find query, options\n\n\tfindInvisibleByRoomId: (roomId, options) ->\n\t\tquery =\n\t\t\t_hidden: true\n\t\t\trid: roomId\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomIdAfterTimestamp: (roomId, timestamp, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\t\t\trid: roomId\n\t\t\tts:\n\t\t\t\t$gt: timestamp\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomIdBeforeTimestamp: (roomId, timestamp, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\t\t\trid: roomId\n\t\t\tts:\n\t\t\t\t$lt: timestamp\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomIdBeforeTimestampInclusive: (roomId, timestamp, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\t\t\trid: roomId\n\t\t\tts:\n\t\t\t\t$lte: timestamp\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomIdBetweenTimestamps: (roomId, afterTimestamp, beforeTimestamp, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\t\t\trid: roomId\n\t\t\tts:\n\t\t\t\t$gt: afterTimestamp\n\t\t\t\t$lt: beforeTimestamp\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomIdBetweenTimestampsInclusive: (roomId, afterTimestamp, beforeTimestamp, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\t\t\trid: roomId\n\t\t\tts:\n\t\t\t\t$gte: afterTimestamp\n\t\t\t\t$lte: beforeTimestamp\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomIdBeforeTimestampNotContainingTypes: (roomId, timestamp, types, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\t\t\trid: roomId\n\t\t\tts:\n\t\t\t\t$lt: timestamp\n\n\t\tif Match.test(types, [String]) and types.length > 0\n\t\t\tquery.t =\n\t\t\t\t$nin: types\n\n\t\treturn @find query, options\n\n\tfindVisibleByRoomIdBetweenTimestampsNotContainingTypes: (roomId, afterTimestamp, beforeTimestamp, types, options) ->\n\t\tquery =\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\t\t\trid: roomId\n\t\t\tts:\n\t\t\t\t$gt: afterTimestamp\n\t\t\t\t$lt: beforeTimestamp\n\n\t\tif Match.test(types, [String]) and types.length > 0\n\t\t\tquery.t =\n\t\t\t\t$nin: types\n\n\t\treturn @find query, options\n\n\tfindVisibleCreatedOrEditedAfterTimestamp: (timestamp, options) ->\n\t\tquery =\n\t\t\t_hidden: { $ne: true }\n\t\t\t$or: [\n\t\t\t\tts:\n\t\t\t\t\t$gt: timestamp\n\t\t\t,\n\t\t\t\t'editedAt':\n\t\t\t\t\t$gt: timestamp\n\t\t\t]\n\n\t\treturn @find query, options\n\n\tfindStarredByUserAtRoom: (userId, roomId, options) ->\n\t\tquery =\n\t\t\t_hidden: { $ne: true }\n\t\t\t'starred._id': userId\n\t\t\trid: roomId\n\n\t\treturn @find query, options\n\n\tfindPinnedByRoom: (roomId, options) ->\n\t\tquery =\n\t\t\tt: { $ne: 'rm' }\n\t\t\t_hidden: { $ne: true }\n\t\t\tpinned: true\n\t\t\trid: roomId\n\n\t\treturn @find query, options\n\n\tfindSnippetedByRoom: (roomId, options) ->\n\t\tquery =\n\t\t\t_hidden: { $ne: true }\n\t\t\tsnippeted: true\n\t\t\trid: roomId\n\n\t\treturn @find query, options\n\n\tgetLastTimestamp: (options = {}) ->\n\t\tquery = { ts: { $exists: 1 } }\n\t\toptions.sort = { ts: -1 }\n\t\toptions.limit = 1\n\n\t\treturn @find(query, options)?.fetch?()?[0]?.ts\n\n\tfindByRoomIdAndMessageIds: (rid, messageIds, options) ->\n\t\tquery =\n\t\t\trid: rid\n\t\t\t_id:\n\t\t\t\t$in: messageIds\n\n\t\treturn @find query, options\n\n\tfindOneBySlackBotIdAndSlackTs: (slackBotId, slackTs) ->\n\t\tquery =\n\t\t\tslackBotId: slackBotId\n\t\t\tslackTs: slackTs\n\n\t\treturn @findOne query\n\n\tfindOneBySlackTs: (slackTs) ->\n\t\tquery =\n\t\t\tslackTs: slackTs\n\n\t\treturn @findOne query\n\n\tcloneAndSaveAsHistoryById: (_id) ->\n\t\tme = RocketChat.models.Users.findOneById Meteor.userId()\n\t\trecord = @findOneById _id\n\t\trecord._hidden = true\n\t\trecord.parent = record._id\n\t\trecord.editedAt = new Date\n\t\trecord.editedBy =\n\t\t\t_id: Meteor.userId()\n\t\t\tusername: me.username\n\t\tdelete record._id\n\t\treturn @insert record\n\n\t# UPDATE\n\tsetHiddenById: (_id, hidden=true) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t_hidden: hidden\n\n\t\treturn @update query, update\n\n\tsetAsDeletedByIdAndUser: (_id, user) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tmsg: ''\n\t\t\t\tt: 'rm'\n\t\t\t\turls: []\n\t\t\t\tmentions: []\n\t\t\t\tattachments: []\n\t\t\t\treactions: []\n\t\t\t\teditedAt: new Date()\n\t\t\t\teditedBy:\n\t\t\t\t\t_id: user._id\n\t\t\t\t\tusername: user.username\n\n\t\treturn @update query, update\n\n\tsetPinnedByIdAndUserId: (_id, pinnedBy, pinned=true, pinnedAt=0) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tpinned: pinned\n\t\t\t\tpinnedAt: pinnedAt || new Date\n\t\t\t\tpinnedBy: pinnedBy\n\n\t\treturn @update query, update\n\n\tsetSnippetedByIdAndUserId: (message, snippetName, snippetedBy, snippeted=true, snippetedAt=0) ->\n\t\tquery =\n\t\t\t_id: message._id\n\n\t\tmsg = \"```\" + message.msg + \"```\"\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tmsg: msg\n\t\t\t\tsnippeted: snippeted\n\t\t\t\tsnippetedAt: snippetedAt || new Date\n\t\t\t\tsnippetedBy: snippetedBy\n\t\t\t\tsnippetName: snippetName\n\n\t\treturn @update query, update\n\n\tsetUrlsById: (_id, urls) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\turls: urls\n\n\t\treturn @update query, update\n\n\tupdateAllUsernamesByUserId: (userId, username) ->\n\t\tquery =\n\t\t\t'u._id': userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"u.username\": username\n\n\t\treturn @update query, update, { multi: true }\n\n\tupdateUsernameOfEditByUserId: (userId, username) ->\n\t\tquery =\n\t\t\t'editedBy._id': userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"editedBy.username\": username\n\n\t\treturn @update query, update, { multi: true }\n\n\tupdateUsernameAndMessageOfMentionByIdAndOldUsername: (_id, oldUsername, newUsername, newMessage) ->\n\t\tquery =\n\t\t\t_id: _id\n\t\t\t\"mentions.username\": oldUsername\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"mentions.$.username\": newUsername\n\t\t\t\t\"msg\": newMessage\n\n\t\treturn @update query, update\n\n\tupdateUserStarById: (_id, userId, starred) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tif starred\n\t\t\tupdate =\n\t\t\t\t$addToSet:\n\t\t\t\t\tstarred: { _id: userId }\n\t\telse\n\t\t\tupdate =\n\t\t\t\t$pull:\n\t\t\t\t\tstarred: { _id: Meteor.userId() }\n\n\t\treturn @update query, update\n\n\tupgradeEtsToEditAt: ->\n\t\tquery =\n\t\t\tets: { $exists: 1 }\n\n\t\tupdate =\n\t\t\t$rename:\n\t\t\t\t\"ets\": \"editedAt\"\n\n\t\treturn @update query, update, { multi: true }\n\n\tsetMessageAttachments: (_id, attachments) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tattachments: attachments\n\n\t\treturn @update query, update\n\n\tsetSlackBotIdAndSlackTs: (_id, slackBotId, slackTs) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tslackBotId: slackBotId\n\t\t\t\tslackTs: slackTs\n\n\t\treturn @update query, update\n\n\n\t# INSERT\n\tcreateWithTypeRoomIdMessageAndUser: (type, roomId, message, user, extraData) ->\n\t\troom = RocketChat.models.Rooms.findOneById roomId, { fields: { sysMes: 1 }}\n\t\tif room?.sysMes is false\n\t\t\treturn\n\t\trecord =\n\t\t\tt: type\n\t\t\trid: roomId\n\t\t\tts: new Date\n\t\t\tmsg: message\n\t\t\tu:\n\t\t\t\t_id: user._id\n\t\t\t\tusername: user.username\n\t\t\tgroupable: false\n\n\t\t_.extend record, extraData\n\n\t\trecord._id = @insertOrUpsert record\n\t\tRocketChat.models.Rooms.incMsgCountById(room._id, 1)\n\t\treturn record\n\n\tcreateUserJoinWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'uj', roomId, message, user, extraData\n\n\tcreateUserLeaveWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'ul', roomId, message, user, extraData\n\n\tcreateUserRemovedWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'ru', roomId, message, user, extraData\n\n\tcreateUserAddedWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'au', roomId, message, user, extraData\n\n\tcreateCommandWithRoomIdAndUser: (command, roomId, user, extraData) ->\n\t\treturn @createWithTypeRoomIdMessageAndUser 'command', roomId, command, user, extraData\n\n\tcreateUserMutedWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'user-muted', roomId, message, user, extraData\n\n\tcreateUserUnmutedWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'user-unmuted', roomId, message, user, extraData\n\n\tcreateNewModeratorWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'new-moderator', roomId, message, user, extraData\n\n\tcreateModeratorRemovedWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'moderator-removed', roomId, message, user, extraData\n\n\tcreateNewOwnerWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'new-owner', roomId, message, user, extraData\n\n\tcreateOwnerRemovedWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'owner-removed', roomId, message, user, extraData\n\n\tcreateSubscriptionRoleAddedWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'subscription-role-added', roomId, message, user, extraData\n\n\tcreateSubscriptionRoleRemovedWithRoomIdAndUser: (roomId, user, extraData) ->\n\t\tmessage = user.username\n\t\treturn @createWithTypeRoomIdMessageAndUser 'subscription-role-removed', roomId, message, user, extraData\n\n\t# REMOVE\n\tremoveById: (_id) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\treturn @remove query\n\n\tremoveByRoomId: (roomId) ->\n\t\tquery =\n\t\t\trid: roomId\n\n\t\treturn @remove query\n\n\tremoveByUserId: (userId) ->\n\t\tquery =\n\t\t\t\"u._id\": userId\n\n\t\treturn @remove query\n\n\tgetMessageByFileId: (fileID) ->\n\t\treturn @findOne { 'file._id': fileID }\n","var extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nRocketChat.models.Messages = new ((function(superClass) {\n  extend(_Class, superClass);\n\n  function _Class() {\n    _Class.__super__.constructor.call(this, 'message');\n    this.tryEnsureIndex({\n      'rid': 1,\n      'ts': 1\n    });\n    this.tryEnsureIndex({\n      'ts': 1\n    });\n    this.tryEnsureIndex({\n      'u._id': 1\n    });\n    this.tryEnsureIndex({\n      'editedAt': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'editedBy._id': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'rid': 1,\n      't': 1,\n      'u._id': 1\n    });\n    this.tryEnsureIndex({\n      'expireAt': 1\n    }, {\n      expireAfterSeconds: 0\n    });\n    this.tryEnsureIndex({\n      'msg': 'text'\n    });\n    this.tryEnsureIndex({\n      'file._id': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'mentions.username': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'pinned': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'snippeted': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'location': '2dsphere'\n    });\n    this.tryEnsureIndex({\n      'slackBotId': 1,\n      'slackTs': 1\n    }, {\n      sparse: 1\n    });\n  }\n\n  _Class.prototype.findByMention = function(username, options) {\n    var query;\n    query = {\n      \"mentions.username\": username\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByMentionAndRoomId = function(username, rid, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      \"mentions.username\": username,\n      \"rid\": rid\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomId = function(roomId, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomIdNotContainingTypes = function(roomId, types, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId\n    };\n    if (Match.test(types, [String]) && types.length > 0) {\n      query.t = {\n        $nin: types\n      };\n    }\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findInvisibleByRoomId = function(roomId, options) {\n    var query;\n    query = {\n      _hidden: true,\n      rid: roomId\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomIdAfterTimestamp = function(roomId, timestamp, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId,\n      ts: {\n        $gt: timestamp\n      }\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomIdBeforeTimestamp = function(roomId, timestamp, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId,\n      ts: {\n        $lt: timestamp\n      }\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomIdBeforeTimestampInclusive = function(roomId, timestamp, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId,\n      ts: {\n        $lte: timestamp\n      }\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomIdBetweenTimestamps = function(roomId, afterTimestamp, beforeTimestamp, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId,\n      ts: {\n        $gt: afterTimestamp,\n        $lt: beforeTimestamp\n      }\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomIdBetweenTimestampsInclusive = function(roomId, afterTimestamp, beforeTimestamp, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId,\n      ts: {\n        $gte: afterTimestamp,\n        $lte: beforeTimestamp\n      }\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomIdBeforeTimestampNotContainingTypes = function(roomId, timestamp, types, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId,\n      ts: {\n        $lt: timestamp\n      }\n    };\n    if (Match.test(types, [String]) && types.length > 0) {\n      query.t = {\n        $nin: types\n      };\n    }\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleByRoomIdBetweenTimestampsNotContainingTypes = function(roomId, afterTimestamp, beforeTimestamp, types, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      rid: roomId,\n      ts: {\n        $gt: afterTimestamp,\n        $lt: beforeTimestamp\n      }\n    };\n    if (Match.test(types, [String]) && types.length > 0) {\n      query.t = {\n        $nin: types\n      };\n    }\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findVisibleCreatedOrEditedAfterTimestamp = function(timestamp, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      $or: [\n        {\n          ts: {\n            $gt: timestamp\n          }\n        }, {\n          'editedAt': {\n            $gt: timestamp\n          }\n        }\n      ]\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findStarredByUserAtRoom = function(userId, roomId, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      'starred._id': userId,\n      rid: roomId\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findPinnedByRoom = function(roomId, options) {\n    var query;\n    query = {\n      t: {\n        $ne: 'rm'\n      },\n      _hidden: {\n        $ne: true\n      },\n      pinned: true,\n      rid: roomId\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findSnippetedByRoom = function(roomId, options) {\n    var query;\n    query = {\n      _hidden: {\n        $ne: true\n      },\n      snippeted: true,\n      rid: roomId\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.getLastTimestamp = function(options) {\n    var query, ref, ref1, ref2;\n    if (options == null) {\n      options = {};\n    }\n    query = {\n      ts: {\n        $exists: 1\n      }\n    };\n    options.sort = {\n      ts: -1\n    };\n    options.limit = 1;\n    return (ref = this.find(query, options)) != null ? typeof ref.fetch === \"function\" ? (ref1 = ref.fetch()) != null ? (ref2 = ref1[0]) != null ? ref2.ts : void 0 : void 0 : void 0 : void 0;\n  };\n\n  _Class.prototype.findByRoomIdAndMessageIds = function(rid, messageIds, options) {\n    var query;\n    query = {\n      rid: rid,\n      _id: {\n        $in: messageIds\n      }\n    };\n    return this.find(query, options);\n  };\n\n  _Class.prototype.findOneBySlackBotIdAndSlackTs = function(slackBotId, slackTs) {\n    var query;\n    query = {\n      slackBotId: slackBotId,\n      slackTs: slackTs\n    };\n    return this.findOne(query);\n  };\n\n  _Class.prototype.findOneBySlackTs = function(slackTs) {\n    var query;\n    query = {\n      slackTs: slackTs\n    };\n    return this.findOne(query);\n  };\n\n  _Class.prototype.cloneAndSaveAsHistoryById = function(_id) {\n    var me, record;\n    me = RocketChat.models.Users.findOneById(Meteor.userId());\n    record = this.findOneById(_id);\n    record._hidden = true;\n    record.parent = record._id;\n    record.editedAt = new Date;\n    record.editedBy = {\n      _id: Meteor.userId(),\n      username: me.username\n    };\n    delete record._id;\n    return this.insert(record);\n  };\n\n  _Class.prototype.setHiddenById = function(_id, hidden) {\n    var query, update;\n    if (hidden == null) {\n      hidden = true;\n    }\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        _hidden: hidden\n      }\n    };\n    return this.update(query, update);\n  };\n\n  _Class.prototype.setAsDeletedByIdAndUser = function(_id, user) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        msg: '',\n        t: 'rm',\n        urls: [],\n        mentions: [],\n        attachments: [],\n        reactions: [],\n        editedAt: new Date(),\n        editedBy: {\n          _id: user._id,\n          username: user.username\n        }\n      }\n    };\n    return this.update(query, update);\n  };\n\n  _Class.prototype.setPinnedByIdAndUserId = function(_id, pinnedBy, pinned, pinnedAt) {\n    var query, update;\n    if (pinned == null) {\n      pinned = true;\n    }\n    if (pinnedAt == null) {\n      pinnedAt = 0;\n    }\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        pinned: pinned,\n        pinnedAt: pinnedAt || new Date,\n        pinnedBy: pinnedBy\n      }\n    };\n    return this.update(query, update);\n  };\n\n  _Class.prototype.setSnippetedByIdAndUserId = function(message, snippetName, snippetedBy, snippeted, snippetedAt) {\n    var msg, query, update;\n    if (snippeted == null) {\n      snippeted = true;\n    }\n    if (snippetedAt == null) {\n      snippetedAt = 0;\n    }\n    query = {\n      _id: message._id\n    };\n    msg = \"```\" + message.msg + \"```\";\n    update = {\n      $set: {\n        msg: msg,\n        snippeted: snippeted,\n        snippetedAt: snippetedAt || new Date,\n        snippetedBy: snippetedBy,\n        snippetName: snippetName\n      }\n    };\n    return this.update(query, update);\n  };\n\n  _Class.prototype.setUrlsById = function(_id, urls) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        urls: urls\n      }\n    };\n    return this.update(query, update);\n  };\n\n  _Class.prototype.updateAllUsernamesByUserId = function(userId, username) {\n    var query, update;\n    query = {\n      'u._id': userId\n    };\n    update = {\n      $set: {\n        \"u.username\": username\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  _Class.prototype.updateUsernameOfEditByUserId = function(userId, username) {\n    var query, update;\n    query = {\n      'editedBy._id': userId\n    };\n    update = {\n      $set: {\n        \"editedBy.username\": username\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  _Class.prototype.updateUsernameAndMessageOfMentionByIdAndOldUsername = function(_id, oldUsername, newUsername, newMessage) {\n    var query, update;\n    query = {\n      _id: _id,\n      \"mentions.username\": oldUsername\n    };\n    update = {\n      $set: {\n        \"mentions.$.username\": newUsername,\n        \"msg\": newMessage\n      }\n    };\n    return this.update(query, update);\n  };\n\n  _Class.prototype.updateUserStarById = function(_id, userId, starred) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    if (starred) {\n      update = {\n        $addToSet: {\n          starred: {\n            _id: userId\n          }\n        }\n      };\n    } else {\n      update = {\n        $pull: {\n          starred: {\n            _id: Meteor.userId()\n          }\n        }\n      };\n    }\n    return this.update(query, update);\n  };\n\n  _Class.prototype.upgradeEtsToEditAt = function() {\n    var query, update;\n    query = {\n      ets: {\n        $exists: 1\n      }\n    };\n    update = {\n      $rename: {\n        \"ets\": \"editedAt\"\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  _Class.prototype.setMessageAttachments = function(_id, attachments) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        attachments: attachments\n      }\n    };\n    return this.update(query, update);\n  };\n\n  _Class.prototype.setSlackBotIdAndSlackTs = function(_id, slackBotId, slackTs) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        slackBotId: slackBotId,\n        slackTs: slackTs\n      }\n    };\n    return this.update(query, update);\n  };\n\n  _Class.prototype.createWithTypeRoomIdMessageAndUser = function(type, roomId, message, user, extraData) {\n    var record, room;\n    room = RocketChat.models.Rooms.findOneById(roomId, {\n      fields: {\n        sysMes: 1\n      }\n    });\n    if ((room != null ? room.sysMes : void 0) === false) {\n      return;\n    }\n    record = {\n      t: type,\n      rid: roomId,\n      ts: new Date,\n      msg: message,\n      u: {\n        _id: user._id,\n        username: user.username\n      },\n      groupable: false\n    };\n    _.extend(record, extraData);\n    record._id = this.insertOrUpsert(record);\n    RocketChat.models.Rooms.incMsgCountById(room._id, 1);\n    return record;\n  };\n\n  _Class.prototype.createUserJoinWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('uj', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createUserLeaveWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('ul', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createUserRemovedWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('ru', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createUserAddedWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('au', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createCommandWithRoomIdAndUser = function(command, roomId, user, extraData) {\n    return this.createWithTypeRoomIdMessageAndUser('command', roomId, command, user, extraData);\n  };\n\n  _Class.prototype.createUserMutedWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('user-muted', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createUserUnmutedWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('user-unmuted', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createNewModeratorWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('new-moderator', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createModeratorRemovedWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('moderator-removed', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createNewOwnerWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('new-owner', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createOwnerRemovedWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('owner-removed', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createSubscriptionRoleAddedWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('subscription-role-added', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.createSubscriptionRoleRemovedWithRoomIdAndUser = function(roomId, user, extraData) {\n    var message;\n    message = user.username;\n    return this.createWithTypeRoomIdMessageAndUser('subscription-role-removed', roomId, message, user, extraData);\n  };\n\n  _Class.prototype.removeById = function(_id) {\n    var query;\n    query = {\n      _id: _id\n    };\n    return this.remove(query);\n  };\n\n  _Class.prototype.removeByRoomId = function(roomId) {\n    var query;\n    query = {\n      rid: roomId\n    };\n    return this.remove(query);\n  };\n\n  _Class.prototype.removeByUserId = function(userId) {\n    var query;\n    query = {\n      \"u._id\": userId\n    };\n    return this.remove(query);\n  };\n\n  _Class.prototype.getMessageByFileId = function(fileID) {\n    return this.findOne({\n      'file._id': fileID\n    });\n  };\n\n  return _Class;\n\n})(RocketChat.models._Base));\n","RocketChat.models.Reports = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('reports');\n\t}\n\tcreateWithMessageDescriptionAndUserId(message, description, userId, extraData) {\n\t\tconst record = {\n\t\t\tmessage,\n\t\t\tdescription,\n\t\t\tts: new Date(),\n\t\t\tuserId\n\t\t};\n\t\t_.extend(record, extraData);\n\t\trecord._id = this.insert(record);\n\t\treturn record;\n\t}\n};\n","class ModelRooms extends RocketChat.models._Base\n\tconstructor: ->\n\t\tsuper(arguments...)\n\n\t\t@tryEnsureIndex { 'name': 1 }, { unique: 1, sparse: 1 }\n\t\t@tryEnsureIndex { 'default': 1 }\n\t\t@tryEnsureIndex { 'usernames': 1 }\n\t\t@tryEnsureIndex { 't': 1 }\n\t\t@tryEnsureIndex { 'u._id': 1 }\n\n\t\tthis.cache.ignoreUpdatedFields.push('msgs', 'lm')\n\t\tthis.cache.ensureIndex(['t', 'name'], 'unique')\n\t\tthis.cache.options = {fields: {usernames: 0}}\n\n\tfindOneByIdOrName: (_idOrName, options) ->\n\t\tquery = {\n\t\t\t$or: [{\n\t\t\t\t_id: _idOrName\n\t\t\t}, {\n\t\t\t\tname: _idOrName\n\t\t\t}]\n\t\t}\n\n\t\treturn this.findOne(query, options)\n\n\tfindOneByImportId: (_id, options) ->\n\t\tquery =\n\t\t\timportIds: _id\n\n\t\treturn @findOne query, options\n\n\tfindOneByName: (name, options) ->\n\t\tquery =\n\t\t\tname: name\n\n\t\treturn @findOne query, options\n\n\tfindOneByNameAndType: (name, type, options) ->\n\t\tquery =\n\t\t\tname: name\n\t\t\tt: type\n\n\t\treturn @findOne query, options\n\n\tfindOneByIdContainingUsername: (_id, username, options) ->\n\t\tquery =\n\t\t\t_id: _id\n\t\t\tusernames: username\n\n\t\treturn @findOne query, options\n\n\tfindOneByNameAndTypeNotContainingUsername: (name, type, username, options) ->\n\t\tquery =\n\t\t\tname: name\n\t\t\tt: type\n\t\t\tusernames:\n\t\t\t\t$ne: username\n\n\t\treturn @findOne query, options\n\n\n\t# FIND\n\n\tfindById: (roomId, options) ->\n\t\treturn @find { _id: roomId }, options\n\n\tfindByIds: (roomIds, options) ->\n\t\treturn @find { _id: $in: [].concat roomIds }, options\n\n\tfindByType: (type, options) ->\n\t\tquery =\n\t\t\tt: type\n\n\t\treturn @find query, options\n\n\tfindByTypes: (types, options) ->\n\t\tquery =\n\t\t\tt:\n\t\t\t\t$in: types\n\n\t\treturn @find query, options\n\n\tfindByUserId: (userId, options) ->\n\t\tquery =\n\t\t\t\"u._id\": userId\n\n\t\treturn @find query, options\n\n\tfindBySubscriptionUserId: (userId, options) ->\n\t\tif this.useCache\n\t\t\tdata = RocketChat.models.Subscriptions.findByUserId(userId).fetch()\n\t\t\tdata = data.map (item) ->\n\t\t\t\tif item._room\n\t\t\t\t\treturn item._room\n\t\t\t\tconsole.log('Empty Room for Subscription', item);\n\t\t\t\treturn {}\n\t\t\treturn this.arrayToCursor this.processQueryOptionsOnResult(data, options)\n\n\t\tdata = RocketChat.models.Subscriptions.findByUserId(userId, {fields: {rid: 1}}).fetch()\n\t\tdata = data.map (item) -> item.rid\n\n\t\tquery =\n\t\t\t_id:\n\t\t\t\t$in: data\n\n\t\tthis.find query, options\n\n\tfindBySubscriptionUserIdUpdatedAfter: (userId, _updatedAt, options) ->\n\t\tif this.useCache\n\t\t\tdata = RocketChat.models.Subscriptions.findByUserId(userId).fetch()\n\t\t\tdata = data.map (item) ->\n\t\t\t\tif item._room\n\t\t\t\t\treturn item._room\n\t\t\t\tconsole.log('Empty Room for Subscription', item);\n\t\t\t\treturn {}\n\t\t\tdata = data.filter (item) -> item._updatedAt > _updatedAt\n\t\t\treturn this.arrayToCursor this.processQueryOptionsOnResult(data, options)\n\n\t\tids = RocketChat.models.Subscriptions.findByUserId(userId, {fields: {rid: 1}}).fetch()\n\t\tids = ids.map (item) -> item.rid\n\n\t\tquery =\n\t\t\t_id:\n\t\t\t\t$in: ids\n\t\t\t_updatedAt:\n\t\t\t\t$gt: _updatedAt\n\n\t\tthis.find query, options\n\n\tfindByNameContaining: (name, options) ->\n\t\tnameRegex = new RegExp s.trim(s.escapeRegExp(name)), \"i\"\n\n\t\tquery =\n\t\t\t$or: [\n\t\t\t\tname: nameRegex\n\t\t\t,\n\t\t\t\tt: 'd'\n\t\t\t\tusernames: nameRegex\n\t\t\t]\n\n\t\treturn @find query, options\n\n\tfindByNameContainingTypesWithUsername: (name, types, options) ->\n\t\tnameRegex = new RegExp s.trim(s.escapeRegExp(name)), \"i\"\n\n\t\t$or = []\n\t\tfor type in types\n\t\t\tobj = {name: nameRegex, t: type.type}\n\t\t\tif type.username?\n\t\t\t\tobj.usernames = type.username\n\t\t\tif type.ids?\n\t\t\t\tobj._id = $in: type.ids\n\t\t\t$or.push obj\n\n\t\tquery =\n\t\t\t$or: $or\n\n\t\treturn @find query, options\n\n\tfindContainingTypesWithUsername: (types, options) ->\n\n\t\t$or = []\n\t\tfor type in types\n\t\t\tobj = {t: type.type}\n\t\t\tif type.username?\n\t\t\t\tobj.usernames = type.username\n\t\t\tif type.ids?\n\t\t\t\tobj._id = $in: type.ids\n\t\t\t$or.push obj\n\n\t\tquery =\n\t\t\t$or: $or\n\n\t\treturn @find query, options\n\n\tfindByNameContainingAndTypes: (name, types, options) ->\n\t\tnameRegex = new RegExp s.trim(s.escapeRegExp(name)), \"i\"\n\n\t\tquery =\n\t\t\tt:\n\t\t\t\t$in: types\n\t\t\t$or: [\n\t\t\t\tname: nameRegex\n\t\t\t,\n\t\t\t\tt: 'd'\n\t\t\t\tusernames: nameRegex\n\t\t\t]\n\n\t\treturn @find query, options\n\n\tfindByNameAndType: (name, type, options) ->\n\t\tquery =\n\t\t\tt: type\n\t\t\tname: name\n\n\t\treturn @find query, options\n\n\tfindByNameAndTypeNotDefault: (name, type, options) ->\n\t\tquery =\n\t\t\tt: type\n\t\t\tname: name\n\t\t\tdefault:\n\t\t\t\t$ne: true\n\n\t\treturn @find query, options\n\n\tfindByNameAndTypeNotContainingUsername: (name, type, username, options) ->\n\t\tquery =\n\t\t\tt: type\n\t\t\tname: name\n\t\t\tusernames:\n\t\t\t\t$ne: username\n\n\t\treturn @find query, options\n\n\tfindByNameStartingAndTypes: (name, types, options) ->\n\t\tnameRegex = new RegExp \"^\" + s.trim(s.escapeRegExp(name)), \"i\"\n\n\t\tquery =\n\t\t\tt:\n\t\t\t\t$in: types\n\t\t\t$or: [\n\t\t\t\tname: nameRegex\n\t\t\t,\n\t\t\t\tt: 'd'\n\t\t\t\tusernames: nameRegex\n\t\t\t]\n\n\t\treturn @find query, options\n\n\tfindByDefaultAndTypes: (defaultValue, types, options) ->\n\t\tquery =\n\t\t\tdefault: defaultValue\n\t\t\tt:\n\t\t\t\t$in: types\n\n\t\treturn @find query, options\n\n\tfindByTypeContainingUsername: (type, username, options) ->\n\t\tquery =\n\t\t\tt: type\n\t\t\tusernames: username\n\n\t\treturn @find query, options\n\n\tfindByTypeContainingUsernames: (type, username, options) ->\n\t\tquery =\n\t\t\tt: type\n\t\t\tusernames: { $all: [].concat(username) }\n\n\t\treturn @find query, options\n\n\tfindByTypesAndNotUserIdContainingUsername: (types, userId, username, options) ->\n\t\tquery =\n\t\t\tt:\n\t\t\t\t$in: types\n\t\t\tuid:\n\t\t\t\t$ne: userId\n\t\t\tusernames: username\n\n\t\treturn @find query, options\n\n\tfindByContainingUsername: (username, options) ->\n\t\tquery =\n\t\t\tusernames: username\n\n\t\treturn @find query, options\n\n\tfindByTypeAndName: (type, name, options) ->\n\t\tif this.useCache\n\t\t\treturn this.cache.findByIndex('t,name', [type, name], options)\n\n\t\tquery =\n\t\t\tname: name\n\t\t\tt: type\n\n\t\treturn @find query, options\n\n\tfindByTypeAndNameContainingUsername: (type, name, username, options) ->\n\t\tquery =\n\t\t\tname: name\n\t\t\tt: type\n\t\t\tusernames: username\n\n\t\treturn @find query, options\n\n\tfindByTypeAndArchivationState: (type, archivationstate, options) ->\n\t\tquery =\n\t\t\tt: type\n\n\t\tif archivationstate\n\t\t\tquery.archived = true\n\t\telse\n\t\t\tquery.archived = { $ne: true }\n\n\t\treturn @find query, options\n\n\t# UPDATE\n\taddImportIds: (_id, importIds) ->\n\t\timportIds = [].concat(importIds);\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$addToSet:\n\t\t\t\timportIds:\n\t\t\t\t\t$each: importIds\n\n\t\treturn @update query, update\n\n\tarchiveById: (_id) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tarchived: true\n\n\t\treturn @update query, update\n\n\tunarchiveById: (_id) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tarchived: false\n\n\t\treturn @update query, update\n\n\taddUsernameById: (_id, username, muted) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$addToSet:\n\t\t\t\tusernames: username\n\n\t\tif muted\n\t\t\tupdate.$addToSet.muted = username\n\n\t\treturn @update query, update\n\n\taddUsernamesById: (_id, usernames) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$addToSet:\n\t\t\t\tusernames:\n\t\t\t\t\t$each: usernames\n\n\t\treturn @update query, update\n\n\taddUsernameByName: (name, username) ->\n\t\tquery =\n\t\t\tname: name\n\n\t\tupdate =\n\t\t\t$addToSet:\n\t\t\t\tusernames: username\n\n\t\treturn @update query, update\n\n\tremoveUsernameById: (_id, username) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$pull:\n\t\t\t\tusernames: username\n\n\t\treturn @update query, update\n\n\tremoveUsernamesById: (_id, usernames) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$pull:\n\t\t\t\tusernames:\n\t\t\t\t\t$in: usernames\n\n\t\treturn @update query, update\n\n\tremoveUsernameFromAll: (username) ->\n\t\tquery =\n\t\t\tusernames: username\n\n\t\tupdate =\n\t\t\t$pull:\n\t\t\t\tusernames: username\n\n\t\treturn @update query, update, { multi: true }\n\n\tremoveUsernameByName: (name, username) ->\n\t\tquery =\n\t\t\tname: name\n\n\t\tupdate =\n\t\t\t$pull:\n\t\t\t\tusernames: username\n\n\t\treturn @update query, update\n\n\tsetNameById: (_id, name) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tname: name\n\n\t\treturn @update query, update\n\n\tincMsgCountById: (_id, inc=1) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$inc:\n\t\t\t\tmsgs: inc\n\n\t\treturn @update query, update\n\n\tincMsgCountAndSetLastMessageTimestampById: (_id, inc=1, lastMessageTimestamp) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tlm: lastMessageTimestamp\n\t\t\t$inc:\n\t\t\t\tmsgs: inc\n\n\t\treturn @update query, update\n\n\treplaceUsername: (previousUsername, username) ->\n\t\tquery =\n\t\t\tusernames: previousUsername\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"usernames.$\": username\n\n\t\treturn @update query, update, { multi: true }\n\n\treplaceMutedUsername: (previousUsername, username) ->\n\t\tquery =\n\t\t\tmuted: previousUsername\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"muted.$\": username\n\n\t\treturn @update query, update, { multi: true }\n\n\treplaceUsernameOfUserByUserId: (userId, username) ->\n\t\tquery =\n\t\t\t\"u._id\": userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"u.username\": username\n\n\t\treturn @update query, update, { multi: true }\n\n\tsetJoinCodeById: (_id, joinCode) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tif joinCode?.trim() isnt ''\n\t\t\tupdate =\n\t\t\t\t$set:\n\t\t\t\t\tjoinCodeRequired: true\n\t\t\t\t\tjoinCode: joinCode\n\t\telse\n\t\t\tupdate =\n\t\t\t\t$set:\n\t\t\t\t\tjoinCodeRequired: false\n\t\t\t\t$unset:\n\t\t\t\t\tjoinCode: 1\n\n\t\treturn @update query, update\n\n\tsetUserById: (_id, user) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tu:\n\t\t\t\t\t_id: user._id\n\t\t\t\t\tusername: user.username\n\n\t\treturn @update query, update\n\n\tsetTypeById: (_id, type) ->\n\t\tquery =\n\t\t\t_id: _id\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tt: type\n\t\tif type == 'p'\n\t\t\tupdate.$unset = {default: ''}\n\n\t\treturn @update query, update\n\n\tsetTopicById: (_id, topic) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\ttopic: topic\n\n\t\treturn @update query, update\n\n\tsetAnnouncementById: (_id, announcement) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tannouncement: announcement\n\n\t\treturn @update query, update\n\n\tmuteUsernameByRoomId: (_id, username) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$addToSet:\n\t\t\t\tmuted: username\n\n\t\treturn @update query, update\n\n\tunmuteUsernameByRoomId: (_id, username) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$pull:\n\t\t\t\tmuted: username\n\n\t\treturn @update query, update\n\n\tsaveDefaultById: (_id, defaultValue) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tdefault: defaultValue is 'true'\n\n\t\treturn @update query, update\n\n\tsetTopicAndTagsById: (_id, topic, tags) ->\n\t\tsetData = {}\n\t\tunsetData = {}\n\n\t\tif topic?\n\t\t\tif not _.isEmpty(s.trim(topic))\n\t\t\t\tsetData.topic = s.trim(topic)\n\t\t\telse\n\t\t\t\tunsetData.topic = 1\n\n\t\tif tags?\n\t\t\tif not _.isEmpty(s.trim(tags))\n\t\t\t\tsetData.tags = s.trim(tags).split(',').map((tag) => return s.trim(tag))\n\t\t\telse\n\t\t\t\tunsetData.tags = 1\n\n\t\tupdate = {}\n\n\t\tif not _.isEmpty setData\n\t\t\tupdate.$set = setData\n\n\t\tif not _.isEmpty unsetData\n\t\t\tupdate.$unset = unsetData\n\n\t\tif _.isEmpty update\n\t\t\treturn\n\n\t\treturn @update { _id: _id }, update\n\n\t# INSERT\n\tcreateWithTypeNameUserAndUsernames: (type, name, user, usernames, extraData) ->\n\t\troom =\n\t\t\tname: name\n\t\t\tt: type\n\t\t\tusernames: usernames\n\t\t\tmsgs: 0\n\t\t\tu:\n\t\t\t\t_id: user._id\n\t\t\t\tusername: user.username\n\n\t\t_.extend room, extraData\n\n\t\troom._id = @insert room\n\t\treturn room\n\n\tcreateWithIdTypeAndName: (_id, type, name, extraData) ->\n\t\troom =\n\t\t\t_id: _id\n\t\t\tts: new Date()\n\t\t\tt: type\n\t\t\tname: name\n\t\t\tusernames: []\n\t\t\tmsgs: 0\n\n\t\t_.extend room, extraData\n\n\t\t@insert room\n\t\treturn room\n\n\n\t# REMOVE\n\tremoveById: (_id) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\treturn @remove query\n\n\tremoveByTypeContainingUsername: (type, username) ->\n\t\tquery =\n\t\t\tt: type\n\t\t\tusernames: username\n\n\t\treturn @remove query\n\nRocketChat.models.Rooms = new ModelRooms('room', true)\n","var ModelRooms,\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nModelRooms = (function(superClass) {\n  extend(ModelRooms, superClass);\n\n  function ModelRooms() {\n    ModelRooms.__super__.constructor.apply(this, arguments);\n    this.tryEnsureIndex({\n      'name': 1\n    }, {\n      unique: 1,\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'default': 1\n    });\n    this.tryEnsureIndex({\n      'usernames': 1\n    });\n    this.tryEnsureIndex({\n      't': 1\n    });\n    this.tryEnsureIndex({\n      'u._id': 1\n    });\n    this.cache.ignoreUpdatedFields.push('msgs', 'lm');\n    this.cache.ensureIndex(['t', 'name'], 'unique');\n    this.cache.options = {\n      fields: {\n        usernames: 0\n      }\n    };\n  }\n\n  ModelRooms.prototype.findOneByIdOrName = function(_idOrName, options) {\n    var query;\n    query = {\n      $or: [\n        {\n          _id: _idOrName\n        }, {\n          name: _idOrName\n        }\n      ]\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelRooms.prototype.findOneByImportId = function(_id, options) {\n    var query;\n    query = {\n      importIds: _id\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelRooms.prototype.findOneByName = function(name, options) {\n    var query;\n    query = {\n      name: name\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelRooms.prototype.findOneByNameAndType = function(name, type, options) {\n    var query;\n    query = {\n      name: name,\n      t: type\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelRooms.prototype.findOneByIdContainingUsername = function(_id, username, options) {\n    var query;\n    query = {\n      _id: _id,\n      usernames: username\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelRooms.prototype.findOneByNameAndTypeNotContainingUsername = function(name, type, username, options) {\n    var query;\n    query = {\n      name: name,\n      t: type,\n      usernames: {\n        $ne: username\n      }\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelRooms.prototype.findById = function(roomId, options) {\n    return this.find({\n      _id: roomId\n    }, options);\n  };\n\n  ModelRooms.prototype.findByIds = function(roomIds, options) {\n    return this.find({\n      _id: {\n        $in: [].concat(roomIds)\n      }\n    }, options);\n  };\n\n  ModelRooms.prototype.findByType = function(type, options) {\n    var query;\n    query = {\n      t: type\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByTypes = function(types, options) {\n    var query;\n    query = {\n      t: {\n        $in: types\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByUserId = function(userId, options) {\n    var query;\n    query = {\n      \"u._id\": userId\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findBySubscriptionUserId = function(userId, options) {\n    var data, query;\n    if (this.useCache) {\n      data = RocketChat.models.Subscriptions.findByUserId(userId).fetch();\n      data = data.map(function(item) {\n        if (item._room) {\n          return item._room;\n        }\n        console.log('Empty Room for Subscription', item);\n        return {};\n      });\n      return this.arrayToCursor(this.processQueryOptionsOnResult(data, options));\n    }\n    data = RocketChat.models.Subscriptions.findByUserId(userId, {\n      fields: {\n        rid: 1\n      }\n    }).fetch();\n    data = data.map(function(item) {\n      return item.rid;\n    });\n    query = {\n      _id: {\n        $in: data\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findBySubscriptionUserIdUpdatedAfter = function(userId, _updatedAt, options) {\n    var data, ids, query;\n    if (this.useCache) {\n      data = RocketChat.models.Subscriptions.findByUserId(userId).fetch();\n      data = data.map(function(item) {\n        if (item._room) {\n          return item._room;\n        }\n        console.log('Empty Room for Subscription', item);\n        return {};\n      });\n      data = data.filter(function(item) {\n        return item._updatedAt > _updatedAt;\n      });\n      return this.arrayToCursor(this.processQueryOptionsOnResult(data, options));\n    }\n    ids = RocketChat.models.Subscriptions.findByUserId(userId, {\n      fields: {\n        rid: 1\n      }\n    }).fetch();\n    ids = ids.map(function(item) {\n      return item.rid;\n    });\n    query = {\n      _id: {\n        $in: ids\n      },\n      _updatedAt: {\n        $gt: _updatedAt\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByNameContaining = function(name, options) {\n    var nameRegex, query;\n    nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), \"i\");\n    query = {\n      $or: [\n        {\n          name: nameRegex\n        }, {\n          t: 'd',\n          usernames: nameRegex\n        }\n      ]\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByNameContainingTypesWithUsername = function(name, types, options) {\n    var $or, i, len, nameRegex, obj, query, type;\n    nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), \"i\");\n    $or = [];\n    for (i = 0, len = types.length; i < len; i++) {\n      type = types[i];\n      obj = {\n        name: nameRegex,\n        t: type.type\n      };\n      if (type.username != null) {\n        obj.usernames = type.username;\n      }\n      if (type.ids != null) {\n        obj._id = {\n          $in: type.ids\n        };\n      }\n      $or.push(obj);\n    }\n    query = {\n      $or: $or\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findContainingTypesWithUsername = function(types, options) {\n    var $or, i, len, obj, query, type;\n    $or = [];\n    for (i = 0, len = types.length; i < len; i++) {\n      type = types[i];\n      obj = {\n        t: type.type\n      };\n      if (type.username != null) {\n        obj.usernames = type.username;\n      }\n      if (type.ids != null) {\n        obj._id = {\n          $in: type.ids\n        };\n      }\n      $or.push(obj);\n    }\n    query = {\n      $or: $or\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByNameContainingAndTypes = function(name, types, options) {\n    var nameRegex, query;\n    nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), \"i\");\n    query = {\n      t: {\n        $in: types\n      },\n      $or: [\n        {\n          name: nameRegex\n        }, {\n          t: 'd',\n          usernames: nameRegex\n        }\n      ]\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByNameAndType = function(name, type, options) {\n    var query;\n    query = {\n      t: type,\n      name: name\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByNameAndTypeNotDefault = function(name, type, options) {\n    var query;\n    query = {\n      t: type,\n      name: name,\n      \"default\": {\n        $ne: true\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByNameAndTypeNotContainingUsername = function(name, type, username, options) {\n    var query;\n    query = {\n      t: type,\n      name: name,\n      usernames: {\n        $ne: username\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByNameStartingAndTypes = function(name, types, options) {\n    var nameRegex, query;\n    nameRegex = new RegExp(\"^\" + s.trim(s.escapeRegExp(name)), \"i\");\n    query = {\n      t: {\n        $in: types\n      },\n      $or: [\n        {\n          name: nameRegex\n        }, {\n          t: 'd',\n          usernames: nameRegex\n        }\n      ]\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByDefaultAndTypes = function(defaultValue, types, options) {\n    var query;\n    query = {\n      \"default\": defaultValue,\n      t: {\n        $in: types\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByTypeContainingUsername = function(type, username, options) {\n    var query;\n    query = {\n      t: type,\n      usernames: username\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByTypeContainingUsernames = function(type, username, options) {\n    var query;\n    query = {\n      t: type,\n      usernames: {\n        $all: [].concat(username)\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByTypesAndNotUserIdContainingUsername = function(types, userId, username, options) {\n    var query;\n    query = {\n      t: {\n        $in: types\n      },\n      uid: {\n        $ne: userId\n      },\n      usernames: username\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByContainingUsername = function(username, options) {\n    var query;\n    query = {\n      usernames: username\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByTypeAndName = function(type, name, options) {\n    var query;\n    if (this.useCache) {\n      return this.cache.findByIndex('t,name', [type, name], options);\n    }\n    query = {\n      name: name,\n      t: type\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByTypeAndNameContainingUsername = function(type, name, username, options) {\n    var query;\n    query = {\n      name: name,\n      t: type,\n      usernames: username\n    };\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.findByTypeAndArchivationState = function(type, archivationstate, options) {\n    var query;\n    query = {\n      t: type\n    };\n    if (archivationstate) {\n      query.archived = true;\n    } else {\n      query.archived = {\n        $ne: true\n      };\n    }\n    return this.find(query, options);\n  };\n\n  ModelRooms.prototype.addImportIds = function(_id, importIds) {\n    var query, update;\n    importIds = [].concat(importIds);\n    query = {\n      _id: _id\n    };\n    update = {\n      $addToSet: {\n        importIds: {\n          $each: importIds\n        }\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.archiveById = function(_id) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        archived: true\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.unarchiveById = function(_id) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        archived: false\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.addUsernameById = function(_id, username, muted) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $addToSet: {\n        usernames: username\n      }\n    };\n    if (muted) {\n      update.$addToSet.muted = username;\n    }\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.addUsernamesById = function(_id, usernames) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $addToSet: {\n        usernames: {\n          $each: usernames\n        }\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.addUsernameByName = function(name, username) {\n    var query, update;\n    query = {\n      name: name\n    };\n    update = {\n      $addToSet: {\n        usernames: username\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.removeUsernameById = function(_id, username) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $pull: {\n        usernames: username\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.removeUsernamesById = function(_id, usernames) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $pull: {\n        usernames: {\n          $in: usernames\n        }\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.removeUsernameFromAll = function(username) {\n    var query, update;\n    query = {\n      usernames: username\n    };\n    update = {\n      $pull: {\n        usernames: username\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelRooms.prototype.removeUsernameByName = function(name, username) {\n    var query, update;\n    query = {\n      name: name\n    };\n    update = {\n      $pull: {\n        usernames: username\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.setNameById = function(_id, name) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        name: name\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.incMsgCountById = function(_id, inc) {\n    var query, update;\n    if (inc == null) {\n      inc = 1;\n    }\n    query = {\n      _id: _id\n    };\n    update = {\n      $inc: {\n        msgs: inc\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.incMsgCountAndSetLastMessageTimestampById = function(_id, inc, lastMessageTimestamp) {\n    var query, update;\n    if (inc == null) {\n      inc = 1;\n    }\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        lm: lastMessageTimestamp\n      },\n      $inc: {\n        msgs: inc\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.replaceUsername = function(previousUsername, username) {\n    var query, update;\n    query = {\n      usernames: previousUsername\n    };\n    update = {\n      $set: {\n        \"usernames.$\": username\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelRooms.prototype.replaceMutedUsername = function(previousUsername, username) {\n    var query, update;\n    query = {\n      muted: previousUsername\n    };\n    update = {\n      $set: {\n        \"muted.$\": username\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelRooms.prototype.replaceUsernameOfUserByUserId = function(userId, username) {\n    var query, update;\n    query = {\n      \"u._id\": userId\n    };\n    update = {\n      $set: {\n        \"u.username\": username\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelRooms.prototype.setJoinCodeById = function(_id, joinCode) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    if ((joinCode != null ? joinCode.trim() : void 0) !== '') {\n      update = {\n        $set: {\n          joinCodeRequired: true,\n          joinCode: joinCode\n        }\n      };\n    } else {\n      update = {\n        $set: {\n          joinCodeRequired: false\n        },\n        $unset: {\n          joinCode: 1\n        }\n      };\n    }\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.setUserById = function(_id, user) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        u: {\n          _id: user._id,\n          username: user.username\n        }\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.setTypeById = function(_id, type) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        t: type\n      }\n    };\n    if (type === 'p') {\n      update.$unset = {\n        \"default\": ''\n      };\n    }\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.setTopicById = function(_id, topic) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        topic: topic\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.setAnnouncementById = function(_id, announcement) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        announcement: announcement\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.muteUsernameByRoomId = function(_id, username) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $addToSet: {\n        muted: username\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.unmuteUsernameByRoomId = function(_id, username) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $pull: {\n        muted: username\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.saveDefaultById = function(_id, defaultValue) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $set: {\n        \"default\": defaultValue === 'true'\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelRooms.prototype.setTopicAndTagsById = function(_id, topic, tags) {\n    var setData, unsetData, update;\n    setData = {};\n    unsetData = {};\n    if (topic != null) {\n      if (!_.isEmpty(s.trim(topic))) {\n        setData.topic = s.trim(topic);\n      } else {\n        unsetData.topic = 1;\n      }\n    }\n    if (tags != null) {\n      if (!_.isEmpty(s.trim(tags))) {\n        setData.tags = s.trim(tags).split(',').map((function(_this) {\n          return function(tag) {\n            return s.trim(tag);\n          };\n        })(this));\n      } else {\n        unsetData.tags = 1;\n      }\n    }\n    update = {};\n    if (!_.isEmpty(setData)) {\n      update.$set = setData;\n    }\n    if (!_.isEmpty(unsetData)) {\n      update.$unset = unsetData;\n    }\n    if (_.isEmpty(update)) {\n      return;\n    }\n    return this.update({\n      _id: _id\n    }, update);\n  };\n\n  ModelRooms.prototype.createWithTypeNameUserAndUsernames = function(type, name, user, usernames, extraData) {\n    var room;\n    room = {\n      name: name,\n      t: type,\n      usernames: usernames,\n      msgs: 0,\n      u: {\n        _id: user._id,\n        username: user.username\n      }\n    };\n    _.extend(room, extraData);\n    room._id = this.insert(room);\n    return room;\n  };\n\n  ModelRooms.prototype.createWithIdTypeAndName = function(_id, type, name, extraData) {\n    var room;\n    room = {\n      _id: _id,\n      ts: new Date(),\n      t: type,\n      name: name,\n      usernames: [],\n      msgs: 0\n    };\n    _.extend(room, extraData);\n    this.insert(room);\n    return room;\n  };\n\n  ModelRooms.prototype.removeById = function(_id) {\n    var query;\n    query = {\n      _id: _id\n    };\n    return this.remove(query);\n  };\n\n  ModelRooms.prototype.removeByTypeContainingUsername = function(type, username) {\n    var query;\n    query = {\n      t: type,\n      usernames: username\n    };\n    return this.remove(query);\n  };\n\n  return ModelRooms;\n\n})(RocketChat.models._Base);\n\nRocketChat.models.Rooms = new ModelRooms('room', true);\n","class ModelSettings extends RocketChat.models._Base\n\tconstructor: ->\n\t\tsuper(arguments...)\n\n\t\t@tryEnsureIndex { 'blocked': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'hidden': 1 }, { sparse: 1 }\n\n\t# FIND\n\tfindById: (_id) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\treturn @find query\n\n\tfindOneNotHiddenById: (_id) ->\n\t\tquery =\n\t\t\t_id: _id\n\t\t\thidden: { $ne: true }\n\n\t\treturn @findOne query\n\n\tfindByIds: (_id = []) ->\n\t\t_id = [].concat _id\n\n\t\tquery =\n\t\t\t_id:\n\t\t\t\t$in: _id\n\n\t\treturn @find query\n\n\tfindByRole: (role, options) ->\n\t\tquery =\n\t\t\trole: role\n\n\t\treturn @find query, options\n\n\tfindPublic: (options) ->\n\t\tquery =\n\t\t\tpublic: true\n\n\t\treturn @find query, options\n\n\tfindNotHiddenPublic: (ids = [])->\n\t\tfilter =\n\t\t\thidden: { $ne: true }\n\t\t\tpublic: true\n\n\t\tif ids.length > 0\n\t\t\tfilter._id =\n\t\t\t\t$in: ids\n\n\t\treturn @find filter, { fields: _id: 1, value: 1 }\n\n\tfindNotHiddenPublicUpdatedAfter: (updatedAt) ->\n\t\tfilter =\n\t\t\thidden: { $ne: true }\n\t\t\tpublic: true\n\t\t\t_updatedAt:\n\t\t\t\t$gt: updatedAt\n\n\t\treturn @find filter, { fields: _id: 1, value: 1 }\n\n\tfindNotHiddenPrivate: ->\n\t\treturn @find {\n\t\t\thidden: { $ne: true }\n\t\t\tpublic: { $ne: true }\n\t\t}\n\n\tfindNotHidden: (options) ->\n\t\treturn @find { hidden: { $ne: true } }, options\n\n\tfindNotHiddenUpdatedAfter: (updatedAt)->\n\t\treturn @find {\n\t\t\thidden: { $ne: true }\n\t\t\t_updatedAt:\n\t\t\t\t$gt: updatedAt\n\t\t}\n\n\t# UPDATE\n\tupdateValueById: (_id, value) ->\n\t\tquery =\n\t\t\tblocked: { $ne: true }\n\t\t\tvalue: { $ne: value }\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tvalue: value\n\n\t\treturn @update query, update\n\n\tupdateValueAndEditorById: (_id, value, editor) ->\n\t\tquery =\n\t\t\tblocked: { $ne: true }\n\t\t\tvalue: { $ne: value }\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tvalue: value\n\t\t\t\teditor: editor\n\n\t\treturn @update query, update\n\n\tupdateValueNotHiddenById: (_id, value) ->\n\t\tquery =\n\t\t\t_id: _id\n\t\t\thidden: { $ne: true }\n\t\t\tblocked: { $ne: true }\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tvalue: value\n\n\t\treturn @update query, update\n\n\tupdateOptionsById: (_id, options) ->\n\t\tquery =\n\t\t\tblocked: { $ne: true }\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$set: options\n\n\t\treturn @update query, update\n\n\t# INSERT\n\tcreateWithIdAndValue: (_id, value) ->\n\t\trecord =\n\t\t\t_id: _id\n\t\t\tvalue: value\n\t\t\t_createdAt: new Date\n\n\t\treturn @insert record\n\n\t# REMOVE\n\tremoveById: (_id) ->\n\t\tquery =\n\t\t\tblocked: { $ne: true }\n\t\t\t_id: _id\n\n\t\treturn @remove query\n\nRocketChat.models.Settings = new ModelSettings('settings', true)\n","var ModelSettings,\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nModelSettings = (function(superClass) {\n  extend(ModelSettings, superClass);\n\n  function ModelSettings() {\n    ModelSettings.__super__.constructor.apply(this, arguments);\n    this.tryEnsureIndex({\n      'blocked': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'hidden': 1\n    }, {\n      sparse: 1\n    });\n  }\n\n  ModelSettings.prototype.findById = function(_id) {\n    var query;\n    query = {\n      _id: _id\n    };\n    return this.find(query);\n  };\n\n  ModelSettings.prototype.findOneNotHiddenById = function(_id) {\n    var query;\n    query = {\n      _id: _id,\n      hidden: {\n        $ne: true\n      }\n    };\n    return this.findOne(query);\n  };\n\n  ModelSettings.prototype.findByIds = function(_id) {\n    var query;\n    if (_id == null) {\n      _id = [];\n    }\n    _id = [].concat(_id);\n    query = {\n      _id: {\n        $in: _id\n      }\n    };\n    return this.find(query);\n  };\n\n  ModelSettings.prototype.findByRole = function(role, options) {\n    var query;\n    query = {\n      role: role\n    };\n    return this.find(query, options);\n  };\n\n  ModelSettings.prototype.findPublic = function(options) {\n    var query;\n    query = {\n      \"public\": true\n    };\n    return this.find(query, options);\n  };\n\n  ModelSettings.prototype.findNotHiddenPublic = function(ids) {\n    var filter;\n    if (ids == null) {\n      ids = [];\n    }\n    filter = {\n      hidden: {\n        $ne: true\n      },\n      \"public\": true\n    };\n    if (ids.length > 0) {\n      filter._id = {\n        $in: ids\n      };\n    }\n    return this.find(filter, {\n      fields: {\n        _id: 1,\n        value: 1\n      }\n    });\n  };\n\n  ModelSettings.prototype.findNotHiddenPublicUpdatedAfter = function(updatedAt) {\n    var filter;\n    filter = {\n      hidden: {\n        $ne: true\n      },\n      \"public\": true,\n      _updatedAt: {\n        $gt: updatedAt\n      }\n    };\n    return this.find(filter, {\n      fields: {\n        _id: 1,\n        value: 1\n      }\n    });\n  };\n\n  ModelSettings.prototype.findNotHiddenPrivate = function() {\n    return this.find({\n      hidden: {\n        $ne: true\n      },\n      \"public\": {\n        $ne: true\n      }\n    });\n  };\n\n  ModelSettings.prototype.findNotHidden = function(options) {\n    return this.find({\n      hidden: {\n        $ne: true\n      }\n    }, options);\n  };\n\n  ModelSettings.prototype.findNotHiddenUpdatedAfter = function(updatedAt) {\n    return this.find({\n      hidden: {\n        $ne: true\n      },\n      _updatedAt: {\n        $gt: updatedAt\n      }\n    });\n  };\n\n  ModelSettings.prototype.updateValueById = function(_id, value) {\n    var query, update;\n    query = {\n      blocked: {\n        $ne: true\n      },\n      value: {\n        $ne: value\n      },\n      _id: _id\n    };\n    update = {\n      $set: {\n        value: value\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSettings.prototype.updateValueAndEditorById = function(_id, value, editor) {\n    var query, update;\n    query = {\n      blocked: {\n        $ne: true\n      },\n      value: {\n        $ne: value\n      },\n      _id: _id\n    };\n    update = {\n      $set: {\n        value: value,\n        editor: editor\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSettings.prototype.updateValueNotHiddenById = function(_id, value) {\n    var query, update;\n    query = {\n      _id: _id,\n      hidden: {\n        $ne: true\n      },\n      blocked: {\n        $ne: true\n      }\n    };\n    update = {\n      $set: {\n        value: value\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSettings.prototype.updateOptionsById = function(_id, options) {\n    var query, update;\n    query = {\n      blocked: {\n        $ne: true\n      },\n      _id: _id\n    };\n    update = {\n      $set: options\n    };\n    return this.update(query, update);\n  };\n\n  ModelSettings.prototype.createWithIdAndValue = function(_id, value) {\n    var record;\n    record = {\n      _id: _id,\n      value: value,\n      _createdAt: new Date\n    };\n    return this.insert(record);\n  };\n\n  ModelSettings.prototype.removeById = function(_id) {\n    var query;\n    query = {\n      blocked: {\n        $ne: true\n      },\n      _id: _id\n    };\n    return this.remove(query);\n  };\n\n  return ModelSettings;\n\n})(RocketChat.models._Base);\n\nRocketChat.models.Settings = new ModelSettings('settings', true);\n","class ModelSubscriptions extends RocketChat.models._Base\n\tconstructor: ->\n\t\tsuper(arguments...)\n\n\t\t@tryEnsureIndex { 'rid': 1, 'u._id': 1 }, { unique: 1 }\n\t\t@tryEnsureIndex { 'rid': 1, 'alert': 1, 'u._id': 1 }\n\t\t@tryEnsureIndex { 'rid': 1, 'roles': 1 }\n\t\t@tryEnsureIndex { 'u._id': 1, 'name': 1, 't': 1 }\n\t\t@tryEnsureIndex { 'u._id': 1, 'name': 1, 't': 1, 'code': 1 }, { unique: 1 }\n\t\t@tryEnsureIndex { 'open': 1 }\n\t\t@tryEnsureIndex { 'alert': 1 }\n\t\t@tryEnsureIndex { 'unread': 1 }\n\t\t@tryEnsureIndex { 'ts': 1 }\n\t\t@tryEnsureIndex { 'ls': 1 }\n\t\t@tryEnsureIndex { 'audioNotification': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'desktopNotifications': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'mobilePushNotifications': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'emailNotifications': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'autoTranslate': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'autoTranslateLanguage': 1 }, { sparse: 1 }\n\n\t\tthis.cache.ensureIndex('rid', 'array')\n\t\tthis.cache.ensureIndex('u._id', 'array')\n\t\tthis.cache.ensureIndex('name', 'array')\n\t\tthis.cache.ensureIndex(['rid', 'u._id'], 'unique')\n\t\tthis.cache.ensureIndex(['name', 'u._id'], 'unique')\n\n\n\t# FIND ONE\n\tfindOneByRoomIdAndUserId: (roomId, userId) ->\n\t\tif this.useCache\n\t\t\treturn this.cache.findByIndex('rid,u._id', [roomId, userId]).fetch()\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t\"u._id\": userId\n\n\t\treturn @findOne query\n\n\tfindOneByRoomNameAndUserId: (roomName, userId) ->\n\t\tif this.useCache\n\t\t\treturn this.cache.findByIndex('name,u._id', [roomName, userId]).fetch()\n\t\tquery =\n\t\t\tname: roomName\n\t\t\t\"u._id\": userId\n\n\t\treturn @findOne query\n\n\t# FIND\n\tfindByUserId: (userId, options) ->\n\t\tif this.useCache\n\t\t\treturn this.cache.findByIndex('u._id', userId, options)\n\n\t\tquery =\n\t\t\t\"u._id\": userId\n\n\t\treturn @find query, options\n\n\tfindByUserIdUpdatedAfter: (userId, updatedAt, options) ->\n\t\tquery =\n\t\t\t\"u._id\": userId\n\t\t\t_updatedAt:\n\t\t\t\t$gt: updatedAt\n\n\t\treturn @find query, options\n\n\t# FIND\n\tfindByRoomIdAndRoles: (roomId, roles, options) ->\n\t\troles = [].concat roles\n\t\tquery =\n\t\t\t\"rid\": roomId\n\t\t\t\"roles\": { $in: roles }\n\n\t\treturn @find query, options\n\n\tfindByType: (types, options) ->\n\t\tquery =\n\t\t\tt:\n\t\t\t\t$in: types\n\n\t\treturn @find query, options\n\n\tfindByTypeAndUserId: (type, userId, options) ->\n\t\tquery =\n\t\t\tt: type\n\t\t\t'u._id': userId\n\n\t\treturn @find query, options\n\n\tfindByTypeNameAndUserId: (type, name, userId, options) ->\n\t\tquery =\n\t\t\tt: type\n\t\t\tname: name\n\t\t\t'u._id': userId\n\n\t\treturn @find query, options\n\n\tfindByRoomId: (roomId, options) ->\n\t\tif this.useCache\n\t\t\treturn this.cache.findByIndex('rid', roomId, options)\n\n\t\tquery =\n\t\t\trid: roomId\n\n\t\treturn @find query, options\n\n\tfindByRoomIdAndNotUserId: (roomId, userId, options) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id':\n\t\t\t\t$ne: userId\n\n\t\treturn @find query, options\n\n\tgetLastSeen: (options = {}) ->\n\t\tquery = { ls: { $exists: 1 } }\n\t\toptions.sort = { ls: -1 }\n\t\toptions.limit = 1\n\n\t\treturn @find(query, options)?.fetch?()?[0]?.ls\n\n\tfindByRoomIdAndUserIds: (roomId, userIds) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id':\n\t\t\t\t$in: userIds\n\n\t\treturn @find query\n\n\t# UPDATE\n\tarchiveByRoomId: (roomId) ->\n\t\tquery =\n\t\t\trid: roomId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\talert: false\n\t\t\t\topen: false\n\t\t\t\tarchived: true\n\n\t\treturn @update query, update, { multi: true }\n\n\tunarchiveByRoomId: (roomId) ->\n\t\tquery =\n\t\t\trid: roomId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\talert: false\n\t\t\t\topen: true\n\t\t\t\tarchived: false\n\n\t\treturn @update query, update, { multi: true }\n\n\thideByRoomIdAndUserId: (roomId, userId) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id': userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\talert: false\n\t\t\t\topen: false\n\n\t\treturn @update query, update\n\n\topenByRoomIdAndUserId: (roomId, userId) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id': userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\topen: true\n\n\t\treturn @update query, update\n\n\tsetAsReadByRoomIdAndUserId: (roomId, userId) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id': userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\topen: true\n\t\t\t\talert: false\n\t\t\t\tunread: 0\n\t\t\t\tls: new Date\n\n\t\treturn @update query, update\n\n\tsetAsUnreadByRoomIdAndUserId: (roomId, userId, firstMessageUnreadTimestamp) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id': userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\topen: true\n\t\t\t\talert: true\n\t\t\t\tls: firstMessageUnreadTimestamp\n\n\t\treturn @update query, update\n\n\tsetFavoriteByRoomIdAndUserId: (roomId, userId, favorite=true) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id': userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tf: favorite\n\n\t\treturn @update query, update\n\n\tupdateNameAndAlertByRoomId: (roomId, name) ->\n\t\tquery =\n\t\t\trid: roomId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tname: name\n\t\t\t\talert: true\n\n\t\treturn @update query, update, { multi: true }\n\n\tupdateNameByRoomId: (roomId, name) ->\n\t\tquery =\n\t\t\trid: roomId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tname: name\n\n\t\treturn @update query, update, { multi: true }\n\n\tsetUserUsernameByUserId: (userId, username) ->\n\t\tquery =\n\t\t\t\"u._id\": userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"u.username\": username\n\n\t\treturn @update query, update, { multi: true }\n\n\tsetNameForDirectRoomsWithOldName: (oldName, name) ->\n\t\tquery =\n\t\t\tname: oldName\n\t\t\tt: \"d\"\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tname: name\n\n\t\treturn @update query, update, { multi: true }\n\n\tincUnreadOfDirectForRoomIdExcludingUserId: (roomId, userId, inc=1) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\tt: 'd'\n\t\t\t'u._id':\n\t\t\t\t$ne: userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\talert: true\n\t\t\t\topen: true\n\t\t\t$inc:\n\t\t\t\tunread: inc\n\n\t\treturn @update query, update, { multi: true }\n\n\tincUnreadForRoomIdExcludingUserId: (roomId, userId, inc=1) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id':\n\t\t\t\t$ne: userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\talert: true\n\t\t\t\topen: true\n\t\t\t$inc:\n\t\t\t\tunread: inc\n\n\t\treturn @update query, update, { multi: true }\n\n\tincUnreadForRoomIdAndUserIds: (roomId, userIds, inc=1) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id':\n\t\t\t\t$in: userIds\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\talert: true\n\t\t\t\topen: true\n\t\t\t$inc:\n\t\t\t\tunread: inc\n\n\t\treturn @update query, update, { multi: true }\n\n\tsetAlertForRoomIdExcludingUserId: (roomId, userId) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t'u._id':\n\t\t\t\t$ne: userId\n\t\t\t$or: [\n\t\t\t\t{ alert: { $ne: true } }\n\t\t\t\t{ open: { $ne: true } }\n\t\t\t]\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\talert: true\n\t\t\t\topen: true\n\n\t\treturn @update query, update, { multi: true }\n\n\tsetBlockedByRoomId: (rid, blocked, blocker) ->\n\t\tquery =\n\t\t\trid: rid\n\t\t\t'u._id': blocked\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tblocked: true\n\n\t\tquery2 =\n\t\t\trid: rid\n\t\t\t'u._id': blocker\n\n\t\tupdate2 =\n\t\t\t$set:\n\t\t\t\tblocker: true\n\n\t\treturn @update(query, update) and @update(query2, update2)\n\n\tunsetBlockedByRoomId: (rid, blocked, blocker) ->\n\t\tquery =\n\t\t\trid: rid\n\t\t\t'u._id': blocked\n\n\t\tupdate =\n\t\t\t$unset:\n\t\t\t\tblocked: 1\n\n\t\tquery2 =\n\t\t\trid: rid\n\t\t\t'u._id': blocker\n\n\t\tupdate2 =\n\t\t\t$unset:\n\t\t\t\tblocker: 1\n\n\t\treturn @update(query, update) and @update(query2, update2)\n\n\tupdateTypeByRoomId: (roomId, type) ->\n\t\tquery =\n\t\t\trid: roomId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tt: type\n\n\t\treturn @update query, update, { multi: true }\n\n\taddRoleById: (_id, role) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$addToSet:\n\t\t\t\troles: role\n\n\t\treturn @update query, update\n\n\tremoveRoleById: (_id, role) ->\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$pull:\n\t\t\t\troles: role\n\n\t\treturn @update query, update\n\n\tsetArchivedByUsername: (username, archived) ->\n\t\tquery =\n\t\t\tt: 'd'\n\t\t\tname: username\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tarchived: archived\n\n\t\treturn @update query, update, { multi: true }\n\n\t# INSERT\n\tcreateWithRoomAndUser: (room, user, extraData) ->\n\t\tsubscription =\n\t\t\topen: false\n\t\t\talert: false\n\t\t\tunread: 0\n\t\t\tts: room.ts\n\t\t\trid: room._id\n\t\t\tname: room.name\n\t\t\tt: room.t\n\t\t\tu:\n\t\t\t\t_id: user._id\n\t\t\t\tusername: user.username\n\n\t\t_.extend subscription, extraData\n\n\t\treturn @insert subscription\n\n\n\t# REMOVE\n\tremoveByUserId: (userId) ->\n\t\tquery =\n\t\t\t\"u._id\": userId\n\n\t\treturn @remove query\n\n\tremoveByRoomId: (roomId) ->\n\t\tquery =\n\t\t\trid: roomId\n\n\t\treturn @remove query\n\n\tremoveByRoomIdAndUserId: (roomId, userId) ->\n\t\tquery =\n\t\t\trid: roomId\n\t\t\t\"u._id\": userId\n\n\t\treturn @remove query\n\nRocketChat.models.Subscriptions = new ModelSubscriptions('subscription', true)\n","var ModelSubscriptions,\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nModelSubscriptions = (function(superClass) {\n  extend(ModelSubscriptions, superClass);\n\n  function ModelSubscriptions() {\n    ModelSubscriptions.__super__.constructor.apply(this, arguments);\n    this.tryEnsureIndex({\n      'rid': 1,\n      'u._id': 1\n    }, {\n      unique: 1\n    });\n    this.tryEnsureIndex({\n      'rid': 1,\n      'alert': 1,\n      'u._id': 1\n    });\n    this.tryEnsureIndex({\n      'rid': 1,\n      'roles': 1\n    });\n    this.tryEnsureIndex({\n      'u._id': 1,\n      'name': 1,\n      't': 1\n    });\n    this.tryEnsureIndex({\n      'u._id': 1,\n      'name': 1,\n      't': 1,\n      'code': 1\n    }, {\n      unique: 1\n    });\n    this.tryEnsureIndex({\n      'open': 1\n    });\n    this.tryEnsureIndex({\n      'alert': 1\n    });\n    this.tryEnsureIndex({\n      'unread': 1\n    });\n    this.tryEnsureIndex({\n      'ts': 1\n    });\n    this.tryEnsureIndex({\n      'ls': 1\n    });\n    this.tryEnsureIndex({\n      'audioNotification': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'desktopNotifications': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'mobilePushNotifications': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'emailNotifications': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'autoTranslate': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'autoTranslateLanguage': 1\n    }, {\n      sparse: 1\n    });\n    this.cache.ensureIndex('rid', 'array');\n    this.cache.ensureIndex('u._id', 'array');\n    this.cache.ensureIndex('name', 'array');\n    this.cache.ensureIndex(['rid', 'u._id'], 'unique');\n    this.cache.ensureIndex(['name', 'u._id'], 'unique');\n  }\n\n  ModelSubscriptions.prototype.findOneByRoomIdAndUserId = function(roomId, userId) {\n    var query;\n    if (this.useCache) {\n      return this.cache.findByIndex('rid,u._id', [roomId, userId]).fetch();\n    }\n    query = {\n      rid: roomId,\n      \"u._id\": userId\n    };\n    return this.findOne(query);\n  };\n\n  ModelSubscriptions.prototype.findOneByRoomNameAndUserId = function(roomName, userId) {\n    var query;\n    if (this.useCache) {\n      return this.cache.findByIndex('name,u._id', [roomName, userId]).fetch();\n    }\n    query = {\n      name: roomName,\n      \"u._id\": userId\n    };\n    return this.findOne(query);\n  };\n\n  ModelSubscriptions.prototype.findByUserId = function(userId, options) {\n    var query;\n    if (this.useCache) {\n      return this.cache.findByIndex('u._id', userId, options);\n    }\n    query = {\n      \"u._id\": userId\n    };\n    return this.find(query, options);\n  };\n\n  ModelSubscriptions.prototype.findByUserIdUpdatedAfter = function(userId, updatedAt, options) {\n    var query;\n    query = {\n      \"u._id\": userId,\n      _updatedAt: {\n        $gt: updatedAt\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelSubscriptions.prototype.findByRoomIdAndRoles = function(roomId, roles, options) {\n    var query;\n    roles = [].concat(roles);\n    query = {\n      \"rid\": roomId,\n      \"roles\": {\n        $in: roles\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelSubscriptions.prototype.findByType = function(types, options) {\n    var query;\n    query = {\n      t: {\n        $in: types\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelSubscriptions.prototype.findByTypeAndUserId = function(type, userId, options) {\n    var query;\n    query = {\n      t: type,\n      'u._id': userId\n    };\n    return this.find(query, options);\n  };\n\n  ModelSubscriptions.prototype.findByTypeNameAndUserId = function(type, name, userId, options) {\n    var query;\n    query = {\n      t: type,\n      name: name,\n      'u._id': userId\n    };\n    return this.find(query, options);\n  };\n\n  ModelSubscriptions.prototype.findByRoomId = function(roomId, options) {\n    var query;\n    if (this.useCache) {\n      return this.cache.findByIndex('rid', roomId, options);\n    }\n    query = {\n      rid: roomId\n    };\n    return this.find(query, options);\n  };\n\n  ModelSubscriptions.prototype.findByRoomIdAndNotUserId = function(roomId, userId, options) {\n    var query;\n    query = {\n      rid: roomId,\n      'u._id': {\n        $ne: userId\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelSubscriptions.prototype.getLastSeen = function(options) {\n    var query, ref, ref1, ref2;\n    if (options == null) {\n      options = {};\n    }\n    query = {\n      ls: {\n        $exists: 1\n      }\n    };\n    options.sort = {\n      ls: -1\n    };\n    options.limit = 1;\n    return (ref = this.find(query, options)) != null ? typeof ref.fetch === \"function\" ? (ref1 = ref.fetch()) != null ? (ref2 = ref1[0]) != null ? ref2.ls : void 0 : void 0 : void 0 : void 0;\n  };\n\n  ModelSubscriptions.prototype.findByRoomIdAndUserIds = function(roomId, userIds) {\n    var query;\n    query = {\n      rid: roomId,\n      'u._id': {\n        $in: userIds\n      }\n    };\n    return this.find(query);\n  };\n\n  ModelSubscriptions.prototype.archiveByRoomId = function(roomId) {\n    var query, update;\n    query = {\n      rid: roomId\n    };\n    update = {\n      $set: {\n        alert: false,\n        open: false,\n        archived: true\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.unarchiveByRoomId = function(roomId) {\n    var query, update;\n    query = {\n      rid: roomId\n    };\n    update = {\n      $set: {\n        alert: false,\n        open: true,\n        archived: false\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.hideByRoomIdAndUserId = function(roomId, userId) {\n    var query, update;\n    query = {\n      rid: roomId,\n      'u._id': userId\n    };\n    update = {\n      $set: {\n        alert: false,\n        open: false\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSubscriptions.prototype.openByRoomIdAndUserId = function(roomId, userId) {\n    var query, update;\n    query = {\n      rid: roomId,\n      'u._id': userId\n    };\n    update = {\n      $set: {\n        open: true\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSubscriptions.prototype.setAsReadByRoomIdAndUserId = function(roomId, userId) {\n    var query, update;\n    query = {\n      rid: roomId,\n      'u._id': userId\n    };\n    update = {\n      $set: {\n        open: true,\n        alert: false,\n        unread: 0,\n        ls: new Date\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSubscriptions.prototype.setAsUnreadByRoomIdAndUserId = function(roomId, userId, firstMessageUnreadTimestamp) {\n    var query, update;\n    query = {\n      rid: roomId,\n      'u._id': userId\n    };\n    update = {\n      $set: {\n        open: true,\n        alert: true,\n        ls: firstMessageUnreadTimestamp\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSubscriptions.prototype.setFavoriteByRoomIdAndUserId = function(roomId, userId, favorite) {\n    var query, update;\n    if (favorite == null) {\n      favorite = true;\n    }\n    query = {\n      rid: roomId,\n      'u._id': userId\n    };\n    update = {\n      $set: {\n        f: favorite\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSubscriptions.prototype.updateNameAndAlertByRoomId = function(roomId, name) {\n    var query, update;\n    query = {\n      rid: roomId\n    };\n    update = {\n      $set: {\n        name: name,\n        alert: true\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.updateNameByRoomId = function(roomId, name) {\n    var query, update;\n    query = {\n      rid: roomId\n    };\n    update = {\n      $set: {\n        name: name\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.setUserUsernameByUserId = function(userId, username) {\n    var query, update;\n    query = {\n      \"u._id\": userId\n    };\n    update = {\n      $set: {\n        \"u.username\": username\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.setNameForDirectRoomsWithOldName = function(oldName, name) {\n    var query, update;\n    query = {\n      name: oldName,\n      t: \"d\"\n    };\n    update = {\n      $set: {\n        name: name\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.incUnreadOfDirectForRoomIdExcludingUserId = function(roomId, userId, inc) {\n    var query, update;\n    if (inc == null) {\n      inc = 1;\n    }\n    query = {\n      rid: roomId,\n      t: 'd',\n      'u._id': {\n        $ne: userId\n      }\n    };\n    update = {\n      $set: {\n        alert: true,\n        open: true\n      },\n      $inc: {\n        unread: inc\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.incUnreadForRoomIdExcludingUserId = function(roomId, userId, inc) {\n    var query, update;\n    if (inc == null) {\n      inc = 1;\n    }\n    query = {\n      rid: roomId,\n      'u._id': {\n        $ne: userId\n      }\n    };\n    update = {\n      $set: {\n        alert: true,\n        open: true\n      },\n      $inc: {\n        unread: inc\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.incUnreadForRoomIdAndUserIds = function(roomId, userIds, inc) {\n    var query, update;\n    if (inc == null) {\n      inc = 1;\n    }\n    query = {\n      rid: roomId,\n      'u._id': {\n        $in: userIds\n      }\n    };\n    update = {\n      $set: {\n        alert: true,\n        open: true\n      },\n      $inc: {\n        unread: inc\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.setAlertForRoomIdExcludingUserId = function(roomId, userId) {\n    var query, update;\n    query = {\n      rid: roomId,\n      'u._id': {\n        $ne: userId\n      },\n      $or: [\n        {\n          alert: {\n            $ne: true\n          }\n        }, {\n          open: {\n            $ne: true\n          }\n        }\n      ]\n    };\n    update = {\n      $set: {\n        alert: true,\n        open: true\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.setBlockedByRoomId = function(rid, blocked, blocker) {\n    var query, query2, update, update2;\n    query = {\n      rid: rid,\n      'u._id': blocked\n    };\n    update = {\n      $set: {\n        blocked: true\n      }\n    };\n    query2 = {\n      rid: rid,\n      'u._id': blocker\n    };\n    update2 = {\n      $set: {\n        blocker: true\n      }\n    };\n    return this.update(query, update) && this.update(query2, update2);\n  };\n\n  ModelSubscriptions.prototype.unsetBlockedByRoomId = function(rid, blocked, blocker) {\n    var query, query2, update, update2;\n    query = {\n      rid: rid,\n      'u._id': blocked\n    };\n    update = {\n      $unset: {\n        blocked: 1\n      }\n    };\n    query2 = {\n      rid: rid,\n      'u._id': blocker\n    };\n    update2 = {\n      $unset: {\n        blocker: 1\n      }\n    };\n    return this.update(query, update) && this.update(query2, update2);\n  };\n\n  ModelSubscriptions.prototype.updateTypeByRoomId = function(roomId, type) {\n    var query, update;\n    query = {\n      rid: roomId\n    };\n    update = {\n      $set: {\n        t: type\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.addRoleById = function(_id, role) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $addToSet: {\n        roles: role\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSubscriptions.prototype.removeRoleById = function(_id, role) {\n    var query, update;\n    query = {\n      _id: _id\n    };\n    update = {\n      $pull: {\n        roles: role\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelSubscriptions.prototype.setArchivedByUsername = function(username, archived) {\n    var query, update;\n    query = {\n      t: 'd',\n      name: username\n    };\n    update = {\n      $set: {\n        archived: archived\n      }\n    };\n    return this.update(query, update, {\n      multi: true\n    });\n  };\n\n  ModelSubscriptions.prototype.createWithRoomAndUser = function(room, user, extraData) {\n    var subscription;\n    subscription = {\n      open: false,\n      alert: false,\n      unread: 0,\n      ts: room.ts,\n      rid: room._id,\n      name: room.name,\n      t: room.t,\n      u: {\n        _id: user._id,\n        username: user.username\n      }\n    };\n    _.extend(subscription, extraData);\n    return this.insert(subscription);\n  };\n\n  ModelSubscriptions.prototype.removeByUserId = function(userId) {\n    var query;\n    query = {\n      \"u._id\": userId\n    };\n    return this.remove(query);\n  };\n\n  ModelSubscriptions.prototype.removeByRoomId = function(roomId) {\n    var query;\n    query = {\n      rid: roomId\n    };\n    return this.remove(query);\n  };\n\n  ModelSubscriptions.prototype.removeByRoomIdAndUserId = function(roomId, userId) {\n    var query;\n    query = {\n      rid: roomId,\n      \"u._id\": userId\n    };\n    return this.remove(query);\n  };\n\n  return ModelSubscriptions;\n\n})(RocketChat.models._Base);\n\nRocketChat.models.Subscriptions = new ModelSubscriptions('subscription', true);\n","RocketChat.models.Uploads = new class extends RocketChat.models._Base\n\tconstructor: ->\n\t\tsuper('uploads')\n\n\t\t@tryEnsureIndex { 'rid': 1 }\n\t\t@tryEnsureIndex { 'uploadedAt': 1 }\n\n\tfindNotHiddenFilesOfRoom: (roomId, limit) ->\n\t\tfileQuery =\n\t\t\trid: roomId\n\t\t\tcomplete: true\n\t\t\tuploading: false\n\t\t\t_hidden:\n\t\t\t\t$ne: true\n\n\t\tfileOptions =\n\t\t\tlimit: limit\n\t\t\tsort:\n\t\t\t\tuploadedAt: -1\n\t\t\tfields:\n\t\t\t\t_id: 1\n\t\t\t\tuserId: 1\n\t\t\t\trid: 1\n\t\t\t\tname: 1\n\t\t\t\tdescription: 1\n\t\t\t\ttype: 1\n\t\t\t\turl: 1\n\t\t\t\tuploadedAt: 1\n\n\t\treturn @find fileQuery, fileOptions\n\n\tinsertFileInit: (roomId, userId, store, file, extra) ->\n\t\tfileData =\n\t\t\trid: roomId\n\t\t\tuserId: userId\n\t\t\tstore: store\n\t\t\tcomplete: false\n\t\t\tuploading: true\n\t\t\tprogress: 0\n\t\t\textension: s.strRightBack(file.name, '.')\n\t\t\tuploadedAt: new Date()\n\n\t\t_.extend(fileData, file, extra);\n\n\t\tif @model.direct?.insert?\n\t\t\tfile = @model.direct.insert fileData\n\t\telse\n\t\t\tfile = @insert fileData\n\n\t\treturn file\n\n\tupdateFileComplete: (fileId, userId, file) ->\n\t\tif not fileId\n\t\t\treturn\n\n\t\tfilter =\n\t\t\t_id: fileId\n\t\t\tuserId: userId\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tcomplete: true\n\t\t\t\tuploading: false\n\t\t\t\tprogress: 1\n\n\t\tupdate.$set = _.extend file, update.$set\n\n\t\tif @model.direct?.insert?\n\t\t\tresult = @model.direct.update filter, update\n\t\telse\n\t\t\tresult = @update filter, update\n\n\t\treturn result\n","var extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nRocketChat.models.Uploads = new ((function(superClass) {\n  extend(_Class, superClass);\n\n  function _Class() {\n    _Class.__super__.constructor.call(this, 'uploads');\n    this.tryEnsureIndex({\n      'rid': 1\n    });\n    this.tryEnsureIndex({\n      'uploadedAt': 1\n    });\n  }\n\n  _Class.prototype.findNotHiddenFilesOfRoom = function(roomId, limit) {\n    var fileOptions, fileQuery;\n    fileQuery = {\n      rid: roomId,\n      complete: true,\n      uploading: false,\n      _hidden: {\n        $ne: true\n      }\n    };\n    fileOptions = {\n      limit: limit,\n      sort: {\n        uploadedAt: -1\n      },\n      fields: {\n        _id: 1,\n        userId: 1,\n        rid: 1,\n        name: 1,\n        description: 1,\n        type: 1,\n        url: 1,\n        uploadedAt: 1\n      }\n    };\n    return this.find(fileQuery, fileOptions);\n  };\n\n  _Class.prototype.insertFileInit = function(roomId, userId, store, file, extra) {\n    var fileData, ref;\n    fileData = {\n      rid: roomId,\n      userId: userId,\n      store: store,\n      complete: false,\n      uploading: true,\n      progress: 0,\n      extension: s.strRightBack(file.name, '.'),\n      uploadedAt: new Date()\n    };\n    _.extend(fileData, file, extra);\n    if (((ref = this.model.direct) != null ? ref.insert : void 0) != null) {\n      file = this.model.direct.insert(fileData);\n    } else {\n      file = this.insert(fileData);\n    }\n    return file;\n  };\n\n  _Class.prototype.updateFileComplete = function(fileId, userId, file) {\n    var filter, ref, result, update;\n    if (!fileId) {\n      return;\n    }\n    filter = {\n      _id: fileId,\n      userId: userId\n    };\n    update = {\n      $set: {\n        complete: true,\n        uploading: false,\n        progress: 1\n      }\n    };\n    update.$set = _.extend(file, update.$set);\n    if (((ref = this.model.direct) != null ? ref.insert : void 0) != null) {\n      result = this.model.direct.update(filter, update);\n    } else {\n      result = this.update(filter, update);\n    }\n    return result;\n  };\n\n  return _Class;\n\n})(RocketChat.models._Base));\n","class ModelUsers extends RocketChat.models._Base\n\tconstructor: ->\n\t\tsuper(arguments...)\n\n\t\t@tryEnsureIndex { 'roles': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'name': 1 }\n\t\t@tryEnsureIndex { 'lastLogin': 1 }\n\t\t@tryEnsureIndex { 'status': 1 }\n\t\t@tryEnsureIndex { 'active': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'statusConnection': 1 }, { sparse: 1 }\n\t\t@tryEnsureIndex { 'type': 1 }\n\n\t\tthis.cache.ensureIndex('username', 'unique')\n\n\tfindOneByImportId: (_id, options) ->\n\t\treturn @findOne { importIds: _id }, options\n\n\tfindOneByUsername: (username, options) ->\n\t\tquery =\n\t\t\tusername: username\n\n\t\treturn @findOne query, options\n\n\tfindOneByEmailAddress: (emailAddress, options) ->\n\t\tquery =\n\t\t\t'emails.address': new RegExp(\"^\" + s.escapeRegExp(emailAddress) + \"$\", 'i')\n\n\t\treturn @findOne query, options\n\n\tfindOneAdmin: (admin, options) ->\n\t\tquery =\n\t\t\tadmin: admin\n\n\t\treturn @findOne query, options\n\n\tfindOneByIdAndLoginToken: (_id, token, options) ->\n\t\tquery =\n\t\t\t_id: _id\n\t\t\t'services.resume.loginTokens.hashedToken' : Accounts._hashLoginToken(token)\n\n\t\treturn @findOne query, options\n\n\n\t# FIND\n\tfindById: (userId) ->\n\t\tquery =\n\t\t\t_id: userId\n\n\t\treturn @find query\n\n\tfindUsersNotOffline: (options) ->\n\t\tquery =\n\t\t\tusername:\n\t\t\t\t$exists: 1\n\t\t\tstatus:\n\t\t\t\t$in: ['online', 'away', 'busy']\n\n\t\treturn @find query, options\n\n\n\tfindByUsername: (username, options) ->\n\t\tquery =\n\t\t\tusername: username\n\n\t\treturn @find query, options\n\n\tfindUsersByUsernamesWithHighlights: (usernames, options) ->\n\t\tif this.useCache\n\t\t\tresult =\n\t\t\t\tfetch: () ->\n\t\t\t\t\treturn RocketChat.models.Users.getDynamicView('highlights').data().filter (record) ->\n\t\t\t\t\t\treturn usernames.indexOf(record.username) > -1\n\t\t\t\tcount: () ->\n\t\t\t\t\treturn result.fetch().length\n\t\t\t\tforEach: (fn) ->\n\t\t\t\t\treturn result.fetch().forEach(fn)\n\t\t\treturn result\n\n\t\tquery =\n\t\t\tusername: { $in: usernames }\n\t\t\t'settings.preferences.highlights.0':\n\t\t\t\t$exists: true\n\n\t\treturn @find query, options\n\n\tfindActiveByUsernameOrNameRegexWithExceptions: (searchTerm, exceptions = [], options = {}) ->\n\t\tif not _.isArray exceptions\n\t\t\texceptions = [ exceptions ]\n\n\t\ttermRegex = new RegExp s.escapeRegExp(searchTerm), 'i'\n\t\tquery = {\n\t\t\t$or: [{\n\t\t\t\tusername: termRegex\n\t\t\t}, {\n\t\t\t\tname: termRegex\n\t\t\t}],\n\t\t\tactive: true,\n\t\t\ttype: {\n\t\t\t\t$in: ['user', 'bot']\n\t\t\t},\n\t\t\t$and: [{\n\t\t\t\tusername: {\n\t\t\t\t\t$exists: true\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tusername: {\n\t\t\t\t\t$nin: exceptions\n\t\t\t\t}\n\t\t\t}]\n\t\t}\n\n\t\treturn @find query, options\n\n\tfindByActiveUsersExcept: (searchTerm, exceptions = [], options = {}) ->\n\t\tif not _.isArray exceptions\n\t\t\texceptions = [ exceptions ]\n\n\t\ttermRegex = new RegExp s.escapeRegExp(searchTerm), 'i'\n\t\tquery =\n\t\t\t$and: [\n\t\t\t\t{\n\t\t\t\t\tactive: true\n\t\t\t\t\t$or: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tusername: termRegex\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: termRegex\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t\t{\n\t\t\t\t\tusername: { $exists: true, $nin: exceptions }\n\t\t\t\t}\n\t\t\t]\n\n\t\treturn @find query, options\n\n\tfindUsersByNameOrUsername: (nameOrUsername, options) ->\n\t\tquery =\n\t\t\tusername:\n\t\t\t\t$exists: 1\n\n\t\t\t$or: [\n\t\t\t\t{name: nameOrUsername}\n\t\t\t\t{username: nameOrUsername}\n\t\t\t]\n\n\t\t\ttype:\n\t\t\t\t$in: ['user']\n\n\t\treturn @find query, options\n\n\tfindByUsernameNameOrEmailAddress: (usernameNameOrEmailAddress, options) ->\n\t\tquery =\n\t\t\t$or: [\n\t\t\t\t{name: usernameNameOrEmailAddress}\n\t\t\t\t{username: usernameNameOrEmailAddress}\n\t\t\t\t{'emails.address': usernameNameOrEmailAddress}\n\t\t\t]\n\t\t\ttype:\n\t\t\t\t$in: ['user', 'bot']\n\n\t\treturn @find query, options\n\n\tfindLDAPUsers: (options) ->\n\t\tquery =\n\t\t\tldap: true\n\n\t\treturn @find query, options\n\n\tfindCrowdUsers: (options) ->\n\t\tquery =\n\t\t\tcrowd: true\n\n\t\treturn @find query, options\n\n\tgetLastLogin: (options = {}) ->\n\t\tquery = { lastLogin: { $exists: 1 } }\n\t\toptions.sort = { lastLogin: -1 }\n\t\toptions.limit = 1\n\n\t\treturn @find(query, options)?.fetch?()?[0]?.lastLogin\n\n\tfindUsersByUsernames: (usernames, options) ->\n\t\tquery =\n\t\t\tusername:\n\t\t\t\t$in: usernames\n\n\t\treturn @find query, options\n\n\t# UPDATE\n\taddImportIds: (_id, importIds) ->\n\t\timportIds = [].concat(importIds)\n\n\t\tquery =\n\t\t\t_id: _id\n\n\t\tupdate =\n\t\t\t$addToSet:\n\t\t\t\timportIds:\n\t\t\t\t\t$each: importIds\n\n\t\treturn @update query, update\n\n\tupdateLastLoginById: (_id) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tlastLogin: new Date\n\n\t\treturn @update _id, update\n\n\tsetServiceId: (_id, serviceName, serviceId) ->\n\t\tupdate =\n\t\t\t$set: {}\n\n\t\tserviceIdKey = \"services.#{serviceName}.id\"\n\t\tupdate.$set[serviceIdKey] = serviceId\n\n\t\treturn @update _id, update\n\n\tsetUsername: (_id, username) ->\n\t\tupdate =\n\t\t\t$set: username: username\n\n\t\treturn @update _id, update\n\n\tsetEmail: (_id, email) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\temails: [\n\t\t\t\t\taddress: email\n\t\t\t\t\tverified: false\n\t\t\t\t]\n\n\t\treturn @update _id, update\n\n\tsetEmailVerified: (_id, email) ->\n\t\tquery =\n\t\t\t_id: _id\n\t\t\temails:\n\t\t\t\t$elemMatch:\n\t\t\t\t\taddress: email\n\t\t\t\t\tverified: false\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t'emails.$.verified': true\n\n\t\treturn @update query, update\n\n\tsetName: (_id, name) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tname: name\n\n\t\treturn @update _id, update\n\n\tsetCustomFields: (_id, fields) ->\n\t\tvalues = {}\n\t\tfor key, value of fields\n\t\t\tvalues[\"customFields.#{key}\"] = value\n\n\t\tupdate =\n\t\t\t$set: values\n\n\t\treturn @update _id, update\n\n\tsetAvatarOrigin: (_id, origin) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tavatarOrigin: origin\n\n\t\treturn @update _id, update\n\n\tunsetAvatarOrigin: (_id) ->\n\t\tupdate =\n\t\t\t$unset:\n\t\t\t\tavatarOrigin: 1\n\n\t\treturn @update _id, update\n\n\tsetUserActive: (_id, active=true) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tactive: active\n\n\t\treturn @update _id, update\n\n\tsetAllUsersActive: (active) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tactive: active\n\n\t\treturn @update {}, update, { multi: true }\n\n\tunsetLoginTokens: (_id) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"services.resume.loginTokens\" : []\n\n\t\treturn @update _id, update\n\n\tunsetRequirePasswordChange: (_id) ->\n\t\tupdate =\n\t\t\t$unset:\n\t\t\t\t\"requirePasswordChange\" : true\n\t\t\t\t\"requirePasswordChangeReason\" : true\n\n\t\treturn @update _id, update\n\n\tresetPasswordAndSetRequirePasswordChange: (_id, requirePasswordChange, requirePasswordChangeReason) ->\n\t\tupdate =\n\t\t\t$unset:\n\t\t\t\t\"services.password\": 1\n\t\t\t$set:\n\t\t\t\t\"requirePasswordChange\" : requirePasswordChange,\n\t\t\t\t\"requirePasswordChangeReason\": requirePasswordChangeReason\n\n\t\treturn @update _id, update\n\n\tsetLanguage: (_id, language) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tlanguage: language\n\n\t\treturn @update _id, update\n\n\tsetProfile: (_id, profile) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"settings.profile\": profile\n\n\t\treturn @update _id, update\n\n\tsetPreferences: (_id, preferences) ->\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\t\"settings.preferences\": preferences\n\n\t\treturn @update _id, update\n\n\tsetUtcOffset: (_id, utcOffset) ->\n\t\tquery =\n\t\t\t_id: _id\n\t\t\tutcOffset:\n\t\t\t\t$ne: utcOffset\n\n\t\tupdate =\n\t\t\t$set:\n\t\t\t\tutcOffset: utcOffset\n\n\t\treturn @update query, update\n\n\tsaveUserById: (_id, data) ->\n\t\tsetData = {}\n\t\tunsetData = {}\n\n\t\tif data.name?\n\t\t\tif not _.isEmpty(s.trim(data.name))\n\t\t\t\tsetData.name = s.trim(data.name)\n\t\t\telse\n\t\t\t\tunsetData.name = 1\n\n\t\tif data.email?\n\t\t\tif not _.isEmpty(s.trim(data.email))\n\t\t\t\tsetData.emails = [\n\t\t\t\t\taddress: s.trim(data.email)\n\t\t\t\t]\n\t\t\telse\n\t\t\t\tunsetData.emails = 1\n\n\t\tif data.phone?\n\t\t\tif not _.isEmpty(s.trim(data.phone))\n\t\t\t\tsetData.phone = [\n\t\t\t\t\tphoneNumber: s.trim(data.phone)\n\t\t\t\t]\n\t\t\telse\n\t\t\t\tunsetData.phone = 1\n\n\t\tupdate = {}\n\n\t\tif not _.isEmpty setData\n\t\t\tupdate.$set = setData\n\n\t\tif not _.isEmpty unsetData\n\t\t\tupdate.$unset = unsetData\n\n\t\tif _.isEmpty update\n\t\t\treturn true\n\n\t\treturn @update { _id: _id }, update\n\n\t# INSERT\n\tcreate: (data) ->\n\t\tuser =\n\t\t\tcreatedAt: new Date\n\t\t\tavatarOrigin: 'none'\n\n\t\t_.extend user, data\n\n\t\treturn @insert user\n\n\n\t# REMOVE\n\tremoveById: (_id) ->\n\t\treturn @remove _id\n\n\t###\n\tFind users to send a message by email if:\n\t- he is not online\n\t- has a verified email\n\t- has not disabled email notifications\n\t- `active` is equal to true (false means they were deactivated and can't login)\n\t###\n\tgetUsersToSendOfflineEmail: (usersIds) ->\n\t\tquery =\n\t\t\t_id:\n\t\t\t\t$in: usersIds\n\t\t\tactive: true\n\t\t\tstatus: 'offline'\n\t\t\tstatusConnection:\n\t\t\t\t$ne: 'online'\n\t\t\t'emails.verified': true\n\n\t\treturn @find query, { fields: { name: 1, username: 1, emails: 1, 'settings.preferences.emailNotificationMode': 1 } }\n\nRocketChat.models.Users = new ModelUsers(Meteor.users, true)\n","var ModelUsers,\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nModelUsers = (function(superClass) {\n  extend(ModelUsers, superClass);\n\n  function ModelUsers() {\n    ModelUsers.__super__.constructor.apply(this, arguments);\n    this.tryEnsureIndex({\n      'roles': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'name': 1\n    });\n    this.tryEnsureIndex({\n      'lastLogin': 1\n    });\n    this.tryEnsureIndex({\n      'status': 1\n    });\n    this.tryEnsureIndex({\n      'active': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'statusConnection': 1\n    }, {\n      sparse: 1\n    });\n    this.tryEnsureIndex({\n      'type': 1\n    });\n    this.cache.ensureIndex('username', 'unique');\n  }\n\n  ModelUsers.prototype.findOneByImportId = function(_id, options) {\n    return this.findOne({\n      importIds: _id\n    }, options);\n  };\n\n  ModelUsers.prototype.findOneByUsername = function(username, options) {\n    var query;\n    query = {\n      username: username\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelUsers.prototype.findOneByEmailAddress = function(emailAddress, options) {\n    var query;\n    query = {\n      'emails.address': new RegExp(\"^\" + s.escapeRegExp(emailAddress) + \"$\", 'i')\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelUsers.prototype.findOneAdmin = function(admin, options) {\n    var query;\n    query = {\n      admin: admin\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelUsers.prototype.findOneByIdAndLoginToken = function(_id, token, options) {\n    var query;\n    query = {\n      _id: _id,\n      'services.resume.loginTokens.hashedToken': Accounts._hashLoginToken(token)\n    };\n    return this.findOne(query, options);\n  };\n\n  ModelUsers.prototype.findById = function(userId) {\n    var query;\n    query = {\n      _id: userId\n    };\n    return this.find(query);\n  };\n\n  ModelUsers.prototype.findUsersNotOffline = function(options) {\n    var query;\n    query = {\n      username: {\n        $exists: 1\n      },\n      status: {\n        $in: ['online', 'away', 'busy']\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.findByUsername = function(username, options) {\n    var query;\n    query = {\n      username: username\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.findUsersByUsernamesWithHighlights = function(usernames, options) {\n    var query, result;\n    if (this.useCache) {\n      result = {\n        fetch: function() {\n          return RocketChat.models.Users.getDynamicView('highlights').data().filter(function(record) {\n            return usernames.indexOf(record.username) > -1;\n          });\n        },\n        count: function() {\n          return result.fetch().length;\n        },\n        forEach: function(fn) {\n          return result.fetch().forEach(fn);\n        }\n      };\n      return result;\n    }\n    query = {\n      username: {\n        $in: usernames\n      },\n      'settings.preferences.highlights.0': {\n        $exists: true\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.findActiveByUsernameOrNameRegexWithExceptions = function(searchTerm, exceptions, options) {\n    var query, termRegex;\n    if (exceptions == null) {\n      exceptions = [];\n    }\n    if (options == null) {\n      options = {};\n    }\n    if (!_.isArray(exceptions)) {\n      exceptions = [exceptions];\n    }\n    termRegex = new RegExp(s.escapeRegExp(searchTerm), 'i');\n    query = {\n      $or: [\n        {\n          username: termRegex\n        }, {\n          name: termRegex\n        }\n      ],\n      active: true,\n      type: {\n        $in: ['user', 'bot']\n      },\n      $and: [\n        {\n          username: {\n            $exists: true\n          }\n        }, {\n          username: {\n            $nin: exceptions\n          }\n        }\n      ]\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.findByActiveUsersExcept = function(searchTerm, exceptions, options) {\n    var query, termRegex;\n    if (exceptions == null) {\n      exceptions = [];\n    }\n    if (options == null) {\n      options = {};\n    }\n    if (!_.isArray(exceptions)) {\n      exceptions = [exceptions];\n    }\n    termRegex = new RegExp(s.escapeRegExp(searchTerm), 'i');\n    query = {\n      $and: [\n        {\n          active: true,\n          $or: [\n            {\n              username: termRegex\n            }, {\n              name: termRegex\n            }\n          ]\n        }, {\n          username: {\n            $exists: true,\n            $nin: exceptions\n          }\n        }\n      ]\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.findUsersByNameOrUsername = function(nameOrUsername, options) {\n    var query;\n    query = {\n      username: {\n        $exists: 1\n      },\n      $or: [\n        {\n          name: nameOrUsername\n        }, {\n          username: nameOrUsername\n        }\n      ],\n      type: {\n        $in: ['user']\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.findByUsernameNameOrEmailAddress = function(usernameNameOrEmailAddress, options) {\n    var query;\n    query = {\n      $or: [\n        {\n          name: usernameNameOrEmailAddress\n        }, {\n          username: usernameNameOrEmailAddress\n        }, {\n          'emails.address': usernameNameOrEmailAddress\n        }\n      ],\n      type: {\n        $in: ['user', 'bot']\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.findLDAPUsers = function(options) {\n    var query;\n    query = {\n      ldap: true\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.findCrowdUsers = function(options) {\n    var query;\n    query = {\n      crowd: true\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.getLastLogin = function(options) {\n    var query, ref, ref1, ref2;\n    if (options == null) {\n      options = {};\n    }\n    query = {\n      lastLogin: {\n        $exists: 1\n      }\n    };\n    options.sort = {\n      lastLogin: -1\n    };\n    options.limit = 1;\n    return (ref = this.find(query, options)) != null ? typeof ref.fetch === \"function\" ? (ref1 = ref.fetch()) != null ? (ref2 = ref1[0]) != null ? ref2.lastLogin : void 0 : void 0 : void 0 : void 0;\n  };\n\n  ModelUsers.prototype.findUsersByUsernames = function(usernames, options) {\n    var query;\n    query = {\n      username: {\n        $in: usernames\n      }\n    };\n    return this.find(query, options);\n  };\n\n  ModelUsers.prototype.addImportIds = function(_id, importIds) {\n    var query, update;\n    importIds = [].concat(importIds);\n    query = {\n      _id: _id\n    };\n    update = {\n      $addToSet: {\n        importIds: {\n          $each: importIds\n        }\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelUsers.prototype.updateLastLoginById = function(_id) {\n    var update;\n    update = {\n      $set: {\n        lastLogin: new Date\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setServiceId = function(_id, serviceName, serviceId) {\n    var serviceIdKey, update;\n    update = {\n      $set: {}\n    };\n    serviceIdKey = \"services.\" + serviceName + \".id\";\n    update.$set[serviceIdKey] = serviceId;\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setUsername = function(_id, username) {\n    var update;\n    update = {\n      $set: {\n        username: username\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setEmail = function(_id, email) {\n    var update;\n    update = {\n      $set: {\n        emails: [\n          {\n            address: email,\n            verified: false\n          }\n        ]\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setEmailVerified = function(_id, email) {\n    var query, update;\n    query = {\n      _id: _id,\n      emails: {\n        $elemMatch: {\n          address: email,\n          verified: false\n        }\n      }\n    };\n    update = {\n      $set: {\n        'emails.$.verified': true\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelUsers.prototype.setName = function(_id, name) {\n    var update;\n    update = {\n      $set: {\n        name: name\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setCustomFields = function(_id, fields) {\n    var key, update, value, values;\n    values = {};\n    for (key in fields) {\n      value = fields[key];\n      values[\"customFields.\" + key] = value;\n    }\n    update = {\n      $set: values\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setAvatarOrigin = function(_id, origin) {\n    var update;\n    update = {\n      $set: {\n        avatarOrigin: origin\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.unsetAvatarOrigin = function(_id) {\n    var update;\n    update = {\n      $unset: {\n        avatarOrigin: 1\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setUserActive = function(_id, active) {\n    var update;\n    if (active == null) {\n      active = true;\n    }\n    update = {\n      $set: {\n        active: active\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setAllUsersActive = function(active) {\n    var update;\n    update = {\n      $set: {\n        active: active\n      }\n    };\n    return this.update({}, update, {\n      multi: true\n    });\n  };\n\n  ModelUsers.prototype.unsetLoginTokens = function(_id) {\n    var update;\n    update = {\n      $set: {\n        \"services.resume.loginTokens\": []\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.unsetRequirePasswordChange = function(_id) {\n    var update;\n    update = {\n      $unset: {\n        \"requirePasswordChange\": true,\n        \"requirePasswordChangeReason\": true\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.resetPasswordAndSetRequirePasswordChange = function(_id, requirePasswordChange, requirePasswordChangeReason) {\n    var update;\n    update = {\n      $unset: {\n        \"services.password\": 1\n      },\n      $set: {\n        \"requirePasswordChange\": requirePasswordChange,\n        \"requirePasswordChangeReason\": requirePasswordChangeReason\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setLanguage = function(_id, language) {\n    var update;\n    update = {\n      $set: {\n        language: language\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setProfile = function(_id, profile) {\n    var update;\n    update = {\n      $set: {\n        \"settings.profile\": profile\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setPreferences = function(_id, preferences) {\n    var update;\n    update = {\n      $set: {\n        \"settings.preferences\": preferences\n      }\n    };\n    return this.update(_id, update);\n  };\n\n  ModelUsers.prototype.setUtcOffset = function(_id, utcOffset) {\n    var query, update;\n    query = {\n      _id: _id,\n      utcOffset: {\n        $ne: utcOffset\n      }\n    };\n    update = {\n      $set: {\n        utcOffset: utcOffset\n      }\n    };\n    return this.update(query, update);\n  };\n\n  ModelUsers.prototype.saveUserById = function(_id, data) {\n    var setData, unsetData, update;\n    setData = {};\n    unsetData = {};\n    if (data.name != null) {\n      if (!_.isEmpty(s.trim(data.name))) {\n        setData.name = s.trim(data.name);\n      } else {\n        unsetData.name = 1;\n      }\n    }\n    if (data.email != null) {\n      if (!_.isEmpty(s.trim(data.email))) {\n        setData.emails = [\n          {\n            address: s.trim(data.email)\n          }\n        ];\n      } else {\n        unsetData.emails = 1;\n      }\n    }\n    if (data.phone != null) {\n      if (!_.isEmpty(s.trim(data.phone))) {\n        setData.phone = [\n          {\n            phoneNumber: s.trim(data.phone)\n          }\n        ];\n      } else {\n        unsetData.phone = 1;\n      }\n    }\n    update = {};\n    if (!_.isEmpty(setData)) {\n      update.$set = setData;\n    }\n    if (!_.isEmpty(unsetData)) {\n      update.$unset = unsetData;\n    }\n    if (_.isEmpty(update)) {\n      return true;\n    }\n    return this.update({\n      _id: _id\n    }, update);\n  };\n\n  ModelUsers.prototype.create = function(data) {\n    var user;\n    user = {\n      createdAt: new Date,\n      avatarOrigin: 'none'\n    };\n    _.extend(user, data);\n    return this.insert(user);\n  };\n\n  ModelUsers.prototype.removeById = function(_id) {\n    return this.remove(_id);\n  };\n\n\n  /*\n  \tFind users to send a message by email if:\n  \t- he is not online\n  \t- has a verified email\n  \t- has not disabled email notifications\n  \t- `active` is equal to true (false means they were deactivated and can't login)\n   */\n\n  ModelUsers.prototype.getUsersToSendOfflineEmail = function(usersIds) {\n    var query;\n    query = {\n      _id: {\n        $in: usersIds\n      },\n      active: true,\n      status: 'offline',\n      statusConnection: {\n        $ne: 'online'\n      },\n      'emails.verified': true\n    };\n    return this.find(query, {\n      fields: {\n        name: 1,\n        username: 1,\n        emails: 1,\n        'settings.preferences.emailNotificationMode': 1\n      }\n    });\n  };\n\n  return ModelUsers;\n\n})(RocketChat.models._Base);\n\nRocketChat.models.Users = new ModelUsers(Meteor.users, true);\n","/* eslint new-cap: 0 */\n\nimport loki from 'lokijs';\nimport {EventEmitter} from 'events';\nimport objectPath from 'object-path';\n\nconst logger = new Logger('BaseCache');\n\nconst lokiEq = loki.LokiOps.$eq;\nconst lokiNe = loki.LokiOps.$ne;\n\nloki.LokiOps.$eq = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.indexOf(b) !== -1;\n\t}\n\treturn lokiEq(a, b);\n};\n\nloki.LokiOps.$ne = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.indexOf(b) === -1;\n\t}\n\treturn lokiNe(a, b);\n};\n\nconst lokiIn = loki.LokiOps.$in;\nloki.LokiOps.$in = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.some(subA => lokiIn(subA, b));\n\t}\n\treturn lokiIn(a, b);\n};\n\nloki.LokiOps.$nin = function(a, b) {\n\treturn !loki.LokiOps.$in(a, b);\n};\n\nloki.LokiOps.$all = function(a, b) {\n\treturn b.every(subB => a.includes(subB));\n};\n\nloki.LokiOps.$exists = function(a, b) {\n\tif (b) {\n\t\treturn loki.LokiOps.$ne(a, undefined);\n\t}\n\n\treturn loki.LokiOps.$eq(a, undefined);\n};\n\nloki.LokiOps.$elemMatch = function(a, b) {\n\treturn _.findWhere(a, b);\n};\n\nconst ignore = [\n\t'emit',\n\t'load',\n\t'on',\n\t'addToAllIndexes'\n];\n\nfunction traceMethodCalls(target) {\n\ttarget._stats = {};\n\n\tfor (const property in target) {\n\t\tif (typeof target[property] === 'function' && ignore.indexOf(property) === -1) {\n\t\t\ttarget._stats[property] = {\n\t\t\t\tcalls: 0,\n\t\t\t\ttime: 0,\n\t\t\t\tavg: 0\n\t\t\t};\n\t\t\tconst origMethod = target[property];\n\t\t\ttarget[property] = function(...args) {\n\n\t\t\t\tif (target.loaded !== true) {\n\t\t\t\t\treturn origMethod.apply(target, args);\n\t\t\t\t}\n\n\t\t\t\tconst startTime = RocketChat.statsTracker.now();\n\t\t\t\tconst result = origMethod.apply(target, args);\n\t\t\t\tconst time = Math.round(RocketChat.statsTracker.now() - startTime) / 1000;\n\t\t\t\ttarget._stats[property].time += time;\n\t\t\t\ttarget._stats[property].calls++;\n\t\t\t\ttarget._stats[property].avg = target._stats[property].time / target._stats[property].calls;\n\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\t}\n\n\tsetInterval(function() {\n\t\tfor (const property in target._stats) {\n\t\t\tif (target._stats.hasOwnProperty(property) && target._stats[property].time > 0) {\n\t\t\t\tconst tags = [`property:${ property }`, `collection:${ target.collectionName }`];\n\t\t\t\tRocketChat.statsTracker.timing('cache.methods.time', target._stats[property].avg, tags);\n\t\t\t\tRocketChat.statsTracker.increment('cache.methods.totalTime', target._stats[property].time, tags);\n\t\t\t\tRocketChat.statsTracker.increment('cache.methods.count', target._stats[property].calls, tags);\n\t\t\t\ttarget._stats[property].avg = 0;\n\t\t\t\ttarget._stats[property].time = 0;\n\t\t\t\ttarget._stats[property].calls = 0;\n\t\t\t}\n\t\t}\n\t}, 10000);\n\n\ttarget._getStatsAvg = function() {\n\t\tconst stats = [];\n\t\tfor (const property in target._stats) {\n\t\t\tif (target._stats.hasOwnProperty(property)) {\n\t\t\t\tstats.push([Math.round(target._stats[property].avg*100)/100, property]);\n\t\t\t}\n\t\t}\n\t\treturn _.sortBy(stats, function(record) {\n\t\t\treturn record[0];\n\t\t});\n\t};\n}\n\nclass Adapter {\n\tloadDatabase(/*dbname, callback*/) {}\n\tsaveDatabase(/*dbname, dbstring, callback*/) {}\n\tdeleteDatabase(/*dbname, callback*/) {}\n}\n\nconst db = new loki('rocket.chat.json', {adapter: Adapter});\n\nclass ModelsBaseCache extends EventEmitter {\n\tconstructor(model) {\n\t\tsuper();\n\n\t\ttraceMethodCalls(this);\n\n\t\tthis.indexes = {};\n\t\tthis.ignoreUpdatedFields = ['_updatedAt'];\n\n\t\tthis.query = {};\n\t\tthis.options = {};\n\n\t\tthis.ensureIndex('_id', 'unique');\n\n\t\tthis.joins = {};\n\n\t\tthis.on('inserted', (...args) => { this.emit('changed', 'inserted', ...args); });\n\t\tthis.on('removed', (...args) => { this.emit('changed', 'removed', ...args); });\n\t\tthis.on('updated', (...args) => { this.emit('changed', 'updated', ...args); });\n\n\t\tthis.on('beforeinsert', (...args) => { this.emit('beforechange', 'inserted', ...args); });\n\t\tthis.on('beforeremove', (...args) => { this.emit('beforechange', 'removed', ...args); });\n\t\tthis.on('beforeupdate', (...args) => { this.emit('beforechange', 'updated', ...args); });\n\n\t\tthis.on('inserted', (...args) => { this.emit('sync', 'inserted', ...args); });\n\t\tthis.on('updated', (...args) => { this.emit('sync', 'updated', ...args); });\n\t\tthis.on('beforeremove', (...args) => { this.emit('sync', 'removed', ...args); });\n\n\t\tthis.db = db;\n\n\t\tthis.model = model;\n\n\t\tthis.collectionName = this.model._db.collectionName;\n\t\tthis.collection = this.db.addCollection(this.collectionName);\n\t}\n\n\thasOne(join, {field, link}) {\n\t\tthis.join({join, field, link, multi: false});\n\t}\n\n\thasMany(join, {field, link}) {\n\t\tthis.join({join, field, link, multi: true});\n\t}\n\n\tjoin({join, field, link, multi}) {\n\t\tif (!RocketChat.models[join]) {\n\t\t\tconsole.log(`Invalid cache model ${ join }`);\n\t\t\treturn;\n\t\t}\n\n\t\tRocketChat.models[join].cache.on('inserted', (record) => {\n\t\t\tthis.processRemoteJoinInserted({join, field, link, multi, record});\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('beforeupdate', (record, diff) => {\n\t\t\tif (diff[link.remote]) {\n\t\t\t\tthis.processRemoteJoinRemoved({join, field, link, multi, record});\n\t\t\t}\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('updated', (record, diff) => {\n\t\t\tif (diff[link.remote]) {\n\t\t\t\tthis.processRemoteJoinInserted({join, field, link, multi, record});\n\t\t\t}\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('removed', (record) => {\n\t\t\tthis.processRemoteJoinRemoved({join, field, link, multi, record});\n\t\t});\n\n\t\tthis.on('inserted', (localRecord) => {\n\t\t\tthis.processLocalJoinInserted({join, field, link, multi, localRecord});\n\t\t});\n\n\t\tthis.on('beforeupdate', (localRecord, diff) => {\n\t\t\tif (diff[link.local]) {\n\t\t\t\tif (multi === true) {\n\t\t\t\t\tlocalRecord[field] = [];\n\t\t\t\t} else {\n\t\t\t\t\tlocalRecord[field] = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.on('updated', (localRecord, diff) => {\n\t\t\tif (diff[link.local]) {\n\t\t\t\tthis.processLocalJoinInserted({join, field, link, multi, localRecord});\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessRemoteJoinInserted({field, link, multi, record}) {\n\t\tlet localRecords = this._findByIndex(link.local, objectPath.get(record, link.remote));\n\n\t\tif (!localRecords) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Array.isArray(localRecords)) {\n\t\t\tlocalRecords = [localRecords];\n\t\t}\n\n\t\tfor (let i = 0; i < localRecords.length; i++) {\n\t\t\tconst localRecord = localRecords[i];\n\t\t\tif (multi === true && !localRecord[field]) {\n\t\t\t\tlocalRecord[field] = [];\n\t\t\t}\n\n\t\t\tif (typeof link.where === 'function' && link.where(localRecord, record) === false) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet mutableRecord = record;\n\n\t\t\tif (typeof link.transform === 'function') {\n\t\t\t\tmutableRecord = link.transform(localRecord, mutableRecord);\n\t\t\t}\n\n\t\t\tif (multi === true) {\n\t\t\t\tlocalRecord[field].push(mutableRecord);\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = mutableRecord;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${ field }:inserted`, localRecord, mutableRecord);\n\t\t\tthis.emit(`join:${ field }:changed`, 'inserted', localRecord, mutableRecord);\n\t\t}\n\t}\n\n\tprocessLocalJoinInserted({join, field, link, multi, localRecord}) {\n\t\tlet records = RocketChat.models[join].cache._findByIndex(link.remote, objectPath.get(localRecord, link.local));\n\n\t\tif (!Array.isArray(records)) {\n\t\t\trecords = [records];\n\t\t}\n\n\t\tfor (let i = 0; i < records.length; i++) {\n\t\t\tlet record = records[i];\n\n\t\t\tif (typeof link.where === 'function' && link.where(localRecord, record) === false) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (typeof link.transform === 'function') {\n\t\t\t\trecord = link.transform(localRecord, record);\n\t\t\t}\n\n\t\t\tif (multi === true) {\n\t\t\t\tlocalRecord[field].push(record);\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = record;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${ field }:inserted`, localRecord, record);\n\t\t\tthis.emit(`join:${ field }:changed`, 'inserted', localRecord, record);\n\t\t}\n\t}\n\n\tprocessRemoteJoinRemoved({field, link, multi, record}) {\n\t\tlet localRecords = this._findByIndex(link.local, objectPath.get(record, link.remote));\n\n\t\tif (!localRecords) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Array.isArray(localRecords)) {\n\t\t\tlocalRecords = [localRecords];\n\t\t}\n\n\t\tfor (let i = 0; i < localRecords.length; i++) {\n\t\t\tconst localRecord = localRecords[i];\n\n\t\t\tif (multi === true) {\n\t\t\t\tif (Array.isArray(localRecord[field])) {\n\t\t\t\t\tif (typeof link.remove === 'function') {\n\t\t\t\t\t\tlink.remove(localRecord[field], record);\n\t\t\t\t\t} else if (localRecord[field].indexOf(record) > -1) {\n\t\t\t\t\t\tlocalRecord[field].splice(localRecord[field].indexOf(record), 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = undefined;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${ field }:removed`, localRecord, record);\n\t\t\tthis.emit(`join:${ field }:changed`, 'removed', localRecord, record);\n\t\t}\n\t}\n\n\tensureIndex(fields, type='array') {\n\t\tif (!Array.isArray(fields)) {\n\t\t\tfields = [fields];\n\t\t}\n\n\t\tthis.indexes[fields.join(',')] = {\n\t\t\ttype,\n\t\t\tfields,\n\t\t\tdata: {}\n\t\t};\n\t}\n\n\taddToAllIndexes(record) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.addToIndex(indexName, record);\n\t\t\t}\n\t\t}\n\t}\n\n\taddToIndex(indexName, record) {\n\t\tconst index = this.indexes[indexName];\n\t\tif (!index) {\n\t\t\tconsole.error(`Index not defined ${ indexName }`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst keys = [];\n\t\tfor (const field of index.fields) {\n\t\t\tkeys.push(objectPath.get(record, field));\n\t\t}\n\t\tconst key = keys.join('|');\n\n\t\tif (index.type === 'unique') {\n\t\t\tindex.data[key] = record;\n\t\t\treturn;\n\t\t}\n\n\t\tif (index.type === 'array') {\n\t\t\tif (!index.data[key]) {\n\t\t\t\tindex.data[key] = [];\n\t\t\t}\n\t\t\tindex.data[key].push(record);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tremoveFromAllIndexes(record) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.removeFromIndex(indexName, record);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFromIndex(indexName, record) {\n\t\tconst index = this.indexes[indexName];\n\t\tif (!this.indexes[indexName]) {\n\t\t\tconsole.error(`Index not defined ${ indexName }`);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!index.data) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet key = [];\n\t\tfor (const field of index.fields) {\n\t\t\tkey.push(objectPath.get(record, field));\n\t\t}\n\t\tkey = key.join('|');\n\n\t\tif (index.type === 'unique') {\n\t\t\tindex.data[key] = undefined;\n\t\t\treturn;\n\t\t}\n\n\t\tif (index.type === 'array') {\n\t\t\tif (!index.data[key]) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst i = index.data[key].indexOf(record);\n\t\t\tif (i > -1) {\n\t\t\t\tindex.data[key].splice(i, 1);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\n\t_findByIndex(index, keys) {\n\t\tconst key = [].concat(keys).join('|');\n\t\tif (!this.indexes[index]) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.indexes[index].data) {\n\t\t\tconst result = this.indexes[index].data[key];\n\t\t\tif (result) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tif (this.indexes[index].type === 'array') {\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tfindByIndex(index, keys, options={}) {\n\t\treturn {\n\t\t\tfetch: () => {\n\t\t\t\treturn this.processQueryOptionsOnResult(this._findByIndex(index, keys), options);\n\t\t\t},\n\n\t\t\tcount: () => {\n\t\t\t\tconst records = this.findByIndex(index, keys, options).fetch();\n\t\t\t\tif (Array.isArray(records)) {\n\t\t\t\t\treturn records.length;\n\t\t\t\t}\n\t\t\t\treturn !records ? 0 : 1;\n\t\t\t},\n\n\t\t\tforEach: (fn) => {\n\t\t\t\tconst records = this.findByIndex(index, keys, options).fetch();\n\t\t\t\tif (Array.isArray(records)) {\n\t\t\t\t\treturn records.forEach(fn);\n\t\t\t\t}\n\t\t\t\tif (records) {\n\t\t\t\t\treturn fn(records);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tload() {\n\t\tif (this.model._useCache === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.log('Will load cache for', this.collectionName);\n\t\tthis.emit('beforeload');\n\t\tthis.loaded = false;\n\t\tconst time = RocketChat.statsTracker.now();\n\t\tconst data = this.model.db.find(this.query, this.options).fetch();\n\t\tfor (let i=0; i < data.length; i++) {\n\t\t\tthis.insert(data[i]);\n\t\t}\n\t\tconsole.log(String(data.length), 'records load from', this.collectionName);\n\t\tRocketChat.statsTracker.timing('cache.load', RocketChat.statsTracker.now() - time, [`collection:${ this.collectionName }`]);\n\n\t\tthis.startSync();\n\t\tthis.loaded = true;\n\t\tthis.emit('afterload');\n\t}\n\n\tstartSync() {\n\t\tif (this.model._useCache === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.model._db.on('change', ({action, id, data/*, oplog*/}) => {\n\t\t\tswitch (action) {\n\t\t\t\tcase 'insert':\n\t\t\t\t\tdata._id = id;\n\t\t\t\t\tthis.insert(data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'remove':\n\t\t\t\t\tthis.removeById(id);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:record':\n\t\t\t\t\tthis.updateDiffById(id, data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:diff':\n\t\t\t\t\tthis.updateDiffById(id, data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:query':\n\t\t\t\t\tthis.update(data.query, data.update, data.options);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessQueryOptionsOnResult(result, options={}) {\n\t\tif (result === undefined || result === null) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (Array.isArray(result)) {\n\t\t\tif (options.sort) {\n\t\t\t\tresult = result.sort((a, b) => {\n\t\t\t\t\tlet r = 0;\n\t\t\t\t\tfor (const field in options.sort) {\n\t\t\t\t\t\tif (options.sort.hasOwnProperty(field)) {\n\t\t\t\t\t\t\tconst direction = options.sort[field];\n\t\t\t\t\t\t\tlet valueA;\n\t\t\t\t\t\t\tlet valueB;\n\t\t\t\t\t\t\tif (field.indexOf('.') > -1) {\n\t\t\t\t\t\t\t\tvalueA = objectPath.get(a, field);\n\t\t\t\t\t\t\t\tvalueB = objectPath.get(b, field);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvalueA = a[field];\n\t\t\t\t\t\t\t\tvalueB = b[field];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (valueA > valueB) {\n\t\t\t\t\t\t\t\tr = direction;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (valueA < valueB) {\n\t\t\t\t\t\t\t\tr = -direction;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn r;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (typeof options.skip === 'number') {\n\t\t\t\tresult.splice(0, options.skip);\n\t\t\t}\n\n\t\t\tif (typeof options.limit === 'number' && options.limit !== 0) {\n\t\t\t\tresult.splice(options.limit);\n\t\t\t}\n\t\t}\n\n\t\tif (!options.fields) {\n\t\t\toptions.fields = {};\n\t\t}\n\n\t\tconst fieldsToRemove = [];\n\t\tconst fieldsToGet = [];\n\n\t\tfor (const field in options.fields) {\n\t\t\tif (options.fields.hasOwnProperty(field)) {\n\t\t\t\tif (options.fields[field] === 0) {\n\t\t\t\t\tfieldsToRemove.push(field);\n\t\t\t\t} else if (options.fields[field] === 1) {\n\t\t\t\t\tfieldsToGet.push(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (fieldsToRemove.length > 0 && fieldsToGet.length > 0) {\n\t\t\tconsole.warn('Can\\'t mix remove and get fields');\n\t\t\tfieldsToRemove.splice(0, fieldsToRemove.length);\n\t\t}\n\n\t\tif (fieldsToGet.length > 0 && fieldsToGet.indexOf('_id') === -1) {\n\t\t\tfieldsToGet.push('_id');\n\t\t}\n\n\t\tconst pickFields = (obj, fields) => {\n\t\t\tconst picked = {};\n\t\t\tfields.forEach((field) => {\n\t\t\t\tif (field.indexOf('.') !== -1) {\n\t\t\t\t\tobjectPath.set(picked, field, objectPath.get(obj, field));\n\t\t\t\t} else {\n\t\t\t\t\tpicked[field] = obj[field];\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn picked;\n\t\t};\n\n\t\tif (fieldsToRemove.length > 0 || fieldsToGet.length > 0) {\n\t\t\tif (Array.isArray(result)) {\n\t\t\t\tresult = result.map((record) => {\n\t\t\t\t\tif (fieldsToRemove.length > 0) {\n\t\t\t\t\t\treturn _.omit(record, ...fieldsToRemove);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (fieldsToGet.length > 0) {\n\t\t\t\t\t\treturn pickFields(record, fieldsToGet);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (fieldsToRemove.length > 0) {\n\t\t\t\t\treturn _.omit(result, ...fieldsToRemove);\n\t\t\t\t}\n\n\t\t\t\tif (fieldsToGet.length > 0) {\n\t\t\t\t\treturn pickFields(result, fieldsToGet);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprocessQuery(query, parentField) {\n\t\tif (!query) {\n\t\t\treturn query;\n\t\t}\n\n\t\tif (Match.test(query, String)) {\n\t\t\treturn {\n\t\t\t\t_id: query\n\t\t\t};\n\t\t}\n\n\t\tif (Object.keys(query).length > 1 && parentField !== '$elemMatch') {\n\t\t\tconst and = [];\n\t\t\tfor (const field in query) {\n\t\t\t\tif (query.hasOwnProperty(field)) {\n\t\t\t\t\tand.push({\n\t\t\t\t\t\t[field]: query[field]\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tquery = {$and: and};\n\t\t}\n\n\t\tfor (const field in query) {\n\t\t\tif (query.hasOwnProperty(field)) {\n\t\t\t\tconst value = query[field];\n\t\t\t\tif (value instanceof RegExp && field !== '$regex') {\n\t\t\t\t\tquery[field] = {\n\t\t\t\t\t\t$regex: value\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (field === '$and' || field === '$or') {\n\t\t\t\t\tquery[field] = value.map((subValue) => {\n\t\t\t\t\t\treturn this.processQuery(subValue, field);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (Match.test(value, Object) && Object.keys(value).length > 0) {\n\t\t\t\t\tquery[field] = this.processQuery(value, field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn query;\n\t}\n\n\tfind(query, options={}) {\n\t\treturn {\n\t\t\tfetch: () => {\n\t\t\t\ttry {\n\t\t\t\t\tquery = this.processQuery(query);\n\t\t\t\t\treturn this.processQueryOptionsOnResult(this.collection.find(query), options);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Exception on cache find for', this.collectionName);\n\t\t\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\t\t\tconsole.error(e.stack);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tcount: () => {\n\t\t\t\ttry {\n\t\t\t\t\tquery = this.processQuery(query);\n\t\t\t\t\tconst { limit, skip } = options;\n\t\t\t\t\treturn this.processQueryOptionsOnResult(this.collection.find(query), { limit, skip }).length;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Exception on cache find for', this.collectionName);\n\t\t\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\t\t\tconsole.error(e.stack);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tforEach: (fn) => {\n\t\t\t\treturn this.find(query, options).fetch().forEach(fn);\n\t\t\t},\n\n\t\t\tobserve: (obj) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back observe to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments).observe(obj);\n\t\t\t},\n\n\t\t\tobserveChanges: (obj) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back observeChanges to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments).observeChanges(obj);\n\t\t\t},\n\n\t\t\t_publishCursor: (cursor, sub, collection) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back _publishCursor to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments)._publishCursor(cursor, sub, collection);\n\t\t\t}\n\t\t};\n\t}\n\n\tfindOne(query, options) {\n\t\ttry {\n\t\t\tquery = this.processQuery(query);\n\t\t\treturn this.processQueryOptionsOnResult(this.collection.findOne(query), options);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on cache findOne for', this.collectionName);\n\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\tconsole.error(e.stack);\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\tfindOneById(_id, options) {\n\t\treturn this.findByIndex('_id', _id, options).fetch();\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\tconst query = this.processQuery({ _id: { $in: ids }});\n\t\treturn this.processQueryOptionsOnResult(this.collection.findOne(query), options);\n\t}\n\n\tfindWhere(query, options) {\n\t\tquery = this.processQuery(query);\n\t\treturn this.processQueryOptionsOnResult(this.collection.findWhere(query), options);\n\t}\n\n\taddDynamicView() {\n\t\treturn this.collection.addDynamicView(...arguments);\n\t}\n\n\tgetDynamicView() {\n\t\treturn this.collection.getDynamicView(...arguments);\n\t}\n\n\tinsert(record) {\n\t\tif (Array.isArray(record)) {\n\t\t\tfor (const item of record) {\n\t\t\t\tthis.insert(item);\n\t\t\t}\n\t\t} else {\n\t\t\t// TODO remove - ignore updates in room.usernames\n\t\t\tif (this.collectionName === 'rocketchat_room' && record.usernames) {\n\t\t\t\tdelete record.usernames;\n\t\t\t}\n\t\t\tthis.emit('beforeinsert', record);\n\t\t\tthis.addToAllIndexes(record);\n\t\t\tthis.collection.insert(record);\n\t\t\tthis.emit('inserted', record);\n\t\t}\n\t}\n\n\tupdateDiffById(id, diff) {\n\t\t// TODO remove - ignore updates in room.usernames\n\t\tif (this.collectionName === 'rocketchat_room' && diff.usernames) {\n\t\t\tdelete diff.usernames;\n\t\t}\n\n\t\tconst record = this._findByIndex('_id', id);\n\t\tif (!record) {\n\t\t\tconsole.error('Cache.updateDiffById: No record', this.collectionName, id, diff);\n\t\t\treturn;\n\t\t}\n\t\tthis.removeFromAllIndexes(record);\n\n\t\tconst updatedFields = _.without(Object.keys(diff), ...this.ignoreUpdatedFields);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('beforeupdate', record, diff);\n\t\t}\n\n\t\tfor (const key in diff) {\n\t\t\tif (diff.hasOwnProperty(key)) {\n\t\t\t\tobjectPath.set(record, key, diff[key]);\n\t\t\t}\n\t\t}\n\n\t\tthis.collection.update(record);\n\t\tthis.addToAllIndexes(record);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('updated', record, diff);\n\t\t}\n\t}\n\n\tupdateRecord(record, update) {\n\t\t// TODO remove - ignore updates in room.usernames\n\t\tif (this.collectionName === 'rocketchat_room' && (record.usernames || (record.$set && record.$set.usernames))) {\n\t\t\tdelete record.usernames;\n\t\t\tif (record.$set && record.$set.usernames) {\n\t\t\t\tdelete record.$set.usernames;\n\t\t\t}\n\t\t}\n\n\t\tthis.removeFromAllIndexes(record);\n\n\t\tconst topLevelFields = Object.keys(update).map(field => field.split('.')[0]);\n\t\tconst updatedFields = _.without(topLevelFields, ...this.ignoreUpdatedFields);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('beforeupdate', record, record);\n\t\t}\n\n\t\tif (update.$set) {\n\t\t\t_.each(update.$set, (value, field) => {\n\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$unset) {\n\t\t\t_.each(update.$unset, (value, field) => {\n\t\t\t\tobjectPath.del(record, field);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$min) {\n\t\t\t_.each(update.$min, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined || value < curValue) {\n\t\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$max) {\n\t\t\t_.each(update.$max, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined || value > curValue) {\n\t\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$inc) {\n\t\t\t_.each(update.$inc, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = value;\n\t\t\t\t} else {\n\t\t\t\t\tcurValue += value;\n\t\t\t\t}\n\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$mul) {\n\t\t\t_.each(update.$mul, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = 0;\n\t\t\t\t} else {\n\t\t\t\t\tcurValue *= value;\n\t\t\t\t}\n\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$rename) {\n\t\t\t_.each(update.$rename, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue !== undefined) {\n\t\t\t\t\tobjectPath.set(record, value, curValue);\n\t\t\t\t\tobjectPath.del(record, field);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$pullAll) {\n\t\t\t_.each(update.$pullAll, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tcurValue = _.difference(curValue, value);\n\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$pop) {\n\t\t\t_.each(update.$pop, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tif (value === -1) {\n\t\t\t\t\t\tcurValue.shift();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurValue.pop();\n\t\t\t\t\t}\n\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$addToSet) {\n\t\t\t_.each(update.$addToSet, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = [];\n\t\t\t\t}\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tconst length = curValue.length;\n\n\t\t\t\t\tif (value && value.$each && Array.isArray(value.$each)) {\n\t\t\t\t\t\tfor (const valueItem of value.$each) {\n\t\t\t\t\t\t\tif (curValue.indexOf(valueItem) === -1) {\n\t\t\t\t\t\t\t\tcurValue.push(valueItem);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (curValue.indexOf(value) === -1) {\n\t\t\t\t\t\tcurValue.push(value);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (curValue.length > length) {\n\t\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.collection.update(record);\n\t\tthis.addToAllIndexes(record);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('updated', record, record);\n\t\t}\n\t}\n\n\tupdate(query, update, options = {}) {\n\t\tlet records = options.multi ? this.find(query).fetch() : this.findOne(query) || [];\n\t\tif (!Array.isArray(records)) {\n\t\t\trecords = [records];\n\t\t}\n\n\t\tfor (const record of records) {\n\t\t\tthis.updateRecord(record, update);\n\t\t}\n\t}\n\n\tremoveById(id) {\n\t\tconst record = this._findByIndex('_id', id);\n\t\tif (record) {\n\t\t\tthis.emit('beforeremove', record);\n\t\t\tthis.collection.removeWhere({_id: id});\n\t\t\tthis.removeFromAllIndexes(record);\n\t\t\tthis.emit('removed', record);\n\t\t}\n\t}\n}\n\nexport default ModelsBaseCache;\n","/* globals MongoInternals */\n\nconst baseName = 'rocketchat_';\nimport {EventEmitter} from 'events';\n\nconst trash = new Mongo.Collection(`${ baseName }_trash`);\ntry {\n\ttrash._ensureIndex({ collection: 1 });\n\ttrash._ensureIndex({ _deletedAt: 1 }, { expireAfterSeconds: 60 * 60 * 24 * 30 });\n} catch (e) {\n\tconsole.log(e);\n}\n\nconst isOplogAvailable = MongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle && !!MongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle.onOplogEntry;\nlet isOplogEnabled = isOplogAvailable;\nRocketChat.settings.get('Force_Disable_OpLog_For_Cache', (key, value) => {\n\tisOplogEnabled = isOplogAvailable && value === false;\n});\n\nclass ModelsBaseDb extends EventEmitter {\n\tconstructor(model, baseModel) {\n\t\tsuper();\n\n\t\tif (Match.test(model, String)) {\n\t\t\tthis.name = model;\n\t\t\tthis.collectionName = this.baseName + this.name;\n\t\t\tthis.model = new Mongo.Collection(this.collectionName);\n\t\t} else {\n\t\t\tthis.name = model._name;\n\t\t\tthis.collectionName = this.name;\n\t\t\tthis.model = model;\n\t\t}\n\n\t\tthis.baseModel = baseModel;\n\n\t\tthis.wrapModel();\n\n\t\t// When someone start listening for changes we start oplog if available\n\t\tthis.once('newListener', (event/*, listener*/) => {\n\t\t\tif (event === 'change') {\n\t\t\t\tif (isOplogEnabled) {\n\t\t\t\t\tconst query = {\n\t\t\t\t\t\tcollection: this.collectionName\n\t\t\t\t\t};\n\n\t\t\t\t\tMongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle.onOplogEntry(query, this.processOplogRecord.bind(this));\n\t\t\t\t\tMongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle._defineTooFarBehind(Number.MAX_SAFE_INTEGER);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.tryEnsureIndex({ '_updatedAt': 1 });\n\t}\n\n\tget baseName() {\n\t\treturn baseName;\n\t}\n\n\tsetUpdatedAt(record = {}) {\n\n\t\t// TODO: Check if this can be deleted, Rodrigo does not rememebr WHY he added it. So he removed it to fix issue #5541\n\t\t// setUpdatedAt(record = {}, checkQuery = false, query) {\n\t\t// if (checkQuery === true) {\n\t\t// \tif (!query || Object.keys(query).length === 0) {\n\t\t// \t\tthrow new Meteor.Error('Models._Base: Empty query');\n\t\t// \t}\n\t\t// }\n\n\t\tif (/(^|,)\\$/.test(Object.keys(record).join(','))) {\n\t\t\trecord.$set = record.$set || {};\n\t\t\trecord.$set._updatedAt = new Date;\n\t\t} else {\n\t\t\trecord._updatedAt = new Date;\n\t\t}\n\n\t\treturn record;\n\t}\n\n\twrapModel() {\n\t\tthis.originals = {\n\t\t\tinsert: this.model.insert.bind(this.model),\n\t\t\tupdate: this.model.update.bind(this.model),\n\t\t\tremove: this.model.remove.bind(this.model)\n\t\t};\n\t\tconst self = this;\n\n\t\tthis.model.insert = function() {\n\t\t\treturn self.insert(...arguments);\n\t\t};\n\n\t\tthis.model.update = function() {\n\t\t\treturn self.update(...arguments);\n\t\t};\n\n\t\tthis.model.remove = function() {\n\t\t\treturn self.remove(...arguments);\n\t\t};\n\t}\n\n\tfind() {\n\t\treturn this.model.find(...arguments);\n\t}\n\n\tfindOne() {\n\t\treturn this.model.findOne(...arguments);\n\t}\n\n\tfindOneById(_id, options) {\n\t\treturn this.model.findOne({ _id }, options);\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\treturn this.model.findOne({ _id: { $in: ids }}, options);\n\t}\n\n\tdefineSyncStrategy(query, modifier, options) {\n\t\tif (this.baseModel.useCache === false) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\tif (options.upsert === true) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\t// const dbModifiers = [\n\t\t// \t'$currentDate',\n\t\t// \t'$bit',\n\t\t// \t'$pull',\n\t\t// \t'$pushAll',\n\t\t// \t'$push',\n\t\t// \t'$setOnInsert'\n\t\t// ];\n\n\t\tconst cacheAllowedModifiers = [\n\t\t\t'$set',\n\t\t\t'$unset',\n\t\t\t'$min',\n\t\t\t'$max',\n\t\t\t'$inc',\n\t\t\t'$mul',\n\t\t\t'$rename',\n\t\t\t'$pullAll',\n\t\t\t'$pop',\n\t\t\t'$addToSet'\n\t\t];\n\n\t\tconst notAllowedModifiers = Object.keys(modifier).filter(i => i.startsWith('$') && cacheAllowedModifiers.includes(i) === false);\n\n\t\tif (notAllowedModifiers.length > 0) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\tconst placeholderFields = Object.keys(query).filter(item => item.indexOf('$') > -1);\n\t\tif (placeholderFields.length > 0) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\treturn 'cache';\n\t}\n\n\tupdateHasPositionalOperator(update) {\n\t\tfor (const key in update) {\n\t\t\tif (key.includes('.$')) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst value = update[key];\n\n\t\t\tif (Match.test(value, Object)) {\n\t\t\t\tif (this.updateHasPositionalOperator(value) === true) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprocessOplogRecord(action) {\n\t\tif (isOplogEnabled === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'i') {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'insert',\n\t\t\t\tid: action.op.o._id,\n\t\t\t\tdata: action.op.o,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'u') {\n\t\t\tif (!action.op.o.$set && !action.op.o.$unset) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'update:record',\n\t\t\t\t\tid: action.id,\n\t\t\t\t\tdata: action.op.o,\n\t\t\t\t\toplog: true\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst diff = {};\n\t\t\tif (action.op.o.$set) {\n\t\t\t\tfor (const key in action.op.o.$set) {\n\t\t\t\t\tif (action.op.o.$set.hasOwnProperty(key)) {\n\t\t\t\t\t\tdiff[key] = action.op.o.$set[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (action.op.o.$unset) {\n\t\t\t\tfor (const key in action.op.o.$unset) {\n\t\t\t\t\tif (action.op.o.$unset.hasOwnProperty(key)) {\n\t\t\t\t\t\tdiff[key] = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'update:diff',\n\t\t\t\tid: action.id,\n\t\t\t\tdata: diff,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'd') {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'remove',\n\t\t\t\tid: action.id,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t}\n\n\tinsert(record) {\n\t\tthis.setUpdatedAt(record);\n\n\t\tconst result = this.originals.insert(...arguments);\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'insert',\n\t\t\t\tid: result,\n\t\t\t\tdata: _.extend({}, record),\n\t\t\t\toplog: false\n\t\t\t});\n\t\t}\n\n\t\trecord._id = result;\n\n\t\treturn result;\n\t}\n\n\tupdate(query, update, options = {}) {\n\t\tthis.setUpdatedAt(update, true, query);\n\n\t\tconst strategy = this.defineSyncStrategy(query, update, options);\n\t\tlet ids = [];\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0 && strategy === 'db') {\n\t\t\tconst findOptions = {fields: {_id: 1}};\n\t\t\tlet records = options.multi ? this.find(query, findOptions).fetch() : this.findOne(query, findOptions) || [];\n\t\t\tif (!Array.isArray(records)) {\n\t\t\t\trecords = [records];\n\t\t\t}\n\n\t\t\tids = records.map(item => item._id);\n\t\t\tif (options.upsert !== true && this.updateHasPositionalOperator(update) === false) {\n\t\t\t\tquery = {\n\t\t\t\t\t_id: {\n\t\t\t\t\t\t$in: ids\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst result = this.originals.update(query, update, options);\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tif (strategy === 'db') {\n\t\t\t\tif (options.upsert === true) {\n\t\t\t\t\tif (result.insertedId) {\n\t\t\t\t\t\tthis.emit('change', {\n\t\t\t\t\t\t\taction: 'insert',\n\t\t\t\t\t\t\tid: result.insertedId,\n\t\t\t\t\t\t\tdata: this.findOne({_id: result.insertedId}),\n\t\t\t\t\t\t\toplog: false\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tquery = {\n\t\t\t\t\t\t_id: {\n\t\t\t\t\t\t\t$in: ids\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tlet records = options.multi ? this.find(query).fetch() : this.findOne(query) || [];\n\t\t\t\tif (!Array.isArray(records)) {\n\t\t\t\t\trecords = [records];\n\t\t\t\t}\n\t\t\t\tfor (const record of records) {\n\t\t\t\t\tthis.emit('change', {\n\t\t\t\t\t\taction: 'update:record',\n\t\t\t\t\t\tid: record._id,\n\t\t\t\t\t\tdata: record,\n\t\t\t\t\t\toplog: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'update:query',\n\t\t\t\t\tid: undefined,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tquery,\n\t\t\t\t\t\tupdate,\n\t\t\t\t\t\toptions\n\t\t\t\t\t},\n\t\t\t\t\toplog: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tupsert(query, update, options = {}) {\n\t\toptions.upsert = true;\n\t\toptions._returnObject = true;\n\t\treturn this.update(query, update, options);\n\t}\n\n\tremove(query) {\n\t\tconst records = this.model.find(query).fetch();\n\n\t\tconst ids = [];\n\t\tfor (const record of records) {\n\t\t\tids.push(record._id);\n\n\t\t\trecord._deletedAt = new Date;\n\t\t\trecord.__collection__ = this.name;\n\n\t\t\ttrash.upsert({_id: record._id}, _.omit(record, '_id'));\n\t\t}\n\n\t\tquery = { _id: { $in: ids } };\n\n\t\tconst result = this.originals.remove(query);\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tfor (const record of records) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'remove',\n\t\t\t\t\tid: record._id,\n\t\t\t\t\tdata: _.extend({}, record),\n\t\t\t\t\toplog: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tinsertOrUpsert(...args) {\n\t\tif (args[0] && args[0]._id) {\n\t\t\tconst _id = args[0]._id;\n\t\t\tdelete args[0]._id;\n\t\t\targs.unshift({\n\t\t\t\t_id\n\t\t\t});\n\n\t\t\tthis.upsert(...args);\n\t\t\treturn _id;\n\t\t} else {\n\t\t\treturn this.insert(...args);\n\t\t}\n\t}\n\n\tallow() {\n\t\treturn this.model.allow(...arguments);\n\t}\n\n\tdeny() {\n\t\treturn this.model.deny(...arguments);\n\t}\n\n\tensureIndex() {\n\t\treturn this.model._ensureIndex(...arguments);\n\t}\n\n\tdropIndex() {\n\t\treturn this.model._dropIndex(...arguments);\n\t}\n\n\ttryEnsureIndex() {\n\t\ttry {\n\t\t\treturn this.ensureIndex(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Error creating index:', this.name, '->', ...arguments, e);\n\t\t}\n\t}\n\n\ttryDropIndex() {\n\t\ttry {\n\t\t\treturn this.dropIndex(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Error dropping index:', this.name, '->', ...arguments, e);\n\t\t}\n\t}\n\n\ttrashFind(query, options) {\n\t\tquery.__collection__ = this.name;\n\n\t\treturn trash.find(query, options);\n\t}\n\n\ttrashFindDeletedAfter(deletedAt, query = {}, options) {\n\t\tquery.__collection__ = this.name;\n\t\tquery._deletedAt = {\n\t\t\t$gt: deletedAt\n\t\t};\n\n\t\treturn trash.find(query, options);\n\t}\n}\n\nexport default ModelsBaseDb;\n","const AccessTokenServices = {};\n\nRocketChat.registerAccessTokenService = function(serviceName, handleAccessTokenRequest) {\n\tAccessTokenServices[serviceName] = {\n\t\tserviceName,\n\t\thandleAccessTokenRequest\n\t};\n};\n\n// Listen to calls to `login` with an oauth option set. This is where\n// users actually get logged in to meteor via oauth.\nAccounts.registerLoginHandler(function(options) {\n\tif (!options.accessToken) {\n\t\treturn undefined; // don't handle\n\t}\n\n\tcheck(options, Match.ObjectIncluding({\n\t\tserviceName: String\n\t}));\n\n\tconst service = AccessTokenServices[options.serviceName];\n\n\t// Skip everything if there's no service set by the oauth middleware\n\tif (!service) {\n\t\tthrow new Error(`Unexpected AccessToken service ${ options.serviceName }`);\n\t}\n\n\t// Make sure we're configured\n\tif (!ServiceConfiguration.configurations.findOne({service: service.serviceName})) {\n\t\tthrow new ServiceConfiguration.ConfigError();\n\t}\n\n\tif (!_.contains(Accounts.oauth.serviceNames(), service.serviceName)) {\n\t\t// serviceName was not found in the registered services list.\n\t\t// This could happen because the service never registered itself or\n\t\t// unregisterService was called on it.\n\t\treturn {\n\t\t\ttype: 'oauth',\n\t\t\terror: new Meteor.Error(\n\t\t\t\tAccounts.LoginCancelledError.numericError,\n\t\t\t\t`No registered oauth service found for: ${ service.serviceName }`\n\t\t\t)\n\t\t};\n\t}\n\n\tconst oauthResult = service.handleAccessTokenRequest(options);\n\n\treturn Accounts.updateOrCreateUserFromExternalService(service.serviceName, oauthResult.serviceData, oauthResult.options);\n});\n\n\n\n","/* globals Google */\n\nfunction getIdentity(accessToken) {\n\ttry {\n\t\treturn HTTP.get(\n\t\t\t'https://www.googleapis.com/oauth2/v1/userinfo',\n\t\t\t{params: {access_token: accessToken}}).data;\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch identity from Google. ${ err.message }`), {response: err.response});\n\t}\n}\n\nfunction getScopes(accessToken) {\n\ttry {\n\t\treturn HTTP.get(\n\t\t\t'https://www.googleapis.com/oauth2/v1/tokeninfo',\n\t\t\t{params: {access_token: accessToken}}).data.scope.split(' ');\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch tokeninfo from Google. ${ err.message }`), {response: err.response});\n\t}\n}\n\n\nRocketChat.registerAccessTokenService('google', function(options) {\n\tcheck(options, Match.ObjectIncluding({\n\t\taccessToken: String,\n\t\tidToken: String,\n\t\texpiresIn: Match.Integer,\n\t\tscope: Match.Maybe(String),\n\t\tidentity: Match.Maybe(Object)\n\t}));\n\n\tconst identity = options.identity || getIdentity(options.accessToken);\n\n\tconst serviceData = {\n\t\taccessToken: options.accessToken,\n\t\tidToken: options.idToken,\n\t\texpiresAt: (+new Date) + (1000 * parseInt(options.expiresIn, 10)),\n\t\tscope: options.scopes || getScopes(options.accessToken)\n\t};\n\n\tconst fields = _.pick(identity, Google.whitelistedFields);\n\t_.extend(serviceData, fields);\n\n\t// only set the token in serviceData if it's there. this ensures\n\t// that we don't lose old ones (since we only get this on the first\n\t// log in attempt)\n\tif (options.refreshToken) {\n\t\tserviceData.refreshToken = options.refreshToken;\n\t}\n\n\treturn {\n\t\tserviceData,\n\t\toptions: {\n\t\t\tprofile: {\n\t\t\t\tname: identity.name\n\t\t\t}\n\t\t}\n\t};\n});\n","/* globals OAuth */\n\nOAuth._redirectUri = _.wrap(OAuth._redirectUri, function(func, serviceName, ...args) {\n\tconst proxy = RocketChat.settings.get('Accounts_OAuth_Proxy_services').replace(/\\s/g, '').split(',');\n\tif (proxy.includes(serviceName)) {\n\t\treturn `${ RocketChat.settings.get('Accounts_OAuth_Proxy_host') }/oauth_redirect`;\n\t} else {\n\t\treturn func(serviceName, ...args);\n\t}\n\n});\n","RocketChat.statsTracker = new (class StatsTracker {\n\tconstructor() {\n\t\tthis.StatsD = Npm.require('node-dogstatsd').StatsD;\n\t\tthis.dogstatsd = new this.StatsD();\n\t}\n\n\ttrack(type, stats, ...args) {\n\t\tthis.dogstatsd[type](`RocketChat.${ stats }`, ...args);\n\t}\n\n\tnow() {\n\t\tconst hrtime = process.hrtime();\n\t\treturn (hrtime[0] * 1000000 + hrtime[1] / 1000);\n\t}\n\n\ttiming(stats, time, tags) {\n\t\tthis.track('timing', stats, time, tags);\n\t}\n\n\tincrement(stats, time, tags) {\n\t\tthis.track('increment', stats, time, tags);\n\t}\n\n\tdecrement(stats, time, tags) {\n\t\tthis.track('decrement', stats, time, tags);\n\t}\n\n\thistogram(stats, time, tags) {\n\t\tthis.track('histogram', stats, time, tags);\n\t}\n\n\tgauge(stats, time, tags) {\n\t\tthis.track('gauge', stats, time, tags);\n\t}\n\n\tunique(stats, time, tags) {\n\t\tthis.track('unique', stats, time, tags);\n\t}\n\n\tset(stats, time, tags) {\n\t\tthis.track('set', stats, time, tags);\n\t}\n});\n","RocketChat.models.Rooms.cache.hasMany('Subscriptions', {\n\tfield: 'usernames',\n\tlink: {\n\t\tlocal: '_id',\n\t\tremote: 'rid',\n\t\ttransform(room, subscription) {\n\t\t\treturn subscription.u.username;\n\t\t},\n\t\tremove(arr, subscription) {\n\t\t\tif (arr.indexOf(subscription.u.username) > -1) {\n\t\t\t\tarr.splice(arr.indexOf(subscription.u.username), 1);\n\t\t\t}\n\t\t}\n\t}\n});\n\n\nRocketChat.models.Subscriptions.cache.hasOne('Rooms', {\n\tfield: '_room',\n\tlink: {\n\t\tlocal: 'rid',\n\t\tremote: '_id'\n\t}\n});\n\n\nRocketChat.models.Subscriptions.cache.hasOne('Users', {\n\tfield: '_user',\n\tlink: {\n\t\tlocal: 'u._id',\n\t\tremote: '_id'\n\t}\n});\n\nRocketChat.models.Subscriptions.cache.hasOne('Users', {\n\tfield: 'fname',\n\tlink: {\n\t\tlocal: 'name',\n\t\tremote: 'username',\n\t\twhere(subscription/*, user*/) {\n\t\t\treturn subscription.t === 'd';\n\t\t},\n\t\ttransform(subscription, user) {\n\t\t\tif (user == null || subscription == null) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\t// Prevent client cache for old subscriptions with new names\n\t\t\t// Cuz when a user change his name, the subscription's _updateAt\n\t\t\t// will not change\n\t\t\tif (subscription._updatedAt < user._updatedAt) {\n\t\t\t\tsubscription._updatedAt = user._updatedAt;\n\t\t\t}\n\t\t\treturn user.name;\n\t\t}\n\t}\n});\n\nRocketChat.models.Users.cache.load();\nRocketChat.models.Rooms.cache.load();\nRocketChat.models.Subscriptions.cache.load();\nRocketChat.models.Settings.cache.load();\n\n\nRocketChat.models.Users.cache.addDynamicView('highlights').applyFind({\n\t'settings.preferences.highlights': {$size: {$gt: 0}}\n});\n\nRocketChat.models.Subscriptions.cache.addDynamicView('notifications').applyFind({\n\t$or: [\n\t\t{desktopNotifications: {$in: ['all', 'nothing']}},\n\t\t{mobilePushNotifications: {$in: ['all', 'nothing']}}\n\t]\n});\n","/* globals WebAppInternals*/\nfunction testWebAppInternals(fn) {\n\ttypeof WebAppInternals !== 'undefined' && fn(WebAppInternals);\n}\nRocketChat.settings.onload('CDN_PREFIX', function(key, value) {\n\tif (_.isString(value) && value.trim()) {\n\t\treturn testWebAppInternals(WebAppInternals => WebAppInternals.setBundledJsCssPrefix(value));\n\t}\n});\n\nMeteor.startup(function() {\n\tconst value = RocketChat.settings.get('CDN_PREFIX');\n\tif (_.isString(value) && value.trim()) {\n\t\treturn testWebAppInternals(WebAppInternals => WebAppInternals.setBundledJsCssPrefix(value));\n\t}\n});\n","const buildMailURL = _.debounce(function() {\n\tconsole.log('Updating process.env.MAIL_URL');\n\n\tif (RocketChat.settings.get('SMTP_Host')) {\n\t\tprocess.env.MAIL_URL = `${ RocketChat.settings.get('SMTP_Protocol') }://`;\n\n\t\tif (RocketChat.settings.get('SMTP_Username') && RocketChat.settings.get('SMTP_Password')) {\n\t\t\tprocess.env.MAIL_URL += `${ encodeURIComponent(RocketChat.settings.get('SMTP_Username')) }:${ encodeURIComponent(RocketChat.settings.get('SMTP_Password')) }@`;\n\t\t}\n\n\t\tprocess.env.MAIL_URL += encodeURIComponent(RocketChat.settings.get('SMTP_Host'));\n\n\t\tif (RocketChat.settings.get('SMTP_Port')) {\n\t\t\tprocess.env.MAIL_URL += `:${ parseInt(RocketChat.settings.get('SMTP_Port')) }`;\n\t\t}\n\n\t\tprocess.env.MAIL_URL += `?pool=${ RocketChat.settings.get('SMTP_Pool') }`;\n\n\t\treturn process.env.MAIL_URL;\n\t}\n}, 500);\n\nRocketChat.settings.onload('SMTP_Host', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Port', function() {\n\treturn buildMailURL();\n});\n\nRocketChat.settings.onload('SMTP_Username', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Password', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Protocol', function() {\n\treturn buildMailURL();\n});\n\nRocketChat.settings.onload('SMTP_Pool', function() {\n\treturn buildMailURL();\n});\n\nMeteor.startup(function() {\n\treturn buildMailURL();\n});\n","/* globals CustomOAuth */\nconst logger = new Logger('rocketchat:lib', {\n\tmethods: {\n\t\toauth_updated: {\n\t\t\ttype: 'info'\n\t\t}\n\t}\n});\n\nfunction _OAuthServicesUpdate() {\n\tconst services = RocketChat.settings.get(/^(Accounts_OAuth_|Accounts_OAuth_Custom-)[a-z0-9_]+$/i);\n\tservices.forEach((service) => {\n\t\tlogger.oauth_updated(service.key);\n\t\tlet serviceName = service.key.replace('Accounts_OAuth_', '');\n\t\tif (serviceName === 'Meteor') {\n\t\t\tserviceName = 'meteor-developer';\n\t\t}\n\t\tif (/Accounts_OAuth_Custom-/.test(service.key)) {\n\t\t\tserviceName = service.key.replace('Accounts_OAuth_Custom-', '');\n\t\t}\n\t\tif (service.value === true) {\n\t\t\tconst data = {\n\t\t\t\tclientId: RocketChat.settings.get(`${ service.key }_id`),\n\t\t\t\tsecret: RocketChat.settings.get(`${ service.key }_secret`)\n\t\t\t};\n\t\t\tif (/Accounts_OAuth_Custom-/.test(service.key)) {\n\t\t\t\tdata.custom = true;\n\t\t\t\tdata.clientId = RocketChat.settings.get(`${ service.key }-id`);\n\t\t\t\tdata.secret = RocketChat.settings.get(`${ service.key }-secret`);\n\t\t\t\tdata.serverURL = RocketChat.settings.get(`${ service.key }-url`);\n\t\t\t\tdata.tokenPath = RocketChat.settings.get(`${ service.key }-token_path`);\n\t\t\t\tdata.identityPath = RocketChat.settings.get(`${ service.key }-identity_path`);\n\t\t\t\tdata.authorizePath = RocketChat.settings.get(`${ service.key }-authorize_path`);\n\t\t\t\tdata.scope = RocketChat.settings.get(`${ service.key }-scope`);\n\t\t\t\tdata.buttonLabelText = RocketChat.settings.get(`${ service.key }-button_label_text`);\n\t\t\t\tdata.buttonLabelColor = RocketChat.settings.get(`${ service.key }-button_label_color`);\n\t\t\t\tdata.loginStyle = RocketChat.settings.get(`${ service.key }-login_style`);\n\t\t\t\tdata.buttonColor = RocketChat.settings.get(`${ service.key }-button_color`);\n\t\t\t\tdata.tokenSentVia = RocketChat.settings.get(`${ service.key }-token_sent_via`);\n\t\t\t\tdata.usernameField = RocketChat.settings.get(`${ service.key }-username_field`);\n\t\t\t\tdata.mergeUsers = RocketChat.settings.get(`${ service.key }-merge_users`);\n\t\t\t\tnew CustomOAuth(serviceName.toLowerCase(), {\n\t\t\t\t\tserverURL: data.serverURL,\n\t\t\t\t\ttokenPath: data.tokenPath,\n\t\t\t\t\tidentityPath: data.identityPath,\n\t\t\t\t\tauthorizePath: data.authorizePath,\n\t\t\t\t\tscope: data.scope,\n\t\t\t\t\tloginStyle: data.loginStyle,\n\t\t\t\t\ttokenSentVia: data.tokenSentVia,\n\t\t\t\t\tusernameField: data.usernameField,\n\t\t\t\t\tmergeUsers: data.mergeUsers\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (serviceName === 'Facebook') {\n\t\t\t\tdata.appId = data.clientId;\n\t\t\t\tdelete data.clientId;\n\t\t\t}\n\t\t\tif (serviceName === 'Twitter') {\n\t\t\t\tdata.consumerKey = data.clientId;\n\t\t\t\tdelete data.clientId;\n\t\t\t}\n\t\t\tServiceConfiguration.configurations.upsert({\n\t\t\t\tservice: serviceName.toLowerCase()\n\t\t\t}, {\n\t\t\t\t$set: data\n\t\t\t});\n\t\t} else {\n\t\t\tServiceConfiguration.configurations.remove({\n\t\t\t\tservice: serviceName.toLowerCase()\n\t\t\t});\n\t\t}\n\t});\n}\n\nconst OAuthServicesUpdate = _.debounce(Meteor.bindEnvironment(_OAuthServicesUpdate), 2000);\n\nfunction OAuthServicesRemove(_id) {\n\tconst serviceName = _id.replace('Accounts_OAuth_Custom-', '');\n\treturn ServiceConfiguration.configurations.remove({\n\t\tservice: serviceName.toLowerCase()\n\t});\n}\n\nRocketChat.settings.get(/^Accounts_OAuth_.+/, function() {\n\treturn OAuthServicesUpdate(); // eslint-disable-line new-cap\n});\n\nRocketChat.settings.get(/^Accounts_OAuth_Custom-[a-z0-9_]+/, function(key, value) {\n\tif (!value) {\n\t\treturn OAuthServicesRemove(key);// eslint-disable-line new-cap\n\t}\n});\n","// Insert server unique id if it doesn't exist\nRocketChat.settings.add('uniqueID', process.env.DEPLOYMENT_ID || Random.id(), {\n\t'public': true,\n\thidden: true\n});\n\n// When you define a setting and want to add a description, you don't need to automatically define the i18nDescription\n// if you add a node to the i18n.json with the same setting name but with `_Description` it will automatically work.\n\nRocketChat.settings.addGroup('Accounts', function() {\n\tthis.add('Accounts_AllowAnonymousRead', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true\n\t});\n\tthis.add('Accounts_AllowAnonymousWrite', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\tenableQuery: {\n\t\t\t_id: 'Accounts_AllowAnonymousRead',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.add('Accounts_AllowDeleteOwnAccount', false, {\n\t\ttype: 'boolean',\n\t\t'public': true,\n\t\tenableQuery: {\n\t\t\t_id: 'Accounts_AllowUserProfileChange',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.add('Accounts_AllowUserProfileChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowUserAvatarChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowUsernameChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowEmailChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowPasswordChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_LoginExpiration', 90, {\n\t\ttype: 'int',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_ShowFormLogin', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_EmailOrUsernamePlaceholder', '', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nLabel: 'Placeholder_for_email_or_username_login_field'\n\t});\n\tthis.add('Accounts_PasswordPlaceholder', '', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nLabel: 'Placeholder_for_password_login_field'\n\t});\n\tthis.add('Accounts_ForgetUserSessionOnWindowClose', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\n\tthis.section('Registration', function() {\n\t\tthis.add('Accounts_DefaultUsernamePrefixSuggestion', 'user', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Accounts_RequireNameForSignUp', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_RequirePasswordConfirmation', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_EmailVerification', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'SMTP_Host',\n\t\t\t\tvalue: {\n\t\t\t\t\t$exists: 1,\n\t\t\t\t\t$ne: ''\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.add('Accounts_ManuallyApproveNewUsers', false, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t\tthis.add('Accounts_AllowedDomainsList', '', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_BlockedDomainsList', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Accounts_BlockedUsernameList', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Accounts_UseDefaultBlockedDomainsList', true, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t\tthis.add('Accounts_UseDNSDomainCheck', false, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm', 'Public', {\n\t\t\ttype: 'select',\n\t\t\t'public': true,\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'Public',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Public'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'Disabled',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Disabled'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'Secret URL',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Secret_URL'\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm_SecretURL', Random.id(), {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm_LinkReplacementText', 'New user registration is currently disabled', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_Registration_AuthenticationServices_Enabled', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_Registration_AuthenticationServices_Default_Roles', 'user', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_Registration_AuthenticationServices_Enabled',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t});\n\t\tthis.add('Accounts_PasswordReset', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_CustomFields', '', {\n\t\t\ttype: 'code',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Custom_Fields'\n\t\t});\n\t});\n\n\tthis.section('Avatar', function() {\n\t\tthis.add('Accounts_AvatarResize', true, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t\tthis.add('Accounts_AvatarSize', 200, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_AvatarResize',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t});\n\t\tthis.add('Accounts_AvatarStoreType', 'GridFS', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'GridFS',\n\t\t\t\t\ti18nLabel: 'GridFS'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'FileSystem',\n\t\t\t\t\ti18nLabel: 'FileSystem'\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t\tthis.add('Accounts_AvatarStorePath', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_AvatarStoreType',\n\t\t\t\tvalue: 'FileSystem'\n\t\t\t}\n\t\t});\n\t\treturn this.add('Accounts_SetDefaultAvatar', true, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('OAuth', function() {\n\tthis.section('Facebook', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Facebook',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Facebook', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Facebook_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Facebook_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Facebook_callback_url', '_oauth/facebook', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('Google', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Google',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Google', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Google_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Google_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Google_callback_url', '_oauth/google', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('GitHub', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Github',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Github', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Github_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Github_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Github_callback_url', '_oauth/github', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('Linkedin', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Linkedin',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Linkedin', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Linkedin_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Linkedin_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Linkedin_callback_url', '_oauth/linkedin', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('Meteor', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Meteor',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Meteor', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Meteor_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Meteor_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Meteor_callback_url', '_oauth/meteor', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('Twitter', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Twitter',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Twitter', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Twitter_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Twitter_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Twitter_callback_url', '_oauth/twitter', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\treturn this.section('Proxy', function() {\n\t\tthis.add('Accounts_OAuth_Proxy_host', 'https://oauth-proxy.rocket.chat', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Proxy_services', '', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('General', function() {\n\tthis.add('Site_Url', typeof __meteor_runtime_config__ !== 'undefined' && __meteor_runtime_config__ !== null ? __meteor_runtime_config__.ROOT_URL : null, {\n\t\ttype: 'string',\n\t\ti18nDescription: 'Site_Url_Description',\n\t\t'public': true\n\t});\n\tthis.add('Site_Name', 'Rocket.Chat', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Language', '', {\n\t\ttype: 'language',\n\t\t'public': true\n\t});\n\tthis.add('Allow_Invalid_SelfSigned_Certs', false, {\n\t\ttype: 'boolean'\n\t});\n\tthis.add('Favorite_Rooms', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('CDN_PREFIX', '', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Force_SSL', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('GoogleTagManager_id', '', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Bugsnag_api_key', '', {\n\t\ttype: 'string',\n\t\t'public': false\n\t});\n\tthis.add('Force_Disable_OpLog_For_Cache', false, {\n\t\ttype: 'boolean',\n\t\t'public': false\n\t});\n\tthis.add('Restart', 'restart_server', {\n\t\ttype: 'action',\n\t\tactionText: 'Restart_the_server'\n\t});\n\tthis.section('UTF8', function() {\n\t\tthis.add('UTF8_Names_Validation', '[0-9a-zA-Z-_.]+', {\n\t\t\ttype: 'string',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'UTF8_Names_Validation_Description'\n\t\t});\n\t\treturn this.add('UTF8_Names_Slugify', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t});\n\tthis.section('Reporting', function() {\n\t\treturn this.add('Statistics_reporting', true, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t});\n\tthis.section('Notifications', function() {\n\t\treturn this.add('Desktop_Notifications_Duration', 0, {\n\t\t\ttype: 'int',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'Desktop_Notification_Durations_Description'\n\t\t});\n\t});\n\tthis.section('REST API', function() {\n\t\treturn this.add('API_User_Limit', 500, {\n\t\t\ttype: 'int',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'API_User_Limit'\n\t\t});\n\t});\n\tthis.section('Iframe_Integration', function() {\n\t\tthis.add('Iframe_Integration_send_enable', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Iframe_Integration_send_target_origin', '*', {\n\t\t\ttype: 'string',\n\t\t\t'public': true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Iframe_Integration_send_enable',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t});\n\t\tthis.add('Iframe_Integration_receive_enable', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Iframe_Integration_receive_origin', '*', {\n\t\t\ttype: 'string',\n\t\t\t'public': true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Iframe_Integration_receive_enable',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t});\n\t});\n\tthis.section('Translations', function() {\n\t\treturn this.add('Custom_Translations', '', {\n\t\t\ttype: 'code',\n\t\t\t'public': true\n\t\t});\n\t});\n\treturn this.section('Stream_Cast', function() {\n\t\treturn this.add('Stream_Cast_Address', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Email', function() {\n\tthis.section('Header_and_Footer', function() {\n\t\tthis.add('Email_Header', '<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" bgcolor=\"#f3f3f3\" style=\"color:#4a4a4a;font-family: Helvetica,Arial,sans-serif;font-size:14px;line-height:20px;border-collapse:callapse;border-spacing:0;margin:0 auto\"><tr><td style=\"padding:1em\"><table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" width=\"100%\" style=\"width:100%;margin:0 auto;max-width:800px\"><tr><td bgcolor=\"#ffffff\" style=\"background-color:#ffffff; border: 1px solid #DDD; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;\"><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td style=\"background-color: #04436a;\"><h1 style=\"font-family: Helvetica,Arial,sans-serif; padding: 0 1em; margin: 0; line-height: 70px; color: #FFF;\">[Site_Name]</h1></td></tr><tr><td style=\"padding: 1em; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;\">', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Header'\n\t\t});\n\t\treturn this.add('Email_Footer', '</td></tr></table></td></tr><tr><td border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"font-family: Helvetica,Arial,sans-serif; max-width: 800px; margin: 0 auto; padding: 1.5em; text-align: center; font-size: 8pt; color: #999;\">Powered by <a href=\"https://rocket.chat\" target=\"_blank\">Rocket.Chat</a></td></tr></table></td></tr></table>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Footer'\n\t\t});\n\t});\n\tthis.section('SMTP', function() {\n\t\tthis.add('SMTP_Protocol', 'smtp', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'smtp',\n\t\t\t\t\ti18nLabel: 'smtp'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'smtps',\n\t\t\t\t\ti18nLabel: 'smtps'\n\t\t\t\t}\n\t\t\t],\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Protocol'\n\t\t});\n\t\tthis.add('SMTP_Host', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Host'\n\t\t});\n\t\tthis.add('SMTP_Port', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Port'\n\t\t});\n\t\tthis.add('SMTP_Pool', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Pool'\n\t\t});\n\t\tthis.add('SMTP_Username', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Username'\n\t\t});\n\t\tthis.add('SMTP_Password', '', {\n\t\t\ttype: 'password',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Password'\n\t\t});\n\t\tthis.add('From_Email', '', {\n\t\t\ttype: 'string',\n\t\t\tplaceholder: 'email@domain'\n\t\t});\n\t\treturn this.add('SMTP_Test_Button', 'sendSMTPTestEmail', {\n\t\t\ttype: 'action',\n\t\t\tactionText: 'Send_a_test_mail_to_my_user'\n\t\t});\n\t});\n\tthis.section('Invitation', function() {\n\t\tthis.add('Invitation_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Invitation_Subject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Invitation_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Invitation_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Invitation_HTML', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Invitation_HTML_Description',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Invitation_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Invitation_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n\tthis.section('Registration', function() {\n\t\tthis.add('Accounts_Enrollment_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Accounts_Enrollment_Email_Subject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_Enrollment_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Accounts_Enrollment_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Accounts_Enrollment_Email', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_Enrollment_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Accounts_Enrollment_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n\tthis.section('Registration_via_Admin', function() {\n\t\tthis.add('Accounts_UserAddedEmail_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Accounts_UserAddedEmailSubject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_UserAddedEmail_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Accounts_UserAddedEmail_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Accounts_UserAddedEmail', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Accounts_UserAddedEmail_Description',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_UserAddedEmail_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Accounts_UserAddedEmail_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n\tthis.section('Forgot_password_section', function() {\n\t\tthis.add('Forgot_Password_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Forgot_Password_Email_Subject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Forgot_Password_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Forgot_Password_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Forgot_Password_Email', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Forgot_Password_Description',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Forgot_Password_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Forgot_Password_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n\treturn this.section('Verification', function() {\n\t\tthis.add('Verification_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Verification_Email_Subject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Verification_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Verification_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Verification_Email', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Verification_Description',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Verification_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Verification_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Message', function() {\n\tthis.section('Message_Attachments', function() {\n\t\tthis.add('Message_Attachments_GroupAttach', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'Message_Attachments_GroupAttachDescription'\n\t\t});\n\t\tthis.add('Message_AudioRecorderEnabled', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'Message_AudioRecorderEnabledDescription'\n\t\t});\n\t});\n\tthis.add('Message_AllowEditing', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AllowEditing_BlockEditInMinutes', 0, {\n\t\ttype: 'int',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_AllowEditing_BlockEditInMinutesDescription'\n\t});\n\tthis.add('Message_AllowDeleting', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AllowDeleting_BlockDeleteInMinutes', 0, {\n\t\ttype: 'int',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_AllowDeleting_BlockDeleteInMinutes'\n\t});\n\tthis.add('Message_AllowUnrecognizedSlashCommand', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AlwaysSearchRegExp', false, {\n\t\ttype: 'boolean'\n\t});\n\tthis.add('Message_ShowEditedStatus', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_ShowDeletedStatus', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AllowBadWordsFilter', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_BadWordsFilterList', '', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Message_KeepHistory', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_MaxAll', 0, {\n\t\ttype: 'int',\n\t\t'public': true\n\t});\n\tthis.add('Message_MaxAllowedSize', 5000, {\n\t\ttype: 'int',\n\t\t'public': true\n\t});\n\tthis.add('Message_ShowFormattingTips', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_SetNameToAliasEnabled', false, {\n\t\ttype: 'boolean',\n\t\t'public': false,\n\t\ti18nDescription: 'Message_SetNameToAliasEnabled_Description'\n\t});\n\tthis.add('Message_GroupingPeriod', 300, {\n\t\ttype: 'int',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_GroupingPeriodDescription'\n\t});\n\tthis.add('API_Embed', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('API_EmbedCacheExpirationDays', 30, {\n\t\ttype: 'int',\n\t\t'public': false\n\t});\n\tthis.add('API_Embed_clear_cache_now', 'OEmbedCacheCleanup', {\n\t\ttype: 'action',\n\t\tactionText: 'clear',\n\t\ti18nLabel: 'clear_cache_now'\n\t});\n\tthis.add('API_EmbedDisabledFor', '', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nDescription: 'API_EmbedDisabledFor_Description'\n\t});\n\tthis.add('API_EmbedIgnoredHosts', 'localhost, 127.0.0.1, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16', {\n\t\ttype: 'string',\n\t\ti18nDescription: 'API_EmbedIgnoredHosts_Description'\n\t});\n\tthis.add('API_EmbedSafePorts', '80, 443', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Message_TimeFormat', 'LT', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_TimeFormat_Description'\n\t});\n\tthis.add('Message_DateFormat', 'LL', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_DateFormat_Description'\n\t});\n\tthis.add('Message_TimeAndDateFormat', 'LLL', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_TimeAndDateFormat_Description'\n\t});\n\tthis.add('Message_HideType_uj', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_HideType_ul', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_HideType_ru', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_HideType_au', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\treturn this.add('Message_HideType_mute_unmute', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n});\n\nRocketChat.settings.addGroup('Meta', function() {\n\tthis.add('Meta_language', '', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Meta_fb_app_id', '', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Meta_robots', 'INDEX,FOLLOW', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Meta_google-site-verification', '', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Meta_msvalidate01', '', {\n\t\ttype: 'string'\n\t});\n\treturn this.add('Meta_custom', '', {\n\t\ttype: 'code',\n\t\tcode: 'text/html',\n\t\tmultiline: true\n\t});\n});\n\nRocketChat.settings.addGroup('Push', function() {\n\tthis.add('Push_enable', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Push_debug', false, {\n\t\ttype: 'boolean',\n\t\t'public': true,\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.add('Push_enable_gateway', true, {\n\t\ttype: 'boolean',\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.add('Push_gateway', 'https://gateway.rocket.chat', {\n\t\ttype: 'string',\n\t\tenableQuery: [\n\t\t\t{\n\t\t\t\t_id: 'Push_enable',\n\t\t\t\tvalue: true\n\t\t\t}, {\n\t\t\t\t_id: 'Push_enable_gateway',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t]\n\t});\n\tthis.add('Push_production', true, {\n\t\ttype: 'boolean',\n\t\t'public': true,\n\t\tenableQuery: [\n\t\t\t{\n\t\t\t\t_id: 'Push_enable',\n\t\t\t\tvalue: true\n\t\t\t}, {\n\t\t\t\t_id: 'Push_enable_gateway',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t]\n\t});\n\tthis.add('Push_test_push', 'push_test', {\n\t\ttype: 'action',\n\t\tactionText: 'Send_a_test_push_to_my_user',\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.section('Certificates_and_Keys', function() {\n\t\tthis.add('Push_apn_passphrase', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Push_apn_key', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true\n\t\t});\n\t\tthis.add('Push_apn_cert', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true\n\t\t});\n\t\tthis.add('Push_apn_dev_passphrase', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Push_apn_dev_key', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true\n\t\t});\n\t\tthis.add('Push_apn_dev_cert', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true\n\t\t});\n\t\tthis.add('Push_gcm_api_key', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\treturn this.add('Push_gcm_project_number', '', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t});\n\treturn this.section('Privacy', function() {\n\t\tthis.add('Push_show_username_room', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Push_show_message', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Layout', function() {\n\tthis.section('Content', function() {\n\t\tthis.add('Layout_Home_Title', 'Home', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Layout_Home_Body', 'Welcome to Rocket.Chat <br> Go to APP SETTINGS -> Layout to customize this intro.', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Layout_Terms_of_Service', 'Terms of Service <br> Go to APP SETTINGS -> Layout to customize this page.', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Layout_Login_Terms', 'By proceeding you are agreeing to our <a href=\"/terms-of-service\">Terms of Service</a> and <a href=\"/privacy-policy\">Privacy Policy</a>.', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Layout_Privacy_Policy', 'Privacy Policy <br> Go to APP SETTINGS -> Layout to customize this page.', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Layout_Sidenav_Footer', '<img src=\"assets/logo\" />', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'Layout_Sidenav_Footer_description'\n\t\t});\n\t});\n\tthis.section('Custom_Scripts', function() {\n\t\tthis.add('Custom_Script_Logged_Out', '//Add your script', {\n\t\t\ttype: 'code',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Custom_Script_Logged_In', '//Add your script', {\n\t\t\ttype: 'code',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t});\n\treturn this.section('User_Interface', function() {\n\t\tthis.add('UI_DisplayRoles', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('UI_Merge_Channels_Groups', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('UI_Use_Name_Avatar', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('UI_Use_Real_Name', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Logs', function() {\n\tthis.add('Log_Level', '0', {\n\t\ttype: 'select',\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: '0',\n\t\t\t\ti18nLabel: '0_Errors_Only'\n\t\t\t}, {\n\t\t\t\tkey: '1',\n\t\t\t\ti18nLabel: '1_Errors_and_Information'\n\t\t\t}, {\n\t\t\t\tkey: '2',\n\t\t\t\ti18nLabel: '2_Erros_Information_and_Debug'\n\t\t\t}\n\t\t],\n\t\t'public': true\n\t});\n\tthis.add('Log_Package', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Log_File', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\treturn this.add('Log_View_Limit', 1000, {\n\t\ttype: 'int'\n\t});\n});\n\nRocketChat.settings.init();\n","Meteor.methods({\n\t'public-settings/get'(updatedAt) {\n\t\tthis.unblock();\n\t\tconst records = RocketChat.models.Settings.find().fetch().filter(function(record) {\n\t\t\treturn record.hidden !== true && record['public'] === true;\n\t\t});\n\t\tif (updatedAt instanceof Date) {\n\t\t\treturn {\n\t\t\t\tupdate: records.filter(function(record) {\n\t\t\t\t\treturn record._updatedAt > updatedAt;\n\t\t\t\t}),\n\t\t\t\tremove: RocketChat.models.Settings.trashFindDeletedAfter(updatedAt, {\n\t\t\t\t\thidden: {\n\t\t\t\t\t\t$ne: true\n\t\t\t\t\t},\n\t\t\t\t\t'public': true\n\t\t\t\t}, {\n\t\t\t\t\tfields: {\n\t\t\t\t\t\t_id: 1,\n\t\t\t\t\t\t_deletedAt: 1\n\t\t\t\t\t}\n\t\t\t\t}).fetch()\n\t\t\t};\n\t\t}\n\t\treturn records;\n\t},\n\t'private-settings/get'(updatedAt) {\n\t\tif (!Meteor.userId()) {\n\t\t\treturn [];\n\t\t}\n\t\tthis.unblock();\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'view-privileged-setting')) {\n\t\t\treturn [];\n\t\t}\n\t\tconst records = RocketChat.models.Settings.find().fetch().filter(function(record) {\n\t\t\treturn record.hidden !== true;\n\t\t});\n\t\tif (updatedAt instanceof Date) {\n\t\t\treturn {\n\t\t\t\tupdate: records.filter(function(record) {\n\t\t\t\t\treturn record._updatedAt > updatedAt;\n\t\t\t\t}),\n\t\t\t\tremove: RocketChat.models.Settings.trashFindDeletedAfter(updatedAt, {\n\t\t\t\t\thidden: {\n\t\t\t\t\t\t$ne: true\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\tfields: {\n\t\t\t\t\t\t_id: 1,\n\t\t\t\t\t\t_deletedAt: 1\n\t\t\t\t\t}\n\t\t\t\t}).fetch()\n\t\t\t};\n\t\t}\n\t\treturn records;\n\t}\n});\n\nRocketChat.models.Settings.cache.on('changed', function(type, setting) {\n\tif (setting['public'] === true) {\n\t\tRocketChat.Notifications.notifyAllInThisInstance('public-settings-changed', type, _.pick(setting, '_id', 'value'));\n\t}\n\treturn RocketChat.Notifications.notifyLoggedInThisInstance('private-settings-changed', type, setting);\n});\n\nRocketChat.Notifications.streamAll.allowRead('private-settings-changed', function() {\n\tif (this.userId == null) {\n\t\treturn false;\n\t}\n\treturn RocketChat.authz.hasPermission(this.userId, 'view-privileged-setting');\n});\n","/* eslint no-multi-spaces: 0 */\n/* eslint comma-spacing: 0 */\n\nMeteor.methods({\n\taddOAuthService(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'addOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Adding OAuth Services is not allowed', { method: 'addOAuthService', action: 'Adding_OAuth_Services' });\n\t\t}\n\n\t\tname = name.toLowerCase().replace(/[^a-z0-9_]/g, '');\n\t\tname = s.capitalize(name);\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }`                   , false             , { type: 'boolean', group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Enable', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-url`               , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'URL', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-token_path`        , '/oauth/token'    , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Token_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-identity_path`     , '/me'             , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Identity_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-authorize_path`    , '/oauth/authorize', { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Authorize_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-scope`             , 'openid'          , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Scope', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-token_sent_via`    , 'payload'         , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Token_Sent_Via', persistent: true, values: [ { key: 'header', i18nLabel: 'Header' }, { key: 'payload', i18nLabel: 'Payload' } ] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-id`                , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_id', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-secret`            , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Secret', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-login_style`       , 'popup'           , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Login_Style', persistent: true, values: [ { key: 'redirect', i18nLabel: 'Redirect' }, { key: 'popup', i18nLabel: 'Popup' }, { key: '', i18nLabel: 'Default' } ] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_label_text` , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Label_Text', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_label_color`, '#FFFFFF'         , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Label_Color', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_color`      , '#13679A'         , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Color', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-username_field`    , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Username_Field', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-merge_users`       , false             , { type: 'boolean', group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Merge_Users', persistent: true });\n\t}});\n","Meteor.methods({\n\trefreshOAuthService() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'refreshOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Refresh OAuth Services is not allowed', { method: 'refreshOAuthService', action: 'Refreshing_OAuth_Services' });\n\t\t}\n\n\t\tServiceConfiguration.configurations.remove({});\n\n\t\tRocketChat.models.Settings.update({_id: /^Accounts_OAuth_.+/}, {$set: {_updatedAt: new Date}}, {multi: true});\n\t}\n});\n","Meteor.methods({\n\taddUserToRoom(data) {\n\t\treturn Meteor.call('addUsersToRoom', {\n\t\t\trid: data.rid,\n\t\t\tusers: [ data.username ]\n\t\t});\n\t}\n});\n","Meteor.methods({\n\taddUsersToRoom(data = {}) {\n\t\t// Validate user and room\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\tif (!Match.test(data.rid, String)) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Get user and room details\n\t\tconst room = RocketChat.models.Rooms.findOneById(data.rid);\n\t\tconst userId = Meteor.userId();\n\t\tconst user = Meteor.user();\n\t\tconst userInRoom = Array.isArray(room.usernames) && room.usernames.includes(user.username);\n\n\t\t// Can't add to direct room ever\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-cant-invite-for-direct-room', 'Can\\'t invite user to direct rooms', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Can add to any room you're in, with permission, otherwise need specific room type permission\n\t\tlet canAddUser = false;\n\t\tif (userInRoom && RocketChat.authz.hasPermission(userId, 'add-user-to-joined-room', room._id)) {\n\t\t\tcanAddUser = true;\n\t\t} else if (room.t === 'c' && RocketChat.authz.hasPermission(userId, 'add-user-to-any-c-room')) {\n\t\t\tcanAddUser = true;\n\t\t} else if (room.t === 'p' && RocketChat.authz.hasPermission(userId, 'add-user-to-any-p-room')) {\n\t\t\tcanAddUser = true;\n\t\t}\n\n\t\t// Adding wasn't allowed\n\t\tif (!canAddUser) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Missing the users to be added\n\t\tif (!Array.isArray(data.users)) {\n\t\t\tthrow new Meteor.Error('error-invalid-arguments', 'Invalid arguments', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Validate each user, then add to room\n\t\tdata.users.forEach((username) => {\n\t\t\tconst newUser = RocketChat.models.Users.findOneByUsername(username);\n\t\t\tif (!newUser) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-username', 'Invalid username', {\n\t\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tRocketChat.addUserToRoom(data.rid, newUser, user);\n\t\t});\n\n\t\treturn true;\n\t}\n});\n","Meteor.methods({\n\tarchiveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'archiveRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'archiveRoom' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'archive-room', room._id)) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'archiveRoom' });\n\t\t}\n\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-direct-message-room', 'Direct Messages can not be archived', { method: 'archiveRoom' });\n\t\t}\n\n\t\treturn RocketChat.archiveRoom(rid);\n\t}\n});\n","Meteor.methods({\n\tblockUser({rid, blocked}) {\n\n\t\tcheck(rid, String);\n\t\tcheck(blocked, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'blockUser' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tconst subscription2 = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, blocked);\n\n\t\tif (!subscription || !subscription2) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'blockUser' });\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.setBlockedByRoomId(rid, blocked, Meteor.userId());\n\n\t\treturn true;\n\t}\n});\n","Meteor.methods({\n\tcheckRegistrationSecretURL(hash) {\n\n\t\tcheck(hash, String);\n\n\t\treturn hash === RocketChat.settings.get('Accounts_RegistrationForm_SecretURL');\n\t}\n});\n","Meteor.methods({\n\tcleanChannelHistory({roomId, latest, oldest, inclusive}) {\n\t\tcheck(roomId, String);\n\t\tcheck(latest, Date);\n\t\tcheck(oldest, Date);\n\t\tcheck(inclusive, Boolean);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'cleanChannelHistory' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'clean-channel-history')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'cleanChannelHistory' });\n\t\t}\n\n\t\tif (inclusive) {\n\t\t\tRocketChat.models.Messages.remove({\n\t\t\t\trid: roomId,\n\t\t\t\tts: {\n\t\t\t\t\t$gte: oldest,\n\t\t\t\t\t$lte: latest\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tRocketChat.models.Messages.remove({\n\t\t\t\trid: roomId,\n\t\t\t\tts: {\n\t\t\t\t\t$gt: oldest,\n\t\t\t\t\t$lt: latest\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n});\n","Meteor.methods({\n\tcreateChannel(name, members, readOnly = false, customFields = {}) {\n\t\tcheck(name, String);\n\t\tcheck(members, Match.Optional([String]));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'createChannel' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'create-c')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'createChannel' });\n\t\t}\n\n\t\treturn RocketChat.createRoom('c', name, Meteor.user() && Meteor.user().username, members, readOnly, {customFields});\n\t}\n});\n","Meteor.methods({\n\tcreateToken(userId) {\n\t\tif (Meteor.userId() !== userId && !RocketChat.authz.hasPermission(Meteor.userId(), 'user-generate-access-token')) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'createToken' });\n\t\t}\n\t\tconst token = Accounts._generateStampedLoginToken();\n\t\tAccounts._insertLoginToken(userId, token);\n\t\treturn {\n\t\t\tuserId,\n\t\t\tauthToken: token.token\n\t\t};\n\t}\n});\n","Meteor.methods({\n\tcreatePrivateGroup(name, members, readOnly = false, customFields = {}) {\n\t\tcheck(name, String);\n\t\tcheck(members, Match.Optional([String]));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'createPrivateGroup' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'create-p')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'createPrivateGroup' });\n\t\t}\n\n\t\treturn RocketChat.createRoom('p', name, Meteor.user() && Meteor.user().username, members, readOnly, {customFields});\n\t}\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tdeleteMessage(message) {\n\t\tcheck(message, Match.ObjectIncluding({\n\t\t\t_id: String\n\t\t}));\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'deleteMessage'\n\t\t\t});\n\t\t}\n\t\tconst originalMessage = RocketChat.models.Messages.findOneById(message._id, {\n\t\t\tfields: {\n\t\t\t\tu: 1,\n\t\t\t\trid: 1,\n\t\t\t\tfile: 1\n\t\t\t}\n\t\t});\n\t\tif (originalMessage == null) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'deleteMessage',\n\t\t\t\taction: 'Delete_message'\n\t\t\t});\n\t\t}\n\t\tconst hasPermission = RocketChat.authz.hasPermission(Meteor.userId(), 'delete-message', originalMessage.rid);\n\t\tconst deleteAllowed = RocketChat.settings.get('Message_AllowDeleting');\n\t\tconst deleteOwn = originalMessage && originalMessage.u && originalMessage.u._id === Meteor.userId();\n\t\tif (!(hasPermission || (deleteAllowed && deleteOwn))) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'deleteMessage',\n\t\t\t\taction: 'Delete_message'\n\t\t\t});\n\t\t}\n\t\tconst blockDeleteInMinutes = RocketChat.settings.get('Message_AllowDeleting_BlockDeleteInMinutes');\n\t\tif (blockDeleteInMinutes != null && blockDeleteInMinutes !== 0) {\n\t\t\tif (originalMessage.ts == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst msgTs = moment(originalMessage.ts);\n\t\t\tif (msgTs == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst currentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\tif (currentTsDiff > blockDeleteInMinutes) {\n\t\t\t\tthrow new Meteor.Error('error-message-deleting-blocked', 'Message deleting is blocked', {\n\t\t\t\t\tmethod: 'deleteMessage'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn RocketChat.deleteMessage(originalMessage, Meteor.user());\n\t}\n});\n","Meteor.methods({\n\tdeleteUserOwnAccount(password) {\n\n\t\tcheck(password, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowDeleteOwnAccount')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tconst userId = Meteor.userId();\n\t\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tif (user.services && user.services.password && s.trim(user.services.password.bcrypt)) {\n\t\t\tconst result = Accounts._checkPassword(user, { digest: password, algorithm: 'sha-256' });\n\t\t\tif (result.error) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-password', 'Invalid password', { method: 'deleteUserOwnAccount' });\n\t\t\t}\n\t\t} else if (user.username !== s.trim(password)) {\n\t\t\tthrow new Meteor.Error('error-invalid-username', 'Invalid username', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.deleteUser(userId);\n\t\t});\n\n\t\treturn true;\n\t}\n});\n","const Filter = Npm.require('bad-words');\n\nRocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\n\tif (RocketChat.settings.get('Message_AllowBadWordsFilter')) {\n\t\tconst badWordsList = RocketChat.settings.get('Message_BadWordsFilterList');\n\t\tlet options;\n\n\t\t// Add words to the blacklist\n\t\tif (!!badWordsList && badWordsList.length) {\n\t\t\toptions = {\n\t\t\t\tlist: badWordsList.split(',')\n\t\t\t};\n\t\t}\n\t\tconst filter = new Filter(options);\n\t\tmessage.msg = filter.clean(message.msg);\n\t}\n\n\treturn message;\n\n}, 1, 'filterBadWords');\n","RocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\t// Test if the message mentions include @all.\n\tif (message.mentions != null &&\n\t\t_.pluck(message.mentions, '_id').some((item) => item === 'all')) {\n\n\t\t// Check if the user has permissions to use @all.\n\t\tif (!RocketChat.authz.hasPermission(message.u._id, 'mention-all')) {\n\n\t\t\t// Get the language of the user for the error notification.\n\t\t\tconst language = RocketChat.models.Users.findOneById(message.u._id).language;\n\t\t\tconst action = TAPi18n.__('Notify_all_in_this_room', {}, language);\n\n\t\t\t// Add a notification to the chat, informing the user that this\n\t\t\t// action is not allowed.\n\t\t\tRocketChat.Notifications.notifyUser(message.u._id, 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: message.rid,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('error-action-not-allowed', { action }, language)\n\t\t\t});\n\n\t\t\t// Also throw to stop propagation of 'sendMessage'.\n\t\t\tthrow new Meteor.Error(\n\t\t\t\t'error-action-not-allowed',\n\t\t\t\t'Notify all in this room not allowed',\n\t\t\t\t{\n\t\t\t\t\tmethod: 'filterATAllTag',\n\t\t\t\t\taction: 'Notify_all_in_this_room'\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\treturn message;\n\n}, 1, 'filterATAllTag');\n","Meteor.methods({\n\tgetChannelHistory({rid, latest, oldest, inclusive, count = 20, unreads}) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getChannelHistory' });\n\t\t}\n\n\t\tconst fromUserId = Meteor.userId();\n\t\tconst room = Meteor.call('canAccessRoom', rid, fromUserId);\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//Make sure they can access the room\n\t\tif (room.t === 'c' && !RocketChat.authz.hasPermission(fromUserId, 'preview-c-room') && room.usernames.indexOf(room.username) === -1) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//Ensure latest is always defined.\n\t\tif (_.isUndefined(latest)) {\n\t\t\tlatest = new Date();\n\t\t}\n\n\t\t//Verify oldest is a date if it exists\n\t\tif (!_.isUndefined(oldest) && !_.isDate(oldest)) {\n\t\t\tthrow new Meteor.Error('error-invalid-date', 'Invalid date', { method: 'getChannelHistory' });\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\tts: -1\n\t\t\t},\n\t\t\tlimit: count\n\t\t};\n\n\t\tif (!RocketChat.settings.get('Message_ShowEditedStatus')) {\n\t\t\toptions.fields = { 'editedAt': 0 };\n\t\t}\n\n\t\tlet records = [];\n\t\tif (_.isUndefined(oldest) && inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestampInclusive(rid, latest, options).fetch();\n\t\t} else if (_.isUndefined(oldest) && !inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestamp(rid, latest, options).fetch();\n\t\t} else if (!_.isUndefined(oldest) && inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestampsInclusive(rid, oldest, latest, options).fetch();\n\t\t} else {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestamps(rid, oldest, latest, options).fetch();\n\t\t}\n\n\t\tconst UI_Use_Real_Name = RocketChat.settings.get('UI_Use_Real_Name') === true;\n\n\t\tconst messages = _.map(records, (message) => {\n\t\t\tmessage.starred = _.findWhere(message.starred, { _id: fromUserId });\n\t\t\tif (message.u && message.u._id && UI_Use_Real_Name) {\n\t\t\t\tconst user = RocketChat.models.Users.findOneById(message.u._id);\n\t\t\t\tmessage.u.name = user && user.name;\n\t\t\t}\n\t\t\treturn message;\n\t\t});\n\n\t\tif (unreads) {\n\t\t\tlet unreadNotLoaded = 0;\n\t\t\tlet firstUnread = undefined;\n\n\t\t\tif (!_.isUndefined(oldest)) {\n\t\t\t\tconst firstMsg = messages[messages.length - 1];\n\t\t\t\tif (!_.isUndefined(firstMsg) && firstMsg.ts > oldest) {\n\t\t\t\t\tconst unreadMessages = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestamps(rid, oldest, firstMsg.ts, { limit: 1, sort: { ts: 1 } });\n\t\t\t\t\tfirstUnread = unreadMessages.fetch()[0];\n\t\t\t\t\tunreadNotLoaded = unreadMessages.count();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tmessages,\n\t\t\t\tfirstUnread,\n\t\t\t\tunreadNotLoaded\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tmessages\n\t\t};\n\t}\n});\n","Meteor.methods({\n\tgetFullUserData({ filter = '', limit }) {\n\t\tconst result = RocketChat.getFullUserData({ userId: Meteor.userId(), filter, limit });\n\n\t\tif (!result) {\n\t\t\treturn result;\n\t\t}\n\n\t\treturn result.fetch();\n\t}\n});\n","Meteor.methods({\n\tgetRoomRoles(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId() && RocketChat.settings.get('Accounts_AllowAnonymousRead') === false) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getRoomRoles' });\n\t\t}\n\n\t\tcheck(rid, String);\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\t'u.username': 1\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\trid: 1,\n\t\t\t\tu: 1,\n\t\t\t\troles: 1\n\t\t\t}\n\t\t};\n\n\t\tconst roles = RocketChat.models.Roles.find({ scope: 'Subscriptions', description: { $exists: 1, $ne: '' } }).fetch();\n\t\treturn RocketChat.models.Subscriptions.findByRoomIdAndRoles(rid, _.pluck(roles, '_id'), options).fetch();\n\t}\n});\n","Meteor.methods({\n\tgetServerInfo() {\n\t\treturn RocketChat.Info;\n\t}\n});\n","Meteor.methods({\n\tgetUserRoles() {\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getUserRoles' });\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\t'username': 1\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\troles: 1\n\t\t\t}\n\t\t};\n\n\t\tconst roles = RocketChat.models.Roles.find({ scope: 'Users', description: { $exists: 1, $ne: '' } }).fetch();\n\t\tconst roleIds = _.pluck(roles, '_id');\n\n\t\t// Security issue: we should not send all user's roles to all clients, only the 'public' roles\n\t\t// We must remove all roles that are not part of the query from the returned users\n\t\tconst users = RocketChat.models.Users.findUsersInRoles(roleIds, null, options).fetch();\n\t\tfor (const user of users) {\n\t\t\tuser.roles = _.intersection(user.roles, roleIds);\n\t\t}\n\t\treturn users;\n\t}\n});\n","Meteor.methods({\n\tinsertOrUpdateUser(userData) {\n\n\t\tcheck(userData, Object);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'insertOrUpdateUser' });\n\t\t}\n\n\t\treturn RocketChat.saveUser(Meteor.userId(), userData);\n\t}\n});\n","Meteor.methods({\n\tjoinDefaultChannels(silenced) {\n\t\tcheck(silenced, Match.Optional(Boolean));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'joinDefaultChannels' });\n\t\t}\n\n\t\tthis.unblock();\n\t\treturn RocketChat.addUserToDefaultChannels(Meteor.user(), silenced);\n\t}\n});\n","Meteor.methods({\n\tjoinRoom(rid, code) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'joinRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'joinRoom' });\n\t\t}\n\n\t\tif ((room.t !== 'c') || (RocketChat.authz.hasPermission(Meteor.userId(), 'view-c-room') !== true)) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'joinRoom' });\n\t\t}\n\n\t\tif ((room.joinCodeRequired === true) && (code !== room.joinCode) && !RocketChat.authz.hasPermission(Meteor.userId(), 'join-without-join-code')) {\n\t\t\tthrow new Meteor.Error('error-code-invalid', 'Invalid Code', { method: 'joinRoom' });\n\t\t}\n\n\t\treturn RocketChat.addUserToRoom(rid, Meteor.user());\n\t}\n});\n","Meteor.methods({\n\tleaveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'leaveRoom' });\n\t\t}\n\n\t\tthis.unblock();\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\t\tconst user = Meteor.user();\n\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'leaveRoom' });\n\t\t}\n\n\t\tif (!Array.from(room.usernames || []).includes(user.username)) {\n\t\t\tthrow new Meteor.Error('error-user-not-in-room', 'You are not in this room', { method: 'leaveRoom' });\n\t\t}\n\n\t\t// If user is room owner, check if there are other owners. If there isn't anyone else, warn user to set a new owner.\n\t\tif (RocketChat.authz.hasRole(user._id, 'owner', room._id)) {\n\t\t\tconst numOwners = RocketChat.authz.getUsersInRole('owner', room._id).fetch().length;\n\t\t\tif (numOwners === 1) {\n\t\t\t\tthrow new Meteor.Error('error-you-are-last-owner', 'You are the last owner. Please set new owner before leaving the room.', { method: 'leaveRoom' });\n\t\t\t}\n\t\t}\n\n\t\treturn RocketChat.removeUserFromRoom(rid, Meteor.user());\n\t}\n});\n","Meteor.methods({\n\tremoveOAuthService(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'removeOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'removeOAuthService' });\n\t\t}\n\n\t\tname = name.toLowerCase().replace(/[^a-z0-9_]/g, '');\n\t\tname = s.capitalize(name);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-url`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-token_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-identity_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-authorize_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-scope`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-token_sent_via`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-id`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-secret`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_label_text`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_label_color`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_color`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-login_style`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-username_field`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-merge_users`);\n\t}\n});\n","Meteor.methods({\n\trestart_server() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'restart_server' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasRole(Meteor.userId(), 'admin') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'restart_server' });\n\t\t}\n\n\t\tMeteor.setTimeout(() => {\n\t\t\tMeteor.setTimeout(() => {\n\t\t\t\tconsole.warn('Call to process.exit() timed out, aborting.');\n\t\t\t\tprocess.abort();\n\t\t\t}\n\t\t\t, 1000);\n\t\t\tprocess.exit(1);\n\t\t}\n\t\t, 1000);\n\n\t\treturn {\n\t\t\tmessage: 'The_server_will_restart_in_s_seconds',\n\t\t\tparams: [2]\n\t\t};\n\t}\n});\n","Meteor.methods({\n\t'robot.modelCall'(model, method, args) {\n\t\tcheck(model, String);\n\t\tcheck(method, String);\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'robot.modelCall'\n\t\t\t});\n\t\t}\n\t\tif (!RocketChat.authz.hasRole(Meteor.userId(), 'robot')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'robot.modelCall'\n\t\t\t});\n\t\t}\n\t\tconst m = RocketChat.models[model];\n\n\t\tif (!m || !_.isFunction(m[method])) {\n\t\t\tthrow new Meteor.Error('error-invalid-method', 'Invalid method', {\n\t\t\t\tmethod: 'robot.modelCall'\n\t\t\t});\n\t\t}\n\t\tconst cursor = RocketChat.models[model][method].apply(RocketChat.models[model], args);\n\t\treturn cursor && cursor.fetch ? cursor.fetch() : cursor;\n\t}\n});\n","Meteor.methods({\n\tsaveSetting(_id, value, editor) {\n\t\tif (Meteor.userId() === null) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing settings is not allowed', {\n\t\t\t\tmethod: 'saveSetting'\n\t\t\t});\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'edit-privileged-setting')) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing settings is not allowed', {\n\t\t\t\tmethod: 'saveSetting'\n\t\t\t});\n\t\t}\n\n\t\t//Verify the _id passed in is a string.\n\t\tcheck(_id, String);\n\n\t\tconst setting = RocketChat.models.Settings.db.findOneById(_id);\n\n\t\t//Verify the value is what it should be\n\t\tswitch (setting.type) {\n\t\t\tcase 'roomPick':\n\t\t\t\tcheck(value, [Object]);\n\t\t\t\tbreak;\n\t\t\tcase 'boolean':\n\t\t\t\tcheck(value, Boolean);\n\t\t\t\tbreak;\n\t\t\tcase 'int':\n\t\t\t\tcheck(value, Number);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcheck(value, String);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tRocketChat.settings.updateById(_id, value, editor);\n\t\treturn true;\n\t}\n});\n","\nMeteor.methods({\n\tsendInvitationEmail(emails) {\n\t\tcheck(emails, [String]);\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'sendInvitationEmail'\n\t\t\t});\n\t\t}\n\t\tif (!RocketChat.authz.hasRole(Meteor.userId(), 'admin')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'sendInvitationEmail'\n\t\t\t});\n\t\t}\n\t\tconst rfcMailPattern = /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n\t\tconst validEmails = _.compact(_.map(emails, function(email) {\n\t\t\tif (rfcMailPattern.test(email)) {\n\t\t\t\treturn email;\n\t\t\t}\n\t\t}));\n\t\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\t\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\t\tlet html;\n\t\tlet subject;\n\t\tconst user = Meteor.user();\n\t\tconst lng = user.language || RocketChat.settings.get('language') || 'en';\n\t\tif (RocketChat.settings.get('Invitation_Customized')) {\n\t\t\tsubject = RocketChat.settings.get('Invitation_Subject');\n\t\t\thtml = RocketChat.settings.get('Invitation_HTML');\n\t\t} else {\n\t\t\tsubject = TAPi18n.__('Invitation_Subject_Default', {\n\t\t\t\tlng\n\t\t\t});\n\t\t\thtml = TAPi18n.__('Invitation_HTML_Default', {\n\t\t\t\tlng\n\t\t\t});\n\t\t}\n\t\tsubject = RocketChat.placeholders.replace(subject);\n\t\tvalidEmails.forEach(email => {\n\t\t\tthis.unblock();\n\t\t\thtml = RocketChat.placeholders.replace(html, {\n\t\t\t\temail\n\t\t\t});\n\t\t\ttry {\n\t\t\t\tEmail.send({\n\t\t\t\t\tto: email,\n\t\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\t\tsubject,\n\t\t\t\t\thtml: header + html + footer\n\t\t\t\t});\n\t\t\t} catch ({message}) {\n\t\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ message }`, {\n\t\t\t\t\tmethod: 'sendInvitationEmail',\n\t\t\t\t\tmessage\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn validEmails;\n\t}\n});\n","import moment from 'moment'\n\nMeteor.methods\n\tsendMessage: (message) ->\n\n\t\tcheck message, Object\n\n\t\tif not Meteor.userId()\n\t\t\tthrow new Meteor.Error('error-invalid-user', \"Invalid user\", { method: 'sendMessage' })\n\n\t\tif message.ts\n\t\t\ttsDiff = Math.abs(moment(message.ts).diff())\n\t\t\tif tsDiff > 60000\n\t\t\t\tthrow new Meteor.Error('error-message-ts-out-of-sync', 'Message timestamp is out of sync', { method: 'sendMessage', message_ts: message.ts, server_ts: new Date().getTime() })\n\t\t\telse if tsDiff > 10000\n\t\t\t\tmessage.ts = new Date()\n\t\telse\n\t\t\tmessage.ts = new Date()\n\n\t\tif message.msg?.length > RocketChat.settings.get('Message_MaxAllowedSize')\n\t\t\tthrow new Meteor.Error('error-message-size-exceeded', 'Message size exceeds Message_MaxAllowedSize', { method: 'sendMessage' })\n\n\t\tuser = RocketChat.models.Users.findOneById Meteor.userId(), fields: username: 1, name: 1\n\n\t\troom = Meteor.call 'canAccessRoom', message.rid, user._id\n\n\t\tif not room\n\t\t\treturn false\n\n\t\tsubscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(message.rid, Meteor.userId());\n\t\tif subscription and (subscription.blocked or subscription.blocker)\n\t\t\tRocketChat.Notifications.notifyUser Meteor.userId(), 'message', {\n\t\t\t\t_id: Random.id()\n\t\t\t\trid: room._id\n\t\t\t\tts: new Date\n\t\t\t\tmsg: TAPi18n.__('room_is_blocked', {}, user.language)\n\t\t\t}\n\t\t\treturn false\n\n\t\tif user.username in (room.muted or [])\n\t\t\tRocketChat.Notifications.notifyUser Meteor.userId(), 'message', {\n\t\t\t\t_id: Random.id()\n\t\t\t\trid: room._id\n\t\t\t\tts: new Date\n\t\t\t\tmsg: TAPi18n.__('You_have_been_muted', {}, user.language)\n\t\t\t}\n\t\t\treturn false\n\n\t\tmessage.alias = user.name if not message.alias? and RocketChat.settings.get 'Message_SetNameToAliasEnabled'\n\t\tif Meteor.settings.public.sandstorm\n\t\t\tmessage.sandstormSessionId = this.connection.sandstormSessionId()\n\n\t\tRocketChat.metrics.messagesSent.inc() # This line needs to be moved to it's proper place. See the comments on: https://github.com/RocketChat/Rocket.Chat/pull/5736\n\t\tRocketChat.sendMessage user, message, room\n\n# Limit a user, who does not have the \"bot\" role, to sending 5 msgs/second\nDDPRateLimiter.addRule\n\ttype: 'method'\n\tname: 'sendMessage'\n\tuserId: (userId) ->\n\t\tuser = RocketChat.models.Users.findOneById(userId)\n\t\treturn true if not user?.roles\n\t\treturn 'bot' not in user.roles\n, 5, 1000\n","var indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nimport moment from 'moment';\n\nMeteor.methods({\n  sendMessage: function(message) {\n    var ref, ref1, room, subscription, tsDiff, user;\n    check(message, Object);\n    if (!Meteor.userId()) {\n      throw new Meteor.Error('error-invalid-user', \"Invalid user\", {\n        method: 'sendMessage'\n      });\n    }\n    if (message.ts) {\n      tsDiff = Math.abs(moment(message.ts).diff());\n      if (tsDiff > 60000) {\n        throw new Meteor.Error('error-message-ts-out-of-sync', 'Message timestamp is out of sync', {\n          method: 'sendMessage',\n          message_ts: message.ts,\n          server_ts: new Date().getTime()\n        });\n      } else if (tsDiff > 10000) {\n        message.ts = new Date();\n      }\n    } else {\n      message.ts = new Date();\n    }\n    if (((ref = message.msg) != null ? ref.length : void 0) > RocketChat.settings.get('Message_MaxAllowedSize')) {\n      throw new Meteor.Error('error-message-size-exceeded', 'Message size exceeds Message_MaxAllowedSize', {\n        method: 'sendMessage'\n      });\n    }\n    user = RocketChat.models.Users.findOneById(Meteor.userId(), {\n      fields: {\n        username: 1,\n        name: 1\n      }\n    });\n    room = Meteor.call('canAccessRoom', message.rid, user._id);\n    if (!room) {\n      return false;\n    }\n    subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(message.rid, Meteor.userId());\n    if (subscription && (subscription.blocked || subscription.blocker)) {\n      RocketChat.Notifications.notifyUser(Meteor.userId(), 'message', {\n        _id: Random.id(),\n        rid: room._id,\n        ts: new Date,\n        msg: TAPi18n.__('room_is_blocked', {}, user.language)\n      });\n      return false;\n    }\n    if (ref1 = user.username, indexOf.call(room.muted || [], ref1) >= 0) {\n      RocketChat.Notifications.notifyUser(Meteor.userId(), 'message', {\n        _id: Random.id(),\n        rid: room._id,\n        ts: new Date,\n        msg: TAPi18n.__('You_have_been_muted', {}, user.language)\n      });\n      return false;\n    }\n    if ((message.alias == null) && RocketChat.settings.get('Message_SetNameToAliasEnabled')) {\n      message.alias = user.name;\n    }\n    if (Meteor.settings[\"public\"].sandstorm) {\n      message.sandstormSessionId = this.connection.sandstormSessionId();\n    }\n    RocketChat.metrics.messagesSent.inc();\n    return RocketChat.sendMessage(user, message, room);\n  }\n});\n\nDDPRateLimiter.addRule({\n  type: 'method',\n  name: 'sendMessage',\n  userId: function(userId) {\n    var user;\n    user = RocketChat.models.Users.findOneById(userId);\n    if (!(user != null ? user.roles : void 0)) {\n      return true;\n    }\n    return indexOf.call(user.roles, 'bot') < 0;\n  }\n}, 5, 1000);\n","Meteor.methods({\n\tsendSMTPTestEmail() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'sendSMTPTestEmail'\n\t\t\t});\n\t\t}\n\t\tconst user = Meteor.user();\n\t\tif (!user.emails && !user.emails[0] && user.emails[0].address) {\n\t\t\tthrow new Meteor.Error('error-invalid-email', 'Invalid email', {\n\t\t\t\tmethod: 'sendSMTPTestEmail'\n\t\t\t});\n\t\t}\n\t\tthis.unblock();\n\t\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\t\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\t\tconsole.log(`Sending test email to ${ user.emails[0].address }`);\n\t\ttry {\n\t\t\tEmail.send({\n\t\t\t\tto: user.emails[0].address,\n\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\tsubject: 'SMTP Test Email',\n\t\t\t\thtml: `${ header }<p>You have successfully sent an email</p>${ footer }`\n\t\t\t});\n\t\t} catch ({message}) {\n\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ message }`, {\n\t\t\t\tmethod: 'sendSMTPTestEmail',\n\t\t\t\tmessage\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tmessage: 'Your_mail_was_sent_to_s',\n\t\t\tparams: [user.emails[0].address]\n\t\t};\n\t}\n});\n\nDDPRateLimiter.addRule({\n\ttype: 'method',\n\tname: 'sendSMTPTestEmail',\n\tuserId() {\n\t\treturn true;\n\t}\n}, 1, 1000);\n","Meteor.methods({\n\tsetAdminStatus(userId, admin) {\n\n\t\tcheck(userId, String);\n\t\tcheck(admin, Match.Optional(Boolean));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setAdminStatus' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'assign-admin-role') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setAdminStatus' });\n\t\t}\n\n\t\tconst user = Meteor.users.findOne({ _id: userId }, { fields: { username: 1 } });\n\n\t\tif (admin) {\n\t\t\treturn Meteor.call('authorization:addUserToRole', 'admin', user.username);\n\t\t} else {\n\t\t\treturn Meteor.call('authorization:removeUserFromRole', 'admin', user.username);\n\t\t}\n\t}\n});\n","Meteor.methods({\n\tsetRealName(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setRealName' });\n\t\t}\n\n\t\tif (!RocketChat.setRealName(Meteor.userId(), name)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-name', 'Could not change name', { method: 'setRealName' });\n\t\t}\n\n\t\treturn name;\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('setRealName', 1, 1000, {\n\tuserId: () => true\n});\n","Meteor.methods({\n\tsetUsername(username, param = {}) {\n\t\tconst { joinDefaultChannelsSilenced } = param;\n\t\tcheck(username, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setUsername' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (user.username && !RocketChat.settings.get('Accounts_AllowUsernameChange')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setUsername' });\n\t\t}\n\n\t\tif (user.username === username) {\n\t\t\treturn username;\n\t\t}\n\n\t\tlet nameValidation;\n\t\ttry {\n\t\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t\t} catch (error) {\n\t\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t\t}\n\n\t\tif (!nameValidation.test(username)) {\n\t\t\tthrow new Meteor.Error('username-invalid', `${ _.escape(username) } is not a valid username, use only letters, numbers, dots, hyphens and underscores`);\n\t\t}\n\n\t\tif (user.username !== undefined) {\n\t\t\tif (!username.toLowerCase() === user.username.toLowerCase()) {\n\t\t\t\tif (!RocketChat.checkUsernameAvailability(username)) {\n\t\t\t\t\tthrow new Meteor.Error('error-field-unavailable', `<strong>${ _.escape(username) }</strong> is already in use :(`, { method: 'setUsername', field: username });\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!RocketChat.checkUsernameAvailability(username)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `<strong>${ _.escape(username) }</strong> is already in use :(`, { method: 'setUsername', field: username });\n\t\t}\n\n\t\tif (!RocketChat.setUsername(user._id, username)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-username', 'Could not change username', { method: 'setUsername' });\n\t\t}\n\n\t\tif (!user.username) {\n\t\t\tMeteor.runAsUser(user._id, () => Meteor.call('joinDefaultChannels', joinDefaultChannelsSilenced));\n\t\t\tMeteor.defer(function() {\n\t\t\t\treturn RocketChat.callbacks.run('afterCreateUser', RocketChat.models.Users.findOneById(user._id));\n\t\t\t});\n\t\t}\n\n\t\treturn username;\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('setUsername', 1, 1000, {\n\tuserId() { return true; }\n});\n","Meteor.methods({\n\tsetEmail(email) {\n\n\t\tcheck (email, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setEmail' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowEmailChange')) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Changing email is not allowed', { method: 'setEmail', action: 'Changing_email' });\n\t\t}\n\n\t\tif (user.emails && user.emails[0] && user.emails[0].address === email) {\n\t\t\treturn email;\n\t\t}\n\n\t\tif (!RocketChat.setEmail(user._id, email)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-email', 'Could not change email', { method: 'setEmail' });\n\t\t}\n\n\t\treturn email;\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('setEmail', 1, 1000, {\n\tuserId(/*userId*/) { return true; }\n});\n","Meteor.methods({\n\tunarchiveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'unarchive-room', room._id)) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\treturn RocketChat.unarchiveRoom(rid);\n\t}\n});\n","Meteor.methods({\n\tunblockUser({rid, blocked}) {\n\n\t\tcheck(rid, String);\n\t\tcheck(blocked, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'blockUser' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tconst subscription2 = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, blocked);\n\n\t\tif (!subscription || !subscription2) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'blockUser' });\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.unsetBlockedByRoomId(rid, blocked, Meteor.userId());\n\n\t\treturn true;\n\t}\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tupdateMessage(message) {\n\n\t\tcheck(message, Match.ObjectIncluding({_id:String}));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'updateMessage' });\n\t\t}\n\n\t\tconst originalMessage = RocketChat.models.Messages.findOneById(message._id);\n\n\t\tif (!originalMessage || !originalMessage._id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst hasPermission = RocketChat.authz.hasPermission(Meteor.userId(), 'edit-message', message.rid);\n\t\tconst editAllowed = RocketChat.settings.get('Message_AllowEditing');\n\t\tconst editOwn = originalMessage.u && originalMessage.u._id === Meteor.userId();\n\n\t\tif (!hasPermission && (!editAllowed || !editOwn)) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Message editing not allowed', { method: 'updateMessage', action: 'Message_editing' });\n\t\t}\n\n\t\tconst blockEditInMinutes = RocketChat.settings.get('Message_AllowEditing_BlockEditInMinutes');\n\t\tif (Match.test(blockEditInMinutes, Number) && blockEditInMinutes !== 0) {\n\t\t\tlet currentTsDiff;\n\t\t\tlet msgTs;\n\n\t\t\tif (Match.test(originalMessage.ts, Number)) {\n\t\t\t\tmsgTs = moment(originalMessage.ts);\n\t\t\t}\n\t\t\tif (msgTs) {\n\t\t\t\tcurrentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\t}\n\t\t\tif (currentTsDiff > blockEditInMinutes) {\n\t\t\t\tthrow new Meteor.Error('error-message-editing-blocked', 'Message editing is blocked', { method: 'updateMessage' });\n\t\t\t}\n\t\t}\n\n\t\tif (originalMessage.attachments) {\n\t\t\tif (originalMessage.attachments[0].description !== undefined) {\n\t\t\t\tmessage.attachments = originalMessage.attachments;\n\t\t\t\tmessage.attachments[0].description = message.msg;\n\t\t\t\tmessage.msg = originalMessage.msg;\n\t\t\t}\n\t\t}\n\n\t\tmessage.u = originalMessage.u;\n\n\t\treturn RocketChat.updateMessage(message, Meteor.user());\n\t}\n});\n","/* globals openRoom */\nRocketChat.roomTypes.add(null, 0, {\n\ttemplate: 'starredRooms',\n\ticon: 'icon-star'\n});\n\nRocketChat.roomTypes.add('c', 10, {\n\ttemplate: 'channels',\n\ticon: 'icon-hash',\n\troute: {\n\t\tname: 'channel',\n\t\tpath: '/channel/:name',\n\t\taction(params) {\n\t\t\treturn openRoom('c', params.name);\n\t\t}\n\t},\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'c',\n\t\t\tname: identifier\n\t\t};\n\t\treturn ChatRoom.findOne(query);\n\t},\n\n\troomName(roomData) {\n\t\treturn roomData.name;\n\t},\n\n\tcondition() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || RocketChat.settings.get('Accounts_AllowAnonymousRead') === true;\n\t},\n\n\tshowJoinLink(roomId) {\n\t\treturn !!ChatRoom.findOne({ _id: roomId, t: 'c' });\n\t}\n});\n\nRocketChat.roomTypes.add('d', 20, {\n\ttemplate: 'directMessages',\n\ticon: 'icon-at',\n\troute: {\n\t\tname: 'direct',\n\t\tpath: '/direct/:username',\n\t\taction(params) {\n\t\t\treturn openRoom('d', params.username);\n\t\t},\n\t\tlink(sub) {\n\t\t\treturn { username: sub.name };\n\t\t}\n\t},\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tname: identifier\n\t\t};\n\n\t\tconst subscription = ChatSubscription.findOne(query);\n\t\tif (subscription && subscription.rid) {\n\t\t\treturn ChatRoom.findOne(subscription.rid);\n\t\t}\n\t},\n\n\troomName(roomData) {\n\t\tconst subscription = ChatSubscription.findOne({ rid: roomData._id }, { fields: { name: 1, fname: 1 } });\n\t\tif (!subscription) {\n\t\t\treturn '';\n\t\t}\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name') && subscription.fname) {\n\t\t\treturn subscription.fname;\n\t\t}\n\n\t\treturn subscription.name;\n\t},\n\n\tsecondaryRoomName(roomData) {\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name')) {\n\t\t\tconst subscription = ChatSubscription.findOne({ rid: roomData._id }, { fields: { name: 1 } });\n\t\t\treturn subscription && subscription.name;\n\t\t}\n\t},\n\n\tcondition() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);\n\t},\n\n\tgetUserStatus(roomId) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne({rid: roomId});\n\t\tif (subscription == null) { return; }\n\n\t\treturn Session.get(`user_${ subscription.name }_status`);\n\t}\n});\n\nRocketChat.roomTypes.add('p', 30, {\n\ttemplate: 'privateGroups',\n\ticon: 'icon-lock',\n\troute: {\n\t\tname: 'group',\n\t\tpath: '/group/:name',\n\t\taction(params) {\n\t\t\treturn openRoom('p', params.name);\n\t\t}\n\t},\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'p',\n\t\t\tname: identifier\n\t\t};\n\t\treturn ChatRoom.findOne(query);\n\t},\n\n\troomName(roomData) {\n\t\treturn roomData.name;\n\t},\n\n\tcondition() {\n\t\treturn RocketChat.authz.hasAllPermission('view-p-room');\n\t}\n});\n"]}