{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:tutum/startup.js"],"names":["process","env","DOCKERCLOUD_REDIS_HOST","redis","Npm","require","client","createClient","on","console","log","err","del","DOCKERCLOUD_CLIENT_HOST","rpush","DOCKERCLOUD_CLIENT_NAME","port","PORT","DOCKERCLOUD_IP_ADDRESS","split","expire"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;EAOA,IAAIA,QAAQC,GAAR,CAAYC,sBAAZ,IAAsC,IAA1C,EAAgD;AAC/C,KAAMC,QAAQC,IAAIC,OAAJ,CAAY,OAAZ,CAAd;;AAEA,KAAMC,SAASH,MAAMI,YAAN,CAAmBP,QAAQC,GAAR,CAAYC,sBAA/B,CAAf;AAEAI,QAAOE,EAAP,CAAU,OAAV,EAAmB;AAAA,SAAOC,QAAQC,GAAR,CAAY,gBAAZ,EAA8BC,GAA9B,CAAP;AAAA,EAAnB;AAEAL,QAAOM,GAAP,eAAwBZ,QAAQC,GAAR,CAAYY,uBAApC;AACAP,QAAOQ,KAAP,eAA0Bd,QAAQC,GAAR,CAAYY,uBAAtC,EAAkEb,QAAQC,GAAR,CAAYc,uBAA9E;AAEA,KAAMC,OAAOhB,QAAQC,GAAR,CAAYgB,IAAZ,IAAoB,IAAjC;AACAX,QAAOQ,KAAP,eAA0Bd,QAAQC,GAAR,CAAYY,uBAAtC,cAA6Eb,QAAQC,GAAR,CAAYiB,sBAAZ,CAAmCC,KAAnC,CAAyC,GAAzC,EAA8C,CAA9C,CAA7E,SAAmIH,IAAnI,EAX+C,CAa/C;;AACAhB,SAAQQ,EAAR,CAAW,SAAX,EAAsB;AAAA,SAAMF,OAAOc,MAAP,eAA2BpB,QAAQC,GAAR,CAAYY,uBAAvC,EAAmE,EAAnE,CAAN;AAAA,EAAtB;AAEAb,SAAQQ,EAAR,CAAW,QAAX,EAAqB;AAAA,SAAMF,OAAOc,MAAP,eAA2BpB,QAAQC,GAAR,CAAYY,uBAAvC,EAAmE,EAAnE,CAAN;AAAA,EAArB;AACA,4G","file":"/packages/rocketchat_tutum.js","sourcesContent":["/* Examples\n\nDOCKERCLOUD_REDIS_HOST=redis://:password@host:6379\nDOCKERCLOUD_CLIENT_NAME=mywebsite\nDOCKERCLOUD_CLIENT_HOST=mywebsite.dotcloud.com\n*/\n\nif (process.env.DOCKERCLOUD_REDIS_HOST != null) {\n\tconst redis = Npm.require('redis');\n\n\tconst client = redis.createClient(process.env.DOCKERCLOUD_REDIS_HOST);\n\n\tclient.on('error', err => console.log('Redis error ->', err));\n\n\tclient.del(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`);\n\tclient.rpush(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`, process.env.DOCKERCLOUD_CLIENT_NAME);\n\n\tconst port = process.env.PORT || 3000;\n\tclient.rpush(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`, `http://${ process.env.DOCKERCLOUD_IP_ADDRESS.split('/')[0] }:${ port }`);\n\n\t// removes the redis entry in 90 seconds on a SIGTERM\n\tprocess.on('SIGTERM', () => client.expire(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`, 90));\n\n\tprocess.on('SIGINT', () => client.expire(`frontend:${ process.env.DOCKERCLOUD_CLIENT_HOST }`, 90));\n}\n"]}