{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:slashcommands-topic/topic.js"],"names":["Topic","command","params","item","Meteor","isClient","RocketChat","authz","hasAtLeastOnePermission","rid","isServer","hasPermission","userId","call","err","handleError","callbacks","run","ChatRoom","findOne","slashCommands","add","description"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;GAKA,SAASA,KAAT,CAAeC,OAAf,EAAwBC,MAAxB,EAAgCC,IAAhC,EAAsC;AACrC,KAAIF,YAAY,OAAhB,EAAyB;AACxB,MAAIG,OAAOC,QAAP,IAAmBC,WAAWC,KAAX,CAAiBC,uBAAjB,CAAyC,WAAzC,EAAsDL,KAAKM,GAA3D,CAAnB,IAAuFL,OAAOM,QAAP,IAAmBJ,WAAWC,KAAX,CAAiBI,aAAjB,CAA+BP,OAAOQ,MAAP,EAA/B,EAAgD,WAAhD,EAA6DT,KAAKM,GAAlE,CAA9G,EAAuL;AACtLL,UAAOS,IAAP,CAAY,kBAAZ,EAAgCV,KAAKM,GAArC,EAA0C,WAA1C,EAAuDP,MAAvD,EAA+D,UAACY,GAAD,EAAS;AACvE,QAAIA,GAAJ,EAAS;AACR,SAAIV,OAAOC,QAAX,EAAqB;AACpB,aAAOU,YAAYD,GAAZ,CAAP;AACA,MAFD,MAEO;AACN,YAAMA,GAAN;AACA;AACD;;AAED,QAAIV,OAAOC,QAAX,EAAqB;AACpBC,gBAAWU,SAAX,CAAqBC,GAArB,CAAyB,kBAAzB,EAA6CC,SAASC,OAAT,CAAiBhB,KAAKM,GAAtB,CAA7C;AACA;AACD,IAZD;AAaA;AACD;AACD;;AAEDH,WAAWc,aAAX,CAAyBC,GAAzB,CAA6B,OAA7B,EAAsCrB,KAAtC,EAA6C;AAC5CsB,cAAa,yBAD+B;AAE5CpB,SAAQ;AAFoC,CAA7C,uF","file":"/packages/rocketchat_slashcommands-topic.js","sourcesContent":["/*\n * Join is a named function that will replace /topic commands\n * @param {Object} message - The message object\n */\n\nfunction Topic(command, params, item) {\n\tif (command === 'topic') {\n\t\tif (Meteor.isClient && RocketChat.authz.hasAtLeastOnePermission('edit-room', item.rid) || (Meteor.isServer && RocketChat.authz.hasPermission(Meteor.userId(), 'edit-room', item.rid))) {\n\t\t\tMeteor.call('saveRoomSettings', item.rid, 'roomTopic', params, (err) => {\n\t\t\t\tif (err) {\n\t\t\t\t\tif (Meteor.isClient) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow err;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Meteor.isClient) {\n\t\t\t\t\tRocketChat.callbacks.run('roomTopicChanged', ChatRoom.findOne(item.rid));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\nRocketChat.slashCommands.add('topic', Topic, {\n\tdescription: 'Slash_Topic_Description',\n\tparams: 'Slash_Topic_Params'\n});\n"]}