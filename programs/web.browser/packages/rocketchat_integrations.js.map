{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:integrations/lib/rocketchat.js","meteor://ðŸ’»app/packages/rocketchat:integrations/client/collections.js","meteor://ðŸ’»app/packages/rocketchat:integrations/client/startup.js","meteor://ðŸ’»app/packages/rocketchat:integrations/client/route.js","meteor://ðŸ’»app/packages/rocketchat:integrations/client/views/integrations.js","meteor://ðŸ’»app/packages/rocketchat:integrations/client/views/integrationsNew.js","meteor://ðŸ’»app/packages/rocketchat:integrations/client/views/integrationsIncoming.js","meteor://ðŸ’»app/packages/rocketchat:integrations/client/views/integrationsOutgoing.js","meteor://ðŸ’»app/packages/rocketchat:integrations/client/views/integrationsOutgoingHistory.js"],"names":["RocketChat","integrations","outgoingEvents","sendMessage","label","value","use","channel","triggerWords","targetRoom","fileUploaded","roomArchived","roomCreated","roomJoined","roomLeft","userCreated","ChatIntegrations","Mongo","Collection","ChatIntegrationHistory","AdminBox","addOption","href","i18nLabel","permissionGranted","authz","hasAtLeastOnePermission","FlowRouter","route","name","subscriptions","register","Meteor","subscribe","action","BlazeLayout","render","center","pageTitle","t","params","pageTemplate","moment","module","watch","require","v","Template","helpers","hasPermission","find","dateFormated","date","format","eventTypeI18n","event","TAPi18n","__","integrationsNew","hljs","toastr","integrationsIncoming","onCreated","_incomingIntegrationsOnCreated","record","ReactiveVar","username","data","instance","undefined","id","hasAllPermission","findOne","_id","userId","completeToken","token","url","absoluteUrl","set","curValue","example","get","Random","alias","emoji","avatar","msg","bot","i","groupable","attachments","title","title_link","text","image_url","color","ts","Date","u","exampleJson","icon_emoji","icon_url","invalidData","Object","keys","forEach","key","includes","highlight","JSON","stringify","curl","editorOptions","lineNumbers","mode","gutters","foldGutter","matchBrackets","autoCloseBrackets","matchTags","showTrailingSpace","highlightSelectionMatches","events","e","$","val","trim","swal","type","showCancelButton","confirmButtonColor","confirmButtonText","cancelButtonText","closeOnConfirm","html","call","err","handleError","timer","showConfirmButton","go","codeMirrorBox","addClass","CodeMirror","refresh","removeClass","enabled","scriptEnabled","script","error","integration","success","integrationsOutgoing","_integrationsOutgoingOnCreated","retryFailedCalls","retryCount","retryDelay","runOnEdits","updateRecord","urls","triggerWordAnywhere","autorun","sub","ready","intRecord","join","arr","sep","showHistoryButton","canDelete","eventTypes","values","hasTypeSelected","shouldDisplayChannel","shouldDisplayTriggerWords","shouldDisplayTargetRoom","getParam","currentTarget","closest","each","index","codeMirror","impersonateUser","split","filter","length","word","field","parseInt","integrationsOutgoingHistory","_integrationsOutgoingHistoryOnCreated","hasMore","limit","historySub","count","histories","fetch","sort","a","b","_updatedAt","hasProperty","history","property","iconClass","finished","statusI18n","formatDate","formatDateDetail","eventTypei18n","jsonStringify","hljsStack","errorStack","integrationId","historyId","attr","_","throttle","target","scrollTop","scrollHeight","clientHeight"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,WAAWC,YAAX,GAA0B;AACzBC,iBAAgB;AACfC,eAAa;AACZC,UAAO,wCADK;AAEZC,UAAO,aAFK;AAGZC,QAAK;AACJC,aAAS,IADL;AAEJC,kBAAc,IAFV;AAGJC,gBAAY;AAHR;AAHO,GADE;AAUfC,gBAAc;AACbN,UAAO,yCADM;AAEbC,UAAO,cAFM;AAGbC,QAAK;AACJC,aAAS,IADL;AAEJC,kBAAc,KAFV;AAGJC,gBAAY;AAHR;AAHQ,GAVC;AAmBfE,gBAAc;AACbP,UAAO,yCADM;AAEbC,UAAO,cAFM;AAGbC,QAAK;AACJC,aAAS,KADL;AAEJC,kBAAc,KAFV;AAGJC,gBAAY;AAHR;AAHQ,GAnBC;AA4BfG,eAAa;AACZR,UAAO,wCADK;AAEZC,UAAO,aAFK;AAGZC,QAAK;AACJC,aAAS,KADL;AAEJC,kBAAc,KAFV;AAGJC,gBAAY;AAHR;AAHO,GA5BE;AAqCfI,cAAY;AACXT,UAAO,uCADI;AAEXC,UAAO,YAFI;AAGXC,QAAK;AACJC,aAAS,IADL;AAEJC,kBAAc,KAFV;AAGJC,gBAAY;AAHR;AAHM,GArCG;AA8CfK,YAAU;AACTV,UAAO,qCADE;AAETC,UAAO,UAFE;AAGTC,QAAK;AACJC,aAAS,IADL;AAEJC,kBAAc,KAFV;AAGJC,gBAAY;AAHR;AAHI,GA9CK;AAuDfM,eAAa;AACZX,UAAO,wCADK;AAEZC,UAAO,aAFK;AAGZC,QAAK;AACJC,aAAS,KADL;AAEJC,kBAAc,KAFV;AAGJC,gBAAY;AAHR;AAHO;AAvDE;AADS,CAA1B,0H;;;;;;;;;;;ACAA,KAAKO,gBAAL,GAAwB,IAAIC,MAAMC,UAAV,CAAqB,yBAArB,CAAxB;AACA,KAAKC,sBAAL,GAA8B,IAAIF,MAAMC,UAAV,CAAqB,gCAArB,CAA9B,uC;;;;;;;;;;;ACDAlB,WAAWoB,QAAX,CAAoBC,SAApB,CAA8B;AAC7BC,OAAM,oBADuB;AAE7BC,YAAW,cAFkB;AAG7BC,oBAAmB;AAAA,SAAMxB,WAAWyB,KAAX,CAAiBC,uBAAjB,CAAyC,CAAC,qBAAD,EAAwB,yBAAxB,CAAzC,CAAN;AAAA;AAHU,CAA9B,0H;;;;;;;;;;;ACAAC,WAAWC,KAAX,CAAiB,qBAAjB,EAAwC;AACvCC,OAAM,oBADiC;AAEvCC,cAFuC,cAEvB;AACf,OAAKC,QAAL,CAAc,cAAd,EAA8BC,OAAOC,SAAP,CAAiB,cAAjB,CAA9B;AACA,EAJsC;AAKvCC,OALuC,cAK9B;AACR,SAAOC,YAAYC,MAAZ,CAAmB,MAAnB,EAA2B;AACjCC,WAAQ,cADyB;AAEjCC,cAAWC,EAAE,cAAF;AAFsB,GAA3B,CAAP;AAIA;AAVsC,CAAxC;AAaAZ,WAAWC,KAAX,CAAiB,yBAAjB,EAA4C;AAC3CC,OAAM,wBADqC;AAE3CC,cAF2C,cAE3B;AACf,OAAKC,QAAL,CAAc,cAAd,EAA8BC,OAAOC,SAAP,CAAiB,cAAjB,CAA9B;AACA,EAJ0C;AAK3CC,OAL2C,cAKlC;AACR,SAAOC,YAAYC,MAAZ,CAAmB,MAAnB,EAA2B;AACjCC,WAAQ,iBADyB;AAEjCC,cAAWC,EAAE,iBAAF;AAFsB,GAA3B,CAAP;AAIA;AAV0C,CAA5C;AAaAZ,WAAWC,KAAX,CAAiB,mCAAjB,EAAsD;AACrDC,OAAM,6BAD+C;AAErDC,cAFqD,cAErC;AACf,OAAKC,QAAL,CAAc,cAAd,EAA8BC,OAAOC,SAAP,CAAiB,cAAjB,CAA9B;AACA,EAJoD;AAKrDC,OALqD,YAK9CM,MAL8C,EAKtC;AACd,SAAOL,YAAYC,MAAZ,CAAmB,MAAnB,EAA2B;AACjCC,WAAQ,uBADyB;AAEjCC,cAAWC,EAAE,8BAAF,CAFsB;AAGjCE,iBAAc,sBAHmB;AAIjCD;AAJiC,GAA3B,CAAP;AAMA;AAZoD,CAAtD;AAeAb,WAAWC,KAAX,CAAiB,mCAAjB,EAAsD;AACrDC,OAAM,6BAD+C;AAErDK,OAFqD,YAE9CM,MAF8C,EAEtC;AACd,SAAOL,YAAYC,MAAZ,CAAmB,MAAnB,EAA2B;AACjCC,WAAQ,sBADyB;AAEjCC,cAAWC,EAAE,8BAAF,CAFsB;AAGjCC;AAHiC,GAA3B,CAAP;AAKA;AARoD,CAAtD;AAWAb,WAAWC,KAAX,CAAiB,2CAAjB,EAA8D;AAC7DC,OAAM,qCADuD;AAE7DK,OAF6D,YAEtDM,MAFsD,EAE9C;AACd,SAAOL,YAAYC,MAAZ,CAAmB,MAAnB,EAA2B;AACjCC,WAAQ,6BADyB;AAEjCC,cAAWC,EAAE,sCAAF,CAFsB;AAGjCC;AAHiC,GAA3B,CAAP;AAKA;AAR4D,CAA9D,2H;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpDA,IAAIE,eAAJ;AAAWC,OAAOC,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACJ,WAAOI,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAGXC,SAAS9C,YAAT,CAAsB+C,OAAtB,CAA8B;AAC7BC,cAD6B,cACb;AACf,SAAOjD,WAAWyB,KAAX,CAAiBC,uBAAjB,CAAyC,CAAC,qBAAD,EAAwB,yBAAxB,CAAzC,CAAP;AACA,EAH4B;AAI7BzB,aAJ6B,cAId;AACd,SAAOe,iBAAiBkC,IAAjB,EAAP;AACA,EAN4B;AAO7BC,aAP6B,YAOhBC,IAPgB,EAOV;AAClB,SAAOV,OAAOU,IAAP,EAAaC,MAAb,CAAoB,MAApB,CAAP;AACA,EAT4B;AAU7BC,cAV6B,YAUfC,KAVe,EAUR;AACpB,SAAOC,QAAQC,EAAR,CAAWzD,WAAWC,YAAX,CAAwBC,cAAxB,CAAuCqD,KAAvC,EAA8CnD,KAAzD,CAAP;AACA;AAZ4B,CAA9B,0H;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHA2C,SAASW,eAAT,CAAyBV,OAAzB,CAAiC;AAChCC,cADgC,cAChB;AACf,SAAOjD,WAAWyB,KAAX,CAAiBC,uBAAjB,CAAyC,CAAC,qBAAD,EAAwB,yBAAxB,CAAzC,CAAP;AACA;AAH+B,CAAjC,0H;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA,IAAIiC,aAAJ;AAAShB,OAAOC,KAAP,CAAaC,QAAQ,cAAR,CAAb,EAAqC;AAAA,sBAASC,CAAT,EAAW;AAACa,SAAKb,CAAL;AAAO;AAAnB,CAArC,EAA0D,CAA1D;AAA6D,IAAIc,eAAJ;AAAWjB,OAAOC,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACc,WAAOd,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAKjFC,SAASc,oBAAT,CAA8BC,SAA9B;AAAwC,UAASC,8BAAT,GAA0C;AACjF,SAAO,KAAKC,MAAL,GAAc,IAAIC,WAAJ,CAAgB;AACpCC,aAAU;AAD0B,GAAhB,CAArB;AAGA;;AAJD,QAAiDH,8BAAjD;AAAA;AAMAhB,SAASc,oBAAT,CAA8Bb,OAA9B,CAAsC;AACrCC,cADqC,cACrB;AACf,SAAOjD,WAAWyB,KAAX,CAAiBC,uBAAjB,CAAyC,CAAC,qBAAD,EAAwB,yBAAxB,CAAzC,CAAP;AACA,EAHoC;AAKrCyC,KALqC,cAK9B;AACN,MAAM3B,SAASO,SAASqB,QAAT,GAAoBD,IAApB,CAAyB3B,MAAzB,GAAkCO,SAASqB,QAAT,GAAoBD,IAApB,CAAyB3B,MAAzB,EAAlC,GAAsE6B,SAArF;;AAEA,MAAI7B,UAAUA,OAAO8B,EAArB,EAAyB;AACxB,OAAIH,aAAJ;;AACA,OAAInE,WAAWyB,KAAX,CAAiB8C,gBAAjB,CAAkC,qBAAlC,CAAJ,EAA8D;AAC7DJ,WAAOnD,iBAAiBwD,OAAjB,CAAyB;AAAEC,UAAKjC,OAAO8B;AAAd,KAAzB,CAAP;AACA,IAFD,MAEO,IAAItE,WAAWyB,KAAX,CAAiB8C,gBAAjB,CAAkC,yBAAlC,CAAJ,EAAkE;AACxEJ,WAAOnD,iBAAiBwD,OAAjB,CAAyB;AAACC,UAAKjC,OAAO8B,EAAb;AAAiB,uBAAkBtC,OAAO0C,MAAP;AAAnC,KAAzB,CAAP;AACA;;AAED,OAAIP,IAAJ,EAAU;AACT,QAAMQ,gBAAoBR,KAAKM,GAAzB,SAAkCN,KAAKS,KAA7C;AACAT,SAAKU,GAAL,GAAW7C,OAAO8C,WAAP,YAA6BH,aAA7B,CAAX;AACAR,SAAKQ,aAAL,GAAqBA,aAArB;AACA5B,aAASqB,QAAT,GAAoBJ,MAApB,CAA2Be,GAA3B,CAA+BZ,IAA/B;AACA,WAAOA,IAAP;AACA;AACD;;AAED,SAAOpB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BgB,QAAlC;AACA,EA1BoC;AA4BrCC,QA5BqC,cA4B3B;AACT,MAAMjB,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;AACA,SAAO;AACNT,QAAKU,OAAOb,EAAP,EADC;AAENc,UAAOpB,OAAOoB,KAFR;AAGNC,UAAOrB,OAAOqB,KAHR;AAINC,WAAQtB,OAAOsB,MAJT;AAKNC,QAAK,iBALC;AAMNC,QAAK;AACJC,OAAGN,OAAOb,EAAP;AADC,IANC;AASNoB,cAAW,KATL;AAUNC,gBAAa,CAAC;AACbC,WAAO,aADM;AAEbC,gBAAY,qBAFC;AAGbC,UAAM,wCAHO;AAIbC,eAAW,uCAJE;AAKbC,WAAO;AALM,IAAD,CAVP;AAiBNC,OAAI,IAAIC,IAAJ,EAjBE;AAkBNC,MAAG;AACF1B,SAAKU,OAAOb,EAAP,EADH;AAEFJ,cAAUF,OAAOE;AAFf;AAlBG,GAAP;AAuBA,EArDoC;AAuDrCkC,YAvDqC,cAuDvB;AACb,MAAMpC,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;AACA,MAAMf,OAAO;AACZD,aAAUF,OAAOoB,KADL;AAEZiB,eAAYrC,OAAOqB,KAFP;AAGZiB,aAAUtC,OAAOsB,MAHL;AAIZQ,SAAM,iBAJM;AAKZH,gBAAa,CAAC;AACbC,WAAO,aADM;AAEbC,gBAAY,qBAFC;AAGbC,UAAM,wCAHO;AAIbC,eAAW,uCAJE;AAKbC,WAAO;AALM,IAAD;AALD,GAAb;AAcA,MAAMO,cAAc,CAAC,IAAD,EAAO,EAAP,CAApB;AACAC,SAAOC,IAAP,CAAYtC,IAAZ,EAAkBuC,OAAlB,CAA0B,UAACC,GAAD,EAAS;AAClC,OAAIJ,YAAYK,QAAZ,CAAqBzC,KAAKwC,GAAL,CAArB,CAAJ,EAAqC;AACpC,WAAOxC,KAAKwC,GAAL,CAAP;AACA;AACD,GAJD;AAMA,SAAOhD,KAAKkD,SAAL,CAAe,MAAf,EAAuBC,KAAKC,SAAL,CAAe5C,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAAvB,EAAsD9D,KAA7D;AACA,EA/EoC;AAiFrC2G,KAjFqC,cAiF9B;AACN,MAAMhD,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;;AAEA,MAAI,CAAClB,OAAOa,GAAZ,EAAiB;AAChB;AACA;;AAED,MAAMV,OAAO;AACZD,aAAUF,OAAOoB,KADL;AAEZiB,eAAYrC,OAAOqB,KAFP;AAGZiB,aAAUtC,OAAOsB,MAHL;AAIZQ,SAAM,iBAJM;AAKZH,gBAAa,CAAC;AACbC,WAAO,aADM;AAEbC,gBAAY,qBAFC;AAGbC,UAAM,wCAHO;AAIbC,eAAW,uCAJE;AAKbC,WAAO;AALM,IAAD;AALD,GAAb;AAcA,MAAMO,cAAc,CAAC,IAAD,EAAO,EAAP,CAApB;AACAC,SAAOC,IAAP,CAAYtC,IAAZ,EAAkBuC,OAAlB,CAA0B,UAACC,GAAD,EAAS;AAClC,OAAIJ,YAAYK,QAAZ,CAAqBzC,KAAKwC,GAAL,CAArB,CAAJ,EAAqC;AACpC,WAAOxC,KAAKwC,GAAL,CAAP;AACA;AACD,GAJD;AAMA,uEAAoEG,KAAKC,SAAL,CAAe5C,IAAf,CAApE,UAA+FH,OAAOa,GAAtG;AACA,EA9GoC;AAgHrCoC,cAhHqC,cAgHrB;AACf,SAAO;AACNC,gBAAa,IADP;AAENC,SAAM,YAFA;AAGNC,YAAS,CACR;AACA,2BAFQ,EAGR,uBAHQ,CAHH;AAQN;AACAC,eAAY,IATN;AAUN;AACAC,kBAAe,IAXT;AAYNC,sBAAmB,IAZb;AAaNC,cAAW,IAbL;AAcNC,sBAAmB,IAdb;AAeNC,8BAA2B;AAfrB,GAAP;AAiBA;AAlIoC,CAAtC;AAqIA3E,SAASc,oBAAT,CAA8B8D,MAA9B,CAAqC;AACpC,eAAc,UAACC,CAAD,EAAIrF,CAAJ,EAAU;AACvB,MAAMlC,QAAQkC,EAAEyB,MAAF,CAASgB,QAAT,IAAqB,EAAnC;AAEA3E,QAAMwB,IAAN,GAAagG,EAAE,aAAF,EAAiBC,GAAjB,GAAuBC,IAAvB,EAAb;AACA1H,QAAM+E,KAAN,GAAcyC,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAd;AACA1H,QAAMgF,KAAN,GAAcwC,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAd;AACA1H,QAAMiF,MAAN,GAAeuC,EAAE,eAAF,EAAmBC,GAAnB,GAAyBC,IAAzB,EAAf;AACA1H,QAAME,OAAN,GAAgBsH,EAAE,gBAAF,EAAoBC,GAApB,GAA0BC,IAA1B,EAAhB;AACA1H,QAAM6D,QAAN,GAAiB2D,EAAE,iBAAF,EAAqBC,GAArB,GAA2BC,IAA3B,EAAjB;AAEAxF,IAAEyB,MAAF,CAASe,GAAT,CAAa1E,KAAb;AACA,EAZmC;AAcpC,4BAA2B,YAAM;AAChC,MAAMmC,SAASO,SAASqB,QAAT,GAAoBD,IAApB,CAAyB3B,MAAzB,EAAf;AAEAwF,OAAK;AACJpC,UAAOrD,EAAE,cAAF,CADH;AAEJuD,SAAMvD,EAAE,iCAAF,CAFF;AAGJ0F,SAAM,SAHF;AAIJC,qBAAkB,IAJd;AAKJC,uBAAoB,SALhB;AAMJC,sBAAmB7F,EAAE,eAAF,CANf;AAOJ8F,qBAAkB9F,EAAE,QAAF,CAPd;AAQJ+F,mBAAgB,KARZ;AASJC,SAAM;AATF,GAAL,EAUG,YAAM;AACRvG,UAAOwG,IAAP,CAAY,2BAAZ,EAAyChG,OAAO8B,EAAhD,EAAoD,UAACmE,GAAD,EAAS;AAC5D,QAAIA,GAAJ,EAAS;AACRC,iBAAYD,GAAZ;AACA,KAFD,MAEO;AACNT,UAAK;AACJpC,aAAOrD,EAAE,SAAF,CADH;AAEJuD,YAAMvD,EAAE,6BAAF,CAFF;AAGJ0F,YAAM,SAHF;AAIJU,aAAO,IAJH;AAKJC,yBAAmB;AALf,MAAL;AAQAjH,gBAAWkH,EAAX,CAAc,oBAAd;AACA;AACD,IAdD;AAeA,GA1BD;AA2BA,EA5CmC;AA8CpC,6BAA4B,YAAM;AACjC,MAAMC,gBAAgBjB,EAAE,kBAAF,CAAtB;AACAiB,gBAAcC,QAAd,CAAuB,qDAAvB;AACAD,gBAAc5F,IAAd,CAAmB,aAAnB,EAAkC,CAAlC,EAAqC8F,UAArC,CAAgDC,OAAhD;AACA,EAlDmC;AAoDpC,0BAAyB,YAAM;AAC9B,MAAMH,gBAAgBjB,EAAE,kBAAF,CAAtB;AACAiB,gBAAcI,WAAd,CAA0B,qDAA1B;AACAJ,gBAAc5F,IAAd,CAAmB,aAAnB,EAAkC,CAAlC,EAAqC8F,UAArC,CAAgDC,OAAhD;AACA,EAxDmC;AA0DpC,0BAAyB,YAAM;AAC9B,MAAME,UAAUtB,EAAE,wBAAF,EAA4BC,GAA5B,GAAkCC,IAAlC,EAAhB;AACA,MAAMlG,OAAOgG,EAAE,aAAF,EAAiBC,GAAjB,GAAuBC,IAAvB,EAAb;AACA,MAAM3C,QAAQyC,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAd;AACA,MAAM1C,QAAQwC,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAd;AACA,MAAMzC,SAASuC,EAAE,eAAF,EAAmBC,GAAnB,GAAyBC,IAAzB,EAAf;AACA,MAAMxH,UAAUsH,EAAE,gBAAF,EAAoBC,GAApB,GAA0BC,IAA1B,EAAhB;AACA,MAAM7D,WAAW2D,EAAE,iBAAF,EAAqBC,GAArB,GAA2BC,IAA3B,EAAjB;AACA,MAAMqB,gBAAgBvB,EAAE,8BAAF,EAAkCC,GAAlC,GAAwCC,IAAxC,EAAtB;AACA,MAAMsB,SAASxB,EAAE,eAAF,EAAmBC,GAAnB,GAAyBC,IAAzB,EAAf;;AAEA,MAAIxH,YAAY,EAAhB,EAAoB;AACnB,UAAOqD,OAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,8BAAX,CAAb,CAAP;AACA;;AAED,MAAIS,aAAa,EAAjB,EAAqB;AACpB,UAAON,OAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,0BAAX,CAAb,CAAP;AACA;;AAED,MAAM8F,cAAc;AACnBJ,YAASA,YAAY,GADF;AAEnB5I,mBAFmB;AAGnB6E,UAAOA,UAAU,EAAV,GAAeA,KAAf,GAAuBf,SAHX;AAInBgB,UAAOA,UAAU,EAAV,GAAeA,KAAf,GAAuBhB,SAJX;AAKnBiB,WAAQA,WAAW,EAAX,GAAgBA,MAAhB,GAAyBjB,SALd;AAMnBxC,SAAMA,SAAS,EAAT,GAAcA,IAAd,GAAqBwC,SANR;AAOnBgF,WAAQA,WAAW,EAAX,GAAgBA,MAAhB,GAAyBhF,SAPd;AAQnB+E,kBAAeA,kBAAkB;AARd,GAApB;AAWA,MAAM5G,SAASO,SAASqB,QAAT,GAAoBD,IAApB,CAAyB3B,MAAzB,GAAkCO,SAASqB,QAAT,GAAoBD,IAApB,CAAyB3B,MAAzB,EAAlC,GAAsE6B,SAArF;;AACA,MAAI7B,UAAUA,OAAO8B,EAArB,EAAyB;AACxBtC,UAAOwG,IAAP,CAAY,2BAAZ,EAAyChG,OAAO8B,EAAhD,EAAoDiF,WAApD,EAAiE,UAACd,GAAD,EAAS;AACzE,QAAIA,GAAJ,EAAS;AACR,YAAOC,YAAYD,GAAZ,CAAP;AACA;;AAED7E,WAAO4F,OAAP,CAAehG,QAAQC,EAAR,CAAW,qBAAX,CAAf;AACA,IAND;AAOA,GARD,MAQO;AACN8F,eAAYrF,QAAZ,GAAuBA,QAAvB;AAEAlC,UAAOwG,IAAP,CAAY,wBAAZ,EAAsCe,WAAtC,EAAmD,UAACd,GAAD,EAAMtE,IAAN,EAAe;AACjE,QAAIsE,GAAJ,EAAS;AACR,YAAOC,YAAYD,GAAZ,CAAP;AACA;;AAED7E,WAAO4F,OAAP,CAAehG,QAAQC,EAAR,CAAW,mBAAX,CAAf;AACA9B,eAAWkH,EAAX,CAAc,6BAAd,EAA6C;AAAEvE,SAAIH,KAAKM;AAAX,KAA7C;AACA,IAPD;AAQA;AACD;AA7GmC,CAArC,4H;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChJA,IAAId,aAAJ;AAAShB,OAAOC,KAAP,CAAaC,QAAQ,cAAR,CAAb,EAAqC;AAAA,sBAASC,CAAT,EAAW;AAACa,SAAKb,CAAL;AAAO;AAAnB,CAArC,EAA0D,CAA1D;AAA6D,IAAIc,eAAJ;AAAWjB,OAAOC,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACc,WAAOd,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAKjFC,SAAS0G,oBAAT,CAA8B3F,SAA9B;AAAwC,UAAS4F,8BAAT,GAA0C;AAAA;;AACjF,OAAK1F,MAAL,GAAc,IAAIC,WAAJ,CAAgB;AAC7BC,aAAU,YADmB;AAE7BU,UAAOO,OAAOb,EAAP,CAAU,EAAV,CAFsB;AAG7BqF,qBAAkB,IAHW;AAI7BC,eAAY,CAJiB;AAK7BC,eAAY,eALiB;AAM7BC,eAAY;AANiB,GAAhB,CAAd;;AASA,OAAKC,YAAL,GAAoB,YAAM;AACzB,SAAK/F,MAAL,CAAYe,GAAZ,CAAgB;AACfoE,aAAStB,EAAE,wBAAF,EAA4BC,GAA5B,GAAkCC,IAAlC,OAA6C,GADvC;AAEfxE,WAAOsE,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAFQ;AAGflG,UAAMgG,EAAE,aAAF,EAAiBC,GAAjB,GAAuBC,IAAvB,EAHS;AAIf3C,WAAOyC,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAJQ;AAKf1C,WAAOwC,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EALQ;AAMfzC,YAAQuC,EAAE,eAAF,EAAmBC,GAAnB,GAAyBC,IAAzB,EANO;AAOfxH,aAASsH,EAAE,gBAAF,EAAoBC,GAApB,KAA2BD,EAAE,gBAAF,EAAoBC,GAApB,GAA0BC,IAA1B,EAA3B,GAA8D1D,SAPxD;AAQfH,cAAU2D,EAAE,iBAAF,EAAqBC,GAArB,GAA2BC,IAA3B,EARK;AASfvH,kBAAcqH,EAAE,qBAAF,EAAyBC,GAAzB,KAAiCD,EAAE,qBAAF,EAAyBC,GAAzB,GAA+BC,IAA/B,EAAjC,GAAyE1D,SATxE;AAUf2F,UAAMnC,EAAE,aAAF,EAAiBC,GAAjB,GAAuBC,IAAvB,EAVS;AAWfnD,WAAOiD,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAXQ;AAYfqB,mBAAevB,EAAE,8BAAF,EAAkCC,GAAlC,GAAwCC,IAAxC,OAAmD,GAZnD;AAafsB,YAAQxB,EAAE,eAAF,EAAmBC,GAAnB,GAAyBC,IAAzB,EAbO;AAcftH,gBAAYoH,EAAE,mBAAF,EAAuBC,GAAvB,KAA+BD,EAAE,mBAAF,EAAuBC,GAAvB,GAA6BC,IAA7B,EAA/B,GAAqE1D,SAdlE;AAef4F,yBAAqBpC,EAAE,4BAAF,EAAgCC,GAAhC,KAAwCD,EAAE,4BAAF,EAAgCC,GAAhC,GAAsCC,IAAtC,EAAxC,GAAuF1D,SAf7F;AAgBfsF,sBAAkB9B,EAAE,iCAAF,EAAqCC,GAArC,GAA2CC,IAA3C,OAAsD,GAhBzD;AAiBf6B,gBAAY/B,EAAE,mBAAF,EAAuBC,GAAvB,KAA+BD,EAAE,mBAAF,EAAuBC,GAAvB,GAA6BC,IAA7B,EAA/B,GAAqE,CAjBlE;AAkBf8B,gBAAYhC,EAAE,mBAAF,EAAuBC,GAAvB,KAA+BD,EAAE,mBAAF,EAAuBC,GAAvB,GAA6BC,IAA7B,EAA/B,GAAqE,eAlBlE;AAmBf+B,gBAAYjC,EAAE,2BAAF,EAA+BC,GAA/B,GAAqCC,IAArC,OAAgD;AAnB7C,IAAhB;AAqBA,GAtBD;;AAwBA,OAAKmC,OAAL,CAAa,YAAM;AAClB,OAAM5F,KAAK,MAAKH,IAAL,IAAa,MAAKA,IAAL,CAAU3B,MAAvB,IAAiC,MAAK2B,IAAL,CAAU3B,MAAV,GAAmB8B,EAA/D;;AAEA,OAAIA,EAAJ,EAAQ;AACP,QAAM6F,MAAM,MAAKlI,SAAL,CAAe,cAAf,CAAZ;;AACA,QAAIkI,IAAIC,KAAJ,EAAJ,EAAiB;AAChB,SAAIC,kBAAJ;;AAEA,SAAIrK,WAAWyB,KAAX,CAAiB8C,gBAAjB,CAAkC,qBAAlC,CAAJ,EAA8D;AAC7D8F,kBAAYrJ,iBAAiBwD,OAAjB,CAAyB;AAAEC,YAAKH;AAAP,OAAzB,CAAZ;AACA,MAFD,MAEO,IAAItE,WAAWyB,KAAX,CAAiB8C,gBAAjB,CAAkC,yBAAlC,CAAJ,EAAkE;AACxE8F,kBAAYrJ,iBAAiBwD,OAAjB,CAAyB;AAAEC,YAAKH,EAAP;AAAW,yBAAkBtC,OAAO0C,MAAP;AAA7B,OAAzB,CAAZ;AACA;;AAED,SAAI2F,SAAJ,EAAe;AACd,YAAKrG,MAAL,CAAYe,GAAZ,CAAgBsF,SAAhB;AACA,MAFD,MAEO;AACNzG,aAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,sBAAX,CAAb;AACA9B,iBAAWkH,EAAX,CAAc,oBAAd;AACA;AACD;AACD;AACD,GAtBD;AAuBA;;AAzDD,QAAiDa,8BAAjD;AAAA;AA2DA3G,SAAS0G,oBAAT,CAA8BzG,OAA9B,CAAsC;AACrCsH,KADqC,YAChCC,GADgC,EAC3BC,GAD2B,EACtB;AACd,MAAI,CAACD,GAAD,IAAQ,CAACA,IAAID,IAAjB,EAAuB;AACtB,UAAOC,GAAP;AACA;;AAED,SAAOA,IAAID,IAAJ,CAASE,GAAT,CAAP;AACA,EAPoC;AASrCC,kBATqC,cASjB;AACnB,SAAO,KAAKjI,MAAL,IAAe,KAAKA,MAAL,EAAf,IAAgC,OAAO,KAAKA,MAAL,GAAc8B,EAArB,KAA4B,WAAnE;AACA,EAXoC;AAarCrB,cAbqC,cAarB;AACf,SAAOjD,WAAWyB,KAAX,CAAiBC,uBAAjB,CAAyC,CAAC,qBAAD,EAAwB,yBAAxB,CAAzC,CAAP;AACA,EAfoC;AAiBrCyC,KAjBqC,cAiB9B;AACN,SAAOpB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAP;AACA,EAnBoC;AAqBrCwF,UArBqC,cAqBzB;AACX,SAAO,KAAKlI,MAAL,IAAe,KAAKA,MAAL,EAAf,IAAgC,OAAO,KAAKA,MAAL,GAAc8B,EAArB,KAA4B,WAAnE;AACA,EAvBoC;AAyBrCqG,WAzBqC,cAyBxB;AACZ,SAAOnE,OAAOoE,MAAP,CAAc5K,WAAWC,YAAX,CAAwBC,cAAtC,CAAP;AACA,EA3BoC;AA6BrC2K,gBA7BqC,cA6BnB;AACjB,MAAM7G,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;AAEA,SAAO,OAAOlB,OAAOT,KAAd,KAAwB,QAAxB,IAAoCS,OAAOT,KAAP,KAAiB,EAA5D;AACA,EAjCoC;AAmCrCuH,qBAnCqC,cAmCd;AACtB,MAAM9G,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;AAEA,SAAO,OAAOlB,OAAOT,KAAd,KAAwB,QAAxB,IAAoCvD,WAAWC,YAAX,CAAwBC,cAAxB,CAAuC8D,OAAOT,KAA9C,EAAqDjD,GAArD,CAAyDC,OAApG;AACA,EAvCoC;AAyCrCwK,0BAzCqC,cAyCT;AAC3B,MAAM/G,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;AAEA,SAAO,OAAOlB,OAAOT,KAAd,KAAwB,QAAxB,IAAoCvD,WAAWC,YAAX,CAAwBC,cAAxB,CAAuC8D,OAAOT,KAA9C,EAAqDjD,GAArD,CAAyDE,YAApG;AACA,EA7CoC;AA+CrCwK,wBA/CqC,cA+CX;AACzB,MAAMhH,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;AAEA,SAAO,OAAOlB,OAAOT,KAAd,KAAwB,QAAxB,IAAoCvD,WAAWC,YAAX,CAAwBC,cAAxB,CAAuC8D,OAAOT,KAA9C,EAAqDjD,GAArD,CAAyDG,UAApG;AACA,EAnDoC;AAqDrCwE,QArDqC,cAqD3B;AACT,MAAMjB,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;AAEA,SAAO;AACNT,QAAKU,OAAOb,EAAP,EADC;AAENc,UAAOpB,OAAOoB,KAFR;AAGNC,UAAOrB,OAAOqB,KAHR;AAINC,WAAQtB,OAAOsB,MAJT;AAKNC,QAAK,eALC;AAMNC,QAAK;AACJC,OAAGN,OAAOb,EAAP;AADC,IANC;AASNoB,cAAW,KATL;AAUNC,gBAAa,CAAC;AACbC,WAAO,aADM;AAEbC,gBAAY,qBAFC;AAGbC,UAAM,wCAHO;AAIbC,eAAW,uCAJE;AAKbC,WAAO;AALM,IAAD,CAVP;AAiBNC,OAAI,IAAIC,IAAJ,EAjBE;AAkBNC,MAAG;AACF1B,SAAKU,OAAOb,EAAP,EADH;AAEFJ,cAAUF,OAAOE;AAFf;AAlBG,GAAP;AAuBA,EA/EoC;AAiFrCkC,YAjFqC,cAiFvB;AACb,MAAMpC,SAASjB,SAASqB,QAAT,GAAoBJ,MAApB,CAA2BkB,GAA3B,EAAf;AACA,MAAMf,OAAO;AACZD,aAAUF,OAAOoB,KADL;AAEZiB,eAAYrC,OAAOqB,KAFP;AAGZiB,aAAUtC,OAAOsB,MAHL;AAIZQ,SAAM,eAJM;AAKZH,gBAAa,CAAC;AACbC,WAAO,aADM;AAEbC,gBAAY,qBAFC;AAGbC,UAAM,wCAHO;AAIbC,eAAW,uCAJE;AAKbC,WAAO;AALM,IAAD;AALD,GAAb;AAcA,MAAMO,cAAc,CAAC,IAAD,EAAO,EAAP,CAApB;AACAC,SAAOC,IAAP,CAAYtC,IAAZ,EAAkBuC,OAAlB,CAA0B,UAACC,GAAD,EAAS;AAClC,OAAIJ,YAAYK,QAAZ,CAAqBzC,KAAKwC,GAAL,CAArB,CAAJ,EAAqC;AACpC,WAAOxC,KAAKwC,GAAL,CAAP;AACA;AACD,GAJD;AAMA,SAAOhD,KAAKkD,SAAL,CAAe,MAAf,EAAuBC,KAAKC,SAAL,CAAe5C,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAAvB,EAAsD9D,KAA7D;AACA,EAzGoC;AA2GrC4G,cA3GqC,cA2GrB;AACf,SAAO;AACNC,gBAAa,IADP;AAENC,SAAM,YAFA;AAGNC,YAAS,CACR;AACA,2BAFQ,EAGR,uBAHQ,CAHH;AAQN;AACAC,eAAY,IATN;AAUN;AACAC,kBAAe,IAXT;AAYNC,sBAAmB,IAZb;AAaNC,cAAW,IAbL;AAcNC,sBAAmB,IAdb;AAeNC,8BAA2B;AAfrB,GAAP;AAiBA;AA7HoC,CAAtC;AAgIA3E,SAAS0G,oBAAT,CAA8B9B,MAA9B,CAAqC;AACpC,eAAc,UAACC,CAAD,EAAIrF,CAAJ,EAAU;AACvBA,IAAEwH,YAAF;AACA,EAHmC;AAKpC,4BAA2B,UAACnC,CAAD,EAAIrF,CAAJ,EAAU;AACpCA,IAAEwH,YAAF;AACA,EAPmC;AASpC,8BAA6B,UAACnC,CAAD,EAAIrF,CAAJ,EAAU;AACtC,MAAMyB,SAASzB,EAAEyB,MAAF,CAASkB,GAAT,EAAf;AACAlB,SAAOT,KAAP,GAAesE,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAf;AAEAxF,IAAEyB,MAAF,CAASe,GAAT,CAAaf,MAAb;AACA,EAdmC;AAgBpC,0BAAyB,YAAM;AAC9BrC,aAAWkH,EAAX,mCAA+ClH,WAAWsJ,QAAX,CAAoB,IAApB,CAA/C;AACA,EAlBmC;AAoBpC,kBAAiB,UAACrD,CAAD,EAAO;AACvBC,IAAED,EAAEsD,aAAJ,EAAmBC,OAAnB,CAA2B,UAA3B,EAAuCjC,WAAvC,CAAmD,mBAAnD;AACArB,IAAED,EAAEsD,aAAJ,EAAmBC,OAAnB,CAA2B,QAA3B,EAAqCjC,WAArC,CAAiD,QAAjD,EAA2DH,QAA3D,CAAoE,UAApE,EAAgF7F,IAAhF,CAAqF,MAArF,EAA6F4C,IAA7F,CAAkGtC,QAAQC,EAAR,CAAW,UAAX,CAAlG;AACAoE,IAAE,aAAF,EAAiBuD,IAAjB,CAAsB,UAACC,KAAD,EAAQC,UAAR;AAAA,UAAuBA,WAAWtC,UAAX,CAAsBC,OAAtB,EAAvB;AAAA,GAAtB;AACA,EAxBmC;AA0BpC,oBAAmB,UAACrB,CAAD,EAAO;AACzBC,IAAED,EAAEsD,aAAJ,EAAmBC,OAAnB,CAA2B,UAA3B,EAAuCpC,QAAvC,CAAgD,mBAAhD;AACAlB,IAAED,EAAEsD,aAAJ,EAAmBC,OAAnB,CAA2B,QAA3B,EAAqCpC,QAArC,CAA8C,QAA9C,EAAwDG,WAAxD,CAAoE,UAApE,EAAgFhG,IAAhF,CAAqF,MAArF,EAA6F4C,IAA7F,CAAkGtC,QAAQC,EAAR,CAAW,QAAX,CAAlG;AACA,EA7BmC;AA+BpC,4BAA2B,YAAM;AAChC,MAAMjB,SAASO,SAASqB,QAAT,GAAoBD,IAApB,CAAyB3B,MAAzB,EAAf;AAEAwF,OAAK;AACJpC,UAAOrD,EAAE,cAAF,CADH;AAEJuD,SAAMvD,EAAE,iCAAF,CAFF;AAGJ0F,SAAM,SAHF;AAIJC,qBAAkB,IAJd;AAKJC,uBAAoB,SALhB;AAMJC,sBAAmB7F,EAAE,eAAF,CANf;AAOJ8F,qBAAkB9F,EAAE,QAAF,CAPd;AAQJ+F,mBAAgB,KARZ;AASJC,SAAM;AATF,GAAL,EAUG,YAAM;AACRvG,UAAOwG,IAAP,CAAY,2BAAZ,EAAyChG,OAAO8B,EAAhD,EAAoD,UAACmE,GAAD,EAAS;AAC5D,QAAIA,GAAJ,EAAS;AACRC,iBAAYD,GAAZ;AACA,KAFD,MAEO;AACNT,UAAK;AACJpC,aAAOrD,EAAE,SAAF,CADH;AAEJuD,YAAMvD,EAAE,6BAAF,CAFF;AAGJ0F,YAAM,SAHF;AAIJU,aAAO,IAJH;AAKJC,yBAAmB;AALf,MAAL;AAQAjH,gBAAWkH,EAAX,CAAc,oBAAd;AACA;AACD,IAdD;AAeA,GA1BD;AA2BA,EA7DmC;AA+DpC,6BAA4B,YAAM;AACjChB,IAAE,kBAAF,EAAsBkB,QAAtB,CAA+B,qDAA/B;AACAlB,IAAE,aAAF,EAAiB,CAAjB,EAAoBmB,UAApB,CAA+BC,OAA/B;AACA,EAlEmC;AAoEpC,0BAAyB,YAAM;AAC9BpB,IAAE,kBAAF,EAAsBqB,WAAtB,CAAkC,qDAAlC;AACArB,IAAE,aAAF,EAAiB,CAAjB,EAAoBmB,UAApB,CAA+BC,OAA/B;AACA,EAvEmC;AAyEpC,0BAAyB,YAAM;AAC9B,MAAM1F,QAAQsE,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAd;AACA,MAAMoB,UAAUtB,EAAE,wBAAF,EAA4BC,GAA5B,GAAkCC,IAAlC,EAAhB;AACA,MAAMlG,OAAOgG,EAAE,aAAF,EAAiBC,GAAjB,GAAuBC,IAAvB,EAAb;AACA,MAAMwD,kBAAkB1D,EAAE,gCAAF,EAAoCC,GAApC,GAA0CC,IAA1C,EAAxB;AACA,MAAM3C,QAAQyC,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAd;AACA,MAAM1C,QAAQwC,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAd;AACA,MAAMzC,SAASuC,EAAE,eAAF,EAAmBC,GAAnB,GAAyBC,IAAzB,EAAf;AACA,MAAM7D,WAAW2D,EAAE,iBAAF,EAAqBC,GAArB,GAA2BC,IAA3B,EAAjB;AACA,MAAMnD,QAAQiD,EAAE,cAAF,EAAkBC,GAAlB,GAAwBC,IAAxB,EAAd;AACA,MAAMqB,gBAAgBvB,EAAE,8BAAF,EAAkCC,GAAlC,GAAwCC,IAAxC,EAAtB;AACA,MAAMsB,SAASxB,EAAE,eAAF,EAAmBC,GAAnB,GAAyBC,IAAzB,EAAf;AACA,MAAM4B,mBAAmB9B,EAAE,iCAAF,EAAqCC,GAArC,GAA2CC,IAA3C,EAAzB;AACA,MAAIiC,OAAOnC,EAAE,aAAF,EAAiBC,GAAjB,GAAuBC,IAAvB,EAAX;;AAEA,MAAI7D,aAAa,EAAb,IAAmBqH,oBAAoB,GAA3C,EAAgD;AAC/C,UAAO3H,OAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,0BAAX,CAAb,CAAP;AACA;;AAEDuG,SAAOA,KAAKwB,KAAL,CAAW,IAAX,EAAiBC,MAAjB,CAAwB,UAAC5G,GAAD;AAAA,UAASA,IAAIkD,IAAJ,OAAe,EAAxB;AAAA,GAAxB,CAAP;;AACA,MAAIiC,KAAK0B,MAAL,KAAgB,CAApB,EAAuB;AACtB,UAAO9H,OAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,oCAAX,CAAb,CAAP;AACA;;AAED,MAAIjD,qBAAJ;AACA,MAAIyJ,4BAAJ;AACA,MAAIH,mBAAJ;;AACA,MAAI9J,WAAWC,YAAX,CAAwBC,cAAxB,CAAuCqD,KAAvC,EAA8CjD,GAA9C,CAAkDE,YAAtD,EAAoE;AACnEA,kBAAeqH,EAAE,qBAAF,EAAyBC,GAAzB,GAA+BC,IAA/B,EAAf;AACAvH,kBAAeA,aAAagL,KAAb,CAAmB,GAAnB,EAAwBC,MAAxB,CAA+B,UAACE,IAAD;AAAA,WAAUA,KAAK5D,IAAL,OAAgB,EAA1B;AAAA,IAA/B,CAAf;AAEAkC,yBAAsBpC,EAAE,4BAAF,EAAgCC,GAAhC,GAAsCC,IAAtC,EAAtB;AACA+B,gBAAajC,EAAE,2BAAF,EAA+BC,GAA/B,GAAqCC,IAArC,EAAb;AACA;;AAED,MAAIxH,gBAAJ;;AACA,MAAIP,WAAWC,YAAX,CAAwBC,cAAxB,CAAuCqD,KAAvC,EAA8CjD,GAA9C,CAAkDC,OAAtD,EAA+D;AAC9DA,aAAUsH,EAAE,gBAAF,EAAoBC,GAApB,GAA0BC,IAA1B,EAAV;;AAEA,OAAI,CAACxH,OAAD,IAAYA,QAAQwH,IAAR,OAAmB,EAAnC,EAAuC;AACtC,WAAOnE,OAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,6BAAX,EAA0C;AAAEmI,YAAOpI,QAAQC,EAAR,CAAW,SAAX;AAAT,KAA1C,CAAb,CAAP;AACA;AACD;;AAED,MAAIhD,mBAAJ;;AACA,MAAIT,WAAWC,YAAX,CAAwBC,cAAxB,CAAuCqD,KAAvC,EAA8CjD,GAA9C,CAAkDG,UAAtD,EAAkE;AACjEA,gBAAaoH,EAAE,mBAAF,EAAuBC,GAAvB,GAA6BC,IAA7B,EAAb;;AAEA,OAAI,CAACtH,UAAD,IAAeA,WAAWsH,IAAX,OAAsB,EAAzC,EAA6C;AAC5C,WAAOnE,OAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,6BAAX,EAA0C;AAAEmI,YAAOpI,QAAQC,EAAR,CAAW,YAAX;AAAT,KAA1C,CAAb,CAAP;AACA;AACD;;AAED,MAAImG,mBAAJ;AACA,MAAIC,mBAAJ;;AACA,MAAIF,qBAAqB,GAAzB,EAA8B;AAC7BC,gBAAaiC,SAAShE,EAAE,mBAAF,EAAuBC,GAAvB,GAA6BC,IAA7B,EAAT,CAAb;AACA8B,gBAAahC,EAAE,mBAAF,EAAuBC,GAAvB,GAA6BC,IAA7B,EAAb;AACA;;AAED,MAAMwB,cAAc;AACnBhG,UAAOA,UAAU,EAAV,GAAeA,KAAf,GAAuBc,SADX;AAEnB8E,YAASA,YAAY,GAFF;AAGnBjF,qBAHmB;AAInB3D,YAASA,YAAY,EAAZ,GAAiBA,OAAjB,GAA2B8D,SAJjB;AAKnB5D,eAAYA,eAAe,EAAf,GAAoBA,UAApB,GAAiC4D,SAL1B;AAMnBe,UAAOA,UAAU,EAAV,GAAeA,KAAf,GAAuBf,SANX;AAOnBgB,UAAOA,UAAU,EAAV,GAAeA,KAAf,GAAuBhB,SAPX;AAQnBiB,WAAQA,WAAW,EAAX,GAAgBA,MAAhB,GAAyBjB,SARd;AASnBxC,SAAMA,SAAS,EAAT,GAAcA,IAAd,GAAqBwC,SATR;AAUnB7D,iBAAcA,iBAAiB,EAAjB,GAAsBA,YAAtB,GAAqC6D,SAVhC;AAWnB2F,SAAMA,SAAS,EAAT,GAAcA,IAAd,GAAqB3F,SAXR;AAYnBO,UAAOA,UAAU,EAAV,GAAeA,KAAf,GAAuBP,SAZX;AAanBgF,WAAQA,WAAW,EAAX,GAAgBA,MAAhB,GAAyBhF,SAbd;AAcnB+E,kBAAeA,kBAAkB,GAdd;AAenBmC,oBAAiBA,oBAAoB,GAflB;AAgBnB5B,qBAAkBA,qBAAqB,GAhBpB;AAiBnBC,eAAYA,aAAaA,UAAb,GAA0B,CAjBnB;AAkBnBC,eAAYA,aAAaA,UAAb,GAA0B,eAlBnB;AAmBnBI,wBAAqBA,wBAAwB,GAnB1B;AAoBnBH,eAAYA,eAAe;AApBR,GAApB;AAuBA,MAAMtH,SAASO,SAASqB,QAAT,GAAoBD,IAApB,CAAyB3B,MAAzB,GAAiCO,SAASqB,QAAT,GAAoBD,IAApB,CAAyB3B,MAAzB,EAAjC,GAAqE6B,SAApF;;AACA,MAAI7B,UAAUA,OAAO8B,EAArB,EAAyB;AACxBtC,UAAOwG,IAAP,CAAY,2BAAZ,EAAyChG,OAAO8B,EAAhD,EAAoDiF,WAApD,EAAiE,UAACd,GAAD,EAAS;AACzE,QAAIA,GAAJ,EAAS;AACR,YAAOC,YAAYD,GAAZ,CAAP;AACA;;AAED7E,WAAO4F,OAAP,CAAehG,QAAQC,EAAR,CAAW,qBAAX,CAAf;AACA,IAND;AAOA,GARD,MAQO;AACNzB,UAAOwG,IAAP,CAAY,wBAAZ,EAAsCe,WAAtC,EAAmD,UAACd,GAAD,EAAMtE,IAAN,EAAe;AACjE,QAAIsE,GAAJ,EAAS;AACR,YAAOC,YAAYD,GAAZ,CAAP;AACA;;AAED7E,WAAO4F,OAAP,CAAehG,QAAQC,EAAR,CAAW,mBAAX,CAAf;AACA9B,eAAWkH,EAAX,CAAc,6BAAd,EAA6C;AAAEvE,SAAIH,KAAKM;AAAX,KAA7C;AACA,IAPD;AAQA;AACD;AA/KmC,CAArC,4H;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChMA,IAAId,aAAJ;AAAShB,OAAOC,KAAP,CAAaC,QAAQ,cAAR,CAAb,EAAqC;AAAA,sBAASC,CAAT,EAAW;AAACa,SAAKb,CAAL;AAAO;AAAnB,CAArC,EAA0D,CAA1D;AAA6D,IAAIJ,eAAJ;AAAWC,OAAOC,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACJ,WAAOI,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAAyD,IAAIc,eAAJ;AAAWjB,OAAOC,KAAP,CAAaC,QAAQ,QAAR,CAAb,EAA+B;AAAA,sBAASC,CAAT,EAAW;AAACc,WAAOd,CAAP;AAAS;AAArB,CAA/B,EAAsD,CAAtD;AAMrJC,SAAS+I,2BAAT,CAAqChI,SAArC;AAA+C,UAASiI,qCAAT,GAAiD;AAAA;;AAC/F,OAAKC,OAAL,GAAe,IAAI/H,WAAJ,CAAgB,KAAhB,CAAf;AACA,OAAKgI,KAAL,GAAa,IAAIhI,WAAJ,CAAgB,EAAhB,CAAb;AACA,OAAKiG,OAAL,CAAa,YAAM;AAClB,OAAM5F,KAAK,MAAKH,IAAL,IAAa,MAAKA,IAAL,CAAU3B,MAAvB,IAAiC,MAAK2B,IAAL,CAAU3B,MAAV,GAAmB8B,EAA/D;;AAEA,OAAIA,EAAJ,EAAQ;AACP,QAAM6F,MAAM,MAAKlI,SAAL,CAAe,cAAf,CAAZ;;AACA,QAAIkI,IAAIC,KAAJ,EAAJ,EAAiB;AAChB,SAAIC,kBAAJ;;AAEA,SAAIrK,WAAWyB,KAAX,CAAiB8C,gBAAjB,CAAkC,qBAAlC,CAAJ,EAA8D;AAC7D8F,kBAAYrJ,iBAAiBwD,OAAjB,CAAyB;AAAEC,YAAKH;AAAP,OAAzB,CAAZ;AACA,MAFD,MAEO,IAAItE,WAAWyB,KAAX,CAAiB8C,gBAAjB,CAAkC,yBAAlC,CAAJ,EAAkE;AACxE8F,kBAAYrJ,iBAAiBwD,OAAjB,CAAyB;AAAEC,YAAKH,EAAP;AAAW,yBAAkBtC,OAAO0C,MAAP;AAA7B,OAAzB,CAAZ;AACA;;AAED,SAAI,CAAC2F,SAAL,EAAgB;AACfzG,aAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,sBAAX,CAAb;AACA9B,iBAAWkH,EAAX,CAAc,oBAAd;AACA;;AAED,SAAMqD,aAAa,MAAKjK,SAAL,CAAe,oBAAf,EAAqCoI,UAAU5F,GAA/C,EAAoD,MAAKwH,KAAL,CAAW/G,GAAX,EAApD,CAAnB;;AACA,SAAIgH,WAAW9B,KAAX,EAAJ,EAAwB;AACvB,UAAIjJ,uBAAuB+B,IAAvB,GAA8BiJ,KAA9B,KAAwC,MAAKF,KAAL,CAAW/G,GAAX,EAA5C,EAA8D;AAC7D,aAAK8G,OAAL,CAAajH,GAAb,CAAiB,IAAjB;AACA;AACD;AACD;AACD,IAvBD,MAuBO;AACNnB,WAAO0F,KAAP,CAAa9F,QAAQC,EAAR,CAAW,sBAAX,CAAb;AACA9B,eAAWkH,EAAX,CAAc,oBAAd;AACA;AACD,GA9BD;AA+BA;;AAlCD,QAAwDkD,qCAAxD;AAAA;AAoCAhJ,SAAS+I,2BAAT,CAAqC9I,OAArC,CAA6C;AAC5CC,cAD4C,cAC5B;AACf,SAAOjD,WAAWyB,KAAX,CAAiBC,uBAAjB,CAAyC,CAAC,qBAAD,EAAwB,yBAAxB,CAAzC,CAAP;AACA,EAH2C;AAK5CsK,QAL4C,cAKlC;AACT,SAAOjJ,SAASqB,QAAT,GAAoB4H,OAApB,CAA4B9G,GAA5B,EAAP;AACA,EAP2C;AAS5CkH,UAT4C,cAShC;AACX,SAAOjL,uBAAuB+B,IAAvB,GAA8BmJ,KAA9B,GAAsCC,IAAtC,CAA2C,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAC3D,OAAI,CAACD,EAAEE,UAAH,GAAgB,CAACD,EAAEC,UAAvB,EAAmC;AAClC,WAAO,CAAP;AACA;;AAED,OAAI,CAACF,EAAEE,UAAH,GAAgB,CAACD,EAAEC,UAAvB,EAAmC;AAClC,WAAO,CAAC,CAAR;AACA;;AAED,UAAO,CAAP;AACA,GAVM,CAAP;AAWA,EArB2C;AAuB5CC,YAvB4C,YAuBhCC,OAvBgC,EAuBvBC,QAvBuB,EAuBb;AAC9B,SAAO,OAAOD,QAAQC,QAAR,CAAP,KAA6B,WAA7B,IAA4CD,QAAQC,QAAR,KAAqB,IAAxE;AACA,EAzB2C;AA2B5CC,UA3B4C,YA2BlCF,OA3BkC,EA2BzB;AAClB,MAAI,OAAOA,QAAQrD,KAAf,KAAyB,WAAzB,IAAwCqD,QAAQrD,KAApD,EAA2D;AAC1D,UAAO,iCAAP;AACA,GAFD,MAEO,IAAIqD,QAAQG,QAAZ,EAAsB;AAC5B,UAAO,+BAAP;AACA,GAFM,MAEA;AACN,UAAO,mBAAP;AACA;AACD,EAnC2C;AAqC5CC,WArC4C,YAqCjCzD,KArCiC,EAqC1B;AACjB,SAAO,OAAOA,KAAP,KAAiB,WAAjB,IAAgCA,KAAhC,GAAwC9F,QAAQC,EAAR,CAAW,SAAX,CAAxC,GAAgED,QAAQC,EAAR,CAAW,SAAX,CAAvE;AACA,EAvC2C;AAyC5CuJ,WAzC4C,YAyCjC5J,IAzCiC,EAyC3B;AAChB,SAAOV,OAAOU,IAAP,EAAaC,MAAb,CAAoB,OAApB,CAAP;AACA,EA3C2C;AA6C5C4J,iBA7C4C,YA6C3B7J,IA7C2B,EA6CrB;AACtB,SAAOV,OAAOU,IAAP,EAAaC,MAAb,CAAoB,iBAApB,CAAP;AACA,EA/C2C;AAiD5C6J,cAjD4C,YAiD9B3J,KAjD8B,EAiDvB;AACpB,SAAOC,QAAQC,EAAR,CAAWzD,WAAWC,YAAX,CAAwBC,cAAxB,CAAuCqD,KAAvC,EAA8CnD,KAAzD,CAAP;AACA,EAnD2C;AAqD5C+M,cArD4C,YAqD9BhJ,IArD8B,EAqDxB;AACnB,SAAOA,OAAOR,KAAKkD,SAAL,CAAe,MAAf,EAAuBC,KAAKC,SAAL,CAAe5C,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAAvB,EAAsD9D,KAA7D,GAAqE,EAA5E;AACA,EAvD2C;AAyD5C+M,UAzD4C,YAyDlCC,UAzDkC,EAyDtB;AACrB,MAAI,CAACA,UAAL,EAAiB;AAChB,UAAO,EAAP;AACA,GAFD,MAEO,IAAI,QAAOA,UAAP,uDAAOA,UAAP,OAAsB,QAA1B,EAAoC;AAC1C,UAAO1J,KAAKkD,SAAL,CAAe,MAAf,EAAuBC,KAAKC,SAAL,CAAesG,UAAf,EAA2B,IAA3B,EAAiC,CAAjC,CAAvB,EAA4DhN,KAAnE;AACA,GAFM,MAEA;AACN,UAAOsD,KAAKkD,SAAL,CAAe,MAAf,EAAuBwG,UAAvB,EAAmChN,KAA1C;AACA;AACD,EAjE2C;AAmE5CiN,cAnE4C,cAmE5B;AACf,SAAO,KAAK9K,MAAL,IAAe,KAAKA,MAAL,EAAf,IAAgC,KAAKA,MAAL,GAAc8B,EAArD;AACA;AArE2C,CAA7C;AAwEAvB,SAAS+I,2BAAT,CAAqCnE,MAArC,CAA4C;AAC3C,kBAAiB,UAACC,CAAD,EAAO;AACvBC,IAAED,EAAEsD,aAAJ,EAAmBC,OAAnB,CAA2B,UAA3B,EAAuCjC,WAAvC,CAAmD,mBAAnD;AACArB,IAAED,EAAEsD,aAAJ,EAAmBC,OAAnB,CAA2B,QAA3B,EAAqCjC,WAArC,CAAiD,QAAjD,EAA2DH,QAA3D,CAAoE,UAApE,EAAgF7F,IAAhF,CAAqF,MAArF,EAA6F4C,IAA7F,CAAkGtC,QAAQC,EAAR,CAAW,UAAX,CAAlG;AACAoE,IAAE,aAAF,EAAiBuD,IAAjB,CAAsB,UAACC,KAAD,EAAQC,UAAR;AAAA,UAAuBA,WAAWtC,UAAX,CAAsBC,OAAtB,EAAvB;AAAA,GAAtB;AACA,EAL0C;AAO3C,oBAAmB,UAACrB,CAAD,EAAO;AACzBC,IAAED,EAAEsD,aAAJ,EAAmBC,OAAnB,CAA2B,UAA3B,EAAuCpC,QAAvC,CAAgD,mBAAhD;AACAlB,IAAED,EAAEsD,aAAJ,EAAmBC,OAAnB,CAA2B,QAA3B,EAAqCpC,QAArC,CAA8C,QAA9C,EAAwDG,WAAxD,CAAoE,UAApE,EAAgFhG,IAAhF,CAAqF,MAArF,EAA6F4C,IAA7F,CAAkGtC,QAAQC,EAAR,CAAW,QAAX,CAAlG;AACA,EAV0C;AAY3C,kBAAiB,UAACmE,CAAD,EAAIrF,CAAJ,EAAU;AAC1B,MAAI,CAACA,CAAD,IAAM,CAACA,EAAE4B,IAAT,IAAiB,CAAC5B,EAAE4B,IAAF,CAAO3B,MAAzB,IAAmC,CAACD,EAAE4B,IAAF,CAAO3B,MAAP,GAAgB8B,EAAxD,EAA4D;AAC3D;AACA;;AAED,MAAMiJ,YAAY1F,EAAED,EAAEsD,aAAJ,EAAmBsC,IAAnB,CAAwB,iBAAxB,CAAlB;AAEAxL,SAAOwG,IAAP,CAAY,2BAAZ,EAAyC;AAAE8E,kBAAe/K,EAAE4B,IAAF,CAAO3B,MAAP,GAAgB8B,EAAjC;AAAqCiJ;AAArC,GAAzC,EAA2F,UAAC3F,CAAD,EAAO;AACjG,OAAIA,CAAJ,EAAO;AACNc,gBAAYd,CAAZ;AACA;AACA;AACD,GALD;AAMA,EAzB0C;AA2B3C,yBAAwB,UAACA,CAAD,EAAIrF,CAAJ,EAAU;AACjC,MAAI,CAACA,CAAD,IAAM,CAACA,EAAE4B,IAAT,IAAiB,CAAC5B,EAAE4B,IAAF,CAAO3B,MAAzB,IAAmC,CAACD,EAAE4B,IAAF,CAAO3B,MAAP,GAAgB8B,EAAxD,EAA4D;AAC3D;AACA;;AAEDtC,SAAOwG,IAAP,CAAY,yBAAZ,EAAuCjG,EAAE4B,IAAF,CAAO3B,MAAP,GAAgB8B,EAAvD,EAA2D,UAACsD,CAAD,EAAO;AACjE,OAAIA,CAAJ,EAAO;AACNc,gBAAYd,CAAZ;AACA;AACA;;AAEDhE,UAAO4F,OAAP,CAAehG,QAAQC,EAAR,CAAW,6BAAX,CAAf;AACA,GAPD;AAQA,EAxC0C;AA0C3C,oBAAmBgK,EAAEC,QAAF,CAAW,UAAC9F,CAAD,EAAIxD,QAAJ,EAAiB;AAC9C,MAAIwD,EAAE+F,MAAF,CAASC,SAAT,IAAsBhG,EAAE+F,MAAF,CAASE,YAAT,GAAwBjG,EAAE+F,MAAF,CAASG,YAA3D,EAAyE;AACxE1J,YAAS6H,KAAT,CAAelH,GAAf,CAAmBX,SAAS6H,KAAT,CAAe/G,GAAf,KAAuB,EAA1C;AACA;AACD,EAJkB,EAIhB,GAJgB;AA1CwB,CAA5C,4H","file":"/packages/rocketchat_integrations.js","sourcesContent":["RocketChat.integrations = {\n\toutgoingEvents: {\n\t\tsendMessage: {\n\t\t\tlabel: 'Integrations_Outgoing_Type_SendMessage',\n\t\t\tvalue: 'sendMessage',\n\t\t\tuse: {\n\t\t\t\tchannel: true,\n\t\t\t\ttriggerWords: true,\n\t\t\t\ttargetRoom: false\n\t\t\t}\n\t\t},\n\t\tfileUploaded: {\n\t\t\tlabel: 'Integrations_Outgoing_Type_FileUploaded',\n\t\t\tvalue: 'fileUploaded',\n\t\t\tuse: {\n\t\t\t\tchannel: true,\n\t\t\t\ttriggerWords: false,\n\t\t\t\ttargetRoom: false\n\t\t\t}\n\t\t},\n\t\troomArchived: {\n\t\t\tlabel: 'Integrations_Outgoing_Type_RoomArchived',\n\t\t\tvalue: 'roomArchived',\n\t\t\tuse: {\n\t\t\t\tchannel: false,\n\t\t\t\ttriggerWords: false,\n\t\t\t\ttargetRoom: false\n\t\t\t}\n\t\t},\n\t\troomCreated: {\n\t\t\tlabel: 'Integrations_Outgoing_Type_RoomCreated',\n\t\t\tvalue: 'roomCreated',\n\t\t\tuse: {\n\t\t\t\tchannel: false,\n\t\t\t\ttriggerWords: false,\n\t\t\t\ttargetRoom: false\n\t\t\t}\n\t\t},\n\t\troomJoined: {\n\t\t\tlabel: 'Integrations_Outgoing_Type_RoomJoined',\n\t\t\tvalue: 'roomJoined',\n\t\t\tuse: {\n\t\t\t\tchannel: true,\n\t\t\t\ttriggerWords: false,\n\t\t\t\ttargetRoom: false\n\t\t\t}\n\t\t},\n\t\troomLeft: {\n\t\t\tlabel: 'Integrations_Outgoing_Type_RoomLeft',\n\t\t\tvalue: 'roomLeft',\n\t\t\tuse: {\n\t\t\t\tchannel: true,\n\t\t\t\ttriggerWords: false,\n\t\t\t\ttargetRoom: false\n\t\t\t}\n\t\t},\n\t\tuserCreated: {\n\t\t\tlabel: 'Integrations_Outgoing_Type_UserCreated',\n\t\t\tvalue: 'userCreated',\n\t\t\tuse: {\n\t\t\t\tchannel: false,\n\t\t\t\ttriggerWords: false,\n\t\t\t\ttargetRoom: true\n\t\t\t}\n\t\t}\n\t}\n};\n","this.ChatIntegrations = new Mongo.Collection('rocketchat_integrations');\nthis.ChatIntegrationHistory = new Mongo.Collection('rocketchat_integration_history');\n","RocketChat.AdminBox.addOption({\n\thref: 'admin-integrations',\n\ti18nLabel: 'Integrations',\n\tpermissionGranted: () => RocketChat.authz.hasAtLeastOnePermission(['manage-integrations', 'manage-own-integrations'])\n});\n","FlowRouter.route('/admin/integrations', {\n\tname: 'admin-integrations',\n\tsubscriptions() {\n\t\tthis.register('integrations', Meteor.subscribe('integrations'));\n\t},\n\taction() {\n\t\treturn BlazeLayout.render('main', {\n\t\t\tcenter: 'integrations',\n\t\t\tpageTitle: t('Integrations')\n\t\t});\n\t}\n});\n\nFlowRouter.route('/admin/integrations/new', {\n\tname: 'admin-integrations-new',\n\tsubscriptions() {\n\t\tthis.register('integrations', Meteor.subscribe('integrations'));\n\t},\n\taction() {\n\t\treturn BlazeLayout.render('main', {\n\t\t\tcenter: 'integrationsNew',\n\t\t\tpageTitle: t('Integration_New')\n\t\t});\n\t}\n});\n\nFlowRouter.route('/admin/integrations/incoming/:id?', {\n\tname: 'admin-integrations-incoming',\n\tsubscriptions() {\n\t\tthis.register('integrations', Meteor.subscribe('integrations'));\n\t},\n\taction(params) {\n\t\treturn BlazeLayout.render('main', {\n\t\t\tcenter: 'pageSettingsContainer',\n\t\t\tpageTitle: t('Integration_Incoming_WebHook'),\n\t\t\tpageTemplate: 'integrationsIncoming',\n\t\t\tparams\n\t\t});\n\t}\n});\n\nFlowRouter.route('/admin/integrations/outgoing/:id?', {\n\tname: 'admin-integrations-outgoing',\n\taction(params) {\n\t\treturn BlazeLayout.render('main', {\n\t\t\tcenter: 'integrationsOutgoing',\n\t\t\tpageTitle: t('Integration_Outgoing_WebHook'),\n\t\t\tparams\n\t\t});\n\t}\n});\n\nFlowRouter.route('/admin/integrations/outgoing/:id?/history', {\n\tname: 'admin-integrations-outgoing-history',\n\taction(params) {\n\t\treturn BlazeLayout.render('main', {\n\t\t\tcenter: 'integrationsOutgoingHistory',\n\t\t\tpageTitle: t('Integration_Outgoing_WebHook_History'),\n\t\t\tparams\n\t\t});\n\t}\n});\n","/* global ChatIntegrations */\nimport moment from 'moment';\n\nTemplate.integrations.helpers({\n\thasPermission() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['manage-integrations', 'manage-own-integrations']);\n\t},\n\tintegrations() {\n\t\treturn ChatIntegrations.find();\n\t},\n\tdateFormated(date) {\n\t\treturn moment(date).format('L LT');\n\t},\n\teventTypeI18n(event) {\n\t\treturn TAPi18n.__(RocketChat.integrations.outgoingEvents[event].label);\n\t}\n});\n","Template.integrationsNew.helpers({\n\thasPermission() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['manage-integrations', 'manage-own-integrations']);\n\t}\n});\n","/* global ChatIntegrations */\n\nimport hljs from 'highlight.js';\nimport toastr from 'toastr';\n\nTemplate.integrationsIncoming.onCreated(function _incomingIntegrationsOnCreated() {\n\treturn this.record = new ReactiveVar({\n\t\tusername: 'rocket.cat'\n\t});\n});\n\nTemplate.integrationsIncoming.helpers({\n\thasPermission() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['manage-integrations', 'manage-own-integrations']);\n\t},\n\n\tdata() {\n\t\tconst params = Template.instance().data.params ? Template.instance().data.params() : undefined;\n\n\t\tif (params && params.id) {\n\t\t\tlet data;\n\t\t\tif (RocketChat.authz.hasAllPermission('manage-integrations')) {\n\t\t\t\tdata = ChatIntegrations.findOne({ _id: params.id });\n\t\t\t} else if (RocketChat.authz.hasAllPermission('manage-own-integrations')) {\n\t\t\t\tdata = ChatIntegrations.findOne({_id: params.id, '_createdBy._id': Meteor.userId() });\n\t\t\t}\n\n\t\t\tif (data) {\n\t\t\t\tconst completeToken = `${ data._id }/${ data.token }`;\n\t\t\t\tdata.url = Meteor.absoluteUrl(`hooks/${ completeToken }`);\n\t\t\t\tdata.completeToken = completeToken;\n\t\t\t\tTemplate.instance().record.set(data);\n\t\t\t\treturn data;\n\t\t\t}\n\t\t}\n\n\t\treturn Template.instance().record.curValue;\n\t},\n\n\texample() {\n\t\tconst record = Template.instance().record.get();\n\t\treturn {\n\t\t\t_id: Random.id(),\n\t\t\talias: record.alias,\n\t\t\temoji: record.emoji,\n\t\t\tavatar: record.avatar,\n\t\t\tmsg: 'Example message',\n\t\t\tbot: {\n\t\t\t\ti: Random.id()\n\t\t\t},\n\t\t\tgroupable: false,\n\t\t\tattachments: [{\n\t\t\t\ttitle: 'Rocket.Chat',\n\t\t\t\ttitle_link: 'https://rocket.chat',\n\t\t\t\ttext: 'Rocket.Chat, the best open source chat',\n\t\t\t\timage_url: 'https://rocket.chat/images/mockup.png',\n\t\t\t\tcolor: '#764FA5'\n\t\t\t}],\n\t\t\tts: new Date(),\n\t\t\tu: {\n\t\t\t\t_id: Random.id(),\n\t\t\t\tusername: record.username\n\t\t\t}\n\t\t};\n\t},\n\n\texampleJson() {\n\t\tconst record = Template.instance().record.get();\n\t\tconst data = {\n\t\t\tusername: record.alias,\n\t\t\ticon_emoji: record.emoji,\n\t\t\ticon_url: record.avatar,\n\t\t\ttext: 'Example message',\n\t\t\tattachments: [{\n\t\t\t\ttitle: 'Rocket.Chat',\n\t\t\t\ttitle_link: 'https://rocket.chat',\n\t\t\t\ttext: 'Rocket.Chat, the best open source chat',\n\t\t\t\timage_url: 'https://rocket.chat/images/mockup.png',\n\t\t\t\tcolor: '#764FA5'\n\t\t\t}]\n\t\t};\n\n\t\tconst invalidData = [null, ''];\n\t\tObject.keys(data).forEach((key) => {\n\t\t\tif (invalidData.includes(data[key])) {\n\t\t\t\tdelete data[key];\n\t\t\t}\n\t\t});\n\n\t\treturn hljs.highlight('json', JSON.stringify(data, null, 2)).value;\n\t},\n\n\tcurl() {\n\t\tconst record = Template.instance().record.get();\n\n\t\tif (!record.url) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {\n\t\t\tusername: record.alias,\n\t\t\ticon_emoji: record.emoji,\n\t\t\ticon_url: record.avatar,\n\t\t\ttext: 'Example message',\n\t\t\tattachments: [{\n\t\t\t\ttitle: 'Rocket.Chat',\n\t\t\t\ttitle_link: 'https://rocket.chat',\n\t\t\t\ttext: 'Rocket.Chat, the best open source chat',\n\t\t\t\timage_url: 'https://rocket.chat/images/mockup.png',\n\t\t\t\tcolor: '#764FA5'\n\t\t\t}]\n\t\t};\n\n\t\tconst invalidData = [null, ''];\n\t\tObject.keys(data).forEach((key) => {\n\t\t\tif (invalidData.includes(data[key])) {\n\t\t\t\tdelete data[key];\n\t\t\t}\n\t\t});\n\n\t\treturn `curl -X POST -H 'Content-Type: application/json' --data '${ JSON.stringify(data) }' ${ record.url }`;\n\t},\n\n\teditorOptions() {\n\t\treturn {\n\t\t\tlineNumbers: true,\n\t\t\tmode: 'javascript',\n\t\t\tgutters: [\n\t\t\t\t// 'CodeMirror-lint-markers'\n\t\t\t\t'CodeMirror-linenumbers',\n\t\t\t\t'CodeMirror-foldgutter'\n\t\t\t],\n\t\t\t// lint: true,\n\t\t\tfoldGutter: true,\n\t\t\t// lineWrapping: true,\n\t\t\tmatchBrackets: true,\n\t\t\tautoCloseBrackets: true,\n\t\t\tmatchTags: true,\n\t\t\tshowTrailingSpace: true,\n\t\t\thighlightSelectionMatches: true\n\t\t};\n\t}\n});\n\nTemplate.integrationsIncoming.events({\n\t'blur input': (e, t) => {\n\t\tconst value = t.record.curValue || {};\n\n\t\tvalue.name = $('[name=name]').val().trim();\n\t\tvalue.alias = $('[name=alias]').val().trim();\n\t\tvalue.emoji = $('[name=emoji]').val().trim();\n\t\tvalue.avatar = $('[name=avatar]').val().trim();\n\t\tvalue.channel = $('[name=channel]').val().trim();\n\t\tvalue.username = $('[name=username]').val().trim();\n\n\t\tt.record.set(value);\n\t},\n\n\t'click .submit > .delete': () => {\n\t\tconst params = Template.instance().data.params();\n\n\t\tswal({\n\t\t\ttitle: t('Are_you_sure'),\n\t\t\ttext: t('You_will_not_be_able_to_recover'),\n\t\t\ttype: 'warning',\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\tconfirmButtonText: t('Yes_delete_it'),\n\t\t\tcancelButtonText: t('Cancel'),\n\t\t\tcloseOnConfirm: false,\n\t\t\thtml: false\n\t\t}, () => {\n\t\t\tMeteor.call('deleteIncomingIntegration', params.id, (err) => {\n\t\t\t\tif (err) {\n\t\t\t\t\thandleError(err);\n\t\t\t\t} else {\n\t\t\t\t\tswal({\n\t\t\t\t\t\ttitle: t('Deleted'),\n\t\t\t\t\t\ttext: t('Your_entry_has_been_deleted'),\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\ttimer: 1000,\n\t\t\t\t\t\tshowConfirmButton: false\n\t\t\t\t\t});\n\n\t\t\t\t\tFlowRouter.go('admin-integrations');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\t'click .button-fullscreen': () => {\n\t\tconst codeMirrorBox = $('.code-mirror-box');\n\t\tcodeMirrorBox.addClass('code-mirror-box-fullscreen content-background-color');\n\t\tcodeMirrorBox.find('.CodeMirror')[0].CodeMirror.refresh();\n\t},\n\n\t'click .button-restore': () => {\n\t\tconst codeMirrorBox = $('.code-mirror-box');\n\t\tcodeMirrorBox.removeClass('code-mirror-box-fullscreen content-background-color');\n\t\tcodeMirrorBox.find('.CodeMirror')[0].CodeMirror.refresh();\n\t},\n\n\t'click .submit > .save': () => {\n\t\tconst enabled = $('[name=enabled]:checked').val().trim();\n\t\tconst name = $('[name=name]').val().trim();\n\t\tconst alias = $('[name=alias]').val().trim();\n\t\tconst emoji = $('[name=emoji]').val().trim();\n\t\tconst avatar = $('[name=avatar]').val().trim();\n\t\tconst channel = $('[name=channel]').val().trim();\n\t\tconst username = $('[name=username]').val().trim();\n\t\tconst scriptEnabled = $('[name=scriptEnabled]:checked').val().trim();\n\t\tconst script = $('[name=script]').val().trim();\n\n\t\tif (channel === '') {\n\t\t\treturn toastr.error(TAPi18n.__('The_channel_name_is_required'));\n\t\t}\n\n\t\tif (username === '') {\n\t\t\treturn toastr.error(TAPi18n.__('The_username_is_required'));\n\t\t}\n\n\t\tconst integration = {\n\t\t\tenabled: enabled === '1',\n\t\t\tchannel,\n\t\t\talias: alias !== '' ? alias : undefined,\n\t\t\temoji: emoji !== '' ? emoji : undefined,\n\t\t\tavatar: avatar !== '' ? avatar : undefined,\n\t\t\tname: name !== '' ? name : undefined,\n\t\t\tscript: script !== '' ? script : undefined,\n\t\t\tscriptEnabled: scriptEnabled === '1'\n\t\t};\n\n\t\tconst params = Template.instance().data.params ? Template.instance().data.params() : undefined;\n\t\tif (params && params.id) {\n\t\t\tMeteor.call('updateIncomingIntegration', params.id, integration, (err) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn handleError(err);\n\t\t\t\t}\n\n\t\t\t\ttoastr.success(TAPi18n.__('Integration_updated'));\n\t\t\t});\n\t\t} else {\n\t\t\tintegration.username = username;\n\n\t\t\tMeteor.call('addIncomingIntegration', integration, (err, data) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn handleError(err);\n\t\t\t\t}\n\n\t\t\t\ttoastr.success(TAPi18n.__('Integration_added'));\n\t\t\t\tFlowRouter.go('admin-integrations-incoming', { id: data._id });\n\t\t\t});\n\t\t}\n\t}\n});\n","/* global ChatIntegrations */\n\nimport hljs from 'highlight.js';\nimport toastr from 'toastr';\n\nTemplate.integrationsOutgoing.onCreated(function _integrationsOutgoingOnCreated() {\n\tthis.record = new ReactiveVar({\n\t\tusername: 'rocket.cat',\n\t\ttoken: Random.id(24),\n\t\tretryFailedCalls: true,\n\t\tretryCount: 6,\n\t\tretryDelay: 'powers-of-ten',\n\t\trunOnEdits: true\n\t});\n\n\tthis.updateRecord = () => {\n\t\tthis.record.set({\n\t\t\tenabled: $('[name=enabled]:checked').val().trim() === '1',\n\t\t\tevent: $('[name=event]').val().trim(),\n\t\t\tname: $('[name=name]').val().trim(),\n\t\t\talias: $('[name=alias]').val().trim(),\n\t\t\temoji: $('[name=emoji]').val().trim(),\n\t\t\tavatar: $('[name=avatar]').val().trim(),\n\t\t\tchannel: $('[name=channel]').val()? $('[name=channel]').val().trim() : undefined,\n\t\t\tusername: $('[name=username]').val().trim(),\n\t\t\ttriggerWords: $('[name=triggerWords]').val() ? $('[name=triggerWords]').val().trim() : undefined,\n\t\t\turls: $('[name=urls]').val().trim(),\n\t\t\ttoken: $('[name=token]').val().trim(),\n\t\t\tscriptEnabled: $('[name=scriptEnabled]:checked').val().trim() === '1',\n\t\t\tscript: $('[name=script]').val().trim(),\n\t\t\ttargetRoom: $('[name=targetRoom]').val() ? $('[name=targetRoom]').val().trim() : undefined,\n\t\t\ttriggerWordAnywhere: $('[name=triggerWordAnywhere]').val() ? $('[name=triggerWordAnywhere]').val().trim() : undefined,\n\t\t\tretryFailedCalls: $('[name=retryFailedCalls]:checked').val().trim() === '1',\n\t\t\tretryCount: $('[name=retryCount]').val() ? $('[name=retryCount]').val().trim() : 6,\n\t\t\tretryDelay: $('[name=retryDelay]').val() ? $('[name=retryDelay]').val().trim() : 'powers-of-ten',\n\t\t\trunOnEdits: $('[name=runOnEdits]:checked').val().trim() === '1'\n\t\t});\n\t};\n\n\tthis.autorun(() => {\n\t\tconst id = this.data && this.data.params && this.data.params().id;\n\n\t\tif (id) {\n\t\t\tconst sub = this.subscribe('integrations');\n\t\t\tif (sub.ready()) {\n\t\t\t\tlet intRecord;\n\n\t\t\t\tif (RocketChat.authz.hasAllPermission('manage-integrations')) {\n\t\t\t\t\tintRecord = ChatIntegrations.findOne({ _id: id });\n\t\t\t\t} else if (RocketChat.authz.hasAllPermission('manage-own-integrations')) {\n\t\t\t\t\tintRecord = ChatIntegrations.findOne({ _id: id, '_createdBy._id': Meteor.userId() });\n\t\t\t\t}\n\n\t\t\t\tif (intRecord) {\n\t\t\t\t\tthis.record.set(intRecord);\n\t\t\t\t} else {\n\t\t\t\t\ttoastr.error(TAPi18n.__('No_integration_found'));\n\t\t\t\t\tFlowRouter.go('admin-integrations');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n});\n\nTemplate.integrationsOutgoing.helpers({\n\tjoin(arr, sep) {\n\t\tif (!arr || !arr.join) {\n\t\t\treturn arr;\n\t\t}\n\n\t\treturn arr.join(sep);\n\t},\n\n\tshowHistoryButton() {\n\t\treturn this.params && this.params() && typeof this.params().id !== 'undefined';\n\t},\n\n\thasPermission() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['manage-integrations', 'manage-own-integrations']);\n\t},\n\n\tdata() {\n\t\treturn Template.instance().record.get();\n\t},\n\n\tcanDelete() {\n\t\treturn this.params && this.params() && typeof this.params().id !== 'undefined';\n\t},\n\n\teventTypes() {\n\t\treturn Object.values(RocketChat.integrations.outgoingEvents);\n\t},\n\n\thasTypeSelected() {\n\t\tconst record = Template.instance().record.get();\n\n\t\treturn typeof record.event === 'string' && record.event !== '';\n\t},\n\n\tshouldDisplayChannel() {\n\t\tconst record = Template.instance().record.get();\n\n\t\treturn typeof record.event === 'string' && RocketChat.integrations.outgoingEvents[record.event].use.channel;\n\t},\n\n\tshouldDisplayTriggerWords() {\n\t\tconst record = Template.instance().record.get();\n\n\t\treturn typeof record.event === 'string' && RocketChat.integrations.outgoingEvents[record.event].use.triggerWords;\n\t},\n\n\tshouldDisplayTargetRoom() {\n\t\tconst record = Template.instance().record.get();\n\n\t\treturn typeof record.event === 'string' && RocketChat.integrations.outgoingEvents[record.event].use.targetRoom;\n\t},\n\n\texample() {\n\t\tconst record = Template.instance().record.get();\n\n\t\treturn {\n\t\t\t_id: Random.id(),\n\t\t\talias: record.alias,\n\t\t\temoji: record.emoji,\n\t\t\tavatar: record.avatar,\n\t\t\tmsg: 'Response text',\n\t\t\tbot: {\n\t\t\t\ti: Random.id()\n\t\t\t},\n\t\t\tgroupable: false,\n\t\t\tattachments: [{\n\t\t\t\ttitle: 'Rocket.Chat',\n\t\t\t\ttitle_link: 'https://rocket.chat',\n\t\t\t\ttext: 'Rocket.Chat, the best open source chat',\n\t\t\t\timage_url: 'https://rocket.chat/images/mockup.png',\n\t\t\t\tcolor: '#764FA5'\n\t\t\t}],\n\t\t\tts: new Date(),\n\t\t\tu: {\n\t\t\t\t_id: Random.id(),\n\t\t\t\tusername: record.username\n\t\t\t}\n\t\t};\n\t},\n\n\texampleJson() {\n\t\tconst record = Template.instance().record.get();\n\t\tconst data = {\n\t\t\tusername: record.alias,\n\t\t\ticon_emoji: record.emoji,\n\t\t\ticon_url: record.avatar,\n\t\t\ttext: 'Response text',\n\t\t\tattachments: [{\n\t\t\t\ttitle: 'Rocket.Chat',\n\t\t\t\ttitle_link: 'https://rocket.chat',\n\t\t\t\ttext: 'Rocket.Chat, the best open source chat',\n\t\t\t\timage_url: 'https://rocket.chat/images/mockup.png',\n\t\t\t\tcolor: '#764FA5'\n\t\t\t}]\n\t\t};\n\n\t\tconst invalidData = [null, ''];\n\t\tObject.keys(data).forEach((key) => {\n\t\t\tif (invalidData.includes(data[key])) {\n\t\t\t\tdelete data[key];\n\t\t\t}\n\t\t});\n\n\t\treturn hljs.highlight('json', JSON.stringify(data, null, 2)).value;\n\t},\n\n\teditorOptions() {\n\t\treturn {\n\t\t\tlineNumbers: true,\n\t\t\tmode: 'javascript',\n\t\t\tgutters: [\n\t\t\t\t// \"CodeMirror-lint-markers\",\n\t\t\t\t'CodeMirror-linenumbers',\n\t\t\t\t'CodeMirror-foldgutter'\n\t\t\t],\n\t\t\t// lint: true,\n\t\t\tfoldGutter: true,\n\t\t\t// lineWrapping: true,\n\t\t\tmatchBrackets: true,\n\t\t\tautoCloseBrackets: true,\n\t\t\tmatchTags: true,\n\t\t\tshowTrailingSpace: true,\n\t\t\thighlightSelectionMatches: true\n\t\t};\n\t}\n});\n\nTemplate.integrationsOutgoing.events({\n\t'blur input': (e, t) => {\n\t\tt.updateRecord();\n\t},\n\n\t'click input[type=radio]': (e, t) => {\n\t\tt.updateRecord();\n\t},\n\n\t'change select[name=event]': (e, t) => {\n\t\tconst record = t.record.get();\n\t\trecord.event = $('[name=event]').val().trim();\n\n\t\tt.record.set(record);\n\t},\n\n\t'click .button.history': () => {\n\t\tFlowRouter.go(`/admin/integrations/outgoing/${ FlowRouter.getParam('id') }/history`);\n\t},\n\n\t'click .expand': (e) => {\n\t\t$(e.currentTarget).closest('.section').removeClass('section-collapsed');\n\t\t$(e.currentTarget).closest('button').removeClass('expand').addClass('collapse').find('span').text(TAPi18n.__('Collapse'));\n\t\t$('.CodeMirror').each((index, codeMirror) => codeMirror.CodeMirror.refresh());\n\t},\n\n\t'click .collapse': (e) => {\n\t\t$(e.currentTarget).closest('.section').addClass('section-collapsed');\n\t\t$(e.currentTarget).closest('button').addClass('expand').removeClass('collapse').find('span').text(TAPi18n.__('Expand'));\n\t},\n\n\t'click .submit > .delete': () => {\n\t\tconst params = Template.instance().data.params();\n\n\t\tswal({\n\t\t\ttitle: t('Are_you_sure'),\n\t\t\ttext: t('You_will_not_be_able_to_recover'),\n\t\t\ttype: 'warning',\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\tconfirmButtonText: t('Yes_delete_it'),\n\t\t\tcancelButtonText: t('Cancel'),\n\t\t\tcloseOnConfirm: false,\n\t\t\thtml: false\n\t\t}, () => {\n\t\t\tMeteor.call('deleteOutgoingIntegration', params.id, (err) => {\n\t\t\t\tif (err) {\n\t\t\t\t\thandleError(err);\n\t\t\t\t} else {\n\t\t\t\t\tswal({\n\t\t\t\t\t\ttitle: t('Deleted'),\n\t\t\t\t\t\ttext: t('Your_entry_has_been_deleted'),\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\ttimer: 1000,\n\t\t\t\t\t\tshowConfirmButton: false\n\t\t\t\t\t});\n\n\t\t\t\t\tFlowRouter.go('admin-integrations');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\t'click .button-fullscreen': () => {\n\t\t$('.code-mirror-box').addClass('code-mirror-box-fullscreen content-background-color');\n\t\t$('.CodeMirror')[0].CodeMirror.refresh();\n\t},\n\n\t'click .button-restore': () => {\n\t\t$('.code-mirror-box').removeClass('code-mirror-box-fullscreen content-background-color');\n\t\t$('.CodeMirror')[0].CodeMirror.refresh();\n\t},\n\n\t'click .submit > .save': () => {\n\t\tconst event = $('[name=event]').val().trim();\n\t\tconst enabled = $('[name=enabled]:checked').val().trim();\n\t\tconst name = $('[name=name]').val().trim();\n\t\tconst impersonateUser = $('[name=impersonateUser]:checked').val().trim();\n\t\tconst alias = $('[name=alias]').val().trim();\n\t\tconst emoji = $('[name=emoji]').val().trim();\n\t\tconst avatar = $('[name=avatar]').val().trim();\n\t\tconst username = $('[name=username]').val().trim();\n\t\tconst token = $('[name=token]').val().trim();\n\t\tconst scriptEnabled = $('[name=scriptEnabled]:checked').val().trim();\n\t\tconst script = $('[name=script]').val().trim();\n\t\tconst retryFailedCalls = $('[name=retryFailedCalls]:checked').val().trim();\n\t\tlet urls = $('[name=urls]').val().trim();\n\n\t\tif (username === '' && impersonateUser === '0') {\n\t\t\treturn toastr.error(TAPi18n.__('The_username_is_required'));\n\t\t}\n\n\t\turls = urls.split('\\n').filter((url) => url.trim() !== '');\n\t\tif (urls.length === 0) {\n\t\t\treturn toastr.error(TAPi18n.__('You_should_inform_one_url_at_least'));\n\t\t}\n\n\t\tlet triggerWords;\n\t\tlet triggerWordAnywhere;\n\t\tlet runOnEdits;\n\t\tif (RocketChat.integrations.outgoingEvents[event].use.triggerWords) {\n\t\t\ttriggerWords = $('[name=triggerWords]').val().trim();\n\t\t\ttriggerWords = triggerWords.split(',').filter((word) => word.trim() !== '');\n\n\t\t\ttriggerWordAnywhere = $('[name=triggerWordAnywhere]').val().trim();\n\t\t\trunOnEdits = $('[name=runOnEdits]:checked').val().trim();\n\t\t}\n\n\t\tlet channel;\n\t\tif (RocketChat.integrations.outgoingEvents[event].use.channel) {\n\t\t\tchannel = $('[name=channel]').val().trim();\n\n\t\t\tif (!channel || channel.trim() === '') {\n\t\t\t\treturn toastr.error(TAPi18n.__('error-the-field-is-required', { field: TAPi18n.__('Channel') }));\n\t\t\t}\n\t\t}\n\n\t\tlet targetRoom;\n\t\tif (RocketChat.integrations.outgoingEvents[event].use.targetRoom) {\n\t\t\ttargetRoom = $('[name=targetRoom]').val().trim();\n\n\t\t\tif (!targetRoom || targetRoom.trim() === '') {\n\t\t\t\treturn toastr.error(TAPi18n.__('error-the-field-is-required', { field: TAPi18n.__('TargetRoom') }));\n\t\t\t}\n\t\t}\n\n\t\tlet retryCount;\n\t\tlet retryDelay;\n\t\tif (retryFailedCalls === '1') {\n\t\t\tretryCount = parseInt($('[name=retryCount]').val().trim());\n\t\t\tretryDelay = $('[name=retryDelay]').val().trim();\n\t\t}\n\n\t\tconst integration = {\n\t\t\tevent: event !== '' ? event : undefined,\n\t\t\tenabled: enabled === '1',\n\t\t\tusername,\n\t\t\tchannel: channel !== '' ? channel : undefined,\n\t\t\ttargetRoom: targetRoom !== '' ? targetRoom : undefined,\n\t\t\talias: alias !== '' ? alias : undefined,\n\t\t\temoji: emoji !== '' ? emoji : undefined,\n\t\t\tavatar: avatar !== '' ? avatar : undefined,\n\t\t\tname: name !== '' ? name : undefined,\n\t\t\ttriggerWords: triggerWords !== '' ? triggerWords : undefined,\n\t\t\turls: urls !== '' ? urls : undefined,\n\t\t\ttoken: token !== '' ? token : undefined,\n\t\t\tscript: script !== '' ? script : undefined,\n\t\t\tscriptEnabled: scriptEnabled === '1',\n\t\t\timpersonateUser: impersonateUser === '1',\n\t\t\tretryFailedCalls: retryFailedCalls === '1',\n\t\t\tretryCount: retryCount ? retryCount : 6,\n\t\t\tretryDelay: retryDelay ? retryDelay : 'powers-of-ten',\n\t\t\ttriggerWordAnywhere: triggerWordAnywhere === '1',\n\t\t\trunOnEdits: runOnEdits === '1'\n\t\t};\n\n\t\tconst params = Template.instance().data.params? Template.instance().data.params() : undefined;\n\t\tif (params && params.id) {\n\t\t\tMeteor.call('updateOutgoingIntegration', params.id, integration, (err) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn handleError(err);\n\t\t\t\t}\n\n\t\t\t\ttoastr.success(TAPi18n.__('Integration_updated'));\n\t\t\t});\n\t\t} else {\n\t\t\tMeteor.call('addOutgoingIntegration', integration, (err, data) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn handleError(err);\n\t\t\t\t}\n\n\t\t\t\ttoastr.success(TAPi18n.__('Integration_added'));\n\t\t\t\tFlowRouter.go('admin-integrations-outgoing', { id: data._id });\n\t\t\t});\n\t\t}\n\t}\n});\n","/* global ChatIntegrations, ChatIntegrationHistory */\n\nimport hljs from 'highlight.js';\nimport moment from 'moment';\nimport toastr from 'toastr';\n\nTemplate.integrationsOutgoingHistory.onCreated(function _integrationsOutgoingHistoryOnCreated() {\n\tthis.hasMore = new ReactiveVar(false);\n\tthis.limit = new ReactiveVar(25);\n\tthis.autorun(() => {\n\t\tconst id = this.data && this.data.params && this.data.params().id;\n\n\t\tif (id) {\n\t\t\tconst sub = this.subscribe('integrations');\n\t\t\tif (sub.ready()) {\n\t\t\t\tlet intRecord;\n\n\t\t\t\tif (RocketChat.authz.hasAllPermission('manage-integrations')) {\n\t\t\t\t\tintRecord = ChatIntegrations.findOne({ _id: id });\n\t\t\t\t} else if (RocketChat.authz.hasAllPermission('manage-own-integrations')) {\n\t\t\t\t\tintRecord = ChatIntegrations.findOne({ _id: id, '_createdBy._id': Meteor.userId() });\n\t\t\t\t}\n\n\t\t\t\tif (!intRecord) {\n\t\t\t\t\ttoastr.error(TAPi18n.__('No_integration_found'));\n\t\t\t\t\tFlowRouter.go('admin-integrations');\n\t\t\t\t}\n\n\t\t\t\tconst historySub = this.subscribe('integrationHistory', intRecord._id, this.limit.get());\n\t\t\t\tif (historySub.ready()) {\n\t\t\t\t\tif (ChatIntegrationHistory.find().count() > this.limit.get()) {\n\t\t\t\t\t\tthis.hasMore.set(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\ttoastr.error(TAPi18n.__('No_integration_found'));\n\t\t\tFlowRouter.go('admin-integrations');\n\t\t}\n\t});\n});\n\nTemplate.integrationsOutgoingHistory.helpers({\n\thasPermission() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['manage-integrations', 'manage-own-integrations']);\n\t},\n\n\thasMore() {\n\t\treturn Template.instance().hasMore.get();\n\t},\n\n\thistories() {\n\t\treturn ChatIntegrationHistory.find().fetch().sort((a, b) => {\n\t\t\tif (+a._updatedAt < +b._updatedAt) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (+a._updatedAt > +b._updatedAt) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t});\n\t},\n\n\thasProperty(history, property) {\n\t\treturn typeof history[property] !== 'undefined' || history[property] != null;\n\t},\n\n\ticonClass(history) {\n\t\tif (typeof history.error !== 'undefined' && history.error) {\n\t\t\treturn 'icon-cancel-circled error-color';\n\t\t} else if (history.finished) {\n\t\t\treturn 'icon-ok-circled success-color';\n\t\t} else {\n\t\t\treturn 'icon-help-circled';\n\t\t}\n\t},\n\n\tstatusI18n(error) {\n\t\treturn typeof error !== 'undefined' && error ? TAPi18n.__('Failure') : TAPi18n.__('Success');\n\t},\n\n\tformatDate(date) {\n\t\treturn moment(date).format('L LTS');\n\t},\n\n\tformatDateDetail(date) {\n\t\treturn moment(date).format('L HH:mm:ss:SSSS');\n\t},\n\n\teventTypei18n(event) {\n\t\treturn TAPi18n.__(RocketChat.integrations.outgoingEvents[event].label);\n\t},\n\n\tjsonStringify(data) {\n\t\treturn data ? hljs.highlight('json', JSON.stringify(data, null, 2)).value : '';\n\t},\n\n\thljsStack(errorStack) {\n\t\tif (!errorStack) {\n\t\t\treturn '';\n\t\t} else if (typeof errorStack === 'object') {\n\t\t\treturn hljs.highlight('json', JSON.stringify(errorStack, null, 2)).value;\n\t\t} else {\n\t\t\treturn hljs.highlight('json', errorStack).value;\n\t\t}\n\t},\n\n\tintegrationId() {\n\t\treturn this.params && this.params() && this.params().id;\n\t}\n});\n\nTemplate.integrationsOutgoingHistory.events({\n\t'click .expand': (e) => {\n\t\t$(e.currentTarget).closest('.section').removeClass('section-collapsed');\n\t\t$(e.currentTarget).closest('button').removeClass('expand').addClass('collapse').find('span').text(TAPi18n.__('Collapse'));\n\t\t$('.CodeMirror').each((index, codeMirror) => codeMirror.CodeMirror.refresh());\n\t},\n\n\t'click .collapse': (e) => {\n\t\t$(e.currentTarget).closest('.section').addClass('section-collapsed');\n\t\t$(e.currentTarget).closest('button').addClass('expand').removeClass('collapse').find('span').text(TAPi18n.__('Expand'));\n\t},\n\n\t'click .replay': (e, t) => {\n\t\tif (!t || !t.data || !t.data.params || !t.data.params().id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst historyId = $(e.currentTarget).attr('data-history-id');\n\n\t\tMeteor.call('replayOutgoingIntegration', { integrationId: t.data.params().id, historyId }, (e) => {\n\t\t\tif (e) {\n\t\t\t\thandleError(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t},\n\n\t'click .clear-history': (e, t) => {\n\t\tif (!t || !t.data || !t.data.params || !t.data.params().id) {\n\t\t\treturn;\n\t\t}\n\n\t\tMeteor.call('clearIntegrationHistory', t.data.params().id, (e) => {\n\t\t\tif (e) {\n\t\t\t\thandleError(e);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttoastr.success(TAPi18n.__('Integration_History_Cleared'));\n\t\t});\n\t},\n\n\t'scroll .content': _.throttle((e, instance) => {\n\t\tif (e.target.scrollTop >= e.target.scrollHeight - e.target.clientHeight) {\n\t\t\tinstance.limit.set(instance.limit.get() + 25);\n\t\t}\n\t}, 200)\n});\n"]}