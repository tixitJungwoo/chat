{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/accountBox.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/combined.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/chatRoomItem.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/channels.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/channelsAnonymous.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/createCombinedFlex.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/directMessages.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/listChannelsFlex.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/listCombinedFlex.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/listPrivateGroupsFlex.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/privateGroups.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/privateGroupsFlex.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/sideNav.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/starredRooms.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/toolbar.js","meteor://ðŸ’»app/packages/rocketchat:ui-sidenav/client/unreadRooms.js"],"names":["Template","accountBox","helpers","myUserInfo","Meteor","user","RocketChat","settings","get","name","t","fname","status","visualStatus","username","Session","_id","userId","showAdminOption","authz","hasAtLeastOnePermission","AdminBox","getOptions","length","registeredMenus","AccountBox","getItems","events","event","preventDefault","setStatus","currentTarget","dataset","callbacks","run","toggle","logout","call","FlowRouter","go","SideNav","setFlex","openFlex","stopPropagation","href","sideNav","onRendered","init","combined","isActive","ChatSubscription","findOne","$in","f","$ne","open","rid","fields","rooms","query","preferences","unreadRoomsMode","$or","alert","hideUnreadStatus","find","sort","chatRoomItem","getParam","document","hasFocus","unread","userStatus","roomTypes","getUserStatus","roomIcon","getIcon","active","canLeave","roomData","cl","route","getRouteLink","archived","undefined","rendered","data","ls","KonchatNotification","newRoom","menu","close","e","warnText","swal","title","text","type","showCancelButton","confirmButtonColor","confirmButtonText","cancelButtonText","closeOnConfirm","html","includes","getRouteName","err","handleError","delete","isConfirm","RoomManager","channels","channelsAnonymous","currentRoom","models","Rooms","createCombinedFlex","selectedUsers","instance","selectedUserNames","valueOf","error","roomName","autocompleteSettings","limit","rules","collection","subscription","field","template","userSearch","noMatchTemplate","userSearchEmpty","matchAll","filter","exceptions","concat","selector","match","term","privateSwitchDisabled","hasAllPermission","privateSwitchChecked","doc","set","value","focus","self","users","_","reject","$","closeFlex","clearForm","overArrow","leaveArrow","keyCode","val","click","validate","toLowerCase","trim","replace","privateGroup","checked","readOnly","createRoute","successRoute","result","invalid","duplicate","archivedduplicate","current","queryParams","onCreated","ReactiveVar","directMessages","listChannelsFlex","channel","channelsList","hasMore","sortChannelsSelected","sortChannels","sortSubscriptionsSelected","sortSubscriptions","showSelected","show","member","Subscriptions","hidden","throttle","target","scrollTop","scrollHeight","clientHeight","debounce","nameFilter","hide","autorun","options","isNumber","RegExp","s","escapeRegExp","fetch","listCombinedFlex","channelTypeSelected","channelType","url","listPrivateGroupsFlex","groups","sortSelected","privateGroups","total","count","totalOpen","privateGroupsFlex","groupName","flexTemplate","getFlex","flexData","footer","showStarredRooms","favoritesEnabled","hasFavoriteRoomOpened","roomType","getTypes","canShowRoomType","userPref","mergeChannels","globalPref","checkCondition","templateName","toggleCurrent","updateUnreadBars","defer","starredRooms","isLoading","filterText","usernamesFromClient","resultsFromClient","startup","toolbarSearch","shortcut","clear","$inputMessage","fromShortcut","getFromServer","cb","currentFilter","results","console","log","resultsFromServer","usersLength","roomsLength","i","push","alreadyOnClient","item","getFromServerDebounced","toolbar","canCreate","resultsList","getPlaceholder","placeholder","TAPi18n","__","Device","isDesktop","window","navigator","platform","popupConfig","Tracker","config","cls","emptyTemplate","input","cleanOnEnter","closeOnEsc","blurOnSelectItem","getFilter","slice","searchQuery","escape","resultsFromClientLength","getValue","records","findWhere","openRouteLink","which","toolbarSearchList","icon","displayName","unreadRooms","hasUnread"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","file":"/packages/rocketchat_ui-sidenav.js","sourcesContent":["Template.accountBox.helpers({\n\tmyUserInfo() {\n\t\tif (Meteor.user() == null && RocketChat.settings.get('Accounts_AllowAnonymousRead')) {\n\t\t\treturn {\n\t\t\t\tname: t('Anonymous'),\n\t\t\t\tfname: t('Anonymous'),\n\t\t\t\tstatus: 'online',\n\t\t\t\tvisualStatus: t('online'),\n\t\t\t\tusername: 'anonymous'\n\t\t\t};\n\t\t}\n\n\t\tlet visualStatus = 'online';\n\t\tconst user = Meteor.user() || {};\n\t\tconst { name, username } = user;\n\t\tswitch (Session.get(`user_${ username }_status`)) {\n\t\t\tcase 'away':\n\t\t\t\tvisualStatus = t('away');\n\t\t\t\tbreak;\n\t\t\tcase 'busy':\n\t\t\t\tvisualStatus = t('busy');\n\t\t\t\tbreak;\n\t\t\tcase 'offline':\n\t\t\t\tvisualStatus = t('invisible');\n\t\t\t\tbreak;\n\t\t}\n\t\treturn {\n\t\t\tname: Session.get(`user_${ username }_name`) || username,\n\t\t\tstatus: Session.get(`user_${ username }_status`),\n\t\t\tvisualStatus,\n\t\t\t_id: Meteor.userId(),\n\t\t\tusername,\n\t\t\tfname: name || username\n\t\t};\n\t},\n\n\tshowAdminOption() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['view-statistics', 'view-room-administration', 'view-user-administration', 'view-privileged-setting' ]) || (RocketChat.AdminBox.getOptions().length > 0);\n\t},\n\n\tregisteredMenus() {\n\t\treturn AccountBox.getItems();\n\t}\n});\n\nTemplate.accountBox.events({\n\t'click .options .status'(event) {\n\t\tevent.preventDefault();\n\t\tAccountBox.setStatus(event.currentTarget.dataset.status);\n\t\treturn RocketChat.callbacks.run('userStatusManuallySet', event.currentTarget.dataset.status);\n\t},\n\n\t'click .account-box'() {\n\t\tif (Meteor.userId() == null && RocketChat.settings.get('Accounts_AllowAnonymousRead')) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn AccountBox.toggle();\n\t},\n\n\t'click #logout'(event) {\n\t\tevent.preventDefault();\n\t\tconst user = Meteor.user();\n\t\treturn Meteor.logout(function() {\n\t\t\tRocketChat.callbacks.run('afterLogoutCleanUp', user);\n\t\t\tMeteor.call('logoutCleanUp', user);\n\t\t\treturn FlowRouter.go('home');\n\t\t});\n\t},\n\n\t'click #avatar'() {\n\t\treturn FlowRouter.go('changeAvatar');\n\t},\n\n\t'click #account'() {\n\t\tSideNav.setFlex('accountFlex');\n\t\tSideNav.openFlex();\n\t\treturn FlowRouter.go('account');\n\t},\n\n\t'click #admin'() {\n\t\tSideNav.setFlex('adminFlex');\n\t\tSideNav.openFlex();\n\t\treturn FlowRouter.go('admin-info');\n\t},\n\n\t'click .account-link'(event) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\treturn AccountBox.openFlex();\n\t},\n\n\t'click .account-box-item'() {\n\t\tif (this.href) {\n\t\t\tFlowRouter.go(this.href);\n\t\t}\n\n\t\tif (this.sideNav != null) {\n\t\t\tSideNav.setFlex(this.sideNav);\n\t\t\treturn SideNav.openFlex();\n\t\t}\n\t}\n});\n\nTemplate.accountBox.onRendered(() => AccountBox.init());\n","Template.combined.helpers({\n\tisActive() {\n\t\tif (ChatSubscription.findOne({ t: { $in: ['c', 'p']}, f: { $ne: true }, open: true, rid: Session.get('openedRoom') }, { fields: { _id: 1 } })) {\n\t\t\treturn 'active';\n\t\t}\n\t},\n\n\trooms() {\n\t\tconst query = {\n\t\t\tt: { $in: ['c', 'p']},\n\t\t\topen: true\n\t\t};\n\n\t\tif (RocketChat.settings.get('Favorite_Rooms')) {\n\t\t\tquery.f = { $ne: true };\n\t\t}\n\n\t\tif (Meteor.user() && Meteor.user().settings && Meteor.user().settings.preferences && Meteor.user().settings.preferences.unreadRoomsMode) {\n\t\t\tquery.$or = [\n\t\t\t\t{ alert: { $ne: true } },\n\t\t\t\t{ hideUnreadStatus: true }\n\t\t\t];\n\t\t}\n\n\t\treturn ChatSubscription.find(query, { sort: { 'name': 1 }});\n\t}});\n\nTemplate.combined.events({\n\t'click .more-channels'() {\n\t\tSideNav.setFlex('listCombinedFlex');\n\t\treturn SideNav.openFlex();\n\t}\n});\n","/* globals KonchatNotification, menu */\n\nTemplate.chatRoomItem.helpers({\n\n\talert() {\n\t\tif (!this.hideUnreadStatus && (FlowRouter.getParam('_id') !== this.rid || !document.hasFocus())) {\n\t\t\treturn this.alert;\n\t\t}\n\t},\n\n\tunread() {\n\t\tif (((FlowRouter.getParam('_id') !== this.rid) || !document.hasFocus()) && (this.unread > 0)) {\n\t\t\treturn this.unread;\n\t\t}\n\t},\n\n\tuserStatus() {\n\t\tconst userStatus = RocketChat.roomTypes.getUserStatus(this.t, this.rid);\n\t\treturn `status-${ userStatus || 'offline' }`;\n\t},\n\n\tname() {\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name') && this.fname) {\n\t\t\treturn this.fname;\n\t\t}\n\n\t\treturn this.name;\n\t},\n\n\troomIcon() {\n\t\treturn RocketChat.roomTypes.getIcon(this.t);\n\t},\n\n\tactive() {\n\t\tif (Session.get('openedRoom') && Session.get('openedRoom') === this.rid || Session.get('openedRoom') === this._id) {\n\t\t\treturn 'active';\n\t\t}\n\t},\n\n\tcanLeave() {\n\t\tconst roomData = Session.get(`roomData${ this.rid }`);\n\n\t\tif (!roomData) { return false; }\n\n\t\tif (((roomData.cl != null) && !roomData.cl) || (roomData.t === 'd')) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t},\n\n\troute() {\n\t\treturn RocketChat.roomTypes.getRouteLink(this.t, this);\n\t},\n\n\tarchived() {\n\t\treturn this.archived ? 'archived' : undefined;\n\t}\n});\n\nTemplate.chatRoomItem.rendered = function() {\n\tif (!(FlowRouter.getParam('_id') && (FlowRouter.getParam('_id') === this.data.rid)) && !this.data.ls && (this.data.alert === true)) {\n\t\treturn KonchatNotification.newRoom(this.data.rid);\n\t}\n};\n\nTemplate.chatRoomItem.events({\n\n\t'click .open-room'() {\n\t\treturn menu.close();\n\t},\n\n\t'click .hide-room'(e) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tconst { rid } = this;\n\t\tconst { name } = this;\n\n\t\tconst warnText = (() => {\n\t\t\tswitch (this.t) {\n\t\t\t\tcase 'c': return 'Hide_Room_Warning';\n\t\t\t\tcase 'p': return 'Hide_Group_Warning';\n\t\t\t\tcase 'd': return 'Hide_Private_Warning';\n\t\t\t}\n\t\t})();\n\n\t\treturn swal({\n\t\t\ttitle: t('Are_you_sure'),\n\t\t\ttext: warnText ? t(warnText, name) : '',\n\t\t\ttype: 'warning',\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\tconfirmButtonText: t('Yes_hide_it'),\n\t\t\tcancelButtonText: t('Cancel'),\n\t\t\tcloseOnConfirm: true,\n\t\t\thtml: false\n\t\t}, function() {\n\t\t\tif (['channel', 'group', 'direct'].includes(FlowRouter.getRouteName()) && (Session.get('openedRoom') === rid)) {\n\t\t\t\tFlowRouter.go('home');\n\t\t\t}\n\n\t\t\treturn Meteor.call('hideRoom', rid, function(err) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn handleError(err);\n\t\t\t\t} else if (rid === Session.get('openedRoom')) {\n\t\t\t\t\treturn Session.delete('openedRoom');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\t'click .leave-room'(e) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tconst { rid } = this;\n\t\tconst { name } = this;\n\n\t\tconst warnText = (() => {\n\t\t\tswitch (false) {\n\t\t\t\tcase this.t !== 'c': return 'Leave_Room_Warning';\n\t\t\t\tcase this.t !== 'p': return 'Leave_Group_Warning';\n\t\t\t\tcase this.t !== 'd': return 'Leave_Private_Warning';\n\t\t\t}\n\t\t})();\n\t\treturn swal({\n\t\t\ttitle: t('Are_you_sure'),\n\t\t\ttext: t(warnText, name),\n\t\t\ttype: 'warning',\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\tconfirmButtonText: t('Yes_leave_it'),\n\t\t\tcancelButtonText: t('Cancel'),\n\t\t\tcloseOnConfirm: false,\n\t\t\thtml: false\n\t\t}, function(isConfirm) {\n\t\t\tif (isConfirm) {\n\t\t\t\treturn Meteor.call('leaveRoom', rid, function(err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn swal({\n\t\t\t\t\t\t\ttitle: t('Warning'),\n\t\t\t\t\t\t\ttext: handleError(err, false),\n\t\t\t\t\t\t\ttype: 'warning',\n\t\t\t\t\t\t\thtml: false\n\t\t\t\t\t\t});\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tswal.close();\n\t\t\t\t\t\tif (['channel', 'group', 'direct'].includes(FlowRouter.getRouteName()) && (Session.get('openedRoom') === rid)) {\n\t\t\t\t\t\t\tFlowRouter.go('home');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn RoomManager.close(rid);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn swal.close();\n\t\t\t}\n\t\t});\n\t}\n});\n","\n\nTemplate.channels.helpers({\n\tisActive() {\n\t\tif (ChatSubscription.findOne({ t: { $in: ['c']}, f: { $ne: true }, open: true, rid: Session.get('openedRoom') }, { fields: { _id: 1 } }) !== null) {\n\t\t\treturn 'active';\n\t\t}\n\t},\n\n\trooms() {\n\t\tconst query = {\n\t\t\tt: { $in: ['c']},\n\t\t\topen: true\n\t\t};\n\n\t\tif (RocketChat.settings.get('Favorite_Rooms')) {\n\t\t\tquery.f = { $ne: true };\n\t\t}\n\n\t\tif (Meteor.user() && Meteor.user().settings && Meteor.user().settings.preferences && Meteor.user().settings.preferences.unreadRoomsMode) {\n\t\t\tquery.$or = [\n\t\t\t\t{ alert: { $ne: true } },\n\t\t\t\t{ hideUnreadStatus: true }\n\t\t\t];\n\t\t}\n\n\t\treturn ChatSubscription.find(\n\t\t\tquery, { sort: { 't': 1, 'name': 1 }});\n\t}\n});\n\nTemplate.channels.events({\n\t'click .more-channels'() {\n\t\tSideNav.setFlex('listChannelsFlex');\n\t\treturn SideNav.openFlex();\n\t}\n});\n","Template.channelsAnonymous.helpers({\n\tisActive() {\n\t\tconst currentRoom = RocketChat.models.Rooms.findOne({ _id: Session.get('openedRoom') });\n\t\tif (currentRoom) {\n\t\t\treturn 'active';\n\t\t}\n\t},\n\n\trooms() {\n\t\tconst query = {\n\t\t\tt: 'c'\n\t\t};\n\n\t\treturn RocketChat.models.Rooms.find(query, { sort: { name: 1 } });\n\t}\n});\n\nTemplate.channelsAnonymous.events({\n\t'click .more-channels'() {\n\t\tSideNav.setFlex('listChannelsFlex');\n\t\tSideNav.openFlex();\n\t}\n});\n","Template.createCombinedFlex.helpers({\n\tselectedUsers() {\n\t\treturn Template.instance().selectedUsers.get();\n\t},\n\n\tname() {\n\t\treturn Template.instance().selectedUserNames[this.valueOf()];\n\t},\n\n\terror() {\n\t\treturn Template.instance().error.get();\n\t},\n\n\troomName() {\n\t\treturn Template.instance().roomName.get();\n\t},\n\n\tautocompleteSettings() {\n\t\treturn {\n\t\t\tlimit: 10,\n\t\t\t// inputDelay: 300\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\t// @TODO maybe change this 'collection' and/or template\n\t\t\t\t\tcollection: 'UserAndRoom',\n\t\t\t\t\tsubscription: 'userAutocomplete',\n\t\t\t\t\tfield: 'username',\n\t\t\t\t\ttemplate: Template.userSearch,\n\t\t\t\t\tnoMatchTemplate: Template.userSearchEmpty,\n\t\t\t\t\tmatchAll: true,\n\t\t\t\t\tfilter: {\n\t\t\t\t\t\texceptions: [Meteor.user().username].concat(Template.instance().selectedUsers.get())\n\t\t\t\t\t},\n\t\t\t\t\tselector(match) {\n\t\t\t\t\t\treturn { term: match };\n\t\t\t\t\t},\n\t\t\t\t\tsort: 'username'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t},\n\tprivateSwitchDisabled() {\n\t\treturn RocketChat.authz.hasAllPermission(['create-c', 'create-p']) ? '' : 'disabled';\n\t},\n\tprivateSwitchChecked() {\n\t\treturn RocketChat.authz.hasAllPermission('create-c') ? '' : 'checked';\n\t}\n});\n\nTemplate.createCombinedFlex.events({\n\t'autocompleteselect #channel-members'(event, instance, doc) {\n\t\tinstance.selectedUsers.set(instance.selectedUsers.get().concat(doc.username));\n\n\t\tinstance.selectedUserNames[doc.username] = doc.name;\n\n\t\tevent.currentTarget.value = '';\n\t\treturn event.currentTarget.focus();\n\t},\n\n\t'click .remove-room-member'() {\n\t\tconst self = this;\n\n\t\tlet users = Template.instance().selectedUsers.get();\n\t\tusers = _.reject(Template.instance().selectedUsers.get(), _id => _id === self.valueOf());\n\n\t\tTemplate.instance().selectedUsers.set(users);\n\n\t\treturn $('#channel-members').focus();\n\t},\n\n\t'click header'(e, instance) {\n\t\treturn SideNav.closeFlex(() => instance.clearForm());\n\t},\n\n\t'click .cancel-channel'(e, instance) {\n\t\treturn SideNav.closeFlex(() => instance.clearForm());\n\t},\n\n\t'mouseenter header'() {\n\t\treturn SideNav.overArrow();\n\t},\n\n\t'mouseleave header'() {\n\t\treturn SideNav.leaveArrow();\n\t},\n\n\t'keydown input[type=\"text\"]'() {\n\t\treturn Template.instance().error.set([]);\n\t},\n\n\t'keyup #channel-name'(e, instance) {\n\t\tif (e.keyCode === 13) {\n\t\t\treturn instance.$('#channel-members').focus();\n\t\t}\n\t},\n\n\t'keydown #channel-members'(e, instance) {\n\t\tif (($(e.currentTarget).val() === '') && (e.keyCode === 13)) {\n\t\t\treturn instance.$('.save-channel').click();\n\t\t}\n\t},\n\n\t'click .save-channel'(e, instance) {\n\t\tconst err = SideNav.validate();\n\t\tconst name = instance.find('#channel-name').value.toLowerCase().trim().replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\t\tconst privateGroup = instance.find('#channel-type').checked;\n\t\tconst readOnly = instance.find('#channel-ro').checked;\n\t\tconst createRoute = privateGroup ? 'createPrivateGroup' : 'createChannel';\n\t\tconst successRoute = privateGroup ? 'group' : 'channel';\n\t\tinstance.roomName.set(name);\n\t\tif (!err) {\n\t\t\treturn Meteor.call(createRoute, name, instance.selectedUsers.get(), readOnly, function(err, result) {\n\t\t\t\tif (err) {\n\t\t\t\t\tif (err.error === 'error-invalid-name') {\n\t\t\t\t\t\tinstance.error.set({ invalid: true });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (err.error === 'error-duplicate-channel-name') {\n\t\t\t\t\t\tinstance.error.set({ duplicate: true });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (err.error === 'error-archived-duplicate-name') {\n\t\t\t\t\t\tinstance.error.set({ archivedduplicate: true });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tSideNav.closeFlex(() => instance.clearForm());\n\n\t\t\t\tif (!privateGroup) {\n\t\t\t\t\tRocketChat.callbacks.run('aftercreateCombined', { _id: result.rid, name });\n\t\t\t\t}\n\n\t\t\t\treturn FlowRouter.go(successRoute, { name }, FlowRouter.current().queryParams);\n\t\t\t});\n\t\t} else {\n\t\t\treturn instance.error.set({ fields: err });\n\t\t}\n\t}\n});\n\nTemplate.createCombinedFlex.onCreated(function() {\n\tconst instance = this;\n\tinstance.selectedUsers = new ReactiveVar([]);\n\tinstance.selectedUserNames = {};\n\tinstance.error = new ReactiveVar([]);\n\tinstance.roomName = new ReactiveVar('');\n\n\treturn instance.clearForm = function() {\n\t\tinstance.error.set([]);\n\t\tinstance.roomName.set('');\n\t\tinstance.selectedUsers.set([]);\n\t\tinstance.find('#channel-name').value = '';\n\t\tinstance.find('#channel-type').checked = false;\n\t\treturn instance.find('#channel-members').value = '';\n\t};\n});\n","Template.directMessages.helpers({\n\tisActive() {\n\t\tif (ChatSubscription.findOne({ t: { $in: ['d']}, f: { $ne: true }, open: true, rid: Session.get('openedRoom') }, { fields: { _id: 1 } })) {\n\t\t\treturn 'active';\n\t\t}\n\t},\n\n\trooms() {\n\t\tconst query = { t: { $in: ['d']}, f: { $ne: true }, open: true };\n\t\tconst sort = { 't': 1 };\n\n\t\tif (Meteor.user() && Meteor.user().settings && Meteor.user().settings.preferences && Meteor.user().settings.preferences.unreadRoomsMode) {\n\t\t\tquery.$or = [\n\t\t\t\t{ alert: { $ne: true } },\n\t\t\t\t{ hideUnreadStatus: true }\n\t\t\t];\n\t\t}\n\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name')) {\n\t\t\tsort.fname = 1;\n\t\t}\n\t\tsort.name = 1;\n\n\t\treturn ChatSubscription.find(query, { sort });\n\t}\n});\n","Template.listChannelsFlex.helpers({\n\tchannel() {\n\t\treturn Template.instance().channelsList.get();\n\t},\n\thasMore() {\n\t\treturn Template.instance().hasMore.get();\n\t},\n\tsortChannelsSelected(sort) {\n\t\treturn Template.instance().sortChannels.get() === sort;\n\t},\n\tsortSubscriptionsSelected(sort) {\n\t\treturn Template.instance().sortSubscriptions.get() === sort;\n\t},\n\tshowSelected(show) {\n\t\treturn Template.instance().show.get() === show;\n\t},\n\tmember() {\n\t\treturn !!RocketChat.models.Subscriptions.findOne({ name: this.name, open: true });\n\t},\n\thidden() {\n\t\treturn !!RocketChat.models.Subscriptions.findOne({ name: this.name, open: false });\n\t}\n});\n\nTemplate.listChannelsFlex.events({\n\t'click header'() {\n\t\treturn SideNav.closeFlex();\n\t},\n\n\t'click .channel-link'() {\n\t\treturn SideNav.closeFlex();\n\t},\n\n\t'click footer .create'() {\n\t\tif (RocketChat.authz.hasAtLeastOnePermission('create-c')) {\n\t\t\treturn SideNav.setFlex('createChannelFlex');\n\t\t}\n\t},\n\n\t'mouseenter header'() {\n\t\treturn SideNav.overArrow();\n\t},\n\n\t'mouseleave header'() {\n\t\treturn SideNav.leaveArrow();\n\t},\n\n\t'scroll .content': _.throttle(function(e, t) {\n\t\tif (t.hasMore.get() && (e.target.scrollTop >= (e.target.scrollHeight - e.target.clientHeight))) {\n\t\t\treturn t.limit.set(t.limit.get() + 50);\n\t\t}\n\t}\n\t, 200),\n\n\t'submit .search-form'(e) {\n\t\treturn e.preventDefault();\n\t},\n\n\t'keyup #channel-search': _.debounce((e, instance) => instance.nameFilter.set($(e.currentTarget).val())\n\t, 300),\n\n\t'change #sort-channels'(e, instance) {\n\t\treturn instance.sortChannels.set($(e.currentTarget).val());\n\t},\n\n\t'change #sort-subscriptions'(e, instance) {\n\t\treturn instance.sortSubscriptions.set($(e.currentTarget).val());\n\t},\n\n\t'change #show'(e, instance) {\n\t\tconst show = $(e.currentTarget).val();\n\t\tif (show === 'joined') {\n\t\t\tinstance.$('#sort-channels').hide();\n\t\t\tinstance.$('#sort-subscriptions').show();\n\t\t} else {\n\t\t\tinstance.$('#sort-channels').show();\n\t\t\tinstance.$('#sort-subscriptions').hide();\n\t\t}\n\t\treturn instance.show.set(show);\n\t}\n});\n\nTemplate.listChannelsFlex.onCreated(function() {\n\tthis.channelsList = new ReactiveVar([]);\n\tthis.hasMore = new ReactiveVar(true);\n\tthis.limit = new ReactiveVar(50);\n\tthis.nameFilter = new ReactiveVar('');\n\tthis.sortChannels = new ReactiveVar('name');\n\tthis.sortSubscriptions = new ReactiveVar('name');\n\tthis.show = new ReactiveVar('all');\n\n\treturn this.autorun(() => {\n\t\tif (this.show.get() === 'joined') {\n\t\t\tthis.hasMore.set(true);\n\t\t\tconst options = { fields: { name: 1 } };\n\t\t\tif (_.isNumber(this.limit.get())) {\n\t\t\t\toptions.limit = this.limit.get();\n\t\t\t}\n\t\t\tif (_.trim(this.sortSubscriptions.get())) {\n\t\t\t\tswitch (this.sortSubscriptions.get()) {\n\t\t\t\t\tcase 'name':\n\t\t\t\t\t\toptions.sort = { name: 1 };\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'ls':\n\t\t\t\t\t\toptions.sort = { ls: -1 };\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.channelsList.set(RocketChat.models.Subscriptions.find({\n\t\t\t\tname: new RegExp(s.trim(s.escapeRegExp(this.nameFilter.get())), 'i'),\n\t\t\t\tt: 'c'\n\t\t\t}, options).fetch()\n\t\t\t);\n\t\t\tif (this.channelsList.get().length < this.limit.get()) {\n\t\t\t\treturn this.hasMore.set(false);\n\t\t\t}\n\t\t} else {\n\t\t\treturn Meteor.call('channelsList', this.nameFilter.get(), 'public', this.limit.get(), this.sortChannels.get(), (err, result) => {\n\t\t\t\tif (result) {\n\t\t\t\t\tthis.hasMore.set(true);\n\t\t\t\t\tthis.channelsList.set(result.channels);\n\t\t\t\t\tif (result.channels.length < this.limit.get()) {\n\t\t\t\t\t\treturn this.hasMore.set(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\t);\n});\n","Template.listCombinedFlex.helpers({\n\tchannel() {\n\t\treturn Template.instance().channelsList.get();\n\t},\n\thasMore() {\n\t\treturn Template.instance().hasMore.get();\n\t},\n\tsortChannelsSelected(sort) {\n\t\treturn Template.instance().sortChannels.get() === sort;\n\t},\n\tsortSubscriptionsSelected(sort) {\n\t\treturn Template.instance().sortSubscriptions.get() === sort;\n\t},\n\tshowSelected(show) {\n\t\treturn Template.instance().show.get() === show;\n\t},\n\tchannelTypeSelected(type) {\n\t\treturn Template.instance().channelType.get() === type;\n\t},\n\tmember() {\n\t\treturn !!RocketChat.models.Subscriptions.findOne({ name: this.name, open: true });\n\t},\n\thidden() {\n\t\treturn !!RocketChat.models.Subscriptions.findOne({ name: this.name, open: false });\n\t},\n\troomIcon() {\n\t\treturn RocketChat.roomTypes.getIcon(this.t);\n\t},\n\turl() {\n\t\treturn this.t === 'p' ? 'group' : 'channel';\n\t}\n});\n\nTemplate.listCombinedFlex.events({\n\t'click header'() {\n\t\treturn SideNav.closeFlex();\n\t},\n\n\t'click .channel-link'() {\n\t\treturn SideNav.closeFlex();\n\t},\n\n\t'mouseenter header'() {\n\t\treturn SideNav.overArrow();\n\t},\n\n\t'mouseleave header'() {\n\t\treturn SideNav.leaveArrow();\n\t},\n\n\t'scroll .content': _.throttle(function(e, t) {\n\t\tif (t.hasMore.get() && (e.target.scrollTop >= (e.target.scrollHeight - e.target.clientHeight))) {\n\t\t\treturn t.limit.set(t.limit.get() + 50);\n\t\t}\n\t}\n\t, 200),\n\n\t'submit .search-form'(e) {\n\t\treturn e.preventDefault();\n\t},\n\n\t'keyup #channel-search': _.debounce((e, instance) => instance.nameFilter.set($(e.currentTarget).val())\n\t, 300),\n\n\t'change #sort-channels'(e, instance) {\n\t\treturn instance.sortChannels.set($(e.currentTarget).val());\n\t},\n\n\t'change #channel-type'(e, instance) {\n\t\treturn instance.channelType.set($(e.currentTarget).val());\n\t},\n\n\t'change #sort-subscriptions'(e, instance) {\n\t\treturn instance.sortSubscriptions.set($(e.currentTarget).val());\n\t},\n\n\t'change #show'(e, instance) {\n\t\tconst show = $(e.currentTarget).val();\n\t\tif (show === 'joined') {\n\t\t\tinstance.$('#sort-channels').hide();\n\t\t\tinstance.$('#sort-subscriptions').show();\n\t\t} else {\n\t\t\tinstance.$('#sort-channels').show();\n\t\t\tinstance.$('#sort-subscriptions').hide();\n\t\t}\n\t\treturn instance.show.set(show);\n\t}\n});\n\nTemplate.listCombinedFlex.onCreated(function() {\n\tthis.channelsList = new ReactiveVar([]);\n\tthis.hasMore = new ReactiveVar(true);\n\tthis.limit = new ReactiveVar(50);\n\tthis.nameFilter = new ReactiveVar('');\n\tthis.sortChannels = new ReactiveVar('name');\n\tthis.sortSubscriptions = new ReactiveVar('name');\n\tthis.channelType = new ReactiveVar('all');\n\tthis.show = new ReactiveVar('all');\n\tthis.type = this.t === 'p' ? 'group' : 'channel';\n\n\treturn this.autorun(() => {\n\t\tif (this.show.get() === 'joined') {\n\t\t\tthis.hasMore.set(true);\n\t\t\tconst options = { fields: { name: 1, t: 1 } };\n\t\t\tif (_.isNumber(this.limit.get())) {\n\t\t\t\toptions.limit = this.limit.get();\n\t\t\t}\n\t\t\tif (_.trim(this.sortSubscriptions.get())) {\n\t\t\t\tswitch (this.sortSubscriptions.get()) {\n\t\t\t\t\tcase 'name':\n\t\t\t\t\t\toptions.sort = { name: 1 };\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'ls':\n\t\t\t\t\t\toptions.sort = { ls: -1 };\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet type = {$in: ['c', 'p']};\n\t\t\tif (_.trim(this.channelType.get())) {\n\t\t\t\tswitch (this.channelType.get()) {\n\t\t\t\t\tcase 'public':\n\t\t\t\t\t\ttype = 'c';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'private':\n\t\t\t\t\t\ttype = 'p';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.channelsList.set(RocketChat.models.Subscriptions.find({\n\t\t\t\tname: new RegExp(s.trim(s.escapeRegExp(this.nameFilter.get())), 'i'),\n\t\t\t\tt: type\n\t\t\t}, options).fetch()\n\t\t\t);\n\t\t\tif (this.channelsList.get().length < this.limit.get()) {\n\t\t\t\treturn this.hasMore.set(false);\n\t\t\t}\n\t\t} else {\n\t\t\treturn Meteor.call('channelsList', this.nameFilter.get(), this.channelType.get(), this.limit.get(), this.sortChannels.get(), (err, result) => {\n\t\t\t\tif (result) {\n\t\t\t\t\tthis.hasMore.set(true);\n\t\t\t\t\tthis.channelsList.set(result.channels);\n\t\t\t\t\tif (result.channels.length < this.limit.get()) {\n\t\t\t\t\t\treturn this.hasMore.set(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\t);\n});\n","Template.listPrivateGroupsFlex.helpers({\n\tgroups() {\n\t\treturn Template.instance().groups.get();\n\t},\n\thasMore() {\n\t\treturn Template.instance().hasMore.get();\n\t},\n\tsortSelected(sort) {\n\t\treturn Template.instance().sort.get() === sort;\n\t},\n\thidden() {\n\t\treturn !!RocketChat.models.Subscriptions.findOne({ name: this.name, open: false });\n\t}\n});\n\nTemplate.listPrivateGroupsFlex.events({\n\t'click header'() {\n\t\treturn SideNav.closeFlex();\n\t},\n\n\t'click .channel-link'() {\n\t\treturn SideNav.closeFlex();\n\t},\n\n\t'mouseenter header'() {\n\t\treturn SideNav.overArrow();\n\t},\n\n\t'mouseleave header'() {\n\t\treturn SideNav.leaveArrow();\n\t},\n\n\t'scroll .content': _.throttle(function(e, t) {\n\t\tif (t.hasMore.get() && (e.target.scrollTop >= (e.target.scrollHeight - e.target.clientHeight))) {\n\t\t\treturn t.limit.set(t.limit.get() + 50);\n\t\t}\n\t}\n\t, 200),\n\n\t'keyup #channel-search': _.debounce((e, instance) => instance.nameFilter.set($(e.currentTarget).val())\n\t, 300),\n\n\t'change #sort'(e, instance) {\n\t\treturn instance.sort.set($(e.currentTarget).val());\n\t}\n});\n\nTemplate.listPrivateGroupsFlex.onCreated(function() {\n\tthis.groups = new ReactiveVar([]);\n\tthis.hasMore = new ReactiveVar(true);\n\tthis.limit = new ReactiveVar(50);\n\tthis.nameFilter = new ReactiveVar('');\n\tthis.sort = new ReactiveVar('name');\n\n\treturn this.autorun(() => {\n\t\tthis.hasMore.set(true);\n\t\tconst options = { fields: { name: 1 } };\n\t\tif (_.isNumber(this.limit.get())) {\n\t\t\toptions.limit = this.limit.get();\n\t\t}\n\t\tif (_.trim(this.sort.get())) {\n\t\t\tswitch (this.sort.get()) {\n\t\t\t\tcase 'name':\n\t\t\t\t\toptions.sort = { name: 1 };\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ls':\n\t\t\t\t\toptions.sort = { ls: -1 };\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.groups.set(RocketChat.models.Subscriptions.find({\n\t\t\tname: new RegExp(s.trim(s.escapeRegExp(this.nameFilter.get())), 'i'),\n\t\t\tt: 'p',\n\t\t\tarchived: { $ne: true }\n\t\t}, options).fetch()\n\t\t);\n\t\tif (this.groups.get().length < this.limit.get()) {\n\t\t\treturn this.hasMore.set(false);\n\t\t}\n\t}\n\t);\n});\n","Template.privateGroups.helpers({\n\tisActive() {\n\t\tif (ChatSubscription.findOne({ t: { $in: ['p']}, f: { $ne: true }, open: true, rid: Session.get('openedRoom') }, { fields: { _id: 1 } })) {\n\t\t\treturn 'active';\n\t\t}\n\t},\n\n\trooms() {\n\t\tconst query = { t: { $in: ['p']}, f: { $ne: true }, open: true };\n\n\t\tif (Meteor.user() && Meteor.user().settings && Meteor.user().settings.preferences && Meteor.user().settings.preferences.unreadRoomsMode) {\n\t\t\tquery.$or = [\n\t\t\t\t{ alert: { $ne: true } },\n\t\t\t\t{ hideUnreadStatus: true }\n\t\t\t];\n\t\t}\n\n\t\treturn ChatSubscription.find(query, { sort: { 't': 1, 'name': 1 }});\n\t},\n\n\ttotal() {\n\t\treturn ChatSubscription.find({ t: { $in: ['p']}, f: { $ne: true } }).count();\n\t},\n\n\ttotalOpen() {\n\t\treturn ChatSubscription.find({ t: { $in: ['p']}, f: { $ne: true }, open: true }).count();\n\t}\n});\n\nTemplate.privateGroups.events({\n\t'click .more-groups'() {\n\t\tSideNav.setFlex('listPrivateGroupsFlex');\n\t\treturn SideNav.openFlex();\n\t}\n});\n","Template.privateGroupsFlex.helpers({\n\tselectedUsers() {\n\t\treturn Template.instance().selectedUsers.get();\n\t},\n\n\tname() {\n\t\treturn Template.instance().selectedUserNames[this.valueOf()];\n\t},\n\n\tgroupName() {\n\t\treturn Template.instance().groupName.get();\n\t},\n\n\terror() {\n\t\treturn Template.instance().error.get();\n\t},\n\n\tautocompleteSettings() {\n\t\treturn {\n\t\t\tlimit: 10,\n\t\t\t// inputDelay: 300\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\t// @TODO maybe change this 'collection' and/or template\n\t\t\t\t\tcollection: 'UserAndRoom',\n\t\t\t\t\tsubscription: 'userAutocomplete',\n\t\t\t\t\tfield: 'username',\n\t\t\t\t\ttemplate: Template.userSearch,\n\t\t\t\t\tnoMatchTemplate: Template.userSearchEmpty,\n\t\t\t\t\tmatchAll: true,\n\t\t\t\t\tfilter: {\n\t\t\t\t\t\texceptions: [Meteor.user().username].concat(Template.instance().selectedUsers.get())\n\t\t\t\t\t},\n\t\t\t\t\tselector(match) {\n\t\t\t\t\t\treturn { term: match };\n\t\t\t\t\t},\n\t\t\t\t\tsort: 'username'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}});\n\nTemplate.privateGroupsFlex.events({\n\t'autocompleteselect #pvt-group-members'(event, instance, doc) {\n\t\tinstance.selectedUsers.set(instance.selectedUsers.get().concat(doc.username));\n\n\t\tinstance.selectedUserNames[doc.username] = doc.name;\n\n\t\tevent.currentTarget.value = '';\n\t\treturn event.currentTarget.focus();\n\t},\n\n\t'click .remove-room-member'() {\n\t\tconst self = this;\n\t\tlet users = Template.instance().selectedUsers.get();\n\t\tusers = _.reject(Template.instance().selectedUsers.get(), _id => _id === self.valueOf());\n\n\t\tTemplate.instance().selectedUsers.set(users);\n\n\t\treturn $('#pvt-group-members').focus();\n\t},\n\n\t'click .cancel-pvt-group'(e, instance) {\n\t\treturn SideNav.closeFlex(() => instance.clearForm());\n\t},\n\n\t'click header'(e, instance) {\n\t\treturn SideNav.closeFlex(() => instance.clearForm());\n\t},\n\n\t'mouseenter header'() {\n\t\treturn SideNav.overArrow();\n\t},\n\n\t'mouseleave header'() {\n\t\treturn SideNav.leaveArrow();\n\t},\n\n\t'keydown input[type=\"text\"]'() {\n\t\treturn Template.instance().error.set([]);\n\t},\n\n\t'keyup #pvt-group-name'(e, instance) {\n\t\tif (e.keyCode === 13) {\n\t\t\treturn instance.$('#pvt-group-members').focus();\n\t\t}\n\t},\n\n\t'keydown #pvt-group-members'(e, instance) {\n\t\tif (($(e.currentTarget).val() === '') && (e.keyCode === 13)) {\n\t\t\treturn instance.$('.save-pvt-group').click();\n\t\t}\n\t},\n\n\t'click .save-pvt-group'(e, instance) {\n\t\tconst err = SideNav.validate();\n\t\tconst name = instance.find('#pvt-group-name').value.toLowerCase().trim();\n\t\tconst readOnly = instance.find('#channel-ro').checked;\n\t\tinstance.groupName.set(name);\n\t\tif (!err) {\n\t\t\treturn Meteor.call('createPrivateGroup', name, instance.selectedUsers.get(), readOnly, function(err) {\n\t\t\t\tif (err) {\n\t\t\t\t\tif (err.error === 'error-invalid-name') {\n\t\t\t\t\t\tinstance.error.set({ invalid: true });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (err.error === 'error-duplicate-channel-name') {\n\t\t\t\t\t\tinstance.error.set({ duplicate: true });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (err.error === 'error-archived-duplicate-name') {\n\t\t\t\t\t\tinstance.error.set({ archivedduplicate: true });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\treturn handleError(err);\n\t\t\t\t}\n\t\t\t\tSideNav.closeFlex();\n\t\t\t\tinstance.clearForm();\n\t\t\t\treturn FlowRouter.go('group', { name }, FlowRouter.current().queryParams);\n\t\t\t});\n\t\t} else {\n\t\t\treturn Template.instance().error.set({fields: err});\n\t\t}\n\t}\n});\n\nTemplate.privateGroupsFlex.onCreated(function() {\n\tconst instance = this;\n\tinstance.selectedUsers = new ReactiveVar([]);\n\tinstance.selectedUserNames = {};\n\tinstance.error = new ReactiveVar([]);\n\tinstance.groupName = new ReactiveVar('');\n\n\treturn instance.clearForm = function() {\n\t\tinstance.error.set([]);\n\t\tinstance.groupName.set('');\n\t\tinstance.selectedUsers.set([]);\n\t\tinstance.find('#pvt-group-name').value = '';\n\t\treturn instance.find('#pvt-group-members').value = '';\n\t};\n});\n"," /* globals menu*/\n\nTemplate.sideNav.helpers({\n\tflexTemplate() {\n\t\treturn SideNav.getFlex().template;\n\t},\n\n\tflexData() {\n\t\treturn SideNav.getFlex().data;\n\t},\n\n\tfooter() {\n\t\treturn RocketChat.settings.get('Layout_Sidenav_Footer');\n\t},\n\n\tshowStarredRooms() {\n\t\tconst favoritesEnabled = RocketChat.settings.get('Favorite_Rooms');\n\t\tconst hasFavoriteRoomOpened = ChatSubscription.findOne({ f: true, open: true });\n\n\t\tif (favoritesEnabled && hasFavoriteRoomOpened) { return true; }\n\t},\n\n\troomType() {\n\t\treturn RocketChat.roomTypes.getTypes();\n\t},\n\n\tcanShowRoomType() {\n\t\tlet userPref = undefined;\n\t\tif (Meteor.user() && Meteor.user().settings && Meteor.user().settings.preferences) {\n\t\t\tuserPref = Meteor.user().settings.preferences.mergeChannels;\n\t\t}\n\t\tconst globalPref = RocketChat.settings.get('UI_Merge_Channels_Groups');\n\t\tconst mergeChannels = (userPref != null) ? userPref : globalPref;\n\t\tif (mergeChannels) {\n\t\t\treturn RocketChat.roomTypes.checkCondition(this) && (this.template !== 'privateGroups');\n\t\t} else {\n\t\t\treturn RocketChat.roomTypes.checkCondition(this);\n\t\t}\n\t},\n\n\ttemplateName() {\n\t\tlet userPref = undefined;\n\t\tif (Meteor.user() && Meteor.user().settings && Meteor.user().settings.preferences) {\n\t\t\tuserPref = Meteor.user().settings.preferences.mergeChannels;\n\t\t}\n\t\tconst globalPref = RocketChat.settings.get('UI_Merge_Channels_Groups');\n\t\tconst mergeChannels = (userPref != null) ? userPref : globalPref;\n\t\tif (mergeChannels) {\n\t\t\treturn this.template === 'channels' ? 'combined' : this.template;\n\t\t} else {\n\t\t\treturn this.template;\n\t\t}\n\t}\n});\n\nTemplate.sideNav.events({\n\t'click .close-flex'() {\n\t\treturn SideNav.closeFlex();\n\t},\n\n\t'click .arrow'() {\n\t\treturn SideNav.toggleCurrent();\n\t},\n\n\t'mouseenter .header'() {\n\t\treturn SideNav.overArrow();\n\t},\n\n\t'mouseleave .header'() {\n\t\treturn SideNav.leaveArrow();\n\t},\n\n\t'scroll .rooms-list'() {\n\t\treturn menu.updateUnreadBars();\n\t},\n\n\t'dropped .side-nav'(e) {\n\t\treturn e.preventDefault();\n\t}\n});\n\nTemplate.sideNav.onRendered(function() {\n\tSideNav.init();\n\tmenu.init();\n\n\treturn Meteor.defer(() => menu.updateUnreadBars());\n});\n","Template.starredRooms.helpers({\n\tisActive() {\n\t\tif (ChatSubscription.findOne({ f: true, rid: Session.get('openedRoom') }, { fields: { _id: 1 } })) {\n\t\t\treturn 'active';\n\t\t}\n\t},\n\n\trooms() {\n\t\tconst query = { f: true, open: true };\n\n\t\tif (Meteor.user().settings && Meteor.user().settings.preferences && Meteor.user().settings.preferences.unreadRoomsMode) {\n\t\t\tquery.$or = [\n\t\t\t\t{ alert: { $ne: true } },\n\t\t\t\t{ hideUnreadStatus: true }\n\t\t\t];\n\t\t}\n\n\t\treturn ChatSubscription.find(query, { sort: { 't': 1, 'name': 1 }\n\t\t});\n\t},\n\ttotal() {\n\t\treturn ChatSubscription.find({ f: true }).count();\n\t}\n});\n","/* global menu */\nlet isLoading;\nlet filterText = '';\nlet usernamesFromClient;\nlet resultsFromClient;\n\nMeteor.startup(() => {\n\tisLoading = new ReactiveVar(false);\n});\n\nconst toolbarSearch = {\n\tshortcut: false,\n\tclear() {\n\t\tconst $inputMessage = $('textarea.input-message');\n\n\t\tif (0 === $inputMessage.length) {\n\t\t\treturn;\n\t\t}\n\n\t\t$inputMessage.focus();\n\t\t$('.toolbar-search__input').val('');\n\n\t\tif (this.shortcut) {\n\t\t\tmenu.close();\n\t\t}\n\t},\n\tfocus(fromShortcut) {\n\t\tmenu.open();\n\t\t$('.toolbar-search__input').focus();\n\t\tthis.shortcut = fromShortcut;\n\t}\n};\n\nthis.toolbarSearch = toolbarSearch;\n\nconst getFromServer = (cb, type) => {\n\tisLoading.set(true);\n\tconst currentFilter = filterText;\n\n\tMeteor.call('spotlight', currentFilter, usernamesFromClient, type, (err, results) => {\n\t\tif (currentFilter !== filterText) {\n\t\t\treturn;\n\t\t}\n\n\t\tisLoading.set(false);\n\n\t\tif (err) {\n\t\t\tconsole.log(err);\n\t\t\treturn false;\n\t\t}\n\n\t\tconst resultsFromServer = [];\n\t\tconst usersLength = results.users.length;\n\t\tconst roomsLength = results.rooms.length;\n\n\t\tif (usersLength) {\n\t\t\tfor (let i = 0; i < usersLength; i++) {\n\t\t\t\tresultsFromServer.push({\n\t\t\t\t\t_id: results.users[i]._id,\n\t\t\t\t\tt: 'd',\n\t\t\t\t\tname: results.users[i].username,\n\t\t\t\t\tfname: results.users[i].name\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (roomsLength) {\n\t\t\tfor (let i = 0; i < roomsLength; i++) {\n\t\t\t\tconst alreadyOnClient = resultsFromClient.find(item => item._id === results.rooms[i]._id);\n\t\t\t\tif (alreadyOnClient) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tresultsFromServer.push({\n\t\t\t\t\t_id: results.rooms[i]._id,\n\t\t\t\t\tt: results.rooms[i].t,\n\t\t\t\t\tname: results.rooms[i].name\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (resultsFromServer.length) {\n\t\t\tcb(resultsFromClient.concat(resultsFromServer));\n\t\t}\n\t});\n};\n\nconst getFromServerDebounced = _.debounce(getFromServer, 500);\n\nTemplate.toolbar.helpers({\n\tcanCreate() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['create-c', 'create-p']);\n\t},\n\tresults() {\n\t\treturn Template.instance().resultsList.get();\n\t},\n\tgetPlaceholder() {\n\t\tlet placeholder = TAPi18n.__('Search');\n\n\t\tif (!Meteor.Device.isDesktop()) {\n\t\t\treturn placeholder;\n\t\t} else if (window.navigator.platform.toLowerCase().includes('mac')) {\n\t\t\tplaceholder = `${ placeholder } (CMD+K)`;\n\t\t} else {\n\t\t\tplaceholder = `${ placeholder } (Ctrl+K)`;\n\t\t}\n\n\t\treturn placeholder;\n\t},\n\tpopupConfig() {\n\t\tconst open = new ReactiveVar(false);\n\n\t\tTracker.autorun(() => {\n\t\t\tif (open.get() === false) {\n\t\t\t\ttoolbarSearch.clear();\n\t\t\t}\n\t\t});\n\n\t\tconst config = {\n\t\t\tcls: 'search-results-list',\n\t\t\tcollection: Meteor.userId() ? RocketChat.models.Subscriptions : RocketChat.models.Rooms,\n\t\t\ttemplate: 'toolbarSearchList',\n\t\t\temptyTemplate: 'toolbarSearchListEmpty',\n\t\t\tinput: '.toolbar-search__input',\n\t\t\tcleanOnEnter: true,\n\t\t\tcloseOnEsc: false,\n\t\t\tblurOnSelectItem: true,\n\t\t\tisLoading,\n\t\t\topen,\n\t\t\tgetFilter(collection, filter, cb) {\n\t\t\t\tfilterText = filter;\n\n\t\t\t\tconst type = {\n\t\t\t\t\tusers: true,\n\t\t\t\t\trooms: true\n\t\t\t\t};\n\n\t\t\t\tconst query = {\n\t\t\t\t\trid: {\n\t\t\t\t\t\t$ne: Session.get('openedRoom')\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (!Meteor.userId()) {\n\t\t\t\t\tquery._id = query.rid;\n\t\t\t\t\tdelete query.rid;\n\t\t\t\t}\n\n\t\t\t\tif (filterText[0] === '#') {\n\t\t\t\t\tfilterText = filterText.slice(1);\n\t\t\t\t\ttype.users = false;\n\t\t\t\t\tquery.t = 'c';\n\t\t\t\t}\n\n\t\t\t\tif (filterText[0] === '@') {\n\t\t\t\t\tfilterText = filterText.slice(1);\n\t\t\t\t\ttype.rooms = false;\n\t\t\t\t\tquery.t = 'd';\n\t\t\t\t}\n\n\t\t\t\tconst searchQuery = new RegExp((RegExp.escape(filterText)), 'i');\n\t\t\t\tquery.$or = [\n\t\t\t\t\t{ name: searchQuery },\n\t\t\t\t\t{ fname: searchQuery }\n\t\t\t\t];\n\n\t\t\t\tresultsFromClient = collection.find(query, {limit: 20, sort: {unread: -1, ls: -1}}).fetch();\n\n\t\t\t\tconst resultsFromClientLength = resultsFromClient.length;\n\t\t\t\tconst user = Meteor.user();\n\t\t\t\tif (user) {\n\t\t\t\t\tusernamesFromClient = [user];\n\t\t\t\t}\n\n\t\t\t\tfor (let i = 0; i < resultsFromClientLength; i++) {\n\t\t\t\t\tif (resultsFromClient[i].t === 'd') {\n\t\t\t\t\t\tusernamesFromClient.push(resultsFromClient[i].name);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcb(resultsFromClient);\n\n\t\t\t\t// Use `filter` here to get results for `#` or `@` filter only\n\t\t\t\tif (resultsFromClient.length < 20) {\n\t\t\t\t\tgetFromServerDebounced(cb, type);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetValue(_id, collection, records) {\n\t\t\t\tconst doc = _.findWhere(records, {_id});\n\n\t\t\t\tRocketChat.roomTypes.openRouteLink(doc.t, doc, FlowRouter.current().queryParams);\n\t\t\t\tmenu.close();\n\t\t\t}\n\t\t};\n\n\t\treturn config;\n\t}\n});\n\nTemplate.toolbar.events({\n\t'keyup .toolbar-search__input'(e) {\n\t\tif (e.which === 27) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\n\t\t\ttoolbarSearch.clear();\n\t\t}\n\t},\n\n\t'click .toolbar-search__input'() {\n\t\ttoolbarSearch.shortcut = false;\n\t},\n\n\t'click .toolbar-search__create-channel, touchend .toolbar-search__create-channel'(e) {\n\t\tif (RocketChat.authz.hasAtLeastOnePermission(['create-c', 'create-p'])) {\n\t\t\tSideNav.setFlex('createCombinedFlex');\n\t\t\tSideNav.openFlex();\n\t\t} else {\n\t\t\te.preventDefault();\n\t\t}\n\t},\n\n\t'blur .toolbar-search__input'() {\n\t\ttoolbarSearch.clear();\n\t}\n});\n\nTemplate.toolbarSearchList.helpers({\n\ticon() {\n\t\treturn RocketChat.roomTypes.getIcon(this.t);\n\t},\n\tuserStatus() {\n\t\tif (this.t === 'd') {\n\t\t\treturn `status-${ Session.get(`user_${ this.name }_status`) || 'offline' }`;\n\t\t} else {\n\t\t\treturn `status-${ RocketChat.roomTypes.getUserStatus(this.t, this.rid || this._id) || 'offline' }`;\n\t\t}\n\t},\n\n\tdisplayName() {\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name') && this.fname) {\n\t\t\treturn this.fname;\n\t\t} else {\n\t\t\treturn this.name;\n\t\t}\n\t}\n});\n","Template.unreadRooms.helpers({\n\thasUnread() {\n\t\tif ((Meteor.user() && Meteor.user().settings && Meteor.user().settings.preferences && Meteor.user().settings.preferences.unreadRoomsMode) && (Template.instance().unreadRooms.count() > 0)) {\n\t\t\treturn 'has-unread';\n\t\t}\n\t},\n\n\trooms() {\n\t\treturn Template.instance().unreadRooms;\n\t}\n});\n\nTemplate.unreadRooms.onCreated(function() {\n\treturn this.autorun(() => {\n\t\tconst query = {\n\t\t\talert: true,\n\t\t\topen: true,\n\t\t\thideUnreadStatus: { $ne: true }\n\t\t};\n\n\t\treturn this.unreadRooms = ChatSubscription.find(query, { sort: { 't': 1, 'name': 1 }});\n\t});\n});\n"]}