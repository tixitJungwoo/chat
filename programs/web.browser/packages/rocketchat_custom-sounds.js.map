{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:custom-sounds/admin/startup.js","meteor://ðŸ’»app/packages/rocketchat:custom-sounds/admin/adminSounds.js","meteor://ðŸ’»app/packages/rocketchat:custom-sounds/admin/soundEdit.js","meteor://ðŸ’»app/packages/rocketchat:custom-sounds/admin/soundInfo.js","meteor://ðŸ’»app/packages/rocketchat:custom-sounds/admin/route.js","meteor://ðŸ’»app/packages/rocketchat:custom-sounds/client/lib/CustomSounds.js","meteor://ðŸ’»app/packages/rocketchat:custom-sounds/client/models/CustomSounds.js","meteor://ðŸ’»app/packages/rocketchat:custom-sounds/client/notifications/updateCustomSound.js","meteor://ðŸ’»app/packages/rocketchat:custom-sounds/client/notifications/deleteCustomSound.js"],"names":["RocketChat","AdminBox","addOption","href","i18nLabel","permissionGranted","authz","hasAtLeastOnePermission","Template","adminSounds","helpers","isReady","instance","ready","get","undefined","customsounds","isLoading","hasMore","limit","length","flexData","tabBar","data","tabBarData","onCreated","ReactiveVar","filter","RocketChatTabBar","showGroup","FlowRouter","current","route","name","TabBar","addButton","groups","id","i18nTitle","icon","template","openClick","set","order","autorun","subscription","subscribe","_","trim","query","filterReg","RegExp","s","escapeRegExp","models","CustomSounds","find","sort","fetch","onRendered","Tracker","afterFlush","SideNav","setFlex","openFlex","events","e","which","stopPropagation","preventDefault","t","currentTarget","value","findOne","_id","open","$audio","$","play","toastr","module","watch","require","v","soundEdit","sound","soundFile","cancel","save","ev","originalEvent","files","target","dataTransfer","file","hasOwnProperty","form","reset","close","back","getSoundData","soundData","previousName","extension","previousExtension","val","newFile","validate","errors","push","error","TAPi18n","__","field","test","type","split","pop","Meteor","call","result","random","Math","round","info","reader","FileReader","readAsBinaryString","onloadend","uploadError","handleError","console","log","success","soundInfo","editingSound","soundToEdit","loadedName","swal","title","text","showCancelButton","confirmButtonColor","confirmButtonText","cancelButtonText","closeOnConfirm","html","disableButtons","enableButtons","timer","showConfirmButton","currentData","clear","subscriptions","register","action","BlazeLayout","render","center","list","add","src","isCordova","getURL","audio","preload","append","remove","update","attr","load","path","absoluteUrl","replace","__meteor_runtime_config__","ROOT_URL_PATH_PREFIX","getList","Object","values","sortBy","startup","_initModel","_Base","Notifications","onAll"],"mappings":"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","file":"/packages/rocketchat_custom-sounds.js","sourcesContent":["RocketChat.AdminBox.addOption({\n\thref: 'custom-sounds',\n\ti18nLabel: 'Custom_Sounds',\n\tpermissionGranted() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['manage-sounds']);\n\t}\n});\n","/* globals RocketChatTabBar */\nTemplate.adminSounds.helpers({\n\tisReady() {\n\t\tif (Template.instance().ready != null) {\n\t\t\treturn Template.instance().ready.get();\n\t\t}\n\t\treturn undefined;\n\t},\n\tcustomsounds() {\n\t\treturn Template.instance().customsounds();\n\t},\n\tisLoading() {\n\t\tif (Template.instance().ready != null) {\n\t\t\tif (!Template.instance().ready.get()) {\n\t\t\t\treturn 'btn-loading';\n\t\t\t}\n\t\t}\n\t},\n\thasMore() {\n\t\tif (Template.instance().limit != null) {\n\t\t\tif (typeof Template.instance().customsounds === 'function') {\n\t\t\t\treturn Template.instance().limit.get() === Template.instance().customsounds().length;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\tflexData() {\n\t\treturn {\n\t\t\ttabBar: Template.instance().tabBar,\n\t\t\tdata: Template.instance().tabBarData.get()\n\t\t};\n\t}\n});\n\nTemplate.adminSounds.onCreated(function() {\n\tconst instance = this;\n\tthis.limit = new ReactiveVar(50);\n\tthis.filter = new ReactiveVar('');\n\tthis.ready = new ReactiveVar(false);\n\n\tthis.tabBar = new RocketChatTabBar();\n\tthis.tabBar.showGroup(FlowRouter.current().route.name);\n\tthis.tabBarData = new ReactiveVar();\n\n\tRocketChat.TabBar.addButton({\n\t\tgroups: ['custom-sounds', 'custom-sounds-selected'],\n\t\tid: 'add-sound',\n\t\ti18nTitle: 'Custom_Sound_Add',\n\t\ticon: 'icon-plus',\n\t\ttemplate: 'adminSoundEdit',\n\t\topenClick(/*e, t*/) {\n\t\t\tinstance.tabBarData.set();\n\t\t\treturn true;\n\t\t},\n\t\torder: 1\n\t});\n\n\tRocketChat.TabBar.addButton({\n\t\tgroups: ['custom-sounds-selected'],\n\t\tid: 'admin-sound-info',\n\t\ti18nTitle: 'Custom_Sound_Info',\n\t\ticon: 'icon-cog',\n\t\ttemplate: 'adminSoundInfo',\n\t\torder: 2\n\t});\n\n\tthis.autorun(function() {\n\t\tconst limit = (instance.limit != null) ? instance.limit.get() : 0;\n\t\tconst subscription = instance.subscribe('customSounds', '', limit);\n\t\tinstance.ready.set(subscription.ready());\n\t});\n\n\tthis.customsounds = function() {\n\t\tconst filter = (instance.filter != null) ? _.trim(instance.filter.get()) : '';\n\n\t\tlet query = {};\n\n\t\tif (filter) {\n\t\t\tconst filterReg = new RegExp(s.escapeRegExp(filter), 'i');\n\t\t\tquery = { name: filterReg };\n\t\t}\n\n\t\tconst limit = (instance.limit != null) ? instance.limit.get() : 0;\n\n\t\treturn RocketChat.models.CustomSounds.find(query, { limit, sort: { name: 1 }}).fetch();\n\t};\n});\n\nTemplate.adminSounds.onRendered(() =>\n\tTracker.afterFlush(function() {\n\t\tSideNav.setFlex('adminFlex');\n\t\tSideNav.openFlex();\n\t})\n);\n\nTemplate.adminSounds.events({\n\t'keydown #sound-filter'(e) {\n\t\t//stop enter key\n\t\tif (e.which === 13) {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t}\n\t},\n\n\t'keyup #sound-filter'(e, t) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tt.filter.set(e.currentTarget.value);\n\t},\n\n\t'click .sound-info'(e, instance) {\n\t\te.preventDefault();\n\t\tinstance.tabBarData.set(RocketChat.models.CustomSounds.findOne({_id: this._id}));\n\t\tinstance.tabBar.showGroup('custom-sounds-selected');\n\t\tinstance.tabBar.open('admin-sound-info');\n\t},\n\n\t'click .load-more'(e, t) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tt.limit.set(t.limit.get() + 50);\n\t},\n\n\t'click .icon-play-circled'(e) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tconst $audio = $(`audio#${ this._id }`);\n\t\tif ($audio && $audio[0] && $audio[0].play) {\n\t\t\t$audio[0].play();\n\t\t}\n\t}\n});\n","import toastr from 'toastr';\n\nTemplate.soundEdit.helpers({\n\tsound() {\n\t\treturn Template.instance().sound;\n\t},\n\n\tname() {\n\t\treturn this.name || this._id;\n\t}\n});\n\nTemplate.soundEdit.events({\n\t'click .cancel'(e, t) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tdelete Template.instance().soundFile;\n\t\tt.cancel(t.find('form'));\n\t},\n\n\t'submit form'(e, t) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tt.save(e.currentTarget);\n\t},\n\n\t'change input[type=file]'(ev) {\n\t\tconst e = (ev.originalEvent != null) ? ev.originalEvent : ev;\n\t\tlet files = e.target.files;\n\t\tif (e.target.files == null || files.length === 0) {\n\t\t\tif (e.dataTransfer.files != null) {\n\t\t\t\tfiles = e.dataTransfer.files;\n\t\t\t} else {\n\t\t\t\tfiles = [];\n\t\t\t}\n\t\t}\n\n\t\t//using let x of y here seems to have incompatibility with some phones\n\t\tfor (const file in files) {\n\t\t\tif (files.hasOwnProperty(file)) {\n\t\t\t\tTemplate.instance().soundFile = files[file];\n\t\t\t}\n\t\t}\n\t}\n});\n\nTemplate.soundEdit.onCreated(function() {\n\tif (this.data != null) {\n\t\tthis.sound = this.data.sound;\n\t} else {\n\t\tthis.sound = undefined;\n\t\tthis.data.tabBar.showGroup('custom-sounds');\n\t}\n\n\tthis.cancel = (form, name) => {\n\t\tform.reset();\n\t\tthis.data.tabBar.close();\n\t\tif (this.sound) {\n\t\t\tthis.data.back(name);\n\t\t}\n\t};\n\n\tthis.getSoundData = () => {\n\t\tconst soundData = {};\n\t\tif (this.sound != null) {\n\t\t\tsoundData._id = this.sound._id;\n\t\t\tsoundData.previousName = this.sound.name;\n\t\t\tsoundData.extension = this.sound.extension;\n\t\t\tsoundData.previousExtension = this.sound.extension;\n\t\t}\n\t\tsoundData.name = s.trim(this.$('#name').val());\n\t\tsoundData.newFile = false;\n\t\treturn soundData;\n\t};\n\n\tthis.validate = () => {\n\t\tconst soundData = this.getSoundData();\n\n\t\tconst errors = [];\n\t\tif (!soundData.name) {\n\t\t\terrors.push('Name');\n\t\t}\n\n\t\tif (!soundData._id) {\n\t\t\tif (!this.soundFile) {\n\t\t\t\terrors.push('Sound_File_mp3');\n\t\t\t}\n\t\t}\n\n\t\tfor (const error of errors) {\n\t\t\ttoastr.error(TAPi18n.__('error-the-field-is-required', { field: TAPi18n.__(error) }));\n\t\t}\n\n\t\tif (this.soundFile) {\n\t\t\tif (!/audio\\/mp3/.test(this.soundFile.type)) {\n\t\t\t\terrors.push('FileType');\n\t\t\t\ttoastr.error(TAPi18n.__('error-invalid-file-type'));\n\t\t\t}\n\t\t}\n\n\t\treturn errors.length === 0;\n\t};\n\n\tthis.save = (form) => {\n\t\tif (this.validate()) {\n\t\t\tconst soundData = this.getSoundData();\n\n\t\t\tif (this.soundFile) {\n\t\t\t\tsoundData.newFile = true;\n\t\t\t\tsoundData.extension = this.soundFile.name.split('.').pop();\n\t\t\t\tsoundData.type = this.soundFile.type;\n\t\t\t}\n\n\t\t\tMeteor.call('insertOrUpdateSound', soundData, (error, result) => {\n\t\t\t\tif (result) {\n\t\t\t\t\tsoundData._id = result;\n\t\t\t\t\tsoundData.random = Math.round(Math.random() * 1000);\n\n\t\t\t\t\tif (this.soundFile) {\n\t\t\t\t\t\ttoastr.info(TAPi18n.__('Uploading_file'));\n\n\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\treader.readAsBinaryString(this.soundFile);\n\t\t\t\t\t\treader.onloadend = () => {\n\t\t\t\t\t\t\tMeteor.call('uploadCustomSound', reader.result, this.soundFile.type, soundData, (uploadError/*, data*/) => {\n\t\t\t\t\t\t\t\tif (uploadError != null) {\n\t\t\t\t\t\t\t\t\thandleError(uploadError);\n\t\t\t\t\t\t\t\t\tconsole.log(uploadError);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tdelete this.soundFile;\n\t\t\t\t\t\t\ttoastr.success(TAPi18n.__('File_uploaded'));\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\ttoastr.success(t('Custom_Sound_Saved_Successfully'));\n\n\t\t\t\t\tthis.cancel(form, soundData.name);\n\t\t\t\t}\n\n\t\t\t\tif (error) {\n\t\t\t\t\thandleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n});\n","Template.soundInfo.helpers({\n\tname() {\n\t\tconst sound = Template.instance().sound.get();\n\t\treturn sound.name;\n\t},\n\n\tsound() {\n\t\treturn Template.instance().sound.get();\n\t},\n\n\teditingSound() {\n\t\treturn Template.instance().editingSound.get();\n\t},\n\n\tsoundToEdit() {\n\t\tconst instance = Template.instance();\n\t\treturn {\n\t\t\ttabBar: instance.data.tabBar,\n\t\t\tdata: instance.data.data,\n\t\t\tsound: instance.sound.get(),\n\t\t\tback(name) {\n\t\t\t\tinstance.editingSound.set();\n\n\t\t\t\tif (name != null) {\n\t\t\t\t\tconst sound = instance.sound.get();\n\t\t\t\t\tif (sound.name != null && sound.name !== name) {\n\t\t\t\t\t\treturn instance.loadedName.set(name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n});\n\nTemplate.soundInfo.events({\n\t'click .delete'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst sound = instance.sound.get();\n\t\tif (sound != null) {\n\t\t\tconst _id = sound._id;\n\t\t\tswal({\n\t\t\t\ttitle: t('Are_you_sure'),\n\t\t\t\ttext: t('Custom_Sound_Delete_Warning'),\n\t\t\t\ttype: 'warning',\n\t\t\t\tshowCancelButton: true,\n\t\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\t\tconfirmButtonText: t('Yes_delete_it'),\n\t\t\t\tcancelButtonText: t('Cancel'),\n\t\t\t\tcloseOnConfirm: false,\n\t\t\t\thtml: false\n\t\t\t}, function() {\n\t\t\t\tswal.disableButtons();\n\n\t\t\t\tMeteor.call('deleteCustomSound', _id, (error/*, result*/) => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\thandleError(error);\n\t\t\t\t\t\tswal.enableButtons();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tswal({\n\t\t\t\t\t\t\ttitle: t('Deleted'),\n\t\t\t\t\t\t\ttext: t('Custom_Sound_Has_Been_Deleted'),\n\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t\ttimer: 2000,\n\t\t\t\t\t\t\tshowConfirmButton: false\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tinstance.data.tabBar.showGroup('custom-sounds');\n\t\t\t\t\t\tinstance.data.tabBar.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\n\t'click .edit-sound'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tinstance.editingSound.set(instance.sound.get()._id);\n\t}\n});\n\nTemplate.soundInfo.onCreated(function() {\n\tthis.sound = new ReactiveVar();\n\n\tthis.editingSound = new ReactiveVar();\n\n\tthis.loadedName = new ReactiveVar();\n\n\tthis.autorun(() => {\n\t\tconst data = Template.currentData();\n\t\tif (data.clear != null) {\n\t\t\tthis.clear = data.clear;\n\t\t}\n\t});\n\n\tthis.autorun(() => {\n\t\tconst data = Template.currentData();\n\t\tconst sound = this.sound.get();\n\t\tif (sound.name != null) {\n\t\t\tthis.loadedName.set(sound.name);\n\t\t} else if (data.name != null) {\n\t\t\tthis.loadedName.set(data.name);\n\t\t}\n\t});\n\n\tthis.autorun(() => {\n\t\tconst data = Template.currentData();\n\t\tthis.sound.set(data);\n\t});\n});\n","FlowRouter.route('/admin/custom-sounds', {\n\tname: 'custom-sounds',\n\tsubscriptions(/*params, queryParams*/) {\n\t\tthis.register('customSounds', Meteor.subscribe('customSounds'));\n\t},\n\taction(/*params*/) {\n\t\tBlazeLayout.render('main', {center: 'adminSounds'});\n\t}\n});\n","class CustomSounds {\n\tconstructor() {\n\t\tthis.list = new ReactiveVar({});\n\t\tthis.add({ _id: 'beep', name: 'Beep', extension: 'mp3', src: 'sounds/beep.mp3' });\n\t\tthis.add({ _id: 'chelle', name: 'Chelle', extension: 'mp3', src: 'sounds/chelle.mp3' });\n\t\tthis.add({ _id: 'ding', name: 'Ding', extension: 'mp3', src: 'sounds/ding.mp3' });\n\t\tthis.add({ _id: 'droplet', name: 'Droplet', extension: 'mp3', src: 'sounds/droplet.mp3' });\n\t\tthis.add({ _id: 'highbell', name: 'Highbell', extension: 'mp3', src: 'sounds/highbell.mp3' });\n\t\tthis.add({ _id: 'seasons', name: 'Seasons', extension: 'mp3', src: 'sounds/seasons.mp3' });\n\t}\n\n\tadd(sound) {\n\t\tif (Meteor.isCordova) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!sound.src) {\n\t\t\tsound.src = this.getURL(sound);\n\t\t}\n\t\tconst audio = $('<audio />', { id: sound._id, preload: true }).append(\n\t\t\t$('<source />', { src: sound.src })\n\t\t);\n\t\tconst list = this.list.get();\n\t\tlist[sound._id] = sound;\n\t\tthis.list.set(list);\n\t\t$('body').append(audio);\n\t}\n\n\tremove(sound) {\n\t\tconst list = this.list.get();\n\t\tdelete list[sound._id];\n\t\tthis.list.set(list);\n\t\t$(`#${ sound._id }`).remove();\n\t}\n\n\tupdate(sound) {\n\t\tconst audio = $(`#${ sound._id }`);\n\t\tif (audio && audio[0]) {\n\t\t\tconst list = this.list.get();\n\t\t\tlist[sound._id] = sound;\n\t\t\tthis.list.set(list);\n\t\t\t$('source', audio).attr('src', this.getURL(sound));\n\t\t\taudio[0].load();\n\t\t} else {\n\t\t\tthis.add(sound);\n\t\t}\n\t}\n\n\tgetURL(sound) {\n\t\tconst path = (Meteor.isCordova) ? Meteor.absoluteUrl().replace(/\\/$/, '') : __meteor_runtime_config__.ROOT_URL_PATH_PREFIX || '';\n\t\treturn `${ path }/custom-sounds/${ sound._id }.${ sound.extension }?_dc=${ sound.random || 0 }`;\n\t}\n\n\tgetList() {\n\t\tconst list = Object.values(this.list.get());\n\t\treturn _.sortBy(list, 'name');\n\t}\n}\n\nRocketChat.CustomSounds = new CustomSounds;\n\nMeteor.startup(() =>\n\tMeteor.call('listCustomSounds', (error, result) => {\n\t\tfor (const sound of result) {\n\t\t\tRocketChat.CustomSounds.add(sound);\n\t\t}\n\t})\n);\n","class CustomSounds extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._initModel('custom_sounds');\n\t}\n}\n\nRocketChat.models.CustomSounds = new CustomSounds();\n","Meteor.startup(() =>\n\tRocketChat.Notifications.onAll('updateCustomSound', data => RocketChat.CustomSounds.update(data.soundData))\n);\n","Meteor.startup(() =>\n\tRocketChat.Notifications.onAll('deleteCustomSound', data => RocketChat.CustomSounds.remove(data.soundData))\n);\n"]}