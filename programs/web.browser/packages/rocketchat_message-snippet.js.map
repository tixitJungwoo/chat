{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/lib/collections.js","meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/actionButton.js","meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/messageType.js","meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/snippetMessage.js","meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/router.js","meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/page/snippetPage.js","meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/tabBar/tabBar.js","meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/tabBar/views/snippetedMessages.js","meteor://ðŸ’»app/packages/rocketchat:message-snippet/client/tabBar/views/snippetMessage.js"],"names":["SnippetedMessages","Mongo","Collection","Meteor","startup","RocketChat","MessageAction","addButton","id","icon","i18nLabel","context","action","message","_arguments","swal","title","text","type","showCancelButton","closeOnConfirm","animation","inputPlaceholder","filename","showInputError","snippeted","call","error","handleError","validation","models","Subscriptions","findOne","rid","userId","undefined","settings","get","authz","hasAtLeastOnePermission","MessageTypes","registerType","system","data","snippetLink","snippetId","snippetName","methods","snippetMessage","subscription","ChatMessage","update","_id","$set","FlowRouter","route","name","BlazeLayout","render","center","flexTabBar","triggersEnter","TabBar","hide","triggersExit","show","moment","module","watch","require","v","Template","snippetPage","helpers","snippet","getParam","snippetContent","html","msg","markdownCode","MarkdownCode","tokens","date","ts","format","time","onCreated","autorun","subscribe","Tracker","groups","i18nTitle","template","order","removeButton","snippetedMessages","hasMessages","find","sort","count","messages","_","extend","customClass","hasMore","instance","ReactiveVar","limit","self","currentData","set","own","u","body"],"mappings":"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","file":"/packages/rocketchat_message-snippet.js","sourcesContent":["this.SnippetedMessages = new Mongo.Collection('rocketchat_snippeted_message');\n","Meteor.startup(function() {\n\tRocketChat.MessageAction.addButton({\n\t\tid: 'snippeted-message',\n\t\ticon: 'icon-code',\n\t\ti18nLabel: 'Snippet',\n\t\tcontext: [\n\t\t\t'snippeted',\n\t\t\t'message',\n\t\t\t'message-mobile'\n\t\t],\n\t\taction() {\n\t\t\tconst message = this._arguments[1];\n\n\t\t\tswal({\n\t\t\t\ttitle: 'Create a Snippet',\n\t\t\t\ttext: 'The name of your snippet (with file extension):',\n\t\t\t\ttype: 'input',\n\t\t\t\tshowCancelButton: true,\n\t\t\t\tcloseOnConfirm: false,\n\t\t\t\tanimation: 'slide-from-top',\n\t\t\t\tinputPlaceholder: 'Snippet name'\n\t\t\t}, function(filename) {\n\t\t\t\tif (filename === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (filename === '') {\n\t\t\t\t\tswal.showInputError('You need to write something!');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tmessage.snippeted = true;\n\t\t\t\tMeteor.call('snippetMessage', message, filename, function(error) {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\treturn handleError(error);\n\t\t\t\t\t}\n\t\t\t\t\tswal('Nice!', `Snippet '${ filename }' created.`, 'success');\n\t\t\t\t});\n\t\t\t});\n\n\t\t},\n\t\tvalidation(message) {\n\t\t\tif (RocketChat.models.Subscriptions.findOne({ rid: message.rid, 'u._id': Meteor.userId() }) === undefined) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (message.snippeted || ((RocketChat.settings.get('Message_AllowSnippeting') === undefined) ||\n\t\t\t\t(RocketChat.settings.get('Message_AllowSnippeting') === null) ||\n\t\t\t\t(RocketChat.settings.get('Message_AllowSnippeting')) === false)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn RocketChat.authz.hasAtLeastOnePermission('snippet-message', message.rid);\n\t\t}\n\t});\n});\n","Meteor.startup(function() {\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'message_snippeted',\n\t\tsystem: true,\n\t\tmessage: 'Snippeted_a_message',\n\t\tdata(message) {\n\t\t\tconst snippetLink = `<a href=\"/snippet/${ message.snippetId }/${ message.snippetName }\">${ message.snippetName }</a>`;\n\t\t\treturn { snippetLink };\n\t\t}\n\t});\n});\n","Meteor.methods({\n\tsnippetMessage(message) {\n\t\tif (typeof Meteor.userId() === 'undefined' || Meteor.userId() === null) {\n\t\t\treturn false;\n\t\t}\n\t\tif ((typeof RocketChat.settings.get('Message_AllowSnippeting') === 'undefined') ||\n\t\t\t(RocketChat.settings.get('Message_AllowSnippeting') === null) ||\n\t\t\t(RocketChat.settings.get('Message_AllowSnippeting') === false)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne({ rid: message.rid, 'u._id': Meteor.userId() });\n\n\t\tif (subscription === undefined) {\n\t\t\treturn false;\n\t\t}\n\t\tChatMessage.update({\n\t\t\t_id: message._id\n\t\t}, {\n\t\t\t$set: {\n\t\t\t\tsnippeted: true\n\t\t\t}\n\t\t});\n\t}\n});\n","/* global FlowRouter, BlazeLayout */\nFlowRouter.route('/snippet/:snippetId/:snippetName', {\n\tname: 'snippetView',\n\taction() {\n\t\tBlazeLayout.render('main', {center: 'snippetPage', flexTabBar: null });\n\t},\n\ttriggersEnter: [ function() {\n\t\tRocketChat.TabBar.hide();\n\t}],\n\ttriggersExit: [\n\t\tfunction() {\n\t\t\tRocketChat.TabBar.show();\n\t\t}\n\t]\n});\n","/* global SnippetedMessages */\nimport moment from 'moment';\n\nTemplate.snippetPage.helpers({\n\tsnippet() {\n\t\treturn SnippetedMessages.findOne({ _id: FlowRouter.getParam('snippetId') });\n\t},\n\tsnippetContent() {\n\t\tconst message = SnippetedMessages.findOne({ _id: FlowRouter.getParam('snippetId') });\n\t\tif (message === undefined) {\n\t\t\treturn null;\n\t\t}\n\t\tmessage.html = message.msg;\n\t\tconst markdownCode = new RocketChat.MarkdownCode(message);\n\t\treturn markdownCode.tokens[0].text;\n\t},\n\tdate() {\n\t\tconst snippet = SnippetedMessages.findOne({ _id: FlowRouter.getParam('snippetId') });\n\t\tif (snippet !== undefined) {\n\t\t\treturn moment(snippet.ts).format(RocketChat.settings.get('Message_DateFormat'));\n\t\t}\n\t},\n\ttime() {\n\t\tconst snippet = SnippetedMessages.findOne({ _id: FlowRouter.getParam('snippetId') });\n\t\tif (snippet !== undefined) {\n\t\t\treturn moment(snippet.ts).format(RocketChat.settings.get('Message_TimeFormat'));\n\t\t}\n\t}\n});\n\nTemplate.snippetPage.onCreated(function() {\n\tconst snippetId = FlowRouter.getParam('snippetId');\n\tthis.autorun(function() {\n\t\tMeteor.subscribe('snippetedMessage', snippetId);\n\t});\n});\n\n","Meteor.startup(function() {\n\tTracker.autorun(function() {\n\t\tif (RocketChat.settings.get('Message_AllowSnippeting')) {\n\t\t\tRocketChat.TabBar.addButton({\n\t\t\t\tgroups: ['channel', 'group', 'direct'],\n\t\t\t\tid: 'snippeted-messages',\n\t\t\t\ti18nTitle: 'Snippeted_Messages',\n\t\t\t\ticon: 'icon-code',\n\t\t\t\ttemplate: 'snippetedMessages',\n\t\t\t\torder: 20\n\t\t\t});\n\t\t} else {\n\t\t\tRocketChat.TabBar.removeButton('snippeted-messages');\n\t\t}\n\t});\n});\n","/* global SnippetedMessages */\nTemplate.snippetedMessages.helpers({\n\thasMessages() {\n\t\treturn SnippetedMessages.find({ snippeted:true, rid: this.rid }, { sort: { ts: -1 } }).count() > 0;\n\t},\n\tmessages() {\n\t\treturn SnippetedMessages.find({ snippeted: true, rid: this.rid }, { sort: { ts: -1 } });\n\t},\n\tmessage() {\n\t\treturn _.extend(this, { customClass: 'snippeted' });\n\t},\n\thasMore() {\n\t\treturn Template.instance().hasMore.get();\n\t}\n});\n\nTemplate.snippetedMessages.onCreated(function() {\n\tthis.hasMore = new ReactiveVar(true);\n\tthis.limit = new ReactiveVar(50);\n\tconst self = this;\n\tthis.autorun(function() {\n\t\tconst data = Template.currentData();\n\t\tself.subscribe('snippetedMessages', data.rid, self.limit.get(), function() {\n\t\t\tif (SnippetedMessages.find({ snippeted: true, rid: data.rid }).count() < self.limit.get()) {\n\t\t\t\treturn self.hasMore.set(false);\n\t\t\t}\n\t\t});\n\t});\n});\n","import moment from 'moment';\n\nTemplate.snippetMessage.helpers({\n\ttime() {\n\t\treturn moment(this.ts).format(RocketChat.settings.get('Message_TimeFormat'));\n\t},\n\tdate() {\n\t\treturn moment(this.ts).format(RocketChat.settings.get('Message_DateFormat'));\n\t},\n\town() {\n\t\tif (this.u !== undefined && this.u && this.u._id === Meteor.userId()) {\n\t\t\treturn 'own';\n\t\t}\n\t},\n\tbody() {\n\t\treturn `<a href=\"/snippet/${ this._id }/${ this.snippetName }\">${ this.snippetName }</a>`;\n\t}\n});\n"]}