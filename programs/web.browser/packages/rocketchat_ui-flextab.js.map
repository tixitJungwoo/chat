{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:ui-flextab/client/tabs/membersList.js","meteor://ðŸ’»app/packages/rocketchat:ui-flextab/client/tabs/messageSearch.js","meteor://ðŸ’»app/packages/rocketchat:ui-flextab/client/tabs/uploadedFilesList.js","meteor://ðŸ’»app/packages/rocketchat:ui-flextab/client/tabs/userEdit.js","meteor://ðŸ’»app/packages/rocketchat:ui-flextab/client/tabs/userInfo.js","meteor://ðŸ’»app/packages/rocketchat:ui-flextab/client/flexTabBar.js"],"names":["Template","membersList","helpers","tAddUsers","t","isGroupChat","includes","ChatRoom","findOne","rid","reactive","isDirectChat","seeAll","instance","showAllUsers","get","roomUsers","onlineUsers","RoomManager","users","room","roomMuted","muted","undefined","userUtcOffset","Meteor","user","utcOffset","totalOnline","map","username","status","Array","from","RocketChat","settings","_","sortBy","u","name","hasMore","usersLimit","length","first","totalShowing","ret","_id","total","loading","canAddUser","roomData","Session","authz","hasAtLeastOnePermission","autocompleteSettingsAddUser","limit","rules","collection","subscription","field","template","userSearch","noMatchTemplate","userSearchEmpty","matchAll","filter","exceptions","selector","match","term","sort","showUserInfo","webrtc","WebRTC","getInstanceByRoomId","videoActive","localUrl","remoteItems","showDetail","userInfoDetail","fields","tabBar","currentData","userDetail","clear","clearUserDetail","showAll","hideAdminControls","video","displayName","events","e","set","event","doc","data","call","error","handleError","$","val","onCreated","ReactiveVar","Tracker","autorun","records","setTimeout","clearRoomUserDetail","showUserDetail","startup","MessageAction","addButton","id","icon","i18nLabel","context","action","message","_arguments","hideDropDown","RoomHistoryManager","getSurroundingMessages","order","messageSearch","tSearchMessages","searchResultMessages","searchResult","messages","currentSearchTerm","ready","extend","customClass","keyCode","preventDefault","debounce","value","target","trim","search","stopPropagation","message_id","currentTarget","closest","attr","remove","findWhere","actions","getButtons","el","Blaze","toHTMLWithData","messageDropdown","append","dropDown","show","throttle","scrollTop","scrollHeight","clientHeight","nonreactive","result","channels","roomFiles","Mongo","Collection","uploadedFilesList","files","find","uploadedAt","hasFiles","count","getFileIcon","type","customClassForFileType","escapedName","s","escapeHTML","canDelete","userId","url","fixCordova","indexOf","isCordova","absoluteUrl","replace","query","_localStorage","getItem","public","sandstorm","navigator","userAgent","__meteor_runtime_config__","ROOT_URL_PATH_PREFIX","siblings","self","swal","title","TAPi18n","__","text","showCancelButton","confirmButtonColor","confirmButtonText","cancelButtonText","closeOnConfirm","html","timer","showConfirmButton","msg","ChatMessage","file","models","Uploads","chatMessages","deleteMsg","subscribe","fetch","toastr","module","watch","require","v","userEdit","canEditOrAdd","requirePasswordChange","role","Roles","description","selectUserRole","cancel","Random","save","userData","form","reset","prop","back","close","getUserData","email","verified","password","joinDefaultChannels","sendWelcomeEmail","roles","validate","errors","push","key","success","moment","userInfo","emails","address","utc","lastLogin","format","createdAt","canDirectMessage","hasAllPermission","isSelf","linkedinUsername","services","linkedin","publicProfileUrl","strRight","servicesMeteor","userTime","now","canRemoveUser","canMuteUser","userMuted","isArray","canSetModerator","isModerator","RoomRoles","canSetOwner","isOwner","hasEmails","hasPhone","phone","isLoading","loadingUserInfo","hasAdminRole","hasRole","active","editingUser","userToEdit","loadedUsername","roleTags","userRoles","UserRoles","roomRoles","union","$in","$exists","isDirect","isBlocker","ChatSubscription","blocker","toggleClass","FlowRouter","go","current","queryParams","window","matchMedia","matches","err","userModerator","room_name","userOwner","disableButtons","enableButtons","blocked","setInterval","flexTabBar","getTemplate","getState","buttons","TabBar","i18nTitle","visible","anonymous","groups","currentGroup","opened","flexData","Object","assign","open"],"mappings":"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","file":"/packages/rocketchat_ui-flextab.js","sourcesContent":["/* globals WebRTC */\n\nTemplate.membersList.helpers({\n\ttAddUsers() {\n\t\treturn t('Add_users');\n\t},\n\n\tisGroupChat() {\n\t\treturn ['c', 'p'].includes(ChatRoom.findOne(this.rid, { reactive: false }).t);\n\t},\n\n\tisDirectChat() {\n\t\treturn ChatRoom.findOne(this.rid, { reactive: false }).t === 'd';\n\t},\n\n\tseeAll() {\n\t\tif (Template.instance().showAllUsers.get()) {\n\t\t\treturn t('Show_only_online');\n\t\t} else {\n\t\t\treturn t('Show_all');\n\t\t}\n\t},\n\n\troomUsers() {\n\t\tconst onlineUsers = RoomManager.onlineUsers.get();\n\t\tconst roomUsers = Template.instance().users.get();\n\t\tconst room = ChatRoom.findOne(this.rid);\n\t\tconst roomMuted = (room != null ? room.muted : undefined) || [];\n\t\tconst userUtcOffset = Meteor.user().utcOffset;\n\t\tlet totalOnline = 0;\n\t\tlet users = roomUsers.map(function(user) {\n\t\t\tlet utcOffset;\n\t\t\tif (onlineUsers[user.username] != null) {\n\t\t\t\ttotalOnline++;\n\t\t\t\t({ utcOffset } = onlineUsers[user.username]);\n\n\t\t\t\tif (utcOffset != null) {\n\t\t\t\t\tif (utcOffset === userUtcOffset) {\n\t\t\t\t\t\tutcOffset = '';\n\t\t\t\t\t} else if (utcOffset > 0) {\n\t\t\t\t\t\tutcOffset = `(UTC +${ utcOffset })`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tutcOffset = `(UTC ${ utcOffset })`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tuser,\n\t\t\t\tstatus: (onlineUsers[user.username] != null ? onlineUsers[user.username].status : undefined),\n\t\t\t\tmuted: Array.from(roomMuted).includes(user.username),\n\t\t\t\tutcOffset\n\t\t\t};\n\t\t});\n\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name')) {\n\t\t\tusers = _.sortBy(users, u => u.user.name);\n\t\t} else {\n\t\t\tusers = _.sortBy(users, u => u.user.username);\n\t\t}\n\t\t// show online users first.\n\t\t// sortBy is stable, so we can do this\n\t\tusers = _.sortBy(users, u => u.status == null);\n\n\t\tlet hasMore = undefined;\n\t\tconst usersLimit = Template.instance().usersLimit.get();\n\t\tif (usersLimit) {\n\t\t\thasMore = users.length > usersLimit;\n\t\t\tusers = _.first(users, usersLimit);\n\t\t}\n\t\tconst totalShowing = users.length;\n\n\t\tconst ret = {\n\t\t\t_id: this.rid,\n\t\t\ttotal: Template.instance().total.get(),\n\t\t\ttotalShowing,\n\t\t\tloading: Template.instance().loading.get(),\n\t\t\ttotalOnline,\n\t\t\tusers,\n\t\t\thasMore\n\t\t};\n\t\treturn ret;\n\t},\n\n\tcanAddUser() {\n\t\tconst roomData = Session.get(`roomData${ this._id }`);\n\t\tif (!roomData) { return ''; }\n\t\treturn (() => {\n\t\t\tswitch (roomData.t) {\n\t\t\t\tcase 'p': return RocketChat.authz.hasAtLeastOnePermission(['add-user-to-any-p-room', 'add-user-to-joined-room'], this._id);\n\t\t\t\tcase 'c': return RocketChat.authz.hasAtLeastOnePermission(['add-user-to-any-c-room', 'add-user-to-joined-room'], this._id);\n\t\t\t\tdefault: return false;\n\t\t\t}\n\t\t})();\n\t},\n\n\tautocompleteSettingsAddUser() {\n\t\treturn {\n\t\t\tlimit: 10,\n\t\t\t// inputDelay: 300\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\tcollection: 'UserAndRoom',\n\t\t\t\t\tsubscription: 'userAutocomplete',\n\t\t\t\t\tfield: 'username',\n\t\t\t\t\ttemplate: Template.userSearch,\n\t\t\t\t\tnoMatchTemplate: Template.userSearchEmpty,\n\t\t\t\t\tmatchAll: true,\n\t\t\t\t\tfilter: {\n\t\t\t\t\t\texceptions: [Meteor.user().username]\n\t\t\t\t\t},\n\t\t\t\t\tselector(match) {\n\t\t\t\t\t\treturn { term: match };\n\t\t\t\t\t},\n\t\t\t\t\tsort: 'username'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t},\n\n\tshowUserInfo() {\n\t\tconst webrtc = WebRTC.getInstanceByRoomId(this.rid);\n\t\tlet videoActive = undefined;\n\t\tif (webrtc && webrtc.localUrl && webrtc.localUrl.get()) {\n\t\t\tvideoActive = webrtc.localUrl.get();\n\t\t} else if (webrtc && webrtc.remoteItems && webrtc.remoteItems.get() && webrtc.remoteItems.get().length > 0) {\n\t\t\tvideoActive = webrtc.remoteItems.get();\n\t\t}\n\t\treturn Template.instance().showDetail.get() && !videoActive;\n\t},\n\n\tuserInfoDetail() {\n\t\tconst room = ChatRoom.findOne(this.rid, { fields: { t: 1 } });\n\n\t\treturn {\n\t\t\ttabBar: Template.currentData().tabBar,\n\t\t\tusername: Template.instance().userDetail.get(),\n\t\t\tclear: Template.instance().clearUserDetail,\n\t\t\tshowAll: ['c', 'p'].includes(room != null ? room.t : undefined),\n\t\t\thideAdminControls: ['c', 'p', 'd'].includes(room != null ? room.t : undefined),\n\t\t\tvideo: ['d'].includes(room != null ? room.t : undefined)\n\t\t};\n\t},\n\tdisplayName() {\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name') && this.user.name) {\n\t\t\treturn this.user.name;\n\t\t}\n\n\t\treturn this.user.username;\n\t}});\n\nTemplate.membersList.events({\n\t'click .see-all'(e, instance) {\n\t\tconst seeAll = instance.showAllUsers.get();\n\t\tinstance.showAllUsers.set(!seeAll);\n\n\t\tif (!seeAll) {\n\t\t\treturn instance.usersLimit.set(100);\n\t\t}\n\t},\n\n\t'autocompleteselect #user-add-search'(event, template, doc) {\n\n\t\tconst roomData = Session.get(`roomData${ template.data.rid }`);\n\n\t\tif (['c', 'p'].includes(roomData.t)) {\n\t\t\treturn Meteor.call('addUserToRoom', { rid: roomData._id, username: doc.username }, function(error) {\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\n\t\t\t\treturn $('#user-add-search').val('');\n\t\t\t});\n\t\t}\n\t},\n\n\t'click .show-more-users'(e, instance) {\n\t\treturn instance.usersLimit.set(instance.usersLimit.get() + 100);\n\t}\n});\n\nTemplate.membersList.onCreated(function() {\n\tthis.showAllUsers = new ReactiveVar(false);\n\tthis.usersLimit = new ReactiveVar(100);\n\tthis.userDetail = new ReactiveVar;\n\tthis.showDetail = new ReactiveVar(false);\n\n\tthis.users = new ReactiveVar([]);\n\tthis.total = new ReactiveVar;\n\tthis.loading = new ReactiveVar(true);\n\n\tthis.tabBar = Template.instance().tabBar;\n\n\tTracker.autorun(() => {\n\t\tif (this.data.rid == null) { return; }\n\n\t\tthis.loading.set(true);\n\t\treturn Meteor.call('getUsersOfRoom', this.data.rid, this.showAllUsers.get(), (error, users) => {\n\t\t\tthis.users.set(users.records);\n\t\t\tthis.total.set(users.total);\n\t\t\treturn this.loading.set(false);\n\t\t}\n\t\t);\n\t}\n\t);\n\n\tthis.clearUserDetail = () => {\n\t\tthis.showDetail.set(false);\n\t\treturn setTimeout(() => {\n\t\t\treturn this.clearRoomUserDetail();\n\t\t}\n\t\t, 500);\n\t};\n\n\tthis.showUserDetail = username => {\n\t\tthis.showDetail.set(username != null);\n\t\treturn this.userDetail.set(username);\n\t};\n\n\tthis.clearRoomUserDetail = this.data.clearUserDetail;\n\n\treturn this.autorun(() => {\n\t\tconst data = Template.currentData();\n\t\treturn this.showUserDetail(data.userDetail);\n\t}\n\t);\n});\n","Meteor.startup(function() {\n\treturn RocketChat.MessageAction.addButton({\n\t\tid: 'jump-to-search-message',\n\t\ticon: 'icon-right-hand',\n\t\ti18nLabel: 'Jump_to_message',\n\t\tcontext: [\n\t\t\t'search'\n\t\t],\n\t\taction() {\n\t\t\tconst message = this._arguments[1];\n\t\t\tRocketChat.MessageAction.hideDropDown();\n\t\t\treturn RoomHistoryManager.getSurroundingMessages(message, 50);\n\t\t},\n\t\torder: 100\n\t});\n});\n\n\nTemplate.messageSearch.helpers({\n\ttSearchMessages() {\n\t\treturn t('Search_Messages');\n\t},\n\n\tsearchResultMessages() {\n\t\tconst searchResult = Template.instance().searchResult.get();\n\t\tif (searchResult) {\n\t\t\treturn searchResult.messages;\n\t\t}\n\t},\n\n\thasMore() {\n\t\treturn Template.instance().hasMore.get();\n\t},\n\n\tcurrentSearchTerm() {\n\t\treturn Template.instance().currentSearchTerm.get();\n\t},\n\n\tready() {\n\t\treturn Template.instance().ready.get();\n\t},\n\n\tmessage() {\n\t\treturn _.extend(this, { customClass: 'search' });\n\t}\n});\n\nTemplate.messageSearch.events({\n\t'keydown #message-search'(e) {\n\t\tif (e.keyCode === 13) {\n\t\t\treturn e.preventDefault();\n\t\t}\n\t},\n\n\t'keyup #message-search': _.debounce(function(e, t) {\n\t\tconst value = e.target.value.trim();\n\t\tif ((value === '') && t.currentSearchTerm.get()) {\n\t\t\tt.currentSearchTerm.set('');\n\t\t\tt.searchResult.set(undefined);\n\t\t\tt.hasMore.set(false);\n\t\t\treturn;\n\t\t} else if (value === t.currentSearchTerm.get()) {\n\t\t\treturn;\n\t\t}\n\n\t\tt.hasMore.set(true);\n\t\tt.limit.set(20);\n\t\treturn t.search();\n\t}\n\t, 500),\n\n\t'click .message-cog'(e, t) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst message_id = $(e.currentTarget).closest('.message').attr('id');\n\t\tconst searchResult = t.searchResult.get();\n\t\tRocketChat.MessageAction.hideDropDown();\n\t\tt.$(`\\#${ message_id } .message-dropdown`).remove();\n\t\tif (searchResult) {\n\t\t\tconst message = _.findWhere(searchResult.messages, { _id: message_id });\n\t\t\tconst actions = RocketChat.MessageAction.getButtons(message, 'search');\n\t\t\tconst el = Blaze.toHTMLWithData(Template.messageDropdown, { actions });\n\t\t\tt.$(`\\#${ message_id } .message-cog-container`).append(el);\n\t\t\tconst dropDown = t.$(`\\#${ message_id } .message-dropdown`);\n\t\t\treturn dropDown.show();\n\t\t}\n\t},\n\n\t'click .load-more button'(e, t) {\n\t\tt.limit.set(t.limit.get() + 20);\n\t\treturn t.search();\n\t},\n\n\t'scroll .content': _.throttle(function(e, t) {\n\t\tif (e.target.scrollTop >= (e.target.scrollHeight - e.target.clientHeight)) {\n\t\t\tt.limit.set(t.limit.get() + 20);\n\t\t\treturn t.search();\n\t\t}\n\t}\n\t, 200)\n});\n\nTemplate.messageSearch.onCreated(function() {\n\tthis.currentSearchTerm = new ReactiveVar('');\n\tthis.searchResult = new ReactiveVar;\n\n\tthis.hasMore = new ReactiveVar(true);\n\tthis.limit = new ReactiveVar(20);\n\tthis.ready = new ReactiveVar(true);\n\n\treturn this.search = () => {\n\t\tthis.ready.set(false);\n\t\tconst value = this.$('#message-search').val();\n\t\treturn Tracker.nonreactive(() => {\n\t\t\treturn Meteor.call('messageSearch', value, Session.get('openedRoom'), this.limit.get(), (error, result) => {\n\t\t\t\tthis.currentSearchTerm.set(value);\n\t\t\t\tthis.ready.set(true);\n\t\t\t\tif ((result != null) && (((result.messages != null ? result.messages.length : undefined) > 0) || ((result.users != null ? result.users.length : undefined) > 0) || ((result.channels != null ? result.channels.length : undefined) > 0))) {\n\t\t\t\t\tthis.searchResult.set(result);\n\t\t\t\t\tif (((result.messages != null ? result.messages.length : undefined) + (result.users != null ? result.users.length : undefined) + (result.channels != null ? result.channels.length : undefined)) < this.limit.get()) {\n\t\t\t\t\t\treturn this.hasMore.set(false);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn this.searchResult.set();\n\t\t\t\t}\n\t\t\t}\n\t\t\t);\n\t\t}\n\t\t);\n\t};\n});\n","/* globals chatMessages*/\nconst roomFiles = new Mongo.Collection('room_files');\n\nTemplate.uploadedFilesList.helpers({\n\tfiles() {\n\t\treturn roomFiles.find({ rid: this.rid }, { sort: { uploadedAt: -1 } });\n\t},\n\n\thasFiles() {\n\t\treturn roomFiles.find({ rid: this.rid }).count() > 0;\n\t},\n\n\thasMore() {\n\t\treturn Template.instance().hasMore.get();\n\t},\n\n\tgetFileIcon(type) {\n\t\tif (type.match(/^image\\/.+$/)) {\n\t\t\treturn 'icon-picture';\n\t\t}\n\n\t\treturn 'icon-docs';\n\t},\n\n\tcustomClassForFileType() {\n\t\tif (this.type.match(/^image\\/.+$/)) {\n\t\t\treturn 'room-files-image';\n\t\t}\n\t},\n\n\tescapedName() {\n\t\treturn s.escapeHTML(this.name);\n\t},\n\n\tcanDelete() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission('delete-message', this.rid) || (RocketChat.settings && RocketChat.settings.get('Message_AllowDeleting') && (this.userId === Meteor.userId()));\n\t},\n\n\turl() {\n\t\treturn `/file-upload/${ this._id }/${ this.name }`;\n\t},\n\n\tfixCordova(url) {\n\t\tif ((url != null ? url.indexOf('data:image') : undefined) === 0) {\n\t\t\treturn url;\n\t\t}\n\n\t\tif (Meteor.isCordova && ((url != null ? url[0] : undefined) === '/')) {\n\t\t\turl = Meteor.absoluteUrl().replace(/\\/$/, '') + url;\n\t\t\tconst query = `rc_uid=${ Meteor.userId() }&rc_token=${ Meteor._localStorage.getItem('Meteor.loginToken') }`;\n\t\t\tif (url.indexOf('?') === -1) {\n\t\t\t\turl = `${ url }?${ query }`;\n\t\t\t} else {\n\t\t\t\turl = `${ url }&${ query }`;\n\t\t\t}\n\t\t}\n\n\t\tif ((Meteor.settings && Meteor.settings.public && Meteor.settings.sandstorm) || url.match(/^(https?:)?\\/\\//i)) {\n\t\t\treturn url;\n\t\t} else if (navigator.userAgent.indexOf('Electron') > -1) {\n\t\t\treturn __meteor_runtime_config__.ROOT_URL_PATH_PREFIX + url;\n\t\t} else {\n\t\t\treturn Meteor.absoluteUrl().replace(/\\/$/, '') + __meteor_runtime_config__.ROOT_URL_PATH_PREFIX + url;\n\t\t}\n\t}\n});\n\nTemplate.uploadedFilesList.events({\n\t'click .room-file-item'(e) {\n\t\tif ($(e.currentTarget).siblings('.icon-picture').length) {\n\t\t\treturn e.preventDefault();\n\t\t}\n\t},\n\n\t'click .icon-trash'() {\n\t\tconst self = this;\n\t\treturn swal({\n\t\t\ttitle: TAPi18n.__('Are_you_sure'),\n\t\t\ttext: TAPi18n.__('You_will_not_be_able_to_recover_file'),\n\t\t\ttype: 'warning',\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\tconfirmButtonText: TAPi18n.__('Yes_delete_it'),\n\t\t\tcancelButtonText: TAPi18n.__('Cancel'),\n\t\t\tcloseOnConfirm: false,\n\t\t\thtml: false\n\t\t}, function() {\n\t\t\tswal({\n\t\t\t\ttitle: TAPi18n.__('Deleted'),\n\t\t\t\ttext: TAPi18n.__('Your_file_has_been_deleted'),\n\t\t\t\ttype: 'success',\n\t\t\t\ttimer: 1000,\n\t\t\t\tshowConfirmButton: false\n\t\t\t});\n\n\t\t\t// Check if the upload message for this file is currently loaded\n\t\t\tconst msg = ChatMessage.findOne({ file: { _id: self._id } });\n\t\t\treturn RocketChat.models.Uploads.remove(self._id, function() {\n\t\t\t\tif (msg) {\n\t\t\t\t\treturn chatMessages[Session.get('openedRoom')].deleteMsg(msg);\n\t\t\t\t} else {\n\t\t\t\t\treturn Meteor.call('deleteFileMessage', self._id, function(error) {\n\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\treturn handleError(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\t'scroll .content': _.throttle(function(e, t) {\n\t\tif (e.target.scrollTop >= (e.target.scrollHeight - e.target.clientHeight)) {\n\t\t\treturn t.limit.set(t.limit.get() + 50);\n\t\t}\n\t}\n\t, 200)\n});\n\nTemplate.uploadedFilesList.onCreated(function() {\n\tconst { rid } = Template.currentData();\n\tthis.hasMore = new ReactiveVar(true);\n\tthis.limit = new ReactiveVar(50);\n\treturn this.autorun(() => {\n\t\treturn this.subscribe('roomFiles', rid, this.limit.get(), () => {\n\t\t\tif (roomFiles.find({ rid }).fetch().length < this.limit.get()) {\n\t\t\t\treturn this.hasMore.set(false);\n\t\t\t}\n\t\t}\n\t\t);\n\t}\n\t);\n});\n","import toastr from 'toastr';\n\nTemplate.userEdit.helpers({\n\tcanEditOrAdd() {\n\t\treturn (Template.instance().user && RocketChat.authz.hasAtLeastOnePermission('edit-other-user-info')) || (!Template.instance().user && RocketChat.authz.hasAtLeastOnePermission('create-user'));\n\t},\n\n\tuser() {\n\t\treturn Template.instance().user;\n\t},\n\n\trequirePasswordChange() {\n\t\treturn !Template.instance().user || Template.instance().user.requirePasswordChange;\n\t},\n\n\trole() {\n\t\treturn RocketChat.models.Roles.find({}, { sort: { description: 1, _id: 1 } });\n\t},\n\n\tselectUserRole() {\n\t\tif (this._id === 'user') {\n\t\t\treturn 'selected';\n\t\t}\n\t},\n\n\tname() {\n\t\treturn this.description || this._id;\n\t}\n});\n\nTemplate.userEdit.events({\n\t'click .cancel'(e, t) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\treturn t.cancel(t.find('form'));\n\t},\n\n\t'click #randomPassword'(e) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\treturn $('#password').val(Random.id());\n\t},\n\n\t'submit form'(e, t) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\treturn t.save(e.currentTarget);\n\t}\n});\n\nTemplate.userEdit.onCreated(function() {\n\tlet userData;\n\tthis.user = this.data != null ? this.data.user : undefined;\n\n\tconst { tabBar } = Template.currentData();\n\n\tthis.cancel = (form, username) => {\n\t\tform.reset();\n\t\tthis.$('input[type=checkbox]').prop('checked', true);\n\t\tif (this.user) {\n\t\t\treturn this.data.back(username);\n\t\t} else {\n\t\t\treturn tabBar.close();\n\t\t}\n\t};\n\n\tthis.getUserData = () => {\n\t\tuserData = { _id: (this.user != null ? this.user._id : undefined) };\n\t\tuserData.name = s.trim(this.$('#name').val());\n\t\tuserData.username = s.trim(this.$('#username').val());\n\t\tuserData.email = s.trim(this.$('#email').val());\n\t\tuserData.verified = this.$('#verified:checked').length > 0;\n\t\tuserData.password = s.trim(this.$('#password').val());\n\t\tuserData.requirePasswordChange = this.$('#changePassword:checked').length > 0;\n\t\tuserData.joinDefaultChannels = this.$('#joinDefaultChannels:checked').length > 0;\n\t\tuserData.sendWelcomeEmail = this.$('#sendWelcomeEmail:checked').length > 0;\n\t\tif (this.$('#role').val()) { userData.roles = [this.$('#role').val()]; }\n\t\treturn userData;\n\t};\n\n\tthis.validate = () => {\n\t\tuserData = this.getUserData();\n\n\t\tconst errors = [];\n\t\tif (!userData.name) {\n\t\t\terrors.push('Name');\n\t\t}\n\t\tif (!userData.username) {\n\t\t\terrors.push('Username');\n\t\t}\n\t\tif (!userData.email) {\n\t\t\terrors.push('Email');\n\t\t}\n\n\t\tfor (const error of Array.from(errors)) {\n\t\t\ttoastr.error(TAPi18n.__('error-the-field-is-required', { field: TAPi18n.__(error) }));\n\t\t}\n\n\t\treturn errors.length === 0;\n\t};\n\n\treturn this.save = form => {\n\t\tif (this.validate()) {\n\t\t\tuserData = this.getUserData();\n\n\t\t\tif (this.user != null) {\n\t\t\t\tfor (const key in userData) {\n\t\t\t\t\tif (key) {\n\t\t\t\t\t\tconst value = userData[key];\n\t\t\t\t\t\tif (!['_id'].includes(key)) {\n\t\t\t\t\t\t\tif (value === this.user[key]) {\n\t\t\t\t\t\t\t\tdelete userData[key];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn Meteor.call('insertOrUpdateUser', userData, (error, result) => {\n\t\t\t\tif (result) {\n\t\t\t\t\tif (userData._id) {\n\t\t\t\t\t\ttoastr.success(t('User_updated_successfully'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoastr.success(t('User_added_successfully'));\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.cancel(form, userData.username);\n\t\t\t\t}\n\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n});\n","/* globals RoomRoles, UserRoles*/\nimport moment from 'moment';\nimport toastr from 'toastr';\n\nTemplate.userInfo.helpers({\n\tname() {\n\t\tconst user = Template.instance().user.get();\n\t\treturn user && user.name ? user.name : TAPi18n.__('Unnamed');\n\t},\n\n\tusername() {\n\t\tconst user = Template.instance().user.get();\n\t\treturn user && user.username;\n\t},\n\n\temail() {\n\t\tconst user = Template.instance().user.get();\n\t\treturn user && user.emails && user.emails[0] && user.emails[0].address;\n\t},\n\n\tutc() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user.utcOffset != null) {\n\t\t\tif (user.utcOffset > 0) {\n\t\t\t\treturn `+${ user.utcOffset }`;\n\t\t\t}\n\t\t\treturn user.utcOffset;\n\t\t}\n\t},\n\n\tlastLogin() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user.lastLogin) {\n\t\t\treturn moment(user.lastLogin).format('LLL');\n\t\t}\n\t},\n\n\tcreatedAt() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user.createdAt) {\n\t\t\treturn moment(user.createdAt).format('LLL');\n\t\t}\n\t},\n\n\tcanDirectMessage(username) {\n\t\tconst user = Meteor.user();\n\t\treturn RocketChat.authz.hasAllPermission('create-d') && user && user.username !== username;\n\t},\n\n\tisSelf(username) {\n\t\tconst user = Meteor.user();\n\t\treturn user && user.username === username;\n\t},\n\n\tlinkedinUsername() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user.services && user.services.linkedin && user.services.linkedin.publicProfileUrl) {\n\t\t\treturn s.strRight(user.services.linkedin.publicProfileUrl), '/in/';\n\t\t}\n\t},\n\n\tservicesMeteor() {\n\t\tconst user = Template.instance().user.get();\n\t\treturn user && user.services && user.services['meteor-developer'];\n\t},\n\n\tuserTime() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user.utcOffset != null) {\n\t\t\treturn Template.instance().now.get().utcOffset(user.utcOffset).format(RocketChat.settings.get('Message_TimeFormat'));\n\t\t}\n\t},\n\n\tcanRemoveUser() {\n\t\treturn RocketChat.authz.hasAllPermission('remove-user', Session.get('openedRoom'));\n\t},\n\n\tcanMuteUser() {\n\t\treturn RocketChat.authz.hasAllPermission('mute-user', Session.get('openedRoom'));\n\t},\n\n\tuserMuted() {\n\t\tconst room = ChatRoom.findOne(Session.get('openedRoom'));\n\t\tconst user = Template.instance().user.get();\n\n\t\treturn _.isArray(room && room.muted) && (room.muted.indexOf(user && user.username) !== -1);\n\t},\n\n\tcanSetModerator() {\n\t\treturn RocketChat.authz.hasAllPermission('set-moderator', Session.get('openedRoom'));\n\t},\n\n\tisModerator() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user._id) {\n\t\t\treturn !!RoomRoles.findOne({ rid: Session.get('openedRoom'), 'u._id': user._id, roles: 'moderator' });\n\t\t}\n\t},\n\n\tcanSetOwner() {\n\t\treturn RocketChat.authz.hasAllPermission('set-owner', Session.get('openedRoom'));\n\t},\n\n\tisOwner() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user._id) {\n\t\t\treturn !!RoomRoles.findOne({ rid: Session.get('openedRoom'), 'u._id': user._id, roles: 'owner' });\n\t\t}\n\t},\n\n\tuser() {\n\t\treturn Template.instance().user.get();\n\t},\n\n\thasEmails() {\n\t\treturn _.isArray(this.emails);\n\t},\n\n\thasPhone() {\n\t\treturn _.isArray(this.phone);\n\t},\n\n\tisLoading() {\n\t\treturn Template.instance().loadingUserInfo.get();\n\t},\n\n\thasAdminRole() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user._id) {\n\t\t\treturn RocketChat.authz.hasRole(user._id, 'admin');\n\t\t}\n\t},\n\n\tactive() {\n\t\tconst user = Template.instance().user.get();\n\t\treturn user && user.active;\n\t},\n\n\teditingUser() {\n\t\treturn Template.instance().editingUser.get();\n\t},\n\n\tuserToEdit() {\n\t\tconst instance = Template.instance();\n\t\treturn {\n\t\t\tuser: instance.user.get(),\n\t\t\tback(username) {\n\t\t\t\tinstance.editingUser.set();\n\n\t\t\t\tif (username != null) {\n\t\t\t\t\tconst user = instance.user.get();\n\t\t\t\t\tif ((user != null ? user.username : undefined) !== username) {\n\t\t\t\t\t\treturn instance.loadedUsername.set(username);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\n\troleTags() {\n\t\tconst user = Template.instance().user.get();\n\t\tif (user && user._id) {\n\t\t\tconst userRoles = UserRoles.findOne(user._id) || {};\n\t\t\tconst roomRoles = RoomRoles.findOne({'u._id': user._id, rid: Session.get('openedRoom') }) || {};\n\t\t\tif (userRoles.roles || roomRoles.roles) {\n\t\t\t\tconst roles = _.union(userRoles.roles || [], roomRoles.roles || []);\n\t\t\t\treturn RocketChat.models.Roles.find({ _id: { $in: roles }, description: { $exists: 1 } }, { fields: { description: 1 } });\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}\n\t},\n\n\tisDirect() {\n\t\tconst room = ChatRoom.findOne(Session.get('openedRoom'));\n\n\t\treturn (room != null ? room.t : undefined) === 'd';\n\t},\n\n\tisBlocker() {\n\t\tconst subscription = ChatSubscription.findOne({rid:Session.get('openedRoom'), 'u._id': Meteor.userId()}, { fields: { blocker: 1 } });\n\t\treturn subscription.blocker;\n\t}\n});\n\nTemplate.userInfo.events({\n\t'click .thumb'(e) {\n\t\treturn $(e.currentTarget).toggleClass('bigger');\n\t},\n\n\t'click .pvt-msg'(e, instance) {\n\t\treturn Meteor.call('createDirectMessage', this.username, (error, result) => {\n\t\t\tif (error) {\n\t\t\t\treturn handleError(error);\n\t\t\t}\n\n\t\t\tif ((result != null ? result.rid : undefined) != null) {\n\t\t\t\treturn FlowRouter.go('direct', { username: this.username }, FlowRouter.current().queryParams, function() {\n\t\t\t\t\tif (window.matchMedia('(max-width: 500px)').matches) {\n\t\t\t\t\t\treturn instance.tabBar.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\n\t'click .back'(e, instance) {\n\t\treturn instance.clear();\n\t},\n\n\t'click .remove-user'(e, instance) {\n\t\te.preventDefault();\n\t\tconst rid = Session.get('openedRoom');\n\t\tconst room = ChatRoom.findOne(rid);\n\t\tconst user = instance.user.get();\n\t\tif (user && RocketChat.authz.hasAllPermission('remove-user', rid)) {\n\t\t\treturn swal({\n\t\t\t\ttitle: t('Are_you_sure'),\n\t\t\t\ttext: t('The_user_will_be_removed_from_s', room.name),\n\t\t\t\ttype: 'warning',\n\t\t\t\tshowCancelButton: true,\n\t\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\t\tconfirmButtonText: t('Yes_remove_user'),\n\t\t\t\tcancelButtonText: t('Cancel'),\n\t\t\t\tcloseOnConfirm: false,\n\t\t\t\thtml: false\n\t\t\t}, () => {\n\t\t\t\treturn Meteor.call('removeUserFromRoom', { rid, username: user.username }, (err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\tswal({\n\t\t\t\t\t\ttitle: t('Removed'),\n\t\t\t\t\t\ttext: t('User_has_been_removed_from_s', room.name),\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\ttimer: 2000,\n\t\t\t\t\t\tshowConfirmButton: false\n\t\t\t\t\t});\n\n\t\t\t\t\treturn instance.clear();\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\treturn toastr.error(TAPi18n.__('error-not-allowed'));\n\t\t}\n\t},\n\n\t'click .mute-user'(e, instance) {\n\t\te.preventDefault();\n\t\tconst rid = Session.get('openedRoom');\n\t\tconst room = ChatRoom.findOne(rid);\n\t\tconst user = instance.user.get();\n\t\tif (user && RocketChat.authz.hasAllPermission('mute-user', rid)) {\n\t\t\treturn swal({\n\t\t\t\ttitle: t('Are_you_sure'),\n\t\t\t\ttext: t('The_user_wont_be_able_to_type_in_s', room.name),\n\t\t\t\ttype: 'warning',\n\t\t\t\tshowCancelButton: true,\n\t\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\t\tconfirmButtonText: t('Yes_mute_user'),\n\t\t\t\tcancelButtonText: t('Cancel'),\n\t\t\t\tcloseOnConfirm: false,\n\t\t\t\thtml: false\n\t\t\t}, () => {\n\t\t\t\treturn Meteor.call('muteUserInRoom', { rid, username: user.username }, function(err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\treturn swal({\n\t\t\t\t\t\ttitle: t('Muted'),\n\t\t\t\t\t\ttext: t('User_has_been_muted_in_s', room.name),\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\ttimer: 2000,\n\t\t\t\t\t\tshowConfirmButton: false\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\n\t'click .unmute-user'(e, t) {\n\t\te.preventDefault();\n\t\tconst rid = Session.get('openedRoom');\n\t\tconst user = t.user.get();\n\t\t//const room = ChatRoom.findOne(rid); // never used\n\t\tif (user && RocketChat.authz.hasAllPermission('mute-user', rid)) {\n\t\t\treturn Meteor.call('unmuteUserInRoom', { rid, username: user.username }, function(err) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn handleError(err);\n\t\t\t\t}\n\t\t\t\treturn toastr.success(TAPi18n.__('User_unmuted_in_room'));\n\t\t\t});\n\t\t} else {\n\t\t\treturn toastr.error(TAPi18n.__('error-not-allowed'));\n\t\t}\n\t},\n\n\t'click .set-moderator'(e, t) {\n\t\te.preventDefault();\n\t\tconst user = t.user.get();\n\t\tif (user) {\n\t\t\tconst userModerator = RoomRoles.findOne({ rid: Session.get('openedRoom'), 'u._id': user._id, roles: 'moderator' }, { fields: { _id: 1 } });\n\t\t\tif (userModerator == null) {\n\t\t\t\treturn Meteor.call('addRoomModerator', Session.get('openedRoom'), user._id, (err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst room = ChatRoom.findOne(Session.get('openedRoom'));\n\t\t\t\t\treturn toastr.success(TAPi18n.__('User__username__is_now_a_moderator_of__room_name_', { username: this.username, room_name: room.name }));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\t'click .unset-moderator'(e, t) {\n\t\te.preventDefault();\n\t\tconst user = t.user.get();\n\t\tif (user) {\n\t\t\tconst userModerator = RoomRoles.findOne({ rid: Session.get('openedRoom'), 'u._id': user._id, roles: 'moderator' }, { fields: { _id: 1 } });\n\t\t\tif (userModerator != null) {\n\t\t\t\treturn Meteor.call('removeRoomModerator', Session.get('openedRoom'), user._id, (err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst room = ChatRoom.findOne(Session.get('openedRoom'));\n\t\t\t\t\treturn toastr.success(TAPi18n.__('User__username__removed_from__room_name__moderators', { username: this.username, room_name: room.name }));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\t'click .set-owner'(e, t) {\n\t\te.preventDefault();\n\t\tconst user = t.user.get();\n\t\tif (user) {\n\t\t\tconst userOwner = RoomRoles.findOne({ rid: Session.get('openedRoom'), 'u._id': user._id, roles: 'owner' }, { fields: { _id: 1 } });\n\t\t\tif (userOwner == null) {\n\t\t\t\treturn Meteor.call('addRoomOwner', Session.get('openedRoom'), user._id, (err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst room = ChatRoom.findOne(Session.get('openedRoom'));\n\t\t\t\t\treturn toastr.success(TAPi18n.__('User__username__is_now_a_owner_of__room_name_', { username: this.username, room_name: room.name }));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\t'click .unset-owner'(e, t) {\n\t\te.preventDefault();\n\t\tconst user = t.user.get();\n\t\tif (user) {\n\t\t\tconst userOwner = RoomRoles.findOne({ rid: Session.get('openedRoom'), 'u._id': user._id, roles: 'owner' }, { fields: { _id: 1 } });\n\t\t\tif (userOwner != null) {\n\t\t\t\treturn Meteor.call('removeRoomOwner', Session.get('openedRoom'), user._id, (err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst room = ChatRoom.findOne(Session.get('openedRoom'));\n\t\t\t\t\treturn toastr.success(TAPi18n.__('User__username__removed_from__room_name__owners', { username: this.username, room_name: room.name }));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\t'click .deactivate'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst user = instance.user.get();\n\t\tif (user) {\n\t\t\treturn Meteor.call('setUserActiveStatus', user._id, false, function(error, result) {\n\t\t\t\tif (result) {\n\t\t\t\t\ttoastr.success(t('User_has_been_deactivated'));\n\t\t\t\t}\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t'click .activate'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst user = instance.user.get();\n\t\tif (user) {\n\t\t\treturn Meteor.call('setUserActiveStatus', user._id, true, function(error, result) {\n\t\t\t\tif (result) {\n\t\t\t\t\ttoastr.success(t('User_has_been_activated'));\n\t\t\t\t}\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t'click .make-admin'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst user = instance.user.get();\n\t\tif (user) {\n\t\t\treturn Meteor.call('setAdminStatus', user._id, true, function(error, result) {\n\t\t\t\tif (result) {\n\t\t\t\t\ttoastr.success(t('User_is_now_an_admin'));\n\t\t\t\t}\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t'click .remove-admin'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst user = instance.user.get();\n\t\tif (user) {\n\t\t\treturn Meteor.call('setAdminStatus', user._id, false, function(error, result) {\n\t\t\t\tif (result) {\n\t\t\t\t\ttoastr.success(t('User_is_no_longer_an_admin'));\n\t\t\t\t}\n\t\t\t\tif (error) {\n\t\t\t\t\treturn handleError(error);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t'click .delete'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst user = instance.user.get();\n\t\tif (user) {\n\t\t\treturn swal({\n\t\t\t\ttitle: t('Are_you_sure'),\n\t\t\t\ttext: t('Delete_User_Warning'),\n\t\t\t\ttype: 'warning',\n\t\t\t\tshowCancelButton: true,\n\t\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\t\tconfirmButtonText: t('Yes_delete_it'),\n\t\t\t\tcancelButtonText: t('Cancel'),\n\t\t\t\tcloseOnConfirm: false,\n\t\t\t\thtml: false\n\t\t\t}, function() {\n\t\t\t\tswal.disableButtons();\n\t\t\t\treturn Meteor.call('deleteUser', user._id, function(error) {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\thandleError(error);\n\t\t\t\t\t\treturn swal.enableButtons();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tswal({\n\t\t\t\t\t\t\ttitle: t('Deleted'),\n\t\t\t\t\t\t\ttext: t('User_has_been_deleted'),\n\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t\ttimer: 2000,\n\t\t\t\t\t\t\tshowConfirmButton: false\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn instance.tabBar.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\n\t'click .edit-user'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t\tconst user = instance.user.get();\n\t\tif (user) {\n\t\t\treturn instance.editingUser.set(user._id);\n\t\t}\n\t},\n\n\t'click .block-user'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\treturn Meteor.call('blockUser', { rid: Session.get('openedRoom'), blocked: instance.user.get()._id }, function(error, result) {\n\t\t\tif (result) {\n\t\t\t\ttoastr.success(t('User_is_blocked'));\n\t\t\t}\n\t\t\tif (error) {\n\t\t\t\treturn handleError(error);\n\t\t\t}\n\t\t});\n\t},\n\n\t'click .unblock-user'(e, instance) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\treturn Meteor.call('unblockUser', { rid: Session.get('openedRoom'), blocked: instance.user.get()._id }, function(error, result) {\n\t\t\tif (result) {\n\t\t\t\ttoastr.success(t('User_is_unblocked'));\n\t\t\t}\n\t\t\tif (error) {\n\t\t\t\treturn handleError(error);\n\t\t\t}\n\t\t});\n\t}\n});\n\nTemplate.userInfo.onCreated(function() {\n\tthis.now = new ReactiveVar(moment());\n\tthis.user = new ReactiveVar;\n\tthis.editingUser = new ReactiveVar;\n\tthis.loadingUserInfo = new ReactiveVar(true);\n\tthis.loadedUsername = new ReactiveVar;\n\tthis.tabBar = Template.currentData().tabBar;\n\n\tMeteor.setInterval(() => {\n\t\treturn this.now.set(moment());\n\t}\n\t, 30000);\n\n\tthis.autorun(() => {\n\t\tconst username = this.loadedUsername.get();\n\n\t\tif (username == null) {\n\t\t\tthis.loadingUserInfo.set(false);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.loadingUserInfo.set(true);\n\n\t\treturn this.subscribe('fullUserData', username, 1, () => {\n\t\t\treturn this.loadingUserInfo.set(false);\n\t\t});\n\t});\n\n\tthis.autorun(() => {\n\t\tconst data = Template.currentData();\n\t\tif (data.clear != null) {\n\t\t\treturn this.clear = data.clear;\n\t\t}\n\t});\n\n\tthis.autorun(() => {\n\t\tconst data = Template.currentData();\n\t\tconst user = this.user.get();\n\t\treturn this.loadedUsername.set((user != null ? user.username : undefined) || (data != null ? data.username : undefined));\n\t});\n\n\treturn this.autorun(() => {\n\t\tlet filter;\n\t\tconst data = Template.currentData();\n\t\tif (data && data.username != null) {\n\t\t\tfilter = { username: data.username };\n\t\t} else if (data && data._id != null) {\n\t\t\tfilter = { _id: data._id };\n\t\t}\n\n\t\tconst user = Meteor.users.findOne(filter);\n\n\t\treturn this.user.set(user);\n\t});\n});\n","Template.flexTabBar.helpers({\n\tactive() {\n\t\tif (this.template === Template.instance().tabBar.getTemplate() && Template.instance().tabBar.getState() === 'opened') {\n\t\t\treturn 'active';\n\t\t}\n\t},\n\n\tbuttons() {\n\t\treturn RocketChat.TabBar.getButtons();\n\t},\n\n\ttitle() {\n\t\treturn t(this.i18nTitle) || this.title;\n\t},\n\n\tvisible() {\n\t\tif (!Meteor.userId() && !this.anonymous) {\n\t\t\treturn 'hidden';\n\t\t}\n\n\t\tif (this.groups.indexOf(Template.instance().tabBar.currentGroup()) === -1) {\n\t\t\treturn 'hidden';\n\t\t}\n\t},\n\n\topened() {\n\t\treturn Template.instance().tabBar.getState();\n\t},\n\n\ttemplate() {\n\t\treturn Template.instance().tabBar.getTemplate();\n\t},\n\n\tflexData() {\n\t\treturn Object.assign(Template.currentData().data || {}, {\n\t\t\ttabBar: Template.instance().tabBar\n\t\t});\n\t}\n});\n\nTemplate.flexTabBar.events({\n\t'click .tab-button'(e, instance) {\n\t\te.preventDefault();\n\t\tif (instance.tabBar.getState() === 'opened' && instance.tabBar.getTemplate() === this.template) {\n\t\t\treturn instance.tabBar.close();\n\t\t} else {\n\t\t\treturn instance.tabBar.open(this);\n\t\t}\n\t}\n});\n\nTemplate.flexTabBar.onCreated(function() {\n\tthis.tabBar = Template.currentData().tabBar;\n});\n"]}