{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:slashcommands-kick/server.js"],"names":["Kick","command","params","rid","Match","test","String","username","trim","replace","user","Meteor","users","findOne","userId","kickedUser","RocketChat","models","Users","findOneByUsername","room","Rooms","findOneById","Notifications","notifyUser","_id","Random","id","ts","Date","msg","TAPi18n","__","postProcess","sprintf","language","usernames","includes","call","slashCommands","add"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AAEA,IAAMA,OAAO,UAASC,OAAT,EAAkBC,MAAlB,QAAiC;AAAA,KAANC,GAAM,QAANA,GAAM;;AAC7C,KAAIF,YAAY,MAAZ,IAAsB,CAACG,MAAMC,IAAN,CAAWH,MAAX,EAAmBI,MAAnB,CAA3B,EAAuD;AACtD;AACA;;AACD,KAAMC,WAAWL,OAAOM,IAAP,GAAcC,OAAd,CAAsB,GAAtB,EAA2B,EAA3B,CAAjB;;AACA,KAAIF,aAAa,EAAjB,EAAqB;AACpB;AACA;;AACD,KAAMG,OAAOC,OAAOC,KAAP,CAAaC,OAAb,CAAqBF,OAAOG,MAAP,EAArB,CAAb;AACA,KAAMC,aAAaC,WAAWC,MAAX,CAAkBC,KAAlB,CAAwBC,iBAAxB,CAA0CZ,QAA1C,CAAnB;AACA,KAAMa,OAAOJ,WAAWC,MAAX,CAAkBI,KAAlB,CAAwBC,WAAxB,CAAoCnB,GAApC,CAAb;;AACA,KAAIY,cAAc,IAAlB,EAAwB;AACvB,SAAOC,WAAWO,aAAX,CAAyBC,UAAzB,CAAoCb,OAAOG,MAAP,EAApC,EAAqD,SAArD,EAAgE;AACtEW,QAAKC,OAAOC,EAAP,EADiE;AAEtExB,WAFsE;AAGtEyB,OAAI,IAAIC,IAAJ,EAHkE;AAItEC,QAAKC,QAAQC,EAAR,CAAW,uBAAX,EAAoC;AACxCC,iBAAa,SAD2B;AAExCC,aAAS,CAAC3B,QAAD;AAF+B,IAApC,EAGFG,KAAKyB,QAHH;AAJiE,GAAhE,CAAP;AASA;;AACD,KAAI,CAACf,KAAKgB,SAAL,IAAkB,EAAnB,EAAuBC,QAAvB,CAAgC9B,QAAhC,MAA8C,KAAlD,EAAyD;AACxD,SAAOS,WAAWO,aAAX,CAAyBC,UAAzB,CAAoCb,OAAOG,MAAP,EAApC,EAAqD,SAArD,EAAgE;AACtEW,QAAKC,OAAOC,EAAP,EADiE;AAEtExB,WAFsE;AAGtEyB,OAAI,IAAIC,IAAJ,EAHkE;AAItEC,QAAKC,QAAQC,EAAR,CAAW,8BAAX,EAA2C;AAC/CC,iBAAa,SADkC;AAE/CC,aAAS,CAAC3B,QAAD;AAFsC,IAA3C,EAGFG,KAAKyB,QAHH;AAJiE,GAAhE,CAAP;AASA;;AACDxB,QAAO2B,IAAP,CAAY,oBAAZ,EAAkC;AAACnC,UAAD;AAAMI;AAAN,EAAlC;AACA,CAlCD;;AAoCAS,WAAWuB,aAAX,CAAyBC,GAAzB,CAA6B,MAA7B,EAAqCxC,IAArC,uC","file":"/packages/rocketchat_slashcommands-kick.js","sourcesContent":["\n// Kick is a named function that will replace /kick commands\n\nconst Kick = function(command, params, {rid}) {\n\tif (command !== 'kick' || !Match.test(params, String)) {\n\t\treturn;\n\t}\n\tconst username = params.trim().replace('@', '');\n\tif (username === '') {\n\t\treturn;\n\t}\n\tconst user = Meteor.users.findOne(Meteor.userId());\n\tconst kickedUser = RocketChat.models.Users.findOneByUsername(username);\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\tif (kickedUser == null) {\n\t\treturn RocketChat.Notifications.notifyUser(Meteor.userId(), 'message', {\n\t\t\t_id: Random.id(),\n\t\t\trid,\n\t\t\tts: new Date,\n\t\t\tmsg: TAPi18n.__('Username_doesnt_exist', {\n\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\tsprintf: [username]\n\t\t\t}, user.language)\n\t\t});\n\t}\n\tif ((room.usernames || []).includes(username) === false) {\n\t\treturn RocketChat.Notifications.notifyUser(Meteor.userId(), 'message', {\n\t\t\t_id: Random.id(),\n\t\t\trid,\n\t\t\tts: new Date,\n\t\t\tmsg: TAPi18n.__('Username_is_not_in_this_room', {\n\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\tsprintf: [username]\n\t\t\t}, user.language)\n\t\t});\n\t}\n\tMeteor.call('removeUserFromRoom', {rid, username});\n};\n\nRocketChat.slashCommands.add('kick', Kick);\n"]}