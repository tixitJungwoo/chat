{"version":3,"sources":["meteor://üíªapp/packages/lily:ui-chart-point/server/models/PointHistory.js","meteor://üíªapp/packages/lily:ui-chart-point/server/pointManager.js"],"names":["PointHistory","tryEnsureIndex","insertLilyPointHistory","pointInfo","console","log","insert","findAllPointHistory","findUserPointHistory","RocketChat","models","_LilyBase","defaultCreatePoint","Meteor","methods","pointCharging","arguments","userId","charginType","event","user","point","_id","Random","id","u","username","chargingType","ts","Date","balance","callback","newJoinRoom","roomId","store","file","msgData","Error","method"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;OAGMA,Y;;;AACF,4BAAc;AAAA;;AAAA,mEACV,iCAAM,cAAN,CADU;;AAGV,cAAKC,cAAL,CAAoB;AAAC,qBAAS;AAAV,SAApB;;AACA,cAAKA,cAAL,CAAoB;AAAC,kBAAM;AAAP,SAApB;;AAJU;AAKb;;2BAEDC,sB;wCAAuBC,S,EAAW;AAC9BC,oBAAQC,GAAR,CAAY,wBAAZ;AACA,mBAAO,KAAKC,MAAL,CAAYH,SAAZ,CAAP;AACH;;;;;2BAEDI,mB;uCAAsB,CAErB;;;;;2BAEDC,oB;wCAAuB,CAEtB;;;;;;EAnBsBC,WAAWC,MAAX,CAAkBC,S;;AAsB7CF,WAAWC,MAAX,CAAkBV,YAAlB,GAAiC,IAAIA,YAAJ,EAAjC,wE;;;;;;;;;;;ACzBA;AACA,IAAIY,qBAAqB,GAAzB;AAEAC,OAAOC,OAAP,CAAe;AACX;AACA;;;;;;OAOAC,aATW,YASGC,SATH,EASc;AACrBZ,gBAAQC,GAAR,CAAY,mDAAZ;AAEAD,gBAAQC,GAAR,CAAY,yBAAyBW,UAAUC,MAA/C;AACAb,gBAAQC,GAAR,CAAY,4BAA4BW,UAAUE,WAAlD,EAJqB,CAOrB;;AACA,YAAMC,QAAQ,EAAd;AACAf,gBAAQC,GAAR,CAAY,wBAAZ,EATqB,CAUrB;;AACAD,gBAAQC,GAAR,CAAY,kBAAZ;AAEA,YAAMe,OAAOP,OAAOO,IAAP,EAAb;AACA,YAAMC,QAAQ;AACVC,iBAAKC,OAAOC,EAAP,EADK;AAEVC,eAAG;AACCH,qBAAKN,UAAUM,GADhB;AAECI,0BAAUV,UAAUU;AAFrB,aAFO;AAMVC,0BAAcX,UAAUW,YANd;AAOVN,mBAAOT,kBAPG;AAQVgB,gBAAI,IAAIC,IAAJ,EARM;AASVV,mBAAOA;AATG,SAAd,CAdqB,CAyBrB;;AACAf,gBAAQC,GAAR,CAAY,oBAAoBgB,KAAhC,EA1BqB,CA2BrB;;AACAZ,mBAAWC,MAAX,CAAkBV,YAAlB,CAA+BE,sBAA/B,CAAsDmB,KAAtD,EA5BqB,CA6BrB;AACA;AACA;AACA;AACA;;AAEAjB,gBAAQC,GAAR,CAAY,gDAAZ;AACH,KA7CU;AA8CXyB,WA9CW,YA8CHC,QA9CG,EA8CO,CAEjB,CAhDU;AAkDX;AACAC,eAnDW,YAmDCC,MAnDD,EAmDSC,KAnDT,EAmDgBC,IAnDhB,EAmDoC;AAAA,YAAdC,OAAc,uEAAJ,EAAI;;AAC3C,YAAI,CAACvB,OAAOI,MAAP,EAAL,EAAsB;AAClB,kBAAM,IAAIJ,OAAOwB,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAACC,wBAAQ;AAAT,aAAvD,CAAN;AACH;;AAED,YAAMlB,OAAOP,OAAOO,IAAP,EAAb;AACH;AAzDU,CAAf,yH","file":"/packages/lily_ui-chart-point.js","sourcesContent":["/**\n * Created by jungwoo on 2017. 7. 1..\n */\nclass PointHistory extends RocketChat.models._LilyBase {\n    constructor() {\n        super('PointHistory');\n\n        this.tryEnsureIndex({'u._id': 1});\n        this.tryEnsureIndex({'ts': 1});\n    }\n\n    insertLilyPointHistory(pointInfo) {\n        console.log(\"insertLilyPointHistory\");\n        return this.insert(pointInfo);\n    }\n\n    findAllPointHistory() {\n\n    }\n\n    findUserPointHistory() {\n\n    }\n}\n\nRocketChat.models.PointHistory = new PointHistory();","//Meteor.call('pointCharging', { _id: msg._id });\nlet defaultCreatePoint = 100;\n\nMeteor.methods({\n    //Ìè¨Ïù∏Ìä∏ Ï∂©Ï†Ñ\n    /*\n     chargingType : Ï∂©Ï†Ñ Ïú†Ìòï\n     NEW_USER Ïã†Í∑ú ÌöåÏõê,\n     CASH : Í≤∞Ïû¨ ,\n     COUPON : Ïø†Ìè∞ ÏÇ¨Ïö©,\n     PROMOTION : ÌîÑÎ°úÎ™®ÏÖò\n     */\n    pointCharging(arguments) {\n        console.log(\"##### LilyChat Point Charging Method Called #####\");\n\n        console.log(\"Parameter newUserId:\" + arguments.userId);\n        console.log(\"Parameter chargingType:\" + arguments.charginType);\n\n\n        //ÌòÑÏû¨ ÏßÑÌñâÌïòÎäî Ïù¥Î≤§Ìä∏Î•º ÌôïÏù∏\n        const event = {};\n        console.log(\"# Event Method Called.\");\n        //Ìè¨Ïù∏Ìä∏ Ï∂©Ï†Ñ\n        console.log(\"# Point Charing.\");\n\n        const user = Meteor.user();\n        const point = {\n            _id: Random.id(),\n            u: {\n                _id: arguments._id,\n                username: arguments.username\n            },\n            chargingType: arguments.chargingType,\n            point: defaultCreatePoint,\n            ts: new Date(),\n            event: event\n        };\n        //let user = Accounts.findUserByUsername(arguments.userId)\n        console.log(\"# Point Data : \" + point);\n        // console.log(\"# Point Data : \" + user._id);\n        RocketChat.models.PointHistory.insertLilyPointHistory(point);\n        // RocketCat.callbacks.run('beforeSavePoint', point);\n        // RocketCat.promises.run('onPointCharging', point).then(function (point) {\n        //     Point.insert(point);\n        //     return RocketCat.callbacks.run('afterSaveCharging', message);\n        // });\n\n        console.log(\"##### LilyChat Point Charging Method END #####\");\n    },\n    balance(callback) {\n\n    }\n    ,\n    //Ï±ÑÎÑê ÏûÖÏû• Ïãú point Ï∞®Í∞ê\n    newJoinRoom(roomId, store, file, msgData = {}) {\n        if (!Meteor.userId()) {\n            throw new Meteor.Error('error-invalid-user', 'Invalid user', {method: 'sendFileMessage'});\n        }\n\n        const user = Meteor.user();\n    }\n})\n;\n"]}