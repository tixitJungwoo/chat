{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:channel-settings/client/lib/ChannelSettings.js","meteor://ðŸ’»app/packages/rocketchat:channel-settings/client/startup/messageTypes.js","meteor://ðŸ’»app/packages/rocketchat:channel-settings/client/startup/tabBar.js","meteor://ðŸ’»app/packages/rocketchat:channel-settings/client/startup/trackSettingsChange.js","meteor://ðŸ’»app/packages/rocketchat:channel-settings/client/views/channelSettings.js"],"names":["RocketChat","ChannelSettings","options","ReactiveVar","addOption","config","id","Tracker","nonreactive","opts","get","set","getOptions","currentData","group","allOptions","_","toArray","allowedOptions","compact","map","option","validation","data","Object","assign","filter","includes","sortBy","Meteor","startup","MessageTypes","registerType","system","message","user_by","u","username","room_type","msg","room_topic","room_announcement","room_description","TabBar","addButton","groups","anonymous","i18nTitle","icon","template","order","roomSettingsChangedCallback","t","Session","rid","type","FlowRouter","current","route","name","RoomManager","close","getParam","subscription","ChatSubscription","findOne","go","queryParams","callbacks","add","priority","HIGH","roomNameChangedCallback","toastr","module","watch","require","v","Template","channelSettings","helpers","obj","keys","key","$key","$value","valueOf","showSetting","setting","room","showInDirect","settings","instance","getRoom","ChatRoom","editing","field","isDisabled","disabled","processing","authz","hasAllPermission","_id","unscape","value","s","unescapeHTML","canDeleteRoom","fields","roomType","hasAtLeastOnePermission","readOnly","ro","has","readOnlyDescription","events","swal","title","text","showCancelButton","confirmButtonColor","confirmButtonText","cancelButtonText","closeOnConfirm","html","disableButtons","call","error","handleError","enableButtons","timer","showConfirmButton","e","keyCode","preventDefault","saveSetting","$","currentTarget","setTimeout","focus","select","attr","onCreated","label","canView","canEdit","save","nameValidation","RegExp","error1","test","room_name","err","run","success","TAPi18n","__","topic","announcement","description","isToggle","hasRole","userId","saveRoomSettings","confirmed","prop","reactWhenReadOnly","archived","action","joinCode","val","is"],"mappings":"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","file":"/packages/rocketchat_channel-settings.js","sourcesContent":["RocketChat.ChannelSettings = new class {\n\tconstructor() {\n\t\tthis.options = new ReactiveVar({});\n\t}\n\n/*\n\t * Adds an option in Channel Settings\n\t * @config (object)\n\t *   id: option id (required)\n\t *   template (string): template name to render (required)\n\t *   validation (function): if option should be displayed\n */\n\taddOption(config) {\n\t\tif (config == null || config.id == null) {\n\t\t\treturn false;\n\t\t}\n\t\treturn Tracker.nonreactive(() => {\n\t\t\tconst opts = this.options.get();\n\t\t\topts[config.id] = config;\n\t\t\treturn this.options.set(opts);\n\t\t});\n\t}\n\n\tgetOptions(currentData, group) {\n\t\tconst allOptions = _.toArray(this.options.get());\n\t\tconst allowedOptions = _.compact(_.map(allOptions, function(option) {\n\t\t\tif (option.validation == null || option.validation()) {\n\t\t\t\toption.data = Object.assign({}, typeof option.data === 'function' ? option.data() : option.data, currentData);\n\t\t\t\treturn option;\n\t\t\t}\n\t\t})).filter(function(option) {\n\t\t\treturn !group || !option.group || option.group.includes(group);\n\t\t});\n\t\treturn _.sortBy(allowedOptions, 'order');\n\t}\n};\n","Meteor.startup(function() {\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room_changed_privacy',\n\t\tsystem: true,\n\t\tmessage: 'room_changed_privacy',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_by: message.u && message.u.username,\n\t\t\t\troom_type: message.msg\n\t\t\t};\n\t\t}\n\t});\n\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room_changed_topic',\n\t\tsystem: true,\n\t\tmessage: 'room_changed_topic',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_by: message.u && message.u.username,\n\t\t\t\troom_topic: message.msg\n\t\t\t};\n\t\t}\n\t});\n\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room_changed_announcement',\n\t\tsystem: true,\n\t\tmessage: 'room_changed_announcement',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_by: message.u && message.u.username,\n\t\t\t\troom_announcement: message.msg\n\t\t\t};\n\t\t}\n\t});\n\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room_changed_description',\n\t\tsystem: true,\n\t\tmessage: 'room_changed_description',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_by: message.u && message.u.username,\n\t\t\t\troom_description: message.msg\n\t\t\t};\n\t\t}\n\t});\n});\n","Meteor.startup(() => {\n\tRocketChat.TabBar.addButton({\n\t\tgroups: ['channel', 'group', 'direct'],\n\t\tid: 'channel-settings',\n\t\tanonymous: true,\n\t\ti18nTitle: 'Room_Info',\n\t\ticon: 'icon-info-circled',\n\t\ttemplate: 'channelSettings',\n\t\torder: 0\n\t});\n});\n","Meteor.startup(function() {\n\tconst roomSettingsChangedCallback = (msg) => {\n\t\tTracker.nonreactive(() => {\n\t\t\tif (msg.t === 'room_changed_privacy') {\n\t\t\t\tif (Session.get('openedRoom') === msg.rid) {\n\t\t\t\t\tconst type = FlowRouter.current().route.name === 'channel' ? 'c' : 'p';\n\t\t\t\t\tRoomManager.close(type + FlowRouter.getParam('name'));\n\n\t\t\t\t\tconst subscription = ChatSubscription.findOne({ rid: msg.rid });\n\t\t\t\t\tconst route = subscription.t === 'c' ? 'channel' : 'group';\n\t\t\t\t\tFlowRouter.go(route, { name: subscription.name }, FlowRouter.current().queryParams);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn msg;\n\t};\n\n\tRocketChat.callbacks.add('streamMessage', roomSettingsChangedCallback, RocketChat.callbacks.priority.HIGH, 'room-settings-changed');\n\n\tconst roomNameChangedCallback = (msg) => {\n\t\tTracker.nonreactive(() => {\n\t\t\tif (msg.t === 'r') {\n\t\t\t\tif (Session.get('openedRoom') === msg.rid) {\n\t\t\t\t\tconst type = FlowRouter.current().route.name === 'channel' ? 'c' : 'p';\n\t\t\t\t\tRoomManager.close(type + FlowRouter.getParam('name'));\n\t\t\t\t\tFlowRouter.go(FlowRouter.current().route.name, { name: msg.msg }, FlowRouter.current().queryParams);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn msg;\n\t};\n\n\tRocketChat.callbacks.add('streamMessage', roomNameChangedCallback, RocketChat.callbacks.priority.HIGH, 'room-name-changed');\n});\n","import toastr from 'toastr';\n\nTemplate.channelSettings.helpers({\n\ttoArray(obj) {\n\t\treturn Object.keys(obj).map((key) => {\n\t\t\treturn {\n\t\t\t\t$key: key,\n\t\t\t\t$value: obj[key]\n\t\t\t};\n\t\t});\n\t},\n\tvalueOf(obj, key) {\n\t\tif (key === 't') {\n\t\t\tif (obj[key] === 'c') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn obj && obj[key];\n\t},\n\tshowSetting(setting, room) {\n\t\tif (setting.showInDirect === false) {\n\t\t\treturn room.t !== 'd';\n\t\t}\n\t\treturn true;\n\t},\n\tsettings() {\n\t\treturn Template.instance().settings;\n\t},\n\tgetRoom() {\n\t\treturn ChatRoom.findOne(this.rid);\n\t},\n\tediting(field) {\n\t\treturn Template.instance().editing.get() === field;\n\t},\n\tisDisabled(field, room) {\n\t\tconst setting = Template.instance().settings[field];\n\t\treturn (typeof setting.disabled === 'function' && setting.disabled(room)) || setting.processing.get() || !RocketChat.authz.hasAllPermission('edit-room', room._id);\n\t},\n\tchannelSettings() {\n\t\treturn RocketChat.ChannelSettings.getOptions(Template.currentData(), 'room');\n\t},\n\tunscape(value) {\n\t\treturn s.unescapeHTML(value);\n\t},\n\tcanDeleteRoom() {\n\t\tconst room = ChatRoom.findOne(this.rid, {\n\t\t\tfields: {\n\t\t\t\tt: 1\n\t\t\t}\n\t\t});\n\t\tconst roomType = room && room.t;\n\t\treturn roomType && RocketChat.authz.hasAtLeastOnePermission(`delete-${ roomType }`, this.rid);\n\t},\n\treadOnly() {\n\t\tconst room = ChatRoom.findOne(this.rid, {\n\t\t\tfields: {\n\t\t\t\tro: 1\n\t\t\t}\n\t\t});\n\t\treturn room && room.ro;\n\t},\n\thas(v, key) {\n\t\treturn !!(v && v[key]);\n\t},\n\treadOnlyDescription() {\n\t\tconst room = ChatRoom.findOne(this.rid, {\n\t\t\tfields: {\n\t\t\t\tro: 1\n\t\t\t}\n\t\t});\n\t\treturn t(room && room.ro ? 'True' : 'False');\n\t}\n});\n\nTemplate.channelSettings.events({\n\t'click .delete'() {\n\t\treturn swal({\n\t\t\ttitle: t('Are_you_sure'),\n\t\t\ttext: t('Delete_Room_Warning'),\n\t\t\ttype: 'warning',\n\t\t\tshowCancelButton: true,\n\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\tconfirmButtonText: t('Yes_delete_it'),\n\t\t\tcancelButtonText: t('Cancel'),\n\t\t\tcloseOnConfirm: false,\n\t\t\thtml: false\n\t\t}, () => {\n\t\t\tswal.disableButtons();\n\t\t\tMeteor.call('eraseRoom', this.rid, function(error) {\n\t\t\t\tif (error) {\n\t\t\t\t\thandleError(error);\n\t\t\t\t\treturn swal.enableButtons();\n\t\t\t\t}\n\t\t\t\tswal({\n\t\t\t\t\ttitle: t('Deleted'),\n\t\t\t\t\ttext: t('Room_has_been_deleted'),\n\t\t\t\t\ttype: 'success',\n\t\t\t\t\ttimer: 2000,\n\t\t\t\t\tshowConfirmButton: false\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t'keydown input[type=text]'(e, t) {\n\t\tif (e.keyCode === 13) {\n\t\t\te.preventDefault();\n\t\t\tt.saveSetting();\n\t\t}\n\t},\n\t'click [data-edit]'(e, t) {\n\t\te.preventDefault();\n\t\tif ($(e.currentTarget).data('edit')) {\n\t\t\tt.editing.set($(e.currentTarget).data('edit'));\n\t\t\treturn setTimeout((function() {\n\t\t\t\treturn t.$('input.editing').focus().select();\n\t\t\t}), 100);\n\t\t}\n\t},\n\t'change [type=\"radio\"]'(e, t) {\n\t\treturn t.editing.set($(e.currentTarget).attr('name'));\n\t},\n\t'change [type=\"checkbox\"]'(e, t) {\n\t\tt.editing.set($(e.currentTarget).attr('name'));\n\t\treturn t.saveSetting();\n\t},\n\t'click .cancel'(e, t) {\n\t\te.preventDefault();\n\t\treturn t.editing.set();\n\t},\n\t'click .save'(e, t) {\n\t\te.preventDefault();\n\t\treturn t.saveSetting();\n\t}\n});\n\nTemplate.channelSettings.onCreated(function() {\n\tthis.editing = new ReactiveVar;\n\tthis.settings = {\n\t\tname: {\n\t\t\ttype: 'text',\n\t\t\tlabel: 'Name',\n\t\t\tcanView(room) {\n\t\t\t\treturn room.t !== 'd';\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn RocketChat.authz.hasAllPermission('edit-room', room._id);\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\tlet nameValidation;\n\t\t\t\tif (!RocketChat.authz.hasAllPermission('edit-room', room._id) || (room.t !== 'c' && room.t !== 'p')) {\n\t\t\t\t\treturn toastr.error(t('error-not-allowed'));\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t\t\t\t} catch (error1) {\n\t\t\t\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t\t\t\t}\n\t\t\t\tif (!nameValidation.test(value)) {\n\t\t\t\t\treturn toastr.error(t('error-invalid-room-name', {\n\t\t\t\t\t\troom_name: {\n\t\t\t\t\t\t\tname: value\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tMeteor.call('saveRoomSettings', room._id, 'roomName', value, function(err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\tRocketChat.callbacks.run('roomNameChanged', {\n\t\t\t\t\t\t_id: room._id,\n\t\t\t\t\t\tname: value\n\t\t\t\t\t});\n\t\t\t\t\treturn toastr.success(TAPi18n.__('Room_name_changed_successfully'));\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\ttopic: {\n\t\t\ttype: 'markdown',\n\t\t\tlabel: 'Topic',\n\t\t\tcanView() {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn RocketChat.authz.hasAllPermission('edit-room', room._id);\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\treturn Meteor.call('saveRoomSettings', room._id, 'roomTopic', value, function(err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\ttoastr.success(TAPi18n.__('Room_topic_changed_successfully'));\n\t\t\t\t\treturn RocketChat.callbacks.run('roomTopicChanged', room);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tannouncement: {\n\t\t\ttype: 'markdown',\n\t\t\tlabel: 'Announcement',\n\t\t\tcanView() {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn RocketChat.authz.hasAllPermission('edit-room', room._id);\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\treturn Meteor.call('saveRoomSettings', room._id, 'roomAnnouncement', value, function(err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\ttoastr.success(TAPi18n.__('Room_announcement_changed_successfully'));\n\t\t\t\t\treturn RocketChat.callbacks.run('roomAnnouncementChanged', room);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tdescription: {\n\t\t\ttype: 'text',\n\t\t\tlabel: 'Description',\n\t\t\tcanView(room) {\n\t\t\t\treturn room.t !== 'd';\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn RocketChat.authz.hasAllPermission('edit-room', room._id);\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\treturn Meteor.call('saveRoomSettings', room._id, 'roomDescription', value, function(err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\treturn toastr.success(TAPi18n.__('Room_description_changed_successfully'));\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tt: {\n\t\t\ttype: 'boolean',\n\t\t\tlabel: 'Private',\n\t\t\tisToggle: true,\n\t\t\tprocessing: new ReactiveVar(false),\n\t\t\tdisabled(room) {\n\t\t\t\treturn room['default'] && !RocketChat.authz.hasRole(Meteor.userId(), 'admin');\n\t\t\t},\n\t\t\tmessage(room) {\n\t\t\t\tif (RocketChat.authz.hasAllPermission('edit-room', room._id) && room['default']) {\n\t\t\t\t\tif (!RocketChat.authz.hasRole(Meteor.userId(), 'admin')) {\n\t\t\t\t\t\treturn 'Room_type_of_default_rooms_cant_be_changed';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tcanView(room) {\n\t\t\t\tif (['c', 'p'].includes(room.t) === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (room.t === 'p' && !RocketChat.authz.hasAllPermission('create-c')) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (room.t === 'c' && !RocketChat.authz.hasAllPermission('create-p')) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn (RocketChat.authz.hasAllPermission('edit-room', room._id) && !room['default']) || RocketChat.authz.hasRole(Meteor.userId(), 'admin');\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\tconst saveRoomSettings = () => {\n\t\t\t\t\tthis.processing.set(true);\n\t\t\t\t\tvalue = value ? 'p' : 'c';\n\t\t\t\t\tRocketChat.callbacks.run('roomTypeChanged', room);\n\t\t\t\t\treturn Meteor.call('saveRoomSettings', room._id, 'roomType', value, (err) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.processing.set(false);\n\t\t\t\t\t\treturn toastr.success(TAPi18n.__('Room_type_changed_successfully'));\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\tif (room['default']) {\n\t\t\t\t\tif (RocketChat.authz.hasRole(Meteor.userId(), 'admin')) {\n\t\t\t\t\t\tswal({\n\t\t\t\t\t\t\ttitle: t('Room_default_change_to_private_will_be_default_no_more'),\n\t\t\t\t\t\t\ttype: 'warning',\n\t\t\t\t\t\t\tshowCancelButton: true,\n\t\t\t\t\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\t\t\t\t\tconfirmButtonText: t('Yes'),\n\t\t\t\t\t\t\tcancelButtonText: t('Cancel'),\n\t\t\t\t\t\t\tcloseOnConfirm: true,\n\t\t\t\t\t\t\thtml: false\n\t\t\t\t\t\t}, function(confirmed) {\n\t\t\t\t\t\t\tif (confirmed) {\n\t\t\t\t\t\t\t\treturn saveRoomSettings();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn $('.channel-settings form [name=\\'t\\']').prop('checked', !!room.type === 'p');\n\t\t\t\t} else {\n\t\t\t\t\treturn saveRoomSettings();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tro: {\n\t\t\ttype: 'boolean',\n\t\t\tlabel: 'Read_only',\n\t\t\tisToggle: true,\n\t\t\tprocessing: new ReactiveVar(false),\n\t\t\tcanView(room) {\n\t\t\t\treturn room.t !== 'd';\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn RocketChat.authz.hasAllPermission('set-readonly', room._id);\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\tthis.processing.set(true);\n\t\t\t\treturn Meteor.call('saveRoomSettings', room._id, 'readOnly', value, (err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\tthis.processing.set(false);\n\t\t\t\t\treturn toastr.success(TAPi18n.__('Read_only_changed_successfully'));\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\treactWhenReadOnly: {\n\t\t\ttype: 'boolean',\n\t\t\tlabel: 'React_when_read_only',\n\t\t\tisToggle: true,\n\t\t\tprocessing: new ReactiveVar(false),\n\t\t\tcanView(room) {\n\t\t\t\treturn room.t !== 'd' && room.ro;\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn RocketChat.authz.hasAllPermission('set-react-when-readonly', room._id);\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\tthis.processing.set(true);\n\t\t\t\treturn Meteor.call('saveRoomSettings', room._id, 'reactWhenReadOnly', value, (err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\tthis.processing.set(false);\n\t\t\t\t\treturn toastr.success(TAPi18n.__('React_when_read_only_changed_successfully'));\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tarchived: {\n\t\t\ttype: 'boolean',\n\t\t\tlabel: 'Room_archivation_state_true',\n\t\t\tisToggle: true,\n\t\t\tprocessing: new ReactiveVar(false),\n\t\t\tcanView(room) {\n\t\t\t\treturn room.t !== 'd';\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn RocketChat.authz.hasAtLeastOnePermission(['archive-room', 'unarchive-room'], room._id);\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\treturn swal({\n\t\t\t\t\ttitle: t('Are_you_sure'),\n\t\t\t\t\ttype: 'warning',\n\t\t\t\t\tshowCancelButton: true,\n\t\t\t\t\tconfirmButtonColor: '#DD6B55',\n\t\t\t\t\tconfirmButtonText: value ? t('Yes_archive_it') : t('Yes_unarchive_it'),\n\t\t\t\t\tcancelButtonText: t('Cancel'),\n\t\t\t\t\tcloseOnConfirm: false,\n\t\t\t\t\thtml: false\n\t\t\t\t}, function(confirmed) {\n\t\t\t\t\tswal.disableButtons();\n\t\t\t\t\tif (confirmed) {\n\t\t\t\t\t\tconst action = value ? 'archiveRoom' : 'unarchiveRoom';\n\t\t\t\t\t\treturn Meteor.call(action, room._id, function(err) {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\tswal.enableButtons();\n\t\t\t\t\t\t\t\thandleError(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tswal({\n\t\t\t\t\t\t\t\ttitle: value ? t('Room_archived') : t('Room_has_been_archived'),\n\t\t\t\t\t\t\t\ttext: value ? t('Room_has_been_archived') : t('Room_has_been_unarchived'),\n\t\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t\t\ttimer: 2000,\n\t\t\t\t\t\t\t\tshowConfirmButton: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn RocketChat.callbacks.run(action, room);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn $('.channel-settings form [name=\\'archived\\']').prop('checked', !!room.archived);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tjoinCode: {\n\t\t\ttype: 'text',\n\t\t\tlabel: 'Password',\n\t\t\tcanView(room) {\n\t\t\t\treturn room.t === 'c' && RocketChat.authz.hasAllPermission('edit-room', room._id);\n\t\t\t},\n\t\t\tcanEdit(room) {\n\t\t\t\treturn RocketChat.authz.hasAllPermission('edit-room', room._id);\n\t\t\t},\n\t\t\tsave(value, room) {\n\t\t\t\treturn Meteor.call('saveRoomSettings', room._id, 'joinCode', value, function(err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn handleError(err);\n\t\t\t\t\t}\n\t\t\t\t\ttoastr.success(TAPi18n.__('Room_password_changed_successfully'));\n\t\t\t\t\treturn RocketChat.callbacks.run('roomCodeChanged', room);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\treturn this.saveSetting = () => {\n\t\tconst room = ChatRoom.findOne(this.data && this.data.rid);\n\t\tconst field = this.editing.get();\n\t\tlet value;\n\t\tif (this.settings[field].type === 'select') {\n\t\t\tvalue = this.$(`.channel-settings form [name=${ field }]:checked`).val();\n\t\t} else if (this.settings[field].type === 'boolean') {\n\t\t\tvalue = this.$(`.channel-settings form [name=${ field }]`).is(':checked');\n\t\t} else {\n\t\t\tvalue = this.$(`.channel-settings form [name=${ field }]`).val();\n\t\t}\n\t\tif (value !== room[field]) {\n\t\t\tthis.settings[field].save(value, room);\n\t\t}\n\t\treturn this.editing.set();\n\t};\n});\n"]}