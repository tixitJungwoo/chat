{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:gitlab/common.js","meteor://ðŸ’»app/packages/rocketchat:gitlab/startup.js"],"names":["config","serverURL","identityPath","scope","addAutopublishFields","forLoggedInUser","forOtherUsers","Gitlab","CustomOAuth","Meteor","isServer","startup","RocketChat","settings","get","key","value","configure","Tracker","autorun","addGroup","section","enableQuery","_id","add","type","readonly","force"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wBACA,IAAMA,SAAS;AACdC,YAAW,oBADG;AAEdC,eAAc,cAFA;AAGdC,QAAO,KAHO;AAIdC,uBAAsB;AACrBC,mBAAiB,CAAC,iBAAD,CADI;AAErBC,iBAAe,CAAC,0BAAD;AAFM;AAJR,CAAf;AAUA,IAAMC,SAAS,IAAIC,WAAJ,CAAgB,QAAhB,EAA0BR,MAA1B,CAAf;;AAEA,IAAIS,OAAOC,QAAX,EAAqB;AACpBD,QAAOE,OAAP,CAAe,YAAW;AACzBC,aAAWC,QAAX,CAAoBC,GAApB,CAAwB,gBAAxB,EAA0C,UAASC,GAAT,EAAcC,KAAd,EAAqB;AAC9DhB,UAAOC,SAAP,GAAmBe,KAAnB;AACAT,UAAOU,SAAP,CAAiBjB,MAAjB;AACA,GAHD;AAIA,EALD;AAMA,CAPD,MAOO;AACNS,QAAOE,OAAP,CAAe,YAAW;AACzBO,UAAQC,OAAR,CAAgB,YAAW;AAC1B,OAAIP,WAAWC,QAAX,CAAoBC,GAApB,CAAwB,gBAAxB,CAAJ,EAA+C;AAC9Cd,WAAOC,SAAP,GAAmBW,WAAWC,QAAX,CAAoBC,GAApB,CAAwB,gBAAxB,CAAnB;AACAP,WAAOU,SAAP,CAAiBjB,MAAjB;AACA;AACD,GALD;AAMA,EAPD;AAQA,0E;;;;;;;;;;;AC7BDY,WAAWC,QAAX,CAAoBO,QAApB,CAA6B,OAA7B,EAAsC,YAAW;AAChD,MAAKC,OAAL,CAAa,QAAb,EAAuB,YAAW;AACjC,MAAMC,cAAc;AACnBC,QAAK,uBADc;AAEnBP,UAAO;AAFY,GAApB;AAKA,OAAKQ,GAAL,CAAS,uBAAT,EAAkC,KAAlC,EAAyC;AAAEC,SAAM,SAAR;AAAmB,aAAQ;AAA3B,GAAzC;AACA,OAAKD,GAAL,CAAS,gBAAT,EAA2B,EAA3B,EAA+B;AAAEC,SAAM,QAAR;AAAkBH,2BAAlB;AAA+B,aAAQ;AAAvC,GAA/B;AACA,OAAKE,GAAL,CAAS,0BAAT,EAAqC,EAArC,EAAyC;AAAEC,SAAM,QAAR;AAAkBH;AAAlB,GAAzC;AACA,OAAKE,GAAL,CAAS,8BAAT,EAAyC,EAAzC,EAA6C;AAAEC,SAAM,QAAR;AAAkBH;AAAlB,GAA7C;AACA,OAAKE,GAAL,CAAS,oCAAT,EAA+C,eAA/C,EAAgE;AAAEC,SAAM,aAAR;AAAuBC,aAAU,IAAjC;AAAuCC,UAAO,IAA9C;AAAoDL;AAApD,GAAhE;AACA,EAXD;AAYA,CAbD,yE","file":"/packages/rocketchat_gitlab.js","sourcesContent":["/* global CustomOAuth */\nconst config = {\n\tserverURL: 'https://gitlab.com',\n\tidentityPath: '/api/v3/user',\n\tscope: 'api',\n\taddAutopublishFields: {\n\t\tforLoggedInUser: ['services.gitlab'],\n\t\tforOtherUsers: ['services.gitlab.username']\n\t}\n};\n\nconst Gitlab = new CustomOAuth('gitlab', config);\n\nif (Meteor.isServer) {\n\tMeteor.startup(function() {\n\t\tRocketChat.settings.get('API_Gitlab_URL', function(key, value) {\n\t\t\tconfig.serverURL = value;\n\t\t\tGitlab.configure(config);\n\t\t});\n\t});\n} else {\n\tMeteor.startup(function() {\n\t\tTracker.autorun(function() {\n\t\t\tif (RocketChat.settings.get('API_Gitlab_URL')) {\n\t\t\t\tconfig.serverURL = RocketChat.settings.get('API_Gitlab_URL');\n\t\t\t\tGitlab.configure(config);\n\t\t\t}\n\t\t});\n\t});\n}\n","RocketChat.settings.addGroup('OAuth', function() {\n\tthis.section('GitLab', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Gitlab',\n\t\t\tvalue: true\n\t\t};\n\n\t\tthis.add('Accounts_OAuth_Gitlab', false, { type: 'boolean', public: true });\n\t\tthis.add('API_Gitlab_URL', '', { type: 'string', enableQuery, public: true });\n\t\tthis.add('Accounts_OAuth_Gitlab_id', '', { type: 'string', enableQuery });\n\t\tthis.add('Accounts_OAuth_Gitlab_secret', '', { type: 'string', enableQuery });\n\t\tthis.add('Accounts_OAuth_Gitlab_callback_url', '_oauth/gitlab', { type: 'relativeUrl', readonly: true, force: true, enableQuery });\n\t});\n});\n"]}