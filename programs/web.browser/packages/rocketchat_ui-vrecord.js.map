{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:ui-vrecord/client/vrecord.js","meteor://ðŸ’»app/packages/rocketchat:ui-vrecord/client/VRecDialog.js"],"names":["VRecDialog","module","watch","require","v","Template","vrecDialog","helpers","recordIcon","VideoRecorder","cameraStarted","get","recording","okDisabled","recordingAvailable","recordDisabled","events","stop","close","stopRecording","record","cb","fileUpload","file","blob","type","name","TAPi18n","__","export","initClass","prototype","opened","initiated","width","height","init","Blaze","render","document","body","open","source","dialog","$","setPosition","addClass","initializeCamera","removeClass","video","sourcePos","offset","left","top","css","start"],"mappings":"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","file":"/packages/rocketchat_ui-vrecord.js","sourcesContent":["/* globals VideoRecorder, fileUpload */\nimport {VRecDialog} from './VRecDialog';\n\nTemplate.vrecDialog.helpers({\n\trecordIcon() {\n\t\tif (VideoRecorder.cameraStarted.get() && VideoRecorder.recording.get()) {\n\t\t\treturn 'icon-stop';\n\t\t} else {\n\t\t\treturn 'icon-circle';\n\t\t}\n\t},\n\n\tokDisabled() {\n\t\tif (VideoRecorder.cameraStarted.get() && VideoRecorder.recordingAvailable.get()) {\n\t\t\treturn '';\n\t\t} else {\n\t\t\treturn 'disabled';\n\t\t}\n\t},\n\n\trecordDisabled() {\n\t\treturn VideoRecorder.cameraStarted.get() ? '' : 'disabled';\n\t}\n});\n\n\nTemplate.vrecDialog.events({\n\t'click .vrec-dialog .cancel'() {\n\t\tVideoRecorder.stop();\n\t\tVRecDialog.close();\n\t},\n\n\t'click .vrec-dialog .record'() {\n\t\tif (VideoRecorder.recording.get()) {\n\t\t\tVideoRecorder.stopRecording();\n\t\t} else {\n\t\t\tVideoRecorder.record();\n\t\t}\n\t},\n\n\t'click .vrec-dialog .ok'() {\n\t\tconst cb = blob => {\n\t\t\tfileUpload([{ file: blob, type: 'video', name: `${ TAPi18n.__('Video record') }.webm` }]);\n\t\t\tVRecDialog.close();\n\t\t};\n\t\tVideoRecorder.stop(cb);\n\t}\n});\n","export const VRecDialog = new class {\n\tstatic initClass() {\n\t\tthis.prototype.opened = false;\n\t\tthis.prototype.initiated = false;\n\t\tthis.prototype.width = 400;\n\t\tthis.prototype.height = 280;\n\t}\n\n\tinit() {\n\t\tif (this.initiated) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.initiated = true;\n\t\treturn Blaze.render(Template.vrecDialog, document.body);\n\t}\n\n\topen(source) {\n\t\tif (!this.initiated) {\n\t\t\tthis.init();\n\t\t}\n\n\t\tthis.source = source;\n\t\tconst dialog = $('.vrec-dialog');\n\t\tthis.setPosition(dialog, source);\n\t\tdialog.addClass('show');\n\t\tthis.opened = true;\n\n\t\treturn this.initializeCamera();\n\t}\n\n\tclose() {\n\t\t$('.vrec-dialog').removeClass('show');\n\t\tthis.opened = false;\n\n\t\tif (this.video != null) {\n\t\t\treturn VideoRecorder.stop();\n\t\t}\n\t}\n\n\tsetPosition(dialog, source) {\n\t\tconst sourcePos = $(source).offset();\n\t\tlet left = (sourcePos.left - this.width) + 100;\n\t\tlet top = sourcePos.top - this.height - 40;\n\n\t\tif (left < 0) {\n\t\t\tleft = 10;\n\t\t}\n\t\tif (top < 0) {\n\t\t\ttop = 10;\n\t\t}\n\n\t\treturn dialog.css({ top: `${ top }px`, left: `${ left }px` });\n\t}\n\n\tinitializeCamera() {\n\t\tthis.video = $('.vrec-dialog video').get('0');\n\t\tif (!this.video) {\n\t\t\treturn;\n\t\t}\n\t\treturn VideoRecorder.start(this.video);\n\t}\n};\n"]}